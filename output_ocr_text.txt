============================================================
第 1 页
============================================================

有
面向21世纪课程教材
Textbook Series for 21st Century
运筹学
第四版
刁在筠
刘桂真
编著
戎晓霞
王光辉
高等教育出版社

============================================================
第 2 页
============================================================

定价38.90元
台雅牛
取赠值服务
使用说明详见书内数字课程说明页
40
E-E
http://abook.hep.edu.cn/45487
9"787040"454871>
网址：
http://abook.hep.com.cn/45487
数字课程网站
ISBN 978-7-04-045487-1
aCe
第一版荣获2000年教育部科技进步二等奖
2007年度普通高等教育精品教材
Operations
Research

============================================================
第 3 页
============================================================

有
面向21世纪课程教材
Textbook Series for 21st Century
运筹学
第四版
刁在筠
刘桂真
编著
戎晓霞
王光辉
高等教育出版社

============================================================
第 4 页
============================================================

−
EM
E
①刁… Ⅲ.
筹学-高等
-教
CIP数据核字
の

============================================================
第 5 页
============================================================

(此页无文本内容)

============================================================
第 6 页
============================================================

次编写、再版过程中，广大读者、兄弟院校的教师、运筹学界的专家们给予了极大
的支持和帮助;教育部、山东大学教务处和数学学院的领导给予了热情的鼓励和
资助;高等教育出版社的数任编辑耐心细致地编辑了本书先后四个版次,借此机
会向他们表示我们最衷心的感谢。
本书如有不妥之处，恳请广大读者批评指正。
编者
2015年12月
.

============================================================
第 7 页
============================================================

E
[Ta]
a
Ta
[ae]
展送的片
。

============================================================
第 8 页
============================================================

的示意图给出了第三版各章内容的相关性。
第8章
第1章
第9章
第6章
第2章
第10章
第7章
第3章
第4章
第5章
现在多媒体教学已普及。因而与本书内容相配套的电子教案即将出版发
行，将为教师的多媒体教学提供方便。
本书(第三版)的修改方案设计及组织工作以刁在筠、刘桂真为主，具体修.
改编写分工为：刁在筠(前言及第1，2，3，4章)、刘桂真(第6章)、宿洁(第8,9，
10章及统稿)、马建华(第5，7章)(马建华为山东经济学院教师，其余均为山东
大学教师)，宿洁完成了在原有教学软件基础上的补充完善提高工作。即将出
版发行的《运筹学电子教案》由吴建良(山东大学)和马建华共同完成。
在本书多次的编写修改过程中,运筹学界的专家们和众多兄弟院校的教师
给予了我们极大支持和帮助;教育部、山东大学教务处和数学与系统科学学院的
领导给予了我们热情的鼓励和资助;高等教育出版社的编辑耐心细致地编辑了
本书先后三个版次,借此机会向他们表示我们衷心的感谢。
限于我们的水平，不妥与错误之处在所难免，恳请广大读者批评指正。
编者
2006年9月

============================================================
第 9 页
============================================================

第二版序
运筹学是多种学科的综合性学科，是最早形成的一门软科学。它把科学的
方法、技术和工具应用到包括一个系统管理在内的各种问题上，以便为那些掌管
系统的人们提供最佳的解决问题的办法。它用科学的方法研究与某一系统的最
优管理有关的问题。它能帮助决策人解决那些可以用定量方法和有关理论来处
理的问题。因此运筹学是一门有重要应用价值的学科，特别在现代科学管理中
更是处处离不开运筹学。常言道“运筹帷幄，决胜千里”，足以看出运筹学之重
要。运筹学研究的范围极为广泛，凡一切可以定量化的管理系统都在研究范围
内。它通过构造模型和进行模拟，了解有关因素之间的关系，预测各种供选择的
方案和可以产生的后果，从而选择达到既定目标的最优途径。运筹学是一门应
用性很强的学科,特别是随着社会主义市场经济的发展,运筹学显得更加重要。
更为重要的还在于我国改革开放深入发展的今天,有许多新情况需要研究,有许
多新问题需要决策,这就为更广泛地应用运筹学提供了机遇,并为其发展创造了
条件。因此越来越多的有关专业的大学生和研究生选学了运筹学的课程。另一
方面现代化的大规模生产更需要现代化的科学管理方法。这就使越来越多的管
理人员感到需要学习运筹学的知识。因此出版关于运筹学方面的好教材就十分
必要。于是全国高等学校数学与力学教学指导委员会在全国公开招标编写新的
运筹学教材。山东大学数学与系统科学学院的几位教授通过竞标，编写了《运
筹学》一书，并于1996年在高等教育出版社出版发行。首版发行近5000册，几
乎遍布全国。经多所学校使用，效果好，受到广大师生的欢迎和同行专家的好
评。该书不但选材精练，论述严谨，而且有相当的深度与广度;不但介绍了运筹
学各分支的新成果,新进展，而且还介绍了有关的流行软件。该书于1997年被
教育部评为“九五”重点教材,2000年获教育部科技进步二等奖，目前又被推荐
为“面向21世纪课程教材”再版。
山东大学采用《运筹学》一书所开设的运筹学课程被列为“全国理科基
地创建名牌课程”，并正在准备作为远程网络课程上网。该书编者根据几年
来的教学实践对《运筹学》一书进行了修改，使论证更加严密，数学品位高，
I

============================================================
第 10 页
============================================================

应用性和可操作性强。在修改过程中特别注意到使教材更具有先进性和
系统性。希望该书的再版将对运筹学的教学和研究起到促进作用，特作
此序。
谢力同
2000年12月

============================================================
第 11 页
============================================================

第二版前言
2
本书自1996年出版发行以来，经山东大学和众多兄弟院校几经教学使
用，反映良好，获广大师生和同行专家的认同和好评。本书1997年被教育
部评为“九五”重点教材,2000年获教育部科学技术进步二等奖，现在被推
荐为“高等教育面向21世纪教学内容和课程体系改革计划”的立项项目，再
版发行。
多年来，我们按照邓小平同志提出的“教育要面向现代化，面向世界，面向
未来”的要求，考虑到目前的学生将是21世纪建设祖国的栋梁之材，我们在采
用本书作为教材的运筹学课程的改革与实践中，不断向兄弟院校学习取经，与
同行专家切磋交流，在优化课程体系，改革教学方法和考核办法中做了一些工
作，调动了学生学习的积极性和主动性，提高了教学质量。为了提高学生解决
实际问题的能力，我们配合本书的有关章节，编制了一套教学软件。内容包括
LINDO和LINGO软件包，及相配套的上机实习的应用练习题及考核题，还有
自编的以MATLAB为基础的图论与网络优化、对策论等内容的教学软件。这
使学生在学习书本上的基本理论和基本算法的同时，能在计算机上熟练地操
作解决一些实际应用案例。大家感觉到运筹学是一门具有强烈应用背景的科
学，这门课不再是纸上谈兵了。山东大学的运筹学课程被列为“国家理科基地
创建名牌课程”项目。
根据我们的教学实践和经验，吸取了同行专家和兄弟院校的宝贵建议，再版
之前，我们对全书进行了仔细认真的修改和润色。主要是在保持原书结构和风
格的前提之下，更加注意了思维的开拓与启迪，内容和方法的实用性、先进性和
系统性，习题搭配的合理性等，对目前流行的一些先进软件也作了简单介绍。
全国高等学校数学与力学教学指导委员会及应用数学指导组的专家和众多
的运筹学界同行对本书的修改提了很多宝贵意见。本书得到教育部、山东大学
教务处和数学与系统科学学院的关怀和资助。在本书出版和再版的过程中得到
高等教育出版社的责任编辑胡乃同同志的大力支持和帮助。借此机会向他们一
并表示我们衷心的感谢。
I

============================================================
第 12 页
============================================================

限于我们的水平，不妥与错误之处在所难免，殷切希望得到本书的各位读者
及同行专家的批评指正。我们很愿意为兄弟院校提供交流相关的教学软件，以
期共同提高。
编者
2000年12月16日

============================================================
第 13 页
============================================================

第一版前言
本书是根据国家教委全国高等学校数学与力学教学指导委员会应用数学专
业教材建设组所拟“运筹学”基本要求编写的。本书主要针对大学本科应用数
学专业的特点及要求,同时兼顾了管理、系统工程等专业的要求,论述了运筹学
各主要分支的模型、基本概念与理论、主要算法和应用。它可以作为这些专业
“运筹学”课程的教材，也可以作为相关专业研究生的教材，还可供从事运筹学、
管理科学的工作者和工程技术人员作参考书。
本书的特点是:选材精炼;对各主要分支的基本理论和主要方法的原理给出
了较为严密的论述;内容上有所侧重和更新,体现了现代运筹学的一些特点。为
使读者对本领域的情况有较为全面的了解，以便今后的发展和提高，本书简单提
及了各主要分支的当前发展动向和新成果，并在相关章节介绍了主要算法适用
于计算机的流行软件。在各章末尾附有内容适当、数量充分的习题和参考文献，
在全书末尾附有供参考的习题答案。
全书共有9章，其中带“*”号的内容是供读者自学或选学的材料，可以略
过不读，不影响后续章节内容的学习。讲授全书的基本内容需72学时。由于各
章内容有相对的独立性，讲授者在使用本教材时可根据专业要求对内容作适当
的增减，因此也可作为学时更多或更少的“运筹学”课程的教材。为方便读者阅
读，下面的示意图给出了各章内容的相关性。
第8章
第1章
第7章
第6章
第2章
第9章
第4章
第3章
第5章
I

============================================================
第 14 页
============================================================

本书由刁在筠(第2，3，4章)、郑汉鼎(第5，7,9章)、刘家壮(第1,6章)、刘
桂真(第8章)编写，并由郑汉鼎完成全书书稿的统稿工作。在编写过程中，应
用数学专业教材建设组运筹学责任委员胡毓达教授、俞文教授、王荫清教授给
予了我们热情的帮助和指导；复旦大学陈开明教授、华东师范大学郑英元教授认
真、仔细地审阅了全文,并提出了宝贵的修改意见;全国高校应用数学专业教材
建设组的各位专家及众多运筹学界的同志们对书稿的内容提出了很多好的和积
极的建议;高等教育出版社的责任编辑胡乃同对全部手稿完成了繁重、细致的编
辑、排版工作；山东大学运筹学专业的数位研究生仔细地抄写了全文。在此，我
们一并表示深切的谢意。
由于水平有限,书中难免有不足之处,恳切希望得到运筹学界同志及读者的
批评和指正。
编者
1993年11月完成初稿
1995年8月完成修改稿

============================================================
第 15 页
============================================================

目录
运筹学简介…
1.6灵敏度分析…
55
第1章
线性规划……
1.改变价值向量c
56
1.1 线性规划问题
5
2.改变右端向量b
59
1.7 参数线性规划
60
2.线性规划模型
1.目标函数含参数的线性规划
8
1.2可行区域与基本可
问题
61
行解
2.右端向量含参数的线性规划
10
问题
64
1.图解法
10
1.8算法复杂性及解线性规划
2.可行区域的几何结构
12
问题的进一步研究
3.基本可行解及线性规划的
1.算法的复杂性
基本定理…
14
2.解线性规划问题的进一步
1.3单纯形方法………………
19
研究
70
1. 单纯形方法…………………
19
第1章习题……
72
2.单纯形表……………
25
参考文献……
82
1.4 初始解……
33
第2章整数线性规划
84
1.两阶段法……
33
2.1 整数线性规划问题
2.关于单纯形方法的几点
1.整数线性规划问题举例
…… 84
说明
39
2.解整数线性规划问题的
1.5 对偶性及对偶单纯
困难性
87
形法
40
2.2 Gomory 割平面法 ……
88
1.对偶线性规划
1. Gomory 割平面法的基本
2.对偶理论…
… 44
思想
88
3.原始和对偶问题的解及其
2. Gomory 割平面法计算
经济意义…
. 48
步骤
91
4.对偶单纯形法…
… 52
2.3 分枝定界法…
95
I

============================================================
第 16 页
============================================================

1.分枝定界法的基本思想
…… 96
4.一般多阶段决策问题………
161
2.分枝定界法的计算步骤
…… 97
4.2 最优化原理
… 163
第2章习题
… 101
1.用递推法解最短路问题 …… 163
参考文献…
…… 103
2.最优化原理
第3章 非线性规划……………105
4.3
确定性的定期多阶段
决策问题
168
1.非线性规划问题
…
105
1．旅行售货员问题
169
2.多阶段资源分配问题
3.2 凸函数和凸规·……… 111
3.可靠性问题
174
1.凸函数及其性质
4.4确定性的不定期多阶段
2.凸规划及其性质
决策问题
177
3.3 一维搜索方法
1.最优线路问题
177
1.0.618法(近似黄金分
2.有限资源分配问题………
182
割法）…
118
第4章习题
186
2. Newton 法…
参考文献
188
3.4无约束最优化方法………123
第5章
图与网络分析…………
190
1.无约束问题的最优性条件
… 123
5.1 图与子图
190
2.最速下降法
125
1.图与网络
190
3.共轭方向法
127
2.图的关联矩阵和邻接矩阵
…
193
3.5 约束最优化方法.…………133
3.子图…
195
1.约束最优化问题的最优性
5.2 图的连通性
197
条件……
133
1.图的连通
198
2.简约梯度法
2.图的割集
200
3.惩罚函数法
5.3 树与支撑树
202
第3章习题
…
1.树及其基本性质
……
202
参考文献 …
… 157
2.支撑树及其基本性质………
204
5.4 最小树问题
205
4.1
1 多阶段决策问题…………159
1.最小树及其性质
206
1.最短路问题
2.求最小树的 Kruskal 算法
… 208
2.资源分配问题
… 160
3. Dijkstra 算法…·
209
… 160
3.生产-库存问题
5.5 最短有向路问题………
210
Ⅱ

============================================================
第 17 页
============================================================

1．最短有向路方程
211
第6章习题
262
2.求最短有向路的Dijkstra
参考文献
265
算法…
212
第7章 排队论…
266
5.6 最大流问题
7.1 随机服务系统概论
266
1.最大流最小割定理…………214
1.随机服务系统的基本组成
2.最大流算法
… 217
部分…
266
5.7 最小费用流问题………… 219
2.几个常用的概率分布和最
1.最小费用流算法
… 219
简单流……
267
3.可靠性问题
5.1 图与子图
问题……
… 225
1.M/M/1/∞系统
… 271
5.8 最大对集问题
2.M/M/1/k系统
276
1.二分图的对集
3.M/M/c/∞系统
1.最优线路问题
4.排队系统费用优化决策 …… 283
3.二分网络的最大权对集
7.3
有限源排队系统…………285
分派问题…………
…… 235
5.9 复杂网络简介
……
1.复杂网络基本模型………… 238
第7章习题
289
2.几个常用的网络统计量
…… 239
参考文献
292
第5章习题
241
第8章决策分析……
参考文献 ……
8.1
第6章 网络计划技术…………247
6.1 网络计划图
2.决策的数学模型
294
1.基本术语 …
…… 248
8.2 风险型决策分析…………
295
2. Newton 法…
1．进行风险型决策分析的基本
3.节点图 …
252
条件和方法
295
3.生产-库存问题
2.决策树 …………
298
1.工作持续时间
253
8.3 不确定型决策分析………301
2.节点时间
254
1.不确定型决策分析的条件…302
3.工作时间
255
2.不确定型决策分析的基本
4.关键路线
256
方法…
302
6.3 网络计划的优化…………
256
8.4效用函数和信息的
I

============================================================
第 18 页
============================================================

330
价值.
306
局势.
1. 效用函数及其应用…………306
1．对抗对策及其平衡局势
2.信息的价值
309
…… 331
2.n人对策及其平衡局势
第8章习题
… 313
参考文献 ……
315
……………
334
…
9.4 合作对策
1.特征函数 …………………
334
9.1 引言……
…… 316
2.分配………
338
1.对策论发展简史
3.核心与稳定集
………
339
2.对策模型
4.核仁………
342
3. 例子 ……
…… 318
5. Shapley值………………
344
9.2 矩阵对策的平衡局势
…… 320
9.5 网络对策
347
1.矩阵对策及其平衡局势
…… 320
1.图形对策
347
2.矩阵对策的混合扩充……… 323
2.合作交流对策
349
3.矩阵对策的简化
………… 324
第9章习题
351
4.线性规划求解方法…………327
353
参考文献
9.3 非合作对策的平衡
习题参考答案或提示……………
355

============================================================
第 19 页
============================================================

运筹学简介
1．运筹学的发展及展望
运筹学(operational research)是20世纪新兴的学科之一,它能帮助决策者应
用分析、实验、量化等方法，对有限资源如人、财、物等进行统筹安排，以取得最
佳、最有效的管理方案.
朴素的运筹学思想在我国古代文献中就有记载.例如著名的战国时代齐王
和田忌赛马的故事.在第二次世界大战中,各国的运筹学工作者进行了大量战略
战术方面的运筹分析，为取得反法西斯战争的胜利做出了贡献.“二战”后，随着
电子计算机技术的迅速发展,运筹学被广泛应用于民用领域,用来提高工作效率
和生产力,产生了巨大的经济效益.进人21世纪以来,大型网络的迅猛发展,使
它逐渐渗透到人们生产、生活和战备的各个领域，引起了某些行业颠覆性的创
新.现在人们已普遍应用的计算机互联网主要是提供数据服务；而移动互联网提
供了方便、快捷的电信服务和媒体服务;电子商务异军突起，推动了商业业态的
变化,还通过网络融入金融,正在改变传统的金融业务；下一代互联网将与物联
网的服务相结合，然后进入生产服务，通过网络技术实现产品的全生命周期管
理，它不仅控制了整个生产过程，还包括零配件供应链的管理、人力资源的管理、
物质资源的管理及客户关系管理等方面.我国经济在深人改革中，经过多年高速
高效发展后,现正步入新常态的重要转型期.创新驱动是实现新常态的关键.创
新是多方面的,但科技创新的地位和作用十分重要.用网络科技来蜕变传统业
态、激发企业创新的积极性，提高劳动和资本的边际产出率极为迫切.因此，社
会、经济、战备的发展创新为运筹学工作者开辟了巨大的用武之地和广阔的研究
领域.可以说,无论在哪一个大型网络管理中都要融人运筹学的优化、管理技能，
因而运筹学本身也得到不断向前发展的动力.高校中越来越多的专业开设了有
关运筹学的课程,以适应当前形势发展对人才多方面的要求.
2.运筹学的基本特点及工作步骤
运筹学是一门科学,更是一门艺术.说它是一门科学,首先是因为它是由多
种学科形成的综合性科学,具有多学科交叉的特点;任何决策都包含定量和定性
1

============================================================
第 20 页
============================================================

两方面,运筹学强调以数量化为基础,因而它是一门以数学为主要工具,给出各
种问题最优方案的量化分析,并指出那些定性因素力度的学科,这是运筹学的第
二个特点;运筹学的第三个特点是它研究问题着眼于全局,从系统的观点出发，
达到整体的优化结果.说它是一门艺术,是因为运筹学的研究发展还需引人一些
非数学的方法和理论,研究和运用运筹学的每一个步骤,都取决于运筹学工作者
的创造性和经验，需要与人沟通、合作、组织、渗透、平衡等方面的技能，这种精巧
的艺术构思和运作是运筹学的第四个特点.近些年软运筹学崛起,对于那些非结
构性的复杂问题,运用软运筹学的方法解决称为软计算.这种方法不追求严格最
优,具有启发式思路,并借用其他学科的思想来得到寻优方法,如著名的遗传算
法、模拟退火、神经网络、模糊逻辑、进化算法、蚁群优化，等等，这表明了运筹学
智能化发展的趋势,这是运筹学的第五个特点.
基于运筹学的这些特点,在解决大量的实际问题时我们很难规定具体的步
骤,但根据实践经验仍可提出一些通行的工作步骤.
(1) 提出和形成问题即要搜集相关资料,弄清问题要求的目标,可能的约
束条件,问题的可控变量以及有关参数.
(2) 建立模型即把问题中的可控变量、参数和目标与约束之间的关系用
一定的模型表示出来.
(3)求解用各种手段(主要是数学方法，也可用其他学科的方法)对模型
求解,解可以是最优解,次优解,满意解.对于超大规模的问题,特别是需实时控
制问题的求解需要用并行运行的计算机,甚至是目前正在深入研究并已经局部
实现的量子计算机、量子传输等工具.对大量一般的问题求解,成功运用的软件
已有很多，如MATLAB、LINDO、LINGO、WinQSB和Excel,等等.
(4) 解的检验将实际问题数据代人模型求得的解毕竟是模型的解,而模
型只是对实际问题理想化的近似.为了检验得到的解是否正确,常采用回溯的方
法,即将历史资料输入模型,研究得到的解与历史实际的符合程度，以判断模型
及解是否正确.
(5)解的控制任何模型都有一定的适用范围,模型的解是否有效首先
需考虑模型是否继续有效.依据灵敏度分析方法,确定最优解保持稳定时的参
数变化范围,一旦实际参数变化超过这个范围时,及时对模型及导出的解进行
修正.
(6)解的实施将求得的解用到实际中必须考虑到实施的问题,如向实际
部门讲清楚解的用法,可能产生的问题及如何修正.
以上过程应反复进行.
2

============================================================
第 21 页
============================================================

3.运筹学的主要分支
按所解决问题性质上的差别,将实际问题归结为不同类型的数学模型,这些
不同类型的数学模型构成了运筹学的各个分支，主要的分支有线性规划、非线性
规划、整数规划、动态规划、多目标规划、随机规划、图与网络分析、排队论、决策
论、对策论、存储论、可靠性理论、模型论、投人产出分析等.它们中的每一个分支
都有丰富的内容，均可独立成册.
上述的前六个部分统称为规划论,它们主要解决两个方面的问题:一个是对
于给定的人力、物力、财力等资源,怎样才能发挥它们的最大效益;另一个是对于
给定的任务,怎样才能用最少的人力、物力和财力去完成它.
图与网络分析主要研究生产管理等系统中经常遇到的工序间的合理衔接搭
配问题,设计中经常碰到的研究各种管道、线路的通过能力以及仓库、附属设施
的布局等问题.在运筹学中把一些研究的对象用节点表示,对象之间的联系用连
线(边)表示，点、边的集合构成图.如果给图中各边赋以某些具体的权数,并指定
了起点和终点,称这样的图为网络图.图与网络分析这一分支通过对图与网络的
性质及优化的研究，解决设计与管理中的实际问题,特别是解决大规模、复杂网
络系统问题.
排队论是一种研究排队服务系统工作过程优化的数学理论和方法.在这类
系统中,服务对象何时到达以及系统对每个对象的服务时间是随机的.排队论通
过找出这类系统工作特征的数值,为设计新的服务系统和改进现有系统提供数
量依据.
决策论所研究的问题普遍存在,凡对于“举棋不定”的问题都必须做出决策.
人们之所以举棋不定,是因为在着手实现某个预期目标时,有多种策略可选择，
采用不同的策略会得到不同的结局和效果.决策者通过对系统状态、采取的策略
及效果的度量进行综合研究,来确定决策准则,并选择最优的决策方案.
对策论又称为博弈论,是一种用来研究具有利害冲突的各方,如何制订出对
自己有利从而战胜对手的斗争策略.前面提到的齐王和田忌赛马的故事就是对
策论的一个绝妙的例子.
其他分支的一些介绍可参见有关参考文献.
参考文献
[1]哈姆迪·A.塔哈(Hamdy A.Taha).运筹学导论(基础篇)[M].刘德刚，朱建
明，韩继业，译.9版.北京：中国人民大学出版社，2014.
3

============================================================
第 22 页
============================================================

[2]《运筹学》教材编写组.运筹学[M].4版.北京:清华大学出版社,2012.
[3]胡运权，等.运筹学基础及应用[M].6版.北京:高等教育出版社，2014.
[4]谢力同,刘家壮.运筹学的起源和发展之我见[J].军事运筹，1988，1(1):1-8.
[5]周华任，马亚平.随机运筹学[M].北京:清华大学出版社，2012.
[6]张杰，郭丽杰，周硕，林彤.运筹学模型及其应用[M].北京：清华大学出版
社,2012.
[7]卓新建.运筹学[M].北京:北京邮电大学出版社,2013.

============================================================
第 23 页
============================================================

第1章
线性规划
线性规划是运筹学的一个基本分支，其应用极其广泛，其作用也已被越来
越多的人所重视，从线性规划诞生至今的几十年中，随着计算机的逐渐普及，
它越来越迅速地渗透于工农业
生产商业活动军事行动和科学研究的各个方
面为社会节省的财富创
值无法估量最近30多年来，线性规划无论
是在深度还是在广度方面
取得了重大进展
本章先通过例子归纳线性规划数学模型的一般形式，然后着重介绍有关
线性规划的一些基本概念基本理论及解线性规划问题的若干方法
1.1 线性规划问题
在各类经济活动中,经常遇到这样的问题:在生产条件不变的情况下,如何
通过统筹安排，改进生产组织或计划，合理安排人力、物力资源，组织生产过程，
使总的经济效益最好.这种问题常常可以化成或近似地化成所谓的“线性规划”
(Linear Programming，简记为LP)问题.本节先举例介绍线性规划问题,然后给出
线性规划问题的一般形式、规范形式和标准形式定义及其矩阵和向量表达式,并
证明三种形式的LP问题是等价的.
1.线性规划问题举例
下面我们举几个例子.
例1.1.1某工厂用3种原料P_{1},P_₂2，P_3生产2种产品Q_{1}，Q_{₂2.已知的条件
如表1.1.1所示,试制订出总利润最大的月生产计划.
分析设产品Q的月产量为x{个单位，j=1,2，它们受到一些条件的限制.
首先，它们不能取负值,即必须有x{,≥0,j=1,2;其次，根据题设,三种原料的月消
耗量分别不能超过它们的月可用量,即它们又必须满足：
$x1+x₂2≤150
2x_1+3x_2≤240
3x,1+2x{2≤300$.
5

============================================================
第 24 页
============================================================

表1.1.1
产品
单位产品所需原料数量/吨。原料可用量/(吨月)
$
$P_3
万元吨2.41.8
Eab
上约束条件$，求$x{1}，x{2}使其
[
+1.8
150
≤240
≤30
.的=0,=1,2.
其中max是板大化(maxmnzc)的商记符
Ya
[T]
aA定制造，要把若1单位的品AA_2两库发题到售点
2,3,4.假设能供应的总量等于需要的总量，即∑$a_{=Σb_{，且已知从仓库A.运
一个单位的产品到B,的运价为c_{问应如何组织运输才能使总的运输费用最小？
以
不
分析假定运费与运量成正比，一般地,采用不同的调运方案,总运费很可
{x
A_{1}，A_{2两仓库运在西地的)品数量志和应该方别定
B。
x11
−

============================================================
第 25 页
============================================================

$x_13+x_{23}3$
$x{14+x{24=4$
最后，x{表示运量，不能取负值，即x{≥0(i=1,2；j=1，2,3，4).我们希望在满足
供需要求的条件下，求x{(i=1,2；j=1，2，3，4)，使总运费最省.总的运输费用为
zx²+²x+2x2）+x2）+x）+₁x）+x²₁）+x=z
归纳以上分析,该问题的数学模型为
minz=_₁1x₁+C₁2₂+C₁3₁₃+C₁4x₁+
C2121+22x22+C₂3x23+C24x24
$S.t.x₁1+12+x13+_₁=a1$
x_{21+x2+x23+x24=a2}$
= b_{1}$
$x_{1{1}$
$= b_{}$
$x_{2+2}$
= b_{}$
x_{3+x{223$
$x_{+x{22}$
= b}$
x₁j≥0，i=1,2；j=1,2,3,4
其中min是极小化(minimize)的简记符号.
在本例题中发点A_{₁}，A_{2$处的产品供应总量是($a_{}+a_2)个单位，而四个收点
B_{2}，B_{2}B_{3，B{4}$处的产品需求总量是(b_{1}+b_{2+b_₃3+b_{4})个单位，两者相等$这-类问题
称为收发平衡型的运输问题.当然也可以研究收发不平衡型运输问题.
一般的运输问题可表述如下:要把某种物资从m个发点A{，i=1，2，…，m_，调运
给需要这种物资的n个收点B_{j=1$，2，…$，n；发点A_{，拥有物资量为$a_{}，i=1，2$，，m_；
7
n
收点B_{}$的需求量是b_{j=1，2}，，n.已知∑$a_{=Σb_{}，从A_{}运-个单位物资到
三
三
B_{}$的运价是$c_{{现在要确定-个调运方案{即确定由A_{}到B{}的运输量$x{_}$i=1},
2，…，m_，j=1，2，…，n，在满足供需要求的条件下，使总运输费用最省.
由类似的分析,我们知道一般运输问题的数学模型是
m
n
可
n
s.t.
司
m
∑x=b₁，j=1,2，…,n
i=
x₁≥0，i=1,2，.，m；j=1,2,…,n
7

============================================================
第 26 页
============================================================

这样的例子不胜枚举.这些例子的具体内容各不相同,但归结出的数学模型
却属于同一类问题,即在一组线性等式或不等式的约束之下，求一个线性函数的
最大值或最小值的问题,我们将这类问题称为线性规划问题.
2.线性规划模型
线性规划问题的一般形式为
min
z=c_₁1x_}+  + C{{}
s.t.
a_{1x1+a₁2x2++ainn=b₁，i=1，·，p
$a₁1x₁1+a₂2x2++anx₂≥b₁，i=p+1，…，m（1.1.1)
x₁≥0，j= 1,.,q
x,≥0，j= q+1, .,n
其中x{}，j=1，…，n，为待定的决策变量，已知的系数a{组成的矩阵
$a1$
a12
$a_1n$
$a_{22$
$a22$
$a_{2$
A=
…
…
…
$a^m}$
$a_2}$
$a_m{$
称为约束矩阵.A$的列向量记为A_{，j=1，…，n；A$的行向量记为A{，$=1，，m
（本书中出现的向量均为列向量，T为转置符号).称c_{₁}x_1}+c_{2_2++c_{x，为目标函
n
数，记为z=∑c{x₁，向量c=（c₁，…，cn)称为价值向量，c(j=1，…，n）称为价值
$=
系数；向量b=（b{1，.，b{)称为右端向量，条件x{≥0称为非负约束；符号x{}≥0
表示变量x;可取正值、负值或零值,称这样的变量为符号无限制变量或自由变量.
π
n
如果原问题是求目标函数∑$c_{x{}$的最大值,则可等价地转换为求Σ(-c_{_{})$的最
三
小值.因此,一般我们考虑的均是求最小值的问题.
一个满足所有约束条件的向量x=（_{1}，，x_{n){称为问题(1.1.1）的
可行解或可行点.所有的可行点组成的集合称为问题（1.1.1）的可行区域，
记为D.
由线性代数和微分学中求条件极值的知识知,给定一个线性规划问题，下列
三种情况必居其一：(1)D=，称该问题无解或不可行；(2)D≠，但目标函数
在D上无界，此时称该问题无界；(3)D≠∅，且目标函数有有限的最优值，此时
称该问题有最优解.求解一个线性规划问题就是要判断该问题属于哪种情况,当
问题有最优解时,还需要在可行区域中求出使目标函数达到最小值的点,也就是
最优解,以及目标函数的最优值.
8

============================================================
第 27 页
============================================================

在很多时候,我们往往考虑的是LP问题(1.1.1)的某些特殊情况.当p=0$,
q=n时，(1.1.1)形式的LP用矩阵向量的形式表示为
min
$c^{ $
(1.1.2)
{s. t. Ax≥b
x≥0
称(1.1.2)形式的LP为规范形式.当p=m,q=n时，问题(1.1.1)为
min
$c^{x x$
s.t.
Ax=b$
(1.1.3)
x≥0
称(1.1.3)形式的LP为标准形式.而(1.1.1)形式的LP称为一般形式.
其实，这三种形式的LP问题都是等价的，即一种形式的LP可以简单地变
换为另一种形式的LP，且它们有相同的解.由于规范形式和标准形式也属于一
般形式,因此只需说明一般形式可变换为规范形式和标准形式即可.
(1)为了把一般形式的LP变换为规范形式,我们必须消除等式约束和符号
无限制变量.在一般形式的LP中，一个等式约束
"
可用下述两个不等式约束去替代
π
∑
$a_{{,}≥b}$
n
∑（-a)x,≥(-b₁)
1=1
对于一个符号无限制变量x{}≥0$，引进两个非负变量$x{}≥0和$x{}≥0，并设
$x_₁=x-x}$
这样就把一般形式的LP变换为规范形式.
（2)为了把一般形式的LP变换为标准形式，必须消除其不等式约束和符号
无限制变量.对后者的处理可按上述方法进行.对一个不等式约束
n.
可引用一个非负变量s{，用
"
了
a{jx-s=b}，s1≥
三
代替上述的不等式约束.称s;为剩余变量.如果在形成LP问题时,得到下述形式
的约束
9

============================================================
第 28 页
============================================================

n
可引进非负变量$s{,用
n
代替这个不等式约束.这样的变量s;称为松弛变量.
例1.1.3将下面的LP问题化成标准形式：
max
z=-x₁+x2
s.t.$2x_{1-$x__2}≥-2
$x_{1}-2x_{2≤2
(1.1.4)
$x_{1}+x{2}}≤
$x_{_1} 0$
解对自由变量$x_{₂2}用$x_3}-x_{4}$代替$；对第$个不等式约束添加剩余变量$x_{}，对
第二、第三个不等式约束分别添加松弛变量x_{0}，x_{2}，再用$z=-z代替原来的目标函
数,便得到了标准形式的LP问题
min$z=x_₁-(x_₃-x_₄)
s.t.2x₁1-（x₃3-x4)-x_5
=-2
x₁-2(x₃3-x₄)
+x6$
=2
(1.1.5)
$x{1+（x_3-x)
+ x_{_2} = 5$
x1，x₃，x₄，x，x，x≥0
1.2可行区域与基本可行解
在LP问题中，目标函数和可行区域是彼此独立但又相互联系的两个部分.
这一节我们主要讨论可行区域D的结构,给出基本可行解的概念及线性规划的
基本定理.
1.图解法
如果一个线性规划问题只有两个变量,则它的可行区域可以在平面上具体
画出.这便于我们直观地了解可行区域D的结构,同时又可方便地利用目标函数
与可行区域的关系用图解法求解该问题.
例1.2.1解线性规划
10

============================================================
第 29 页
============================================================

max
z=-x_{1+x{2}$
s.t.
$2x_{_}- $x_{2}  2$
$x_{1}-2x{2}}≤2
x{1+x_{2≤5
$x_{≥0 $x{2}}= 0$
解这一问题的可行区域如图$1.2.1所示.变量x_{}，x_{2$的非负约束决定了可
行区域必须在第一象限;不等式约束
$2x{1} -x{2  2$
决定了以直线$2x_{1}-x_{2=-2为边界的右下半
$x_{2}}$
$2x_{1}-x{2}=--2$
平面;其他两个不等式也决定了两个半平
z=3$
面.所以，可行区域D是由三个不等式约束
z=1.5
所决定的三个半平面在第一象限中的交
A2
z=0
集，即图$1.2.1中的区域OA_{₁}A_{2A_3}A_{4}O.在区
域OA_{₁}A₂2}A3A_4}O$的内部及边界上的每一个
$x_{1}+x2}=5$
$x_{1}-2{2}=2$
点都是可行点.目标函数的等值线束z=
D
$A_{3}$
-x_{}+_₂2(z取定某$个常值)沿着它的法线
方向(-$1，1)^{移动，当移动到点$A_{2}=}$1$，
${{2}$
0
$A{4}$
二一
4)^{}时,再继续移动就与区域D不相交了.
图1.2.1
于是$A_{2}$点就是最优解，而最优值为$z=-1+
4=3.图1.2.1中画出了$z=0$,z=1.5和$z=3的等值线.
上面求解例1.2.1的过程称为对两个变量的线性规划问题的图解法.
如果将例1.2.1中的目标函数改为求
$z=4x{}-2x₂2的最小值，可行区域不变，用图解
$x_{2}2}$
z=-4
z=-2
法求解的过程如图1.2.2所示.平行线束z=
$2=0$
4x，}-2x{2沿着它的负法线方向(-4，2)移动，
A2
当移动到与可行区域D的一条边A,A重合
(此时z=-4)时，再继续移动就与D不相交
了.于是，线段A{A_{₂2上的每一个点均使目标
$A_{1}$
函数$z=4x_{}-2x_{₂2达到最小值-4，即线段A_{}A{2
上的每一个点均为该问题的最优解.特别地，
$x_{{1}$
0
线段A{A_{₂2的两个端点，即可行区域D的两个
$A_}$
顶点A_₁}=(0，2)，A_₂=（1，4)均是该线性规
图1.2.2
划问题的最优解.

============================================================
第 30 页
============================================================

例1.2.2用图解法解线性规划
min$z=-2x__+x_{2$
$s.t.$x_{1+x_{2}≥=1$
x{1-3x2≥-3
$x_{1≥0 x{2}}= 0$
解该问题的可行区域如图1.2.3所示,这是个无界的区域.让平行线束
z=-2x_{1}+x_{2沿着它的负法线方向(2}，-1){移动，可以无限制地移动下去，一直与
D相交.所以该线性规划问题的最小值是负无穷,无最优解,即该问题无界.在实
际问题中出现这种情形多半是数学模型有问题.
$x_{2
$z=-2x_1+x2}$
$x_{1}-3x{2}=-3$
A
B
$xo}$
$x_1x2=1$
图1.2.3
从图解法的几何直观容易得到下面两个重要结论：
(1)线性规划的可行区域D是若干个半平面的交集，它形成了一个有界的
或无界的凸多边形.
(2)对于给定的线性规划问题,如果它有最优解，最优解总可以在D的某个
顶点上达到.
对于具有n个变量的一般的线性规划问题也有类似的结论.为此我们要引
进若干定义将二维平面上的直线推广到高维空间中的超平面,将二维平面上的
凸多边形推广到高维空间中的多面凸集;然后确切地定义多面凸集的顶点,即基
本可行解;最后证明LP问题若存在最优解,则一定可以在某一个基本可行解上
达到.
2.可行区域的几何结构
不失一般性,考虑标准形式的LP问题
12

============================================================
第 31 页
============================================================

min $z = c^{
(1.2.1)
s.t.Ax = b
x≥0
我们用R^{"表示n维欧氏空间，这里x∈_{"},
c∈R{，b∈Rm，A∈R^m".不妨设可行区域D=$
+2
{x∈R^{|Ax=b_，x≥0}≠$，因而线性方程组
Ax=b相容，总可以把多余方程去掉，使剩下
的等式约束的系数向量线性无关.故可设
秩(A)=m,m<n
集合$S{1}$
首先，对凸集下定义.直观地我们知道:平
面上的长方形与圆、空间中的平行六面体与椭
球体等都是凸的.它们的共同特性是:形体中
集合$S_{2}$
任何两点的连线段整个地落在该形体中.没有
图1.2.4
这个特性的形体就不是凸的.图1.2.4中画出
的集合$_{1$是凸的，S_{2不是凸的.所以我们以此特性作为一般凸集的定义.
定义1.2.1设$SCR^{}是n维欧氏空间中的一个点集，若对任何x∈_,y∈S_
与任何λ∈[0,1]，都有
λx+(1-λ)y∈S
就称S是一个凸集.
定理1.2.1D={x∈R^{|Ax=b，x≥0}$是凸集.
证任取x，y∈D，w=λx+(1-λ)y，其中λ∈[0，1].由于x≥0，y≥0，故
w≥0.又Ax=b，Ay=b，故
Aw=λAx+(1-λ)Ay=b
即w∈D.I
凸集的一个重要性质是：
定理1.2.2任意多个凸集的交集还是凸集.
(证明留作习题.)
定义$1.2.2给定b∈^{1}及非零向量$a∈R^{}，称集合
H=x∈R|ax=b}
是R"中的一个超平面.
显然，超平面是二维空间中的直线、三维空间中的平面在高维空间中的推
广.易证超平面H是凸集.
由超平面H产生了两个闭的半空间
H+={x∈R"|a{x≥b}
13

============================================================
第 32 页
============================================================

H=x∈R{|a{x≤b1
它们都是凸集.
由于凸集的交还是凸集，因而满足一组线性等式
$a{x=b₁，i=1, ,
(1.2.2)
与一组线性不等式
(1.2.3)
$ax≥b₁，i=p+1，.,p+q
的全体向量x的集合也是凸集，这里的p或q可以为零.
定义1.2.3称满足(1.2.2)与(1.2.3)的全体x所构成的集合
S=x∈R|ax=b₁，i=1,·，,p;
$a{1x≥b₁，i=p+1,·，,p+q}
为多面凸集.特别称非空有界的多面凸集为多面体.
由以上定义知线性规划问题的可行区域D=x∈R^{|Ax=b，x≥0|是多面
凸集.
现在我们来说明什么是凸集的顶点.在例1.2.1中,由图1.2.1看出可行区
域D有五个“顶点”：(0，0)，(0，2)，(1，4)，(4，1)，(2，0).容易看到，D中除
了这五点以外，无论是边线上的点，还是区域内部的点，都能表示成D中另外两
点连线中的某一点,但这五个“顶点”却不能.以此为特征我们给出以下定义.
定义$1.2.4设S是凸集，x∈S.若对任何y∈S_$，z∈S_,y≠z，以及任何0<λ<1,
都有
x≠λy+(1-λ)z
则称x为凸集S的一个顶点.
按此定义，长方形的四个角点就是长方形区域的全部顶点，而圆周上的点则
是圆形区域的全部顶点，在图$1.2.1中可行区域D的五个点$O，A_{1}，A_2，A_₃3}，A_{4}是
D的顶点.与顶点$A{，相邻的顶点是原点$O和点$A_{₂2}，与顶点$A_{2相邻的顶点是A_{}，
A3}，如此等等.在图1.2.1中每个顶点至少是两条直线的交点.一般地，对标准形
式的LP问题(1.2.1)，当可行区域非空时，可以证明其多面凸集D一定有顶点，
每个顶点至少是n-m个超平面的交点.至于多面凸集D的顶点个数的有限性，
在下一段我们给出了顶点的代数结构后,结论将是清楚的.
3.基本可行解及线性规划的基本定理
我们考虑标准形式的线性规划问题(1.2.1).由于假设秩(A)=m，故A中必
有m个线性无关的列向量，它们构成满秩方阵B，把A中其余各列组成的子阵
记为N，即A=(B，N)$再把x=(x_{₁1，，x_n})^{1的分量也相应地分为两部分，记为
x_{和x_{n}，则Ax=b可记作
14

============================================================
第 33 页
============================================================

Bx _B}+Nx{n}=bb
由于B是满秩方阵，B^存在.上式两边同时左乘B^{{1}，移项后得
x_B=Bb-B}Nx{N
根据线性方程组理论，可以把x{n视为一组自由变量，给它任意一组值x{n，则可
$B})
得到对应$的x_{b$的-组值x_{b}$于是x=$
便是约束方程组Ax=b的一个解.特别
$}$
B^{b}$
地，令x_{=0，我们得到约束方程组的一种特殊形式的解x=
.对此,我们
有下面的定义.
定义$1.2.5设B是秩为m的约束矩阵A∈^m^"中的一个m阶满秩子方
阵，则称B为一个基(或基阵).B中m个线性无关的列向量称为基向量，变量x
中与之对应的m个分量称为基变量，其余的分量称为非基变量.令所有的非基
xB_B^b$
变量取值为零,得到的解x=
=
称为相应$B$的}基$解.当B^{}b_{}}0$
x{n$
0
时，称基本解x为基本可行解，这时对应的基B称为可行基.
例如转换为标准形式的例1.2.1中的LP问题是：
min$z=x_{1-x_2
s.t.2x₁-_2-x_3
=-2
$x_{1}-2x}$
+x$
=2
(1.2.4)
$x_{_}+x2}$
$+x_{}= 5$
x{}≥0,j=1,2,3,4,5
(1.2.4)式所示LP问题的约束矩阵为
2
-1
-1
0
0
A=
1
-2
0
1
0
1
1
0
0
1
根据以上定义
(-1
0
0
$B_{1}=$
0
001)
是一个基，它所对应的基本解为x^{=(0，0,2,2,5)^;
(200)
$B_{2}=$
11 0
1
15

============================================================
第 34 页
============================================================

也是一个基，它所对应的基本解为$x^{2=(-1，0$，0$，3，6){但基本解x{2的第一个分
量为负值，不满足变量非负的要求,因此$x^{2}不是可行解，而$^{$是基本可行解，B_{}$
是可行基.
给出一个基本解,我们立即知道它是否是可行解，下面的定理给出了判别一
个可行解是否是基本可行解的准则.
定理1.2.3可行解x是基本可行解的充要条件是它的正分量所对应的A
中列向量线性无关.
证不妨设x的前k个分量为正分量，即
x=（x₁，…，x,0，…，0)
x; >0,j=1,..,k
若x是基本可行解,则取正值的变量必定是基变量，它们所对应的约束矩阵
A中的列向量A_{}，…，A_k是基向量，故必线性无关.
反之，若A_{1}，，A_{k线性无关，则必有$k≤m$.由于x$是可行解，有A$x=b$，故有
k
∑x_A{}=b
回
若k=m，则B=(A_{₁}，，A_{k)$就是$个基，x为B所对应的基本可行解；若k<m$，因
为秩(A)=m，则一定可以从其余的n-hk个列向量中再挑选出m-k个，不妨设为
A+1}，…，A}，使A_{₁}，，A_}，Ak₁}，…，A{m构成基B，易知x为相应于基B$的基本可
行解。1
由定义知，基本可行解至少有n-m个分量为零,从几何上看它至少属于
n-m个超平面的交集.容易想象，基本可行解对应的是可行域多面凸集D的顶点.
下面给出证明.
定理1.2.4x是基本可行解的充要条件是x是可行域D的顶点.
证充分性.设x是D的顶点，我们仍设它的前k个分量取正值，这时其对
应的列A_{}，…，A_{k必定是线性无关的.事实上，如果它们相关，则存在非零向量
$y=（y₁1，…，y_，0，…，0)使得
k
∑yA{1}=0=0$
i
于是对任一正实数δ都有
&
∑（x, ±δy,)A,}=bb
=
与上式等价地，当取x^{1=x+δy，x^2=x-δy时总有Ax^{=Ax²2=b.因为x₁>0，j=1，…，k$
当δ>0取充分小时有x^{1}≥0，x^{2}≥0$，故有x^{1∈D，x^{2∈$D$.由于$y≠0$，从m$x{}≠x^{2}
然而
16

============================================================
第 35 页
============================================================

1
1
$\o }$
=
+
2
大
2
2大
这与x是D$的顶点相矛盾，故$A_{}，…，A_{k线性无关，从而x$是基本可行解.
必要性.设x是基本可行解，设它的前k个分量取正值.假定存在x{∈D,
$x^{2∈D，x≠x²2及0<λ<1,使
x=λx+(1-λ）x{2
这里x=（x1，，x1），x^²=（x}，…，x)）1.当j≥k+1时，因为x=0，x₁≥0，x≥0$
故有$x_{1}=x^2}=0.$于 由Ax^{1=Ax^{2}=b可$$
k
∑（x{1}-x{1}A{}=}
又因为$x{}≠x^{2}，至少存-个j(1≤j≤k)使得x{1≠x_{²2}，因而向量A_{1}，，A_{k\线性
相关.由定理1.2.3知这与x是基本可行解相矛盾,所以x是D的一个顶点．
一个基本可行解x，如果它的所有的基变量都取正值，称它是非退化的；如
果有的基变量也取零值,称它为退化的.一个可行基对应一个基本可行解;反之，
若一个基本可行解是非退化的，那么它也对应着唯一的一个可行基;如果一个
基本可行解是退化的,那么一般地说，它可由不止一个可行基得到.由基本可行
解与可行基的这种对应关系,我们知道给定一个标准形式的LP问题(1.2.1),
n
u
它最多有
个可行基,因而基本可行解的个数不会超过
,从而多面凸集D
m
m
n
的顶点个数不会超过
"个.一个LP问题，如果它的所有基本可行解都是非退
$m$
化的，就说该问题是非退化的,否则说它是退化的.
下面定理给出了基本可行解的存在性.
定理1.2.5一个标准形式的LP问题(1.2.1)，若有可行解,则至少有一个
基本可行解.
证设x^{}=(x^{}，，x{2){$是问题(1.2.1)$的任意-个可行解，则有A^{=b，
$x^{≥0.不妨设x{}$的非零分量为前k个，即有x^{>0，j=1，…，k；x{=0，l=k+1，…，n.
如果约束矩阵A$的前k个列向量$A_{_}，…，A_{k线性无关，由定理$1.2.3知$x^{}是基
本可行解；否则存在着不全为零的数δ{,j=1，，k，使得
y
令δ1=0，l=k+1，…，n，得到n维向量δ=（δ₁，…，δ，δ+1，，δn），有
k
n
Aδ=∑δA₁+∑δA1=0
ji
1=k++1$
17

============================================================
第 36 页
============================================================

由于$x{>0$,j=1，…，k，我们可取适当小的正数ε，使得
$x_{±εδ,}≥0,
j=1,.,k,k+1,..,n
易知
A（x0±εδ）=Ax±εAδ=b
所以x^{}+εδ和{x^{}-εδ均是(1.2.1)$的可行解$.在满足不等式
$x_{+εδ,}≥0
的同时,可以选择ε>0,使上述诸式中至少有一个取等号.
这样就得到(1.2$.1)的-个可行解$x^{}+εδ或x{}-εδ，它的非零分量至少比$x{}$
少一个.如果这个解还不是基本可行解,那么上述过程仍可继续下去，……由于
当可行解只有一个非零分量时,该非零分量所对应的列向量一定是线性无关的，
所以(1.2.1)必存在基本可行解。
上述定理同时证明了非空多面凸集D={x∈R^{|Ax=b_{x≥0顶点的
存在性.
我们已经讨论了可行区域的结构,现在考虑目标函数与可行区域的关系.我
们知道当$z取不同值时，目标函数的等值面$c{x=z为R^{}中彼此平行且与向量c
正交的-族超平面.当超平面沿着目标函数的负梯度方向-∇(c^{x)=-c移动时，z
值越来越小$.因而求解-个$}LP问题也就是求$点$x^{∈}D$，使超平面$c{x{=_^{}与D
相交于x，且对所有的$z<z{，超平面$c^{x=z与D不相交.此时，x为该$LP的-
个最优解，而z为最优值.若D=，则该问题无解；若D≠∅，有如下定理.
定理1.2.6若标准形式的LP问题(1.2.1)有有限的最优值,则一定存在
一个基本可行解是最优解.
证设x{是(1.2.1)的一个最优解,即有
min{c{x|Ax=b,x≥0=c^0
如果x是基本可行解,则问题得证;否则,按定理1.2.5的证明过程可作出两个
可行解x^{}+εδ和^{-εδ，它们的目标函数值分别为
c（x0+εδ）=cx0+εcδ
c（x{-εδ）=cx-cδ
因为c^{x^{是最优值，所以有
c{x{+εcδ≥c^x{°
$c ^{x{0-εcδ≥c{x
因而得到cδ=0.故有c{1（x^{}±εδ）=c^{}，且可行解x^{+δ或x{-εδ$的非零分量
个数比x的少.按照定理1.2.5的证明方法继续做下去，最后得到基本可行解
$x，一定有c{x=c{^{0}，即基本可行解x也是(1.2.1)$的最优解_$
定理1.2.6也可叙述为:若标准形式的LP问题的目标函数有有限的最优
18

============================================================
第 37 页
============================================================

值，则必可在某个基本可行解处达到.这个定理具有重要的意义,它与定理1.2.5
一起被称为线性规划的基本定理.它告诉我们,求解标准形式的LP问题,只需在
基本可行解的集合中进行搜索(如果其目标函数有有限最优值的话),而基本可
行解的个数是有限的.然而求出并比较所有的基本可行解的方法通常是不切实
际的.下一节介绍的单纯形方法就是根据线性规划的基本定理，给出一定的规则
和步骤,在基本可行解的一个子集合中逐步搜索,最终求得最优解或判别问题无
最优解.
1.3 单纯形方法
解线性规划问题著名的单纯形方法(simplexmethod)是丹齐格(G.B.
Dantzig)在1947年提出的.本节我们介绍单纯形方法的理论、基本计算步骤及具
体实施运算的单纯形表.
1.单纯形方法
考虑标准形式的LP问题
$min$z = c^{$
(1.3.1)
s. t.Ax =b
(1.3.2)
x≥0
(1.3.3)
仍假设D={x∈R^{|Ax=b，x≥0}≠，秩(A)=m<n，A为-m×n实矩阵.我们已
经知道，如果它有最优解,则必可在某一基本可行解处达到,因而只需在基本可
行解集合中寻求即可.单纯形方法的主要思想就是先找一个基本可行解,判别它
是否为最优解，如不是，就找一个更好的基本可行解，再进行判别，如此迭代进
行,直至找到最优解,或者判定该问题无界.
这里有两个问题需要解决:一是如何得到第一个基本可行解;二是如何判别
和进行迭代.我们先讨论后一个问题,前者留在下一节解决.
假定已找到一个非退化的基本可行解x，即找到了一个基B，此时可将方程
组Ax=b化成与之等价的方程组
x_B+BNxN=Bb
(1.3.4)
这里B=（AB₁，AB₂}，，ABm），对应地xn=（_B₁，B₂2，，Bm），且有Bb>0.为叙
m
述方便，假定B=(A{₁，…，Am)$，记向量
A=BA=（a₁，,amj），j=1，…,n
19

============================================================
第 38 页
============================================================

b=Bb=（b1…，bm）
则(1.3.4)式可写成
x_B+∑xA{}=b$
n
j=m+1
或
x_B+B^1}Nxn}=$
(1.3.5)
显然，如果取的基不同,则对应的方程表达式也不同,我们把(1.3.5)式所
表示的m个方程称为对应于基B的典则方程组，简称典式.在一般情况下,若
9
(1.3.9)
(1.3.7)
0
本可行解.
将约束方程组(1.3.2)式变换成与之等价的(1.3.5)式后，目标函数c{x也
要作相应的变换,用非基变量来表示它.与基B相对应地，价值向量c记为$c^{}
$(c{}，}c{2)}，则
z=cx=cxB+cxN
=c（b-BNxn）+cxN
=cb-（cBN-ce）xN
=cb-∑（cA₁-c₁）x
n
(1.3.6)
j=m+1$
初始的基本可行解x对应的目标函数值用$_0表示，则$z_{=c^{x=c{2b，即_{为
(1.3.6)式中的数项，由于(A_{₁}，…，A{)=B^1B=I_m，故当j=1}，，m时，A{}是
一个第j个分量为1，其余分量为0的m维向量,故有
$c_A₁-C=0，j=1,…,m
引入下面的记号
60
或者用向量表示为
x≥0
+（A
.
$z =c_{12}-^xx$
20

============================================================
第 39 页
============================================================

60
因而，对应于基本可行解x=$
,b>0,经过变换后与原问题等价的问题是
min
z=z_{-^{x$
(1.3.7)
s.t.
x_{B}+B-}Nn}=$
(1.3.8)
x≥0
该问题充分反映了基本可行解x的特征,根据其中的系数情况,我们有以下定理.
定理1.3.1(最优性准则)如果(1.3.7)式中≤0,则x为原问题的
最优解.
证$设x为原问题任-可行解，由$于x≥0$可知$^{x≤0，从而c{x=z_{0}-^{}$
≥\z_{0}=c^{x$.
.
定理1.3.2如果(1.3.7)中的向量ζ的第k个分量_{k>0(显然，m+1≤k≤n)，
而向量A_k}=B^{1}A_k≤0$，则原问题无界.
证令d=
0
因为A_≤0,所以有d≥0$，而
0
…
0
=(B, N )(dB)
(1.3.9)
+（A
，Ak,…,An)
1
0
…
0
=-A_k}}+}Ak}$
=0
对于充分大的正数θ，观察向量x+θd,此时有
A(x+θd)=Ax+θAd=b
$x+θd≥0$
所以x+θd是原问题的可行解,它所对应的目标函数值为
c（x+θd）=cx+θcd
21

============================================================
第 40 页
============================================================

0
…
0
=c{xθ(c{02)$
+θ(c__
1
C
0
…
0
= c{x-θc{A-k$
=c{x-k$
(1.3.10)
由于$ζ_{>0$，而θ>0可任意大，故原问题目标函数无下界.
=
当以上两个定理的条件不满足时，即(1.3.7)式中的向量ζ有某个分量ζ_k>0$
而(1.3.}8)}式中相应的向量A_{=B^{}A_k至少有-个正分量，我们可在原有基B$的
基础上稍加修改而得到一个新的基,从而得到一个新的基本可行解.修改的思
想是:从原来的非基变量中选一个变量让它变为基变量,为保证新得到的解仍
是基本可行解,必须从原来的基变量中选一个让它变为非基变量.也就是说新
基与原有的基有m-1个相同的列向量,仅有一列向量不同.应该选择哪一个
非基变量变为基变量$呢？若已知$_{>0$，因为$$m+1≤k≤n，与$_k$相对应的是非
基变量$xk}，因此当$xk变为基变量时，它的值由零变为正数，比如说$xk=θ>0$，其
余的非基变量仍取值为零.由(1.3.7)式知对应新解的目标函数值为$z=z_{}-^_{k<
_0.至于θ的取值大小应以保证新解是基本可行解为原则.具体地,我们有下面
的定理和证明.
定理1.3.3对于非退化的基本可行解x，若(1.3.7)式中的向量ζ有$_{k
0,而其相应的向量A{k至少有一个正分量，则能找到一个新的基本可行解x，
使c^{}x<c^{x$.
证只需将x具体地找出来.
如定理1.3.2证明中所述，令
$d=(-+$
由(1.3.9)式知
Ad = 0
厦
22

============================================================
第 41 页
============================================================

x=x+a=5)+0-
$\b-θk}$
(1.3.11)
$+ θ_k}$
=
0
下面证明,当适当地选取θ>0后，x即为所求.
显然，
Ax=Ax+θAd=b
为使x≥0，则要求b-0A_{≥0$，所以令
$\rac{}{}$
$\ik
>0,i=1, ,m}
θ = min{
$a{ik
$bsra{}{   }$
(1.3.12)
$ak}$
从而保证了x≥0，因而x是可行解.
下面证明x也是基本解.x的各分量为：
$'9
$x_{}b_{$
i= 1, .,m,i≠r
$\rk
$x{i}}  0$
(1.3.13)
$'\}$
二
$a_k
x,=0，j=m+1,.,n，j≠k
只需证明向量组A{1}，…，A{1}，Ak，A{+1}，，A{m线性无关.假若不然，A_{1}，，A_{}
A_k}，A_{r+}1}，…，A^{m线性相关，因为原来的向量组A_{}，，A^_m$是线性无关的，因而
向量A_k}可由其余$m-1个向量线性表出，即存在m-1个数$y_{,i=1$，…，m_，i≠r}
使得
m
A_{1}=∑yA{}$
i=
i≠r
又A_=B^}A_{k}，}因此$
$\{{k
m$
Ak=BAk=（A₁}，…，Am)
M
…
$\{{}$
二
$\k$
23

============================================================
第 42 页
============================================================

将上面两式相减得
m
$aA}+∑（a-y₁)A{=
i
i≠r
已知$a{k≠0}$，故A_{}…，A_{m}$线性相关$，引出矛盾.
$\rac{} { b }$
最后，由非退化假设$b>0$，因而0=>0.由(1.3.10)知
$\o{k$
$c^{x} c^{x-}kcx
1
由以上定理我们知道相应$基本可行解x$的向量^{}=c{}B^}A-c{1}$有重要的
作用,我们称它为基本可行解x的检验数向量,它的各个分量称为检验数.
注意,在(1.3.12)式中若有几个比值同时达到最小值,则可任意选择一个，
但在新的基本可行解x中,这些对应分量均为零，从而x是一退化的基本可行
解.当我们假设线性规划问题是非退化时,即它的任何一个基本可行解均为非退
化的,上述现象就不会出现.如果检验数向量ζ有不止一个正分量,可以任意选
取一个正分量作为定理中的_k>0.一般常取最大的那个$_，因为从定理1.3.3
的证明中可知，当_k所对应的非基变量x_{k的值由零变为单位1时，目标函数值
减少_个单位.但实际情况表明，这种对ζ_{的选取不一定是最好的策略.首先，
最大的_k不一定对应最大的θ，而选择_{后由基本可行解x到基本可行解x
使目标函数值实际减少0_；其次,即使选择的正值_{k使这一步迭代目标函数
值下降量最大,但从基本可行解x开始的以后各步迭代情况并不一定好.从总
体情况分析选择正值ζ的最好策略是什么？这个问题至今尚未解决.此问题
若得到解决,将使单纯形方法在算法理论和实际应用方面取得极其重大的
进展.
定理1.3.3的证明实则具体给出了从一个基本可行解x移动到另一个“更
好”的基本可行解x的过程.新旧基本可行解x与x的差别在于以原来的非基变
量xk代替原来的基变量x，而成为第r个基变量，而x，变为非基变量.因此整个
过程称为换基，或说进行了一次迭代，称A，为退出基列，Ak为进入基列，x，为离
基变量，x{k为进基变量.对于单纯形方法来说,每一次迭代要依据检验数先确定
一进基变量,然后依据(1.3.13)式(可能的话)确定一离基变量.
上面三个定理给出了单纯形法的迭代步骤,给定一个基本可行解x,计算与
其对应的检验数向量$_.若$_{≤0{则x就是最优解；如果$5的某个分量$ζ_{k>0$而
A{20$，则原问题无界；如果$_{k>0且Ak含有正分量，那么按照(1.3.12)式和
(1.3.13)式求出另一个基本可行解x，使目标函数值减少θk个单位.得到新的
基本可行解后,再按以上程序进行,这样便可得到一个基本可行解的序列.如果
24

============================================================
第 43 页
============================================================

所得到的解均为非退化的,那么每迭代一次目标函数值严格减少,因而序列中的
基本可行解不可能重复出现.由于基本可行解的个数是有限的,故最终一定能找
到最优解或者判定问题无界,所以得到如下定理.
定理1.3.4对于任何非退化的线性规划问题,从任何基本可行解开始，经
过有限多次迭代,或得到一个基本可行的最优解,或作出该线性规划问题无界的
判断.
在单纯形方法的一次迭代过程中，迭代前后的两个基有m-1个相同的列向
量,这样的基称为相邻基.在几何上,可以严格证明相邻基所对应的要么是可行
域多面凸集D的相邻顶点，要么是同一个顶点(在退化情况下).因此直观地说，
单纯形方法就是从可行域多面凸集的一个顶点迭代到与其相邻的另一个顶点，
直至找到最优解或判定问题无界.下面给出具体的计算步骤.
单纯形方法步骤
第1步找一个初始的可行基B；
第2步求出对应的典式及检验数向量ζ；
第3步
求ζk=max|_,|j=1,…，n};
第4步若_k≤0$，停止，
$x{b)$
b
已找到最优解x=
=
$x{$
第5步若A_{k≤0$，停止，原问题无界；
$rac{} {  }$
b
第6步求min
二
$\{i$
第7步以A_{k代替A_{B{得到新的基，转第2步.
2.单纯形表
直接用公式进行单纯形法的迭代计算是很不方便的,其中最复杂的是进行
基变换,但施行基变换所用的实际上是消元法.由线性代数知道,用消元法解线
性方程组可在增广矩阵上利用行初等变换进行计算.因此,我们可以将单纯形法
的全部计算过程在一个类似增广矩阵的数表上进行,这种表格称为单纯形表.
例如某LP问题的约束方程组为
+3x4+2x3=1
$，x1}$
(1.3.14)
+5x4+x_5=3
$x_{_}$
+x_{}$
+x3+2x₄+5=4
$1$
可表示为
25

============================================================
第 44 页
============================================================

$x_{2}$
$x_{3}$
$x_{}$
$x_{s }$
$x_{}$
1
0
0
3
2
一
1
1
0
5
1
3
1
0
1
2
5
4
其中方程组中右端系数写在表的最后一列,为方便计，将其记为第n+1列，用一
条直线把它与其他列分开.由线性代数知,对上面的数表进行行的初等变换不会
改变方程组的解.给定一个基B,我们可以用数表上的行初等变换将其化为形如
(1.3.8)$的典式.在我们这个例子里，若B=(A_{₁，A₂2}，A_₃3)，则可将第-行乘以
(一1)分别加到第二行和第三行,从而得到
$x_{}$
$x_{22}$
$x_{sq}$
$x_{}$
$x_{sq }$
1
0
0
3
2
1
0
1
0
2
-1
2
0
0
1
-1
3
3
这张表所对应的恰恰是方程组(1.3.14)对应于基B的典式.让非基变量
$x{4}=_{3}=0，则第$n+1列的数值给出了对应的基变量的值，x_{₁}=1，x_2=2，x_₃3}=3，即典
式中的右端向量b.注意，表中非基列$的数值\是a{2}，即A_{4=B^{1}A_{₄4=(3，2}，-1)^{}}
A=B}A_₂=（2，-13)，或等价地有
A4=BA₄=3A₁1+2A₂2-A3
A_₂=BA_₂=2A2-A₂2+3A₃3
由于表中可直接读出b和诸A_k，因此改变基的运算可以直接在表上进行.例如，若
把第k=4列引入基,则按公式(1.3.12)得
$\ac{}{ 1}$
1
θ= min{
[\ffa}2}
=
$\ora}{1}$
3
即表中第n+1列的数值与表中x{k所对应列中正值的最小比.现在知道r= 1,即
$x_{2为进基变量，x{1为离基变量.目前的新基为$B=(A_{₄}A_{2}A_₃3}$，为得到对应于基
B的典式,在前一张表上进行行的初等变换:将第一行乘$;然后将它加到第三
1
3
行;再把它乘(-2)加到第二行.这样得到下表
26

============================================================
第 45 页
============================================================

$x_{1}$
$x_{2}$
$x_{3q}$
$x_{}$
$x_{sq }$
2
1-3
1
0
0
1
3
3
43
7
2
1
0
0
3
3
11
10
1
0
1
0
3
3
3
10
1
T
新的基本可行解x=(0，
4
,0
3
3
,
3
一般地，当前的基B=(A_{₁}，…，A_m)时，将约束方程组Ax=b用行初等变换化
成典式后的单纯形表如下
表1.3.1
$x_ }$
$x_{}$
$x_{+1$
$x_k$
$x_{}$
$x_{}$
…
…
$\_{}$
$\ra{{}$
B
1
0
0
$D$
$m+1$
…
…
…
…
…
…
…
$\{{}$
-b
1
0
$\$
$\o{}k
0
.
$m+1
…
…
…
…
…
:
0
0
1
$\$
$\omk
$\$
mm+1
mn
如果xk为进基变量，x，为离基变量，要得到相应于新基B的典式，就要在
表1.3.1中用行初等变换将第k列变为第个分量为1,其余分量为零的单位向
量.在进行这些变换后,一般地第r列不再是单位向量.变换后表中的元素用a_{表
示，则有如下式子（为符号简单计，在以下公式中将b记为A{+)：
用a除第r行的各元素得到
$ao{}j$
$a_{$
=
j=1, . ,n,n + 1
(1.3.15)
$\{{}$
将新的第r行元素乘(-$a)后加到第i行上得到
a=a-aka,j，i=1，,r-1,r+1，，m;
j = 1, .  ,n,n + 1
(1.3.16)
所有这些a{(i=1，…，m；j=1，…，n，n+1)便构成了相应于新基B典式的单纯形
27

============================================================
第 46 页
============================================================

表.新表的最后一列为
$\r{}{ r$
$\fa{{k}$
$b_{{ }$
$b_{1}-$
$\i{
i = 1,.,m,i≠r
这正是基B所对应的基本可行解中各基变量的取值.
当我们换基时,为方便地获得对应于新基B的检验数向量，目标函数的表
达式也要作相应的变换,即要将式子
z=c-（BBN-c）xN
或等价的表达式
z+（cBN-c）xN=b
(1.3.17)
中的B换成B.进行这一变换的最方便的办法是将(1.3.17)式看做一个方程，将
其系数及右端项添加在表1.3.1的最上面作为第0行,将z也视为变量,令约束
方程中z的系数为零.所得到的表格如下.
表1.3.2
z
$x_}$
.
$x$
x_{m$
$x{m}+$
$x_k$
$x_{}$
RHS
•·
…
Z
1
0
0
0
$ζ_{m+$
$ζ_}$
…
$5}$
.
20
$x1}$
0
1
0
0
$a$
$\r{{1k$
$\r}$
$\orac{} {   }$
.
1,m+1
…
:
…
…
…
…
…
…
…
…
x_,}$
0
0
1
0
$a$
$a}$
$\{}$
1
r,m+1$
rn
:
:
…
…
…
…
…
.…
…
x_m$
0
0
0
1
$a$
$\$
$\a$
m，m+1
mk
mi
m
为清楚起见,把基B对应的基变量列在表的左面,最后一列记为RHS,即右端向
量.位于第0行第$n+1列位置上的数$z_0=c{b就是当前的基本可行解所对应的目
标函数值.这就形成了一张完整的单纯形表.当我们换基时,对典式进行的行初等
变换公式(1.3.16)也同样适用于第0行(即将(1.3.16)公式中的行指标i的取值
改为i=0，1，…,r-1,r+1，，m即可).这样在表1.3.2上可以用统一的格式算出对
应于新基B的各元素a以及检验数${j.注意到，对表$1.3.2中的各元素进行行初等
28

============================================================
第 47 页
============================================================

变换时,变量z所对应列中各元素不会有任何改变,因此在表格中为变量z保留一
列是没有必要的.省略变量z对应的列,得到下面的单纯形表(表1.3.3).
表1.3.3
$x_{}$
$x_}$
$x_m}$
$x_{ m+1$
$x_kk$
$x_{}$
RHS
0
0
0
$5_{m{1$
.
…
$5_k}$
…
$\s}$
$20
$x_}$
1
0
0
$\{}}+1}$
$\1}$
$\{}$
$\ac{}{  }$
…
:
:
…
:
…
:
:
…
$x_}$
0
1
0
$\a}$
$\_{{k$
$r\m}1$
:
:
…
…
:
…
…
…
$x_m}$
0
…
0
1
$\$
a$
$a$
m，m+1$
m_}$
mn
若xk为进基变量，x，为离基变量，称元素\a{为转轴元，用*标出，称第k列
为旋转列，第r行为旋转行.单纯形表1.3.3中各元素按公式(1.3.15)和
(1.3.16)(此时i=0,1，…,r-1,r+1,…，m)进行变换,这种变换称为旋转，得到
表1.3.4.
表1.3.4
RHS
$1$
$x_}$
$x_{m$
$x_{m}+1$
$x_kk$
$x_{n}$
^
$ζ}$
0
$2$
0
0
$a_{v{{}$
$a_}$
6}$
$x{}$
1
0
0
…
:
…
…
:
…
:
$x{1$
0
$a_}$
$x$
0
a
1
r,m+1$
$1^{xx$
:
…
:
.
..
…
…
…
a
b
$x_m$
0
a
1
a
0
mr
m.m+1
m"
m
这样便得到一张新的单纯形表,由表中第0行的检验数可判别当前的基本
可行解是否为最优解,或者找出进基变量和离基变量,重复上述步骤,或者判定
问题是无界的.
29

============================================================
第 48 页
============================================================

我们来看两个例题.
例1.3.1求解问题
min $z =-x_{2 +2x_3
=2
s.t.x__2-2x_2+x_3
=1
$x_{2-3x3}+4$
$x_{2 - $_3}$
+x_{_}2$
x₁≥0，j=1,.,5
解这里B=(A_{1}，A_{4，A_3)$是一个单位矩阵，且b=(2,1，2){>0，故基B$是可行基，
$x_{1},_{4}，_{₂为基变量，x_{2，x_3为非基变量，基B对应的基本可行解为x=(2，0，0，1，2)}，其目
标函数值$z_{0}0.方程组Ax=b已是典式，得到第-张单纯形表如下表.
$1$
$x_{}$
$x_{q}$
$x_{}$
$x_{s }$
RHS
0
1
-2
0
0
0
$x_1}$
1
-2
1
0
0
2
$x{}$
0
1*
-3
1
0
1
$x_sq }$
0
1
-1
0
1
2
注意，第0行的元素应是将目标函数$z=-x_₂+2x_{3}化成等价的方程$z+x{2-2x_3}=0后
的相应元素.
检验数$ζ_{2}=1>0，故当前}解$不是最优解，A_{2}列$有两个元素${a_{2{2}，a_3{2均为正
数,取
$b_{}$
b3
1
2
min{
=min
=1
$\a2}$
A
$\3}$
1
故转轴元为$a{22}，x_{2}$为进_基变量$，x_{4}$为出基变量.进行旋转变换后得下表
$x_}$
$x_{}$
$x_{q}$
$x_{}$
$x_{sq }$
RHS
0
0
1
-1
0
-1
$x_{}$
1
0
-5
2
0
4
$x_{2$
0
1
-3
1
0
1
$x _q }$
0
0
2°
-1
1
1
它对应的基本可行解为x=(4，1,0,0，1)，其目标函数值为$_{0=-1.但ζ_3=1>0,
仍不是最优解,此时a{33}为转轴元,进行旋转变换得下表
30

============================================================
第 49 页
============================================================

$x_{q }$
RHS
$x_{1}$
$x_{2}$
$x_{3q}$
$x_{_}$
1
1
3
0
0
0
2
2
2
1
5
13
1
0
0
$x_}$
2
2
2
1
3
5
0
1
0
$x_{2}$
2
2
2
1
1
1
0
0
1
$x_{3}$
2
2
2
13
5
1
山
3
它对应的基本可行解为x=
,0,0
,其目标函数值为$z_{0}=$
此时检
2
！"
2
,
2
2
验数向量ζ≤0,故为最优解.
例1.3.2 解 LP问题
min $z=-x_{2-2x_3$
1
5
13
s.t.
x_1
xA
+
$x_{q }$
2
2
2
1
3
5
$x_{2}$
$x4$
+
x_{5$
2
2
2
1
1
1
$x_{3}$
$x4
+
x_5$
二
2
2
2
x,≥0,j= 1, . ,5
解显然这个问题的可行区域与例1.3.1的相同,但目标函数不同.我们取
13 51
T
x=$
,0,0
作为它的初始基本可行解，此时基B=(A_{₁，A_₂2，A_₃3).约束方
2
2
,
2
程组Ax=b已是典式，但目标函数的表达式$z+x_{2+2x_{3}=0还不是典式.此种情况
我们可以从下面的初始表开始.
$x_{}$
$x_{}$
$x_{q}$
$x_{}$
$x_{sqr }$
RHS
0
1
2
0
0
0
1
5
13
$x_{}$
1
0
0
2
2
2
1
3
5
$x_{22}$
0
1
0
2
2
2
1
1
1
$x_{q}$
0
0
1
2
2
2
31

============================================================
第 50 页
============================================================

应非基变量的元素应为检验数.此时第0行基变量$x{₂}x{3}对应的元素分别为1和
2.可利用行的初等变换将第0行化为典式:将第二行乘以(-1),第三行乘以
(一2)后都加到第0行,得到了第一张单纯形表如下
$x_{}$
$x_{}$
$x_{q}$
$tx$
$x_{sq }$
RHS
3
5
7
0
0
0
2
2
2
1
5
13
$x_{}$
1
0
0
2
2
2
1
3
5
$x_{2}$
0
1
0
2
2
2
1
1
1
$x_{3}$
0
0
1
2
2
2
3
此时$_{}$
->0$，但对应的$A_{4<0$，所以此问题无界.
2
当然，在方程组已成典式，目标函数表达式尚不为典式的情况下也可按公
式(1.3.17)计算得到单纯形表第0行中各元素.如对例1.3.2,我们有
1
5
13
2
2
2
1
3
b
5
B=(A_{1}，A₂2},}A3}
$B^{}N}}}=
=
2
2
,
2
1
1
1
2
2
2
所以
1
5
2
2
1
3
-(0,0)=
$5{N={B-N-c=(0，-1-2
2
2
1
1
2
2
32

============================================================
第 51 页
============================================================

13
2
5
7
$z_{=c{b=(0,-1,-2)
2
2
1-2
同样得到了第一张单纯形表第0行中各元素.
1.4初始解
本节我们讨论如何找第一个基本可行解,即初始解.
如果一个LP问题与例1.3.1或例1.3.2一样,在给出的约束矩阵A中含有
一个m阶的单位矩阵，且b≥0,那么我们已经有了一个明显的基本可行解，且方
程组Ax=b已是典式,只要按例1.3.2的方法将目标函数的表达式化为典式，单
纯形法就可以进行.但是实际问题往往并非如此,为找第一个基本可行解,即初
始解，下面介绍常用的两阶段法.
1．两阶段法
设原问题为
min $z = c{$
s.t.Ax = b
(b ≥0)
(1.4.1)
x≥0
显然，必要时在方程两边同乘(-1)，总可使b≥0.
所谓两阶段法,就是将线性规划问题的求解过程分成两个阶段,第一个阶段
是判断线性规划是否有可行解,如果没有可行解,当然就没有基本可行解,计算
停止;如果有可行解,按第一阶段的方法可以求得一个初始的基本可行解，使运
算进人第二阶段.第二阶段是从这个初始的基本可行解开始，使用单纯形方法或
者判定线性规划问题无界,或者求得一个最优解.
算法的第一阶段是对问题(1.4.1)增加m个人工变量$x_{a=(x_{n+1}，…}，x{n+m)
后,用单纯形法解如下的辅助问题
33

============================================================
第 52 页
============================================================

$n+m$
min g= ∑
$x_}$
i=n+1$
(1.4.2)
s.t.Ax +_{2=b$
x≥0，x_{a≥0$
现在来研究LP问题(1.4.1)与它的辅助LP问题(1.4.2)之间的关系.
设原问题(1.4.1)的可行区域为D,辅助问题(1.4.2)的可行区域为D'，显
然x∈D和
∈D{'是等价的.而对应人工变量$x_{。=0的(1.4.2)的解
$x{$
x
∈D{}，当且仅当有min g=0(注意$x_。≥0).这样我们就能通过解辅助问题来获
0
得原问题的初始解了.
而辅助LP问题(1.4.2)是一个有m+n个变量的标准形式线性规划，且人工
变量对应的m列构成了一个m阶单位矩阵，又因为b≥0，因此(1.4.2)的第一
m
个基本可行解为$x=0$，x_{=b，它所对应的目标函数值为$$g_{0=Σb{}，且方程组已
}
经是典式，目标函数的表达式经适当变换后也易化为典式,因此单纯形法可以开
始.因为要求x_{。≥0，故目标函数有下界g≥0$,从而问题(1.4.2)必有最优解.计
算结果有三种可能情形：
情形1问题(1.4.2)的最优值$g=0$，且人工变量x{₁,j=n+1，…，n+m，皆为
非基变量,此时我们已得到原问题(1.4.1)的一个基本可行解.
情形2问题(1.4.2)的最优值g>0,说明原问题没有可行解.这时或者原问
题的约束方程组不相容，即有秩(A)<秩（A，b)；或者方程组虽相容，但没有非负
解.总之，此时可行区域D=，运算结束.
情形3问题(1.4.2)的最优值g=0,但某些人工变量虽然取值为零,可仍
是基变量.
当情形1出现时,把人工变量对应的列从单纯形表中去掉,然后直接转人第
二阶段:即对原目标函数$z=c^{x应用通常的单纯形法.有时为了方便，在第一阶
段开始时就同时用两个检验数行:一个是关于g的,另一个是关于z的.在第一阶
段迭代时,每次的旋转变换两个检验数行都参加,这样当第一阶段结束时就不必
重新计算第二阶段开始时的检验数行及z0.
当情形3出现时,第一阶段的最优单纯形表如下,辅助问题的检验数向量
μ=（μ₁1，…，μ+m)≤0.
34

============================================================
第 53 页
============================================================

$x_{}$
$x_{}$
$xn$
$x_{+1$
中
…
$x_{+m$
RHS
…
$μ_1$
$μ_$
$μ_{}$
$μ{1$
$μ{n}+m$
0
xB1
-b…-b…-b
:
x{B_}$
$\a{{j$
这里的基变量为$xB{1}，_{B{，…}，xB{m}，不妨设x{B}为-人工变量（n+1≤B{2≤n+m），
显然有b,=0.我们观察表中第r行的前n个元素，即考察a{，j=1，…，n，如果它
们不全为零，设$a_n≠0(1s≤n)，以a_{}为转轴元进行$次旋转变换(注意,此时
不要求$a_>0)后，由于b{=0$,所以θ=0$,故$g值不变，最优解也不变，只是将零值
的x{变成了基变量，代替了取零值的人工变量x_B}，这样使基变量中减少了一个
人工变量.如果{a=0，j=1，…，n，这时矩阵
$$\$
$\r{{}$
…
$\= =
…
:
$\}$
$\}$
mn
有一行全为零，即秩(A)<m.而A是由原约束矩阵A经过一系列行初等变换得
到的.初等变换不改变矩阵的秩，所以有秩(A)=秩(A)<m.这表明单纯形表中的
第r个约束方程是多余的,将它删去就可以了.如果基变量中还有其他人工变
量,重复刚才的过程，直至基变量中没有人工变量.至此,我们获得了原问题
(1.4.1)的第一个基本可行解.
在前几节讨论中我们总假定秩(A)=m,D≠∅，但是对于实际问题来说，一
般地并不知道约束方程组是否满足这些假定.这其实关系不大,上面的分析使我
们知道,在寻找初始解的第一阶段总能解决这两个问题.
例1.4.1求解
min$z=5x,+21x3
$-x4$
=2
$s.t.$__}-_{2+6_3
-x_{sq}$
=1
x{1+x₂2+2x3$
x{,≥0,j= 1, . ,5
35

============================================================
第 54 页
============================================================

解增加人工变量$x_{}{x_{}得到辅助$_P$}问题
min$g=x_{₀+x_
=2
+x_
s.t.x_1-x_2+6x_3-x4
$+x_}$
=1
-x_{sq$
$x_{1}+x__2}+2_x
x,≥0,j= 1,…,7
形成如下形式的表
$x_{}$
$x_{}$
$x_{ }$
RHS
$x_{}$
$x_{22}$
$x_{3}$
$x_q }$
-5
0
-21
0
0
0
0
0
2
g
0
0
0
0
0
-1
-1
0
$x_{6}$
1
-1
6
-1
0
1
0
2
$x_ }$
1
1
2
0
-1
0
1
1
将表中第一行，第$行加到关于$g$的第0行中,使基变量$x_{}x_{,}$的检验数为零,得到
辅助问题的第一张单纯形表.(一般情况下,如何得到辅助问题的第一张单纯形
表?)然后按单纯形法迭代.此处要注意的是两个检验数行都要进行变换.
$x_{_}$
$x_{}$
$x_{}$
$x_{}$
$x_{q }$
$$
x7
RHS
z
-5
0
-21
0
0
0
0
0
g
2
0
8
-1
-1
0
0
3
x6
1
-1
6*
-1
0
1
0
2
$x_}$
1
1
2
0
-1
0
1
1
$x_}$
$x_{}$
$x_{q}$
$x_{}$
$x_{q }$
$x_6}$
$x_}$
RHS
3
7
7
21
0
0
0
7
z
2
2
2
6
2
4
1
4
1
0
-1
g
0
3
3
3
3
3
1
1
1
1
1
1
0
$x_{q}$
0
6
6
6
6
3
2
4
1
1
1
$x7$
0
-1
1
3
3
3
3
3
36

============================================================
第 55 页
============================================================

$x_{2}$
$x_{sq }$
$rx}$
$x_{}$
RHS
$x_}$
$$
$x_{}$
1
21
21
21
2\
63
0
2
0
4
8
8
8
8
8
g
0
0
0
0
0
-1
-1
0
1
1
1
1
1
3
$x_{q}$
0
1
4
8
8
8
8
8
1
3
1
3
1
$x_{2}$
1
0
2
4
4
4
4
4
1
3
T
第一阶段结束,得到辅助问题的一个最优解
,0,0,0,0，同时得到
1
3
T
原问题的第一个基本可行解x^{=
,0,0
,它对应的典式也在这张单纯
4
8
1
4
元为$ā{21}，得到下-张单纯形表.
$x_{}$
$x_{}$
$x_{q}$
x4$
$x_sq }$
RHS
1
11
9
31
z
0
0
2
4
4
4
1
1
1
1
$x_{3q$
0
1
2
4
4
4
1
3
1
$x_}$
1
2
0
2
2
2
1
1
1
31
从而得到原问题的最优解x=
,0,
,0,0
,其最优值为
4
2
4
例1.4.2求解
min$z=3x,+2x2+x_3}$
x_{1}+2x_{2}+x_3}$
=15
s.t.
$2x_{1}$
+5x3$
=18
2x₁+4x2+x_3+x₄=10
x₁}≥0,j=1,2,3,4
解这个例子的系数矩阵中已包含一个单位向量，就是A_{₄=(0，0,1)^{}，因
此在用两阶段法求解时,第一阶段只要增加两个人工变量_}，$x_{，所得辅助
37

============================================================
第 56 页
============================================================

问题为
min
g=x_3+_{6$
=15
+_s$
s.t.
x_{1+2x2+x3
+ x_{} 8$
$2x_}$
+ 5x_3$
=10
$2x_{2}+4x{2}+$_3}+x}$
x; ≥ 0, j= 1,…  ,6
作如下表
$9_$
RHS
$x_}$
$x_{}$
$x_{3}$
$x_{}$
$x_sq }$
z
-3
-2
-1
0
0
0
0
g
0
0
0
0
-1
-1
0
$x_{q }$
1
2
1
0
1
0
15
$x_6$
2
0
5
0
0
1
18
$x_{4}$
2
4
1
1
0
0
10
将表中第一行、第二行加到关于g的第0行中,得到辅助问题的第一张单纯形表
如下：
$x_{}$
$x_{}$
$x_{q}$
$x_{4$
$x_q }$
$x_}$
RHS
-3
2
-2
-1
0
0
0
0
g
3
2
6
0
0
0
33
$x_sq }$
1
2
1
0
1
0
15
$x6$
2
0
5*
0
0
1
18
2
4
1
1
0
$x_{}$
0
10
按单纯形法迭代
38

============================================================
第 57 页
============================================================

$x_{}$
RHS
$x_{}$
$x_{2}$
$x_{q}$
$x_{}$
$x_{sqr }$
13
1
18
z
-2
0
0
0
5
5
5
3
6
57
g
2
0
0
0
5
5
\}
3
1
57
$x_s $
2
0
0
1
5
5
5
2
1
18
$x_{q}$
0
1
0
0
5
5
5}
8
1
32
$x_{}$
4
0
1
0
5
5
5
$x_{}$
$x_{2}$
$x_{q}$
$x_{s}$
$x_{sqr }$
$9$
RHS
6
1
1
34
z
0
0
0
5
2
1v0
5
1
1
11
41
g
0
0
0
5
2
10
5
1
1
1
41
$5xx}$
0
0
1
5
2
\fv0}$
5
2
1
18
$x_{3}$
0
1
0
0
5
5
5
2
1
1
8
$x_{2}$
1
0
0
5
4
20
5
关于目标函数g的检验数都不是正数，因此辅助LP问题的最优解为x=
8 18
41
T
41
0，
,0,
>0,所以原问题无可行解.
5
5
5
在没有明显初始解时，为找第一个基本可行解也可采用大M法.大M法的
缺点是:不容易确定M的取值，且M过大容易引起计算误差，有关介绍可见
[1]、[2]或有关线性规划的专门教材.
2.关于单纯形方法的几点说明
在以上几节的讨论中,我们总假定基本可行解是非退化的,这保证了单纯形
39

============================================================
第 58 页
============================================================

法的每一次迭代使目标函数值严格下降,因此已出现过的基本可行解不可能重
复出现.由于基本可行解的个数有限,因此迭代一定在有限步结束.但如果在单
纯形法迭代过程中遇到退化的基本可行解，就不能保证目标函数值通过迭代得
到改进.于是,有可能使单纯形的迭代在进行了若干次旋转变换后又回到了前面
的某个基本可行解.这意味着算法将无限地循环下去,这种现象称为循环.幸而
这种情况在实际中极少出现,因此这里不加以讨论.当然避免发生循环的方法是
有的，如摄动法[1]字典序方法[]和Bland反循环算法[]，等等.按照这些方法所
给出的有关规则进行单纯形法的迭代,不论是否出现退化情况,均保证单纯形在
有限次迭代后终止运算.
在计算机上实际计算的LP问题,一般其变量个数和约束方程个数都比较
多,如何节省存储单元、减少计算量和误差是必须加以考虑的问题.仔细地分析
前面所述单纯形法的各计算公式,可以使我们在保留最必要的数据前提下,精巧
地处理有关运算,这就是修正的单纯形法或称为逆矩阵法.一般在计算机上解
LP问题时,大多采用的是修正的单纯形法.所幸的是解LP的商用软件包已经普
及,大家可在计算机上直接调用.关于这个方法的详细讨论，请参见文献
[2]或[3].
对于某些有特定结构的大型LP问题,利用修正的单纯形法在紧缩存储及
减少计算误差方面的优越性,将该大型LP问题的计算归结为若干个较小的LP
问题，从而使大型问题可以在中等大小的计算机上得以实现.这类方法统称为分
解方法.Dantzig-Wolfe分解算法就是这类方法的代表，详情请参见[2]、[3].
对于另外一些有特殊结构的LP问题，例如运输问题,变量有上、下界限制，
或者是约束方程组的系数矩阵是稀疏的,将其化为标准形式的LP问题后,往往
使变量个数和约束方程个数都增加很多,导致问题规模增大,给计算和存储带来
困难.已经发展了一些针对这类线性规划问题的专用单纯形算法,如解运输问题
的表上作业法（见第5章中的相关内容）、图上作业法,有界变量单纯形法,有效
约束方法,等等.这些方法避免了上述弊端,提高了单纯形方法解题的能力，关于
这些内容的详细介绍见参考文献[1]、[2]、[3].
1.5对偶性及对偶单纯形法
对偶理论(dualitytheory)是线性规划最重要的内容之一.每一个线性规划问题
必然有与之相伴而生的另一个线性规划问题.其中的一个问题称为“原始”的,记为
(P),则另一个称为“对偶"的,记为(D).这两个问题有着非常密切的关系.本节主
40

============================================================
第 59 页
============================================================

要涉及三个问题:一是给定了LP问题(P)后，如何写出(P)的对偶问题(D);二是
研究问题(P)与(D)之间的关系;最后,给出解LP的对偶单纯形算法.
1.对偶线性规划
考虑(1.1.1)式中定义的一般形式的LP问题
min
$c^{x x$
s.t.
$a{x=b，=1,.,p
$ax≥b₁，i=p+1,.,m
(1.5.1)
x₁}≥0,j=1,.,q
x₁≥0，j=q+1,.，n
这里$a{}=($a₁}，}，a{in)∈R^{是约束矩阵A$的第i个行向量，A为-m×{n矩阵，b=
(b_{₁}，…，b_m){为右端向量.为了使用定理1.3.1（最优性准则)，我们需要把
(1.5.1)变为标准形式的$LP问题:对i=p+1，…，m的每一个不等式约束，减去
一个非负的剩余变量$x{；对每一个自由变量$x{,j=$q+1$，…，n，用两个非负变量
$x_{}≥0和x{，≥0替换它，即有x₁=x_-x{,j=q+1，…，n.并因此将约束矩阵A中相
应的列A{，用列A;和(-A{)来替换，得到标准形式的LP问题如下:
minc^{x
s.t.Ax=b
(1.5.2)
$x≥0$
其中
（-xx"xx1x1+xbxx）=
₁（00^）-31+1+）=
均为$q+2(n-q)+(m-p)维向量，矩阵A用分块矩阵的形式表达为
A=（A₁，…，AA+1，-A1，A-A
0
(1.5.3)
A是一个m×[q+2(n-q)+(m-p)]矩阵，右上角子阵0是一个p×(m-p)零矩阵，
右下角的I是一个(m-p)×(m-p)单位矩阵.
由单纯形算法和最优性准则知，若(1.5.2)有最优基本可行解_。,则LP问
题(1.5.2)存在一个相应于x_{。的可行基_B,使得检验数向量
=cBA-c≤0
令w^{=c{}_B^1}，则w$是线性约束
B
B
$^{}A{≤ c$
(1.5.4)
41

============================================================
第 60 页
============================================================

的一个可行解，其中w=（w₁，…，w）∈^，m是（1.5.1)问题中矩阵A（也是
(1.5.2)问题中矩阵A)的行数.按A列集合的划分(1.5.3)，线性约束(1.5.4)中
的不等式可分为三组:第一组是对应于非负变量x_{,j=1，…,q，有
wA₁≤c，j=1,…,q
(1.5.5)
第二组是对应$自由变量x{,j=q+1$…，n,有
$^{}A{2}≤}$
-wA,≤-c₁}j=q+1,…,n
这两个不等式等价于
$wA₁}=c₁}j=q+1, ,n
(1.5.6)
第三组是对应于i=p+1,，m的不等式约束，有
-w_;≤0, i=p+1, .,m
或者写为
w_₁≥0,i=p+1,. ,m
(1.5.7)
不等式组(1.5.5)，(1.5.6)和(1.5.7)定义了一个新的LP问题的约束.如果我
们对它再加上一个目标函数max w{b_,则构成了一个新$LP问题.我们把($1.5.1)
式定义的LP问题称为原始的,那么将这个新的LP问题称为原始的对偶问题.当
^{}=c_{}B^{1时，由(1.5.4)式知w不仅是对偶问题的可行解，马上可以证明它还是
B
对偶问题的最优解.首先,我们有下面的定义.
定义1.5.1给定一个一般形式的LP问题,称它为原始LP问题,那么它的
对偶问题定义如下：
原始(P)
对偶(D)
$min $c^{$
$b^{$
max
s.t.
$a^{1}}$
i=1 , .  ,p
s.t.
$w_{;}≥0$
$a{}}$
i=p+1, . ,m
$w{1≥0$
j=1,…,q
$A{,}w≤}$
$x_{i}≥0$
$x_{}≥$
j=q+1, …,n
$A{1}}$
现在来观察定义1.5.1中给出的原始LP问题(P)和它的对偶LP问题(D)
之间形式上的关系.首先,原始问题求的是极小,而对偶问题求的是极大,原始问
题的不等式约束是“大于或等于”，而对偶问题的不等式约束是“小于或等于”；
其次,与原始问题中p个等式约束相对应的是对偶问题中p个自由变量,与原始
问题中(m-p)个不等式约束相对应的是对偶问题中(m-p)个非负变量.反之亦
然,即原始问题中的q个非负变量对应的是对偶问题中的q个不等式约束,而原
始问题中的(n-q)个自由变量对应的是对偶问题中的(n-q)个等式约束;第三,
42

============================================================
第 61 页
============================================================

原始问题目标函数中的价值向量c,就是对偶问题约束中的右端向量，而(P)的
右端向量b就是(D)的目标函数中的价值向量;最后，如果用矩阵和向量形式写
出问题(P)和(D)的约束,则易看出这两个问题的约束系数矩阵互为转置.记住
这一些规则,就可以很容易地写出一个LP问题的对偶问题.
根据定义1.5.1,当原始LP问题为规范形式
min
$c^{x$
s.t.
Ax≥b$
x≥0
其对偶问题为
$b^{ w
max
$A^{}{}≤c
s.t.
w ≥0
当LP问题为标准形式
min
$c^{ $
s.t.
Ax =b$
x≥0
其对偶问题为
$b^{ w
max
s.t.
$A^{}c
w≥0
我们往往将w≥0省略，w为自由变量的含义不会混淆.
例1.5.1我们来看例1.4.1中的LP问题.
原始问题
min$5x,+21x_3$
s.t.x_1}-x_2+6_3-_
=2
$x_{1}+__2+23 -x_3=1
x,≥0,j=1,.,5
这里c=(5,0,21,0,0),b=(2,1)，
1
-16
-1
0
A=
1
１2
0
- 1
根据定义,其对偶问题是
43

============================================================
第 62 页
============================================================

$w1$
(2,1)
max
$w_{2$
s.t.
1
5
1
0
-1
1
$w1$
6
2
≥
21
$w_{22$
-1
0
0
0
0
按分量形式写出的对偶问题是
max$2w,1+w_2}$
s.t.
$2w_{2+w{2≤$
-w_{1}+2w{2≤$
$6w_,+2w{2≤ 21$
-w__$
≤0
-$w_{2}≤0$
2.对偶理论
我们来讨论原始LP问题及其对偶问题之间的关系.
定理1.5.1如果一个LP问题有最优解,则它的对偶问题也有最优解，且
它们的最优值相等.
证假设x,w分别是原始问题和它的对偶问题的任一个可行解,根据原始
问题与对偶问题的定义1.5.1知，对于i=1，…，p，有
$a_{{},
,w;≥0
则有
$w₁ax=w,b₁}
i=1, … ,p
(1.5.8)
对于i=p+1，…，m有
$a_{x}≥{},
$w_{1}≥0$
则有
$w{a{1x≥wb₁，i=p+1,…,m
(1.5.9)
将(1.5.8)和(1.5.9)中的m个式子相加得到
$m$
m
Σw,ax≥∑w,b,
一
三
将上式用矩阵向量的形式写出来就是:对原始问题的任一可行解x，及它的对偶
44

============================================================
第 63 页
============================================================

问题的任一可行解w有以下关系式成立：
$w}Ax≥w{b
(1.5.10)
类似地，可证明它们还有另一个关系式
$c^{x ≥w{}
(1.5.11)
成立.将这两个关系式联合起来,我们有
c{x≥wAx≥wb
(1.5.12)
即如果原始问题和它的对偶问题都有可行解,则原始问题任一可行解的目标函
数值永远不会小于其对偶问题任一可行解的目标函数值.由定理假设知,原始问
题有可行解,所以其对偶问题不可能是无界的.
由假设知原始问题有最优解$x_{0}，它对应的基为B{$，即有x_{n}=_B^{{_b.根据本节
开始部分的讨论知{=$c^{}B^1}，就是对偶问题的}个可行解，故按单纯形算法的
理论知，对偶问题必有最优解.由于对偶问题的可行解$=_{}_B^{{1}的目标函
数值为
B
B
由关系式(1.5.12)知，w是其对偶问题的最优解,且它们的最优值相等.
推论1.5.1若x，w分别是原始及其对偶问题的可行解,则x，w分别是原
始、对偶问题最优解的充要条件是c{x={}b.
对偶性的一个重要特征是它具有下述定理中的对称性.
定理1.5.2对偶问题的对偶为原始的LP问题.
证将原始LP问题的对偶问题记为
min(-b)
s.t.（-A₁)w≥-c_,j=1,.,q
(-A₁)w=-_₁,j=q+1,,n
w₁≥0,i=p+1,.,m
$w{≥0,i=1,.,p
把它视为原始问题,按定义1.5.1写出它的对偶问题是
max(-c )^{x
s.t.x₁≥0,j=1, … ,q
x₁≥0，j=q+1,.,n
-ax≤-b₁，i=p+1,…,m
-a{x=-b₁}，i=1,.,p
显然这就是最初的原始LP问题．1
45

============================================================
第 64 页
============================================================

任何一个LP问题总是属于下列三种情况之一：(1)有最优解；(2）问题无
界;(3)无可行解.因此一个原始线性规划问题和它的对偶问题有九种可能的组
合.如表1.5.1所示.
表1.5.1
对偶
原始
有最优解
问题无界
无可行解
有最优解
①
×
×
问题无界
×
×
无可行解
×
③
②
根据定理1.5.1和定理1.5.2,表中除原始和对偶问题都有最优解,即有情
况①发生外,第一行和第一列的其他情形都不可能发生.不可能发生的情况都用
“×”号表示.其余几种情况是由下述定理所保证的.
定理1.5.3给定一个原始LP问题和它的对偶,则表1.5.1中表示的三种
情况恰有一种出现.
证由(1.5.12)关系式知,如果原始LP问题或者它的对偶,二者之中有一
个是无界的，那么另一个不可能有可行解.因此剩下的只有表上所示的情况②和
③.下述例题说明情况②或③是会出现的.
考虑原始LP问题
min x_{1$
s.t.
x_{1}+x_{2≥1$
-x_₁-x_2≥1$
$x{1}≥0，x_{2≥0
其对偶问题是
max$w_{1+w_{2
s.t.w_₁-w_2=1
$2w{1}-w2}=0$
$w{1≥ 0,$w{2 ≥
显然，两个问题均不可行，情况②出现.如果将原始LP加上限制x_{1}≥0{，x_{2≥0$，它
仍是不可行的,但此时它的对偶问题却是
$max$2w_{1+w_2
$s.t.$w__1-w2≤1
$2W{1}-w2≤$
$w₁1≥0，w₂}≥0
46

============================================================
第 65 页
============================================================

显然这是个无界问题,情况③出现.
I
从对偶定义1.5.1可发现,原始问题和它的对偶问题之间存在着一种松紧
关系:一个问题中某个约束是“紧的”,另一个问题中对应的约束就是“松的”,最
终的平衡表达式,就是x和w分别是原始和对偶最优解的充要条件,即互补松
紧性条件.
定理1.5.4(互补松紧性)设x和w分别是原始和对偶问题的可行解，则
它们分别是原始和对偶问题的最优解的充要条件是，对一切i=1，…，m和一切
j=1,…，n有
u₁=w₁（a²x-b₁）=0
(1.5.13)
v_=（c₁-wA₁)x,=$
(1.5.14)
证首先，由对偶定义1.5.1知，对-切i和j有u_{≥0$，_;≥0.定义
u=∑u；≥0,
1
司
因此，u=0当且仅当u=0,i=1，…，m，即对一切i有(1.5.13)式成立.同理，v=0
当且仅当对一切j=1，…，n有(1.5.14)式成立.对一切i和j,将(1.5.13)式和
(1.5.14)式相加,得到
u+v=w（ax-b₁）+∑（c-wA₁)x;
$m$
n
i=
二
=∑w(∑ax,-b₁）+∑（c,-∑ay；)x
m
n
m
=∑a-，b+-a
m
m
n
n
m
=
$'n'g3-x=
n
m
=c {x}-b^{$
因而(1.5.13)和(1.5.14)对一切i和j成立，当且仅当有u+v=0，或者是
$c^{x} =b^{
根据推论1.5.1,定理结论成立.
1
互补松紧条件说明,对于最优解x和w，如果对偶问题中的一个约束取严格
不等式,则原始问题中对应的变量必取值为零;对称地,如果一个问题中其非负
变量取正值,则另一个问题中对应的约束必取等式.
例1.5.2考虑在例1.5.1中给出的原始问题和其对偶问题.由于原始问题
是标准形式的,故松紧条件(1.5.13)自动满足.在例1.4.1中已求出这个原始
47

============================================================
第 66 页
============================================================

LP问题的最优解为x=
T
2
变为
$C_1-w}A{2=$
$C_3-w{}A3}=0$
即对偶问题最优解必使第一个和第三个约束取等式,有
$2w_{1+w_₂2}=$
$6w_,1+ 2w2= 21
11
9
由此可解得w_{_}=
31
$，w_{2=
1
,其对应的目标函数值为一，由定理1.5.4知,此解为
4
4
4
对偶问题的最优解.
3.原始和对偶问题的解及其经济意义
有关对偶问题最优解的全部信息,我们在解原始LP问题的最后一张单纯
形表中可以得到.为了叙述方便计,假定开始解原始LP问题时表的左半部分是
一个单位矩阵,通常它对应于人工变量或松弛变量,如表1.5.2所示.
表1.5.2
{5-
I
在单纯形算法结束时,得到最优基本可行解x，设B是x对应的可行基，此时对
所有的j，其检验数_=wA_{₁-c_≤0，其中w={B^1}根据前面有关对偶性定理的
证明已知w{}=c_{B^1就是其对偶问题的最优解.由$于初始表中1至m列是 个单
位矩阵，所以有
0
…
0
1
j,
j = 1,.,m
$A_{}=$
0
…
0
从而有
48

============================================================
第 67 页
============================================================

$5_₁=w₁-C
j=1,.,m
因此从最后的单纯形表中,可得到对偶问题的最优解为
$w;=5+,
j= 1, . ,m
我们还可看出，在最后的单纯形表中，B^替换了开始的单位矩阵的位置.最后的
单纯形表如表1.5.3所示.
表1.5.3
${o-$
$B^{ }$
例1.5.3回顾例1.4.1,注意在初始表中人工变量x_{，x_}对应的列构成一
单位矩阵，且$c_{=c_{7}=0.为了直接从最后的单纯形表上得到对偶问题最优解的
信息,在用两阶段法求解原始LP问题时,当第一阶段结束后,不必去掉有关人
工变量的列,即取如下形式的单纯形表.
$x_{ }$
$x_{}$
$x_{q}$
$x_}$
$x_{sq }$
$x_{6}$
$x_{_ }$
RHS
1
21
21
21
21
63
z
0
0
4
8
8
8
8
8
1
1
1
1
1
3
$x_{3}$
0
1
4
8
8
8
8
8
1
1
3
1
3
1
$x_{2}$
1
0
2
4
4
4
4
4
开始第二阶段运算，以$a{21为转轴元，作一次旋转变换后得到
$x_{_}$
$x {}$
$x_{q}$
$x_{}$
$x_{sq }$
${x}$
$x_{7$
RHS
1
11
6
11
9
31
0
2
0
2
4
4
4
4
4
1
1
1
1
1
1
$x_{3}$
0
1
2
4
4
4
4
4
1
3
1
3
1x$
1
2
0
2
2
2
2
2
原来参加第二阶段运算的变量$x{₁,j=1，，5对应的检验数ζ_{≤0,j=1，…，5，因

============================================================
第 68 页
============================================================

T
而得到原始问题的最优解x=
,0,0
，且基B=(A_{3}A{₁}=
6
,0,
的逆
2
4
2
1
1
1
4
4
矩阵$B-{1}
.而在初始表中对应单位矩阵的人工变量的价值系数有
1
3
2
2
11
9
$C_{6}=\_{7}=$0$，所以可在最后单纯形表中直接读出对偶问题的最优解$$w_{}=$
$，w_{2}$
4
4
31
其最优值为
—
4
由以上的讨论可以知道，对于任何一个LP问题（P），如果它的对偶问题
(D)可行的话,我们可以通过求解(D)来讨论原问题(P).若(D)无界，则(P)无
解;若(D)有最优解,则可在解(D)的最后一张单纯形表上得到(P)的最优解和
最优值.由于能在计算机上求解的线性规划问题的规模通常受问题所含行数的
限制，当一个线性规划问题的规模太大时,或许改为求解它的对偶问题反而比较
适当.
分析原始和对偶问题的解有其重要的经济意义.我们以资源利用问题（见第
1章习题(A)，3)为例，将其作为(P)问题，并写出其对偶(D)，
n
max
z=
(P)
"
s.t.
ax₁≤b₁，i=1,，2，.,m
三
x₁≥0，j=1,2,.,n
min z=∑b,
m
三
(D)
m.
∑aj}₁≥c₁，j=1,2，,…,n
s.t.
三
w_₁≥0，i=1,2,..,m
在(P)中每个数据或变量的量纲如下：
z=利润，
$c_=第j个变量的单位利润(利润/第j变量单位数），
$x=第j个变量单位数，
第i种资源单位数
a=第j个变量每单位消耗第i种资源数量
第j个变量单位数
50

============================================================
第 69 页
============================================================

$b_{1}=$第i种资源的单位数(总量)$.
在(D)中引入的新变量仅是z和$w{，因为(P)和(D)的最优值相等，故有$z^{}=z{}，
因而z的量纲仍是利润,那么对偶变量w_;的量纲是什么?
让我们按量纲形式重新列出(P)和(D)问题，
n
利润
max
2=
(第j个变量单位数)=利润
第j个变量单位数
(P)
=
第i种资源单位数
s.t.
(第j个变量单位数）
第j个变量单位数
≤(第i种资源单位数)，i=1,2，…$，m
(第j个变量单位数)≥0，j=1,2，.，n
m.
min
$za= =$
M
(第i种资源单位数)w{=利润
(D)
m
第i种资源单位数
利润
M
s.t.
$w_{i$
j=1,2,.,n
第j个变量单位数
第1个变量单位数
w_₁≥0，i=1,2, ., m
为了保持约束条件两侧量纲的一致,易分析出对偶变量w;的量纲为
$_{=利润/第i种资源单位数
即w_;为当第i种资源从原来的量b,增加一个单位时，目标函数最优值的增量.这
个结果在经济学上的含意是重要的.如当已知LP问题(P)的最优解时，它只告
诉了企业管理者在目前情况下如何最好地利用它们的资源,以获取最大利润.而
有作为的管理者都希望能改善现状,以获取更多的利润.对偶变量就提供了这一
重要信息.例如，若(P)的对偶(D)的最优解中有$w_{3}=9，这意味着第3种资源每
增加一个单位,可使目标函数的最优值增加9个单位，而w_{=0时，说明第1种
资源的增加不会使总利润值提高.这给管理者提供了挖潜改革获取更大利润的
有用信息.
对偶变量已被赋予各种名称，如影子价格(shadowprice)，边际投入,边际效
益等.
例1.5.4回顾例1.1.1,这是一个具体的资源利用问题.我们可以同时提
出两个问题：
（1)工厂应如何安排月生产计划，使总利润最大?
（2）若某企业想从该工厂购买这3种原料.该工厂如何定价这3种原料，才
能使双方都认可?
解实质上问题(1)是求原问题的最优解,问题(2)是求其对偶问题的最优
解.利用单纯形方法，我们可同时得到原问题的最优解x{1}=84(吨)，x_{2}=24(吨)，
51

============================================================
第 70 页
============================================================

最优值为244.8(万元/月);对偶问题的最优解w{1=0(万元/吨)，w2=0.12(万
元/吨)$，w_₃3=$0.72（万元/吨).故双方认可的原料定价为原料P_{}为零，原料P_{2}$
为0.12万元/吨，原料P_{3为0.72万元/吨，该企业为购买这3种原料应付出
的代价为244.8万元.第一种原料的定价为0,这说明该原料的影子价值为零，
即原料$_{}$的资源过剩$.从计算结果可知$x{1}+$x_{2}=84+24<150$，即原料P_{}剩余
42吨.
从一般经济意义来看,影子价格反映了资源对目标函数的边际贡献,即资源
转换成经济效益的效率.上面的例子说明,在其他条件不变的情况下,若原料P_{2
月供增加1吨，该厂按最优计划安排生产可多获利0.12万元,原料P3月供增加
1吨,可多获利0.72万元.而原料P_{，增加Ⅰ吨,对获利无影响.但当某资源量不
断增加超过某值时,需要重新计算目标函数的最优解.这将需要灵敏度分析中的
某些知识.
从另一观点看,影子价格反映了资源的稀缺程度.在上面的例子中$w_{>0$$
$w_{3>}0$，表明资源P_{2}，P_{3短缺,决策者要增加收入，先注重影子价格高的资源；w_{}=}0
表明这种资源不短缺或过剩.
在上面的例题中厂方对资源定价,这是资源占用者赋予资源的一个内部价
格,与资源的市场价格无直接关系.影子价格可以计算出经济活动的成本,它不
是市场价格,不能与资源的市场价格概念等同.关于这方面更深入的探讨属于经
济理论问题.
4.对偶单纯形法
根据对偶性,我们还可以给出解标准形线性规划问题
min
$c^{x $
s.t.
Ax=b$
x≥0
的另一种方法——对偶单纯形法
回忆1.3中的单纯形方法及定理1.3.1给出的最优性准则:当基本可行解
x对应的检验数向量有
$^=cB}A-c=wA-c≤
(1.5.15)
时，x为最优解.其中B为x对应的可行基，{}=c{B^{1.可以认为(1.5.15)式是对
偶变量w=c{B^{{1}$的可行性表示.因此单纯形方法可以解释为:它是在保持一个
原始问题可行解的前提下,向对偶可行解的方向迭代,这样的算法称为原始算
法.同样,我们可以从一个对偶可行解开始,保持对偶问题的可行性，向原始可行
解的方向迭代,这样的算法称为对偶单纯形法.
52

============================================================
第 71 页
============================================================

假定初始单纯形表中有一个原始问题的基本解(但不是可行解)和一个对
偶问题的可行解(即检验数向量ζ≤0),那么,为减少原始问题的不可行性,我们
选择这样一个行r,作为旋转行,它对应于原始不可行解的分量b_,<0.通过旋转
变换,我们希望增加当前的目标函数值$z，且保持对偶解的可行性.假设以āk为
$\{} {  b }$
转轴元作旋转变换，目标函数值变$2=z-_k}，新的检$验数为${}5_{-$
$a$
_k因为
$\{}$
已有$_{k}≤0$，b_{<0$，要增加$z值,则要求转轴元$a_k<0^;要保持对偶的可行性,则要求
$\$
$5$
$5_{k≤$
$ai}$
已有${a_<0$，_{k≤0，_,≤0$，故仅需对于${a{<0$的元素必须有
15
$5_k}$
≥
$\ora{}{}j}$
$\or}k
因此旋转列的选取由下式确定
15
$\$
$5$
min
<0,j= 1,.,n
(1.5.16)
$\a}j
$\_{}k
由此可以得到对偶单纯形法的计算步骤.
对偶单纯形方法步骤
第1步列出初始单纯形表(它含有原始问题的一个基本解和对偶问题的
一个可行解）；
第2步求b_=min{b₁|i=1，.，m};
$x{$
第3步若b_,≥0$,停止.已找到原始问题的最优解x=
及最优值
三
$x{n$
$z =c{b};
第4步 若a_≥0，j=1，…，n，则原始问题无可行解(为什么？留作习题)，
停止；
"7
$\{k
第6步以${a{为转轴元作一次旋转变换，转第2步.
注意,与原始单纯形算法相对称的是,在对偶单纯形算法中,先根据右端向
量元素的符号选取旋转行(即先决定离基变量),然后在已选取的第r行中的负
元素与其对应的检验数比值中选取最小者以决定进人基的旋转列(即后决定进
53

============================================================
第 72 页
============================================================

基变量);而在原始单纯形算法中,先根据检验数的符号选取旋转列(即先决定
进基变量)，而后在选取的第k列中正元素与其对应的右端向量元素的比值中选
取最小者以决定离基的变量.对偶单纯形法与原始单纯形法十分对称,以至于读
者可能猜测到,对偶单纯形算法实质上是将原始单纯形算法应用到对偶问题上.
该结论的详细证明可参见[3].
在不出现退化时,对偶单纯形算法是从一个原始(不可行)基本解，移动到
另一个原始(不可行)基本解,并使目标函数值增加,当得到第一个原始基本可
行解时,它就是最优解,算法终止.所经过的基本解不会重复出现,因此算法一定
会在有限步后终止.在出现退化情况时，按某种避免循环的法则，如Bland法则，
亦可保证算法的有限性.
例1.5.5解下面的LP问题
minz=x₁+x_2+x3
s.t.
3x₁+x₂2+x₃3≥1$
-x1+4x2+x3≥2
$x_1，_{2},}x{3}≥=0$
解引进非负的剩余变量$x_{4≥0{，x_{,}≥0,将不等式约束化为等式约束
3x₁+x2+x_3-x4
=1
-x_₁+4x2+x3 -x_₂=2
x,≥0,j=1, .,5
若用原始单纯形法求解,需再引进两个非负的人工变量，然后利用两阶段法求
解.由本例所具有的特点，我们只要将等式两端同乘以(-1),就直接得到原问题
的一个基本(不可行)解和对偶问题的一个可行解(检验数向量ζ≤0),对应的单
纯形表如下：
$x_{r{}$
$x{2}$
$x_{sq }$
$x_{}$
$x_{sqr }$
RHS
-1
-1
2
-1
0
0
0
$x_{}$
-3
-1
-1
1
0
-1
$x_{sq}$
1
-4
-1
0
1
-2
直接利用对偶单纯形法求解$b{=-2<b{}=-1$，所以x_{₂为离基变量，由以下比值决
定进基变量：
min{
- 1
$5_2}$
1
-4
=
一
1
$\2}$
4
因而$x_{2为进基变量，以$a{2}为$转轴元进行旋转变换得 表：
54

============================================================
第 73 页
============================================================

$x_{}$
$x_{}$
$x _{q}$
$x_{4}$
$x_5 }$
RHS
5
3
1
1
0
0
4
4
4
2
13
3
1
1
$x4$
0
1
4
4
4
2
1
1
1
1
$x_{2$
1
0
4
4
4
2
显然x4为离基变量，计算
5
3
1
4
4
4
$5}$
5
min
13
3
1
$\a{{1}$
\o
4
4
4
确定x，为进基变量，以a为转轴元作旋转变换得
$x_{}$
$x_{}$
$x_{3q}$
$x_{}$
$x_{s }$
RHS
6
5
2
6
0
0
13
13
\o
$\ra3}$
3
4
1
2
$1x}$
1
0
13
13
13
\ov
4
1
3
7
$x _{22}$
0
1
\
13
13
13
27
T
9
此时b>0,故原问题的最优解为x=
,0,0,0
,其最优值为
$\frac{11} { 3}$
13'1
由以上例题可见,在某些情况下使用对偶单纯形法比用原始单纯形法更具
优越性.至于对一般问题如何列出含有原始问题的一个基本解和对偶问题的一
个可行解的初始单纯形表,这里不详加讨论,有兴趣的读者可参见有关资料[2].
有时,将原始单纯形法和对偶单纯形法结合起来使用是很方便的,同时使用两种
计算法于同一个线性规划问题叫做原始-对偶单纯形算法,而且这样的算法有
多种形式,这里不再赘述.
1.6 灵敏度分析
在设计实际的线性规划模型时,所搜集到的各个数据不是很精确;另一方面
在市场经济大环境中,各种信息瞬息万变,已形成的数学模型中的有些数据必须
随之而变.因此,对于一个线性规划问题,研究当数据变动时解的变化情况是很
55

============================================================
第 74 页
============================================================

重要的.在本节,我们仅研究个别数据变化时导致解变化的情况,这就是灵敏度
分析(sensitivity analysis).
1．改变价值向量c
考虑如下的LP问题
min
$c^{x $
s.t.Ax =b
(1.6.1)
x≥0
假定已得到它的最优单纯形表如表1.6.1:
表1.6.1
$x_{}$
$x_{n}$
RHS
$c_{{}$
B{-1}N-$
$q{1}a_{}$
0
z
I
$B^{}$
$B^{b$
$x_B$
$x{)$
B^{b}$
最优基本可行解x=
对应的可行基为B，I为一个m阶单位矩阵.
二
$（^{x$
0
当问题(1.6.1)中的某些数据改变时,是否需要我们从头开始进行计算呢?
分析一下表1.6.1,我们发现某些数据只和表中的某些矩阵块有关，因而当某些
数据变动时,只需对表1.6.1中的相应矩阵块进行修改,便可得到新问题的单纯
形表,然后就可以进行判别和迭代了.
在实际问题中,改变价值向量c或改变右端向量b是经常发生的.下面我们
先讨论改变价值向量c的情况.
当问题(1.6.1)中的价值向量由c变为$c^{，而约束系数矩阵A和右端向量b
不变时，可行区域没有变,因此原来的最优基本可行解x还是新问题的基本可行
解，但对新问题来说，x所对应的检验数向量ζ'和目标函数值_{应作相应变动，
按公式我们有
$z_{0=c{{}B-b
故只需改变表1.6.1中的第0行.当≤0时，x仍为新问题的最优解；否则，需
按单纯形法进行迭代.
当价值向量只有一个分量c变成c时，情况更为简明，可按下述办法处理.
情况1$_k}$是非基变量
由单纯形法的计算公式知，只有ζ_k起变化,新的检验数_{}应为
56

============================================================
第 75 页
============================================================

ζ=cBAk-c=cA-Ck+C-c=+（ck-cC）
) ( 1.6.2)
这样就得到了新问题的一张单纯形表.若$_{≤0，则x还是新问题的最优解；否
则,可由此开始进行单纯形迭代.
情况2$x_,}$是基变量
不妨设在问题(1.6.1)的最后一张单纯表中,基变量x{k对应的是表中第l
行的元素，有x{k}=b_{1}此时，c{k变为$$q{在新问题的检$验数向量中仍要求有$^{}}$
而N可按下式计算
$S_{}=c_{2BN-$
=cBN+（0…，0,C-c,，0，0)B⁻N-C
=5+（ck-ck）（BN)）
(1.6.3)
其中(B^{}N)^1表示B^N$的第l行元素.新目标函数值为$
$z^′{0=c{BN=_b
=c{b+（c'2-c）
(1.6.4)
将(1.6.3)与(1.6.4)式归纳为在表1.6.1上的运算是:把单纯形表上的第1行
元素乘以($q^{-c_{2})加到第$0行上去，再令$_{}=0$,就得到了对应新问题的-张单纯
形表.
例1.6.1回忆例1.4.1中的问题
minz=5x,+21x3
s.t.$x_{1}-x_2+6x_3}-_4}$
=2
x_1+x{2+2x3$
-x_{q} $
$x_{1}≥0,
j= 1,.,5
它的最优单纯形表如下
$x_}$
$x_{}$
$x_{3}$
$x_{}$
$x_sq }$
RHS
1
11
9
31
z
0
0
2
4
4
4
1
1
1
1
$x_{3}$
0
1
2
4
4
4
1
3
1
$x{1}$
1
2
0
2
2
2
如果$c_{2}由$0$变为$1，由于$x_{2}$是非基变量,故只需计算$ζ_{2}}$

============================================================
第 76 页
============================================================

1
3
(1.6.5)
$ζ^2=_2+（c2-cC2）=-
+(0-1)=-
2
2
这样就得到了新问题的一张单纯形表如下:
$x_{q}$
$x4$
$x_{sqr }$
RHS
$x_{}$
$x_{2}$
3
11
9
31
0
0
4
4
4
2
2
1
1
1
1
0
1
$x^{3}$
2
4
4
4
1
3
1
1
2
0
$x_{}$
2
2
2
1
1
1
由于$ζ^{}≤0$，因此原问题的最优解$x}$
,0，,\，0，00
仍是新问题的最优解.
2
4
实际上,由(1.6.5)式我们还可得到更多的有用信息:如果对这个问题而
1
言，改变的仅仅是c{2}，其他数据均不改变,当新的$c_{}≥-
时,原来的最优解仍是
2
1
新问题的最优解;当$c_{2<时,最优解的情况会发生变化.
2
如果原问题中的c_{3}由$21变成5${x_{3}为基变量.在原来问题的最优单纯形表
中只需按如下规则改变第0行中各元素:将x₃对应的第一行元素乘以(5-21)加
到第0行上去,再令$ζ_{=$0.得到新问题的单纯形表如下：
$x_{}$
$x_{2}$
$x_{3}$
$x_{}$
$x_{sq }$
RHS
15
5
25
15
2
0
0
2
4
4
4
1
1
1
1
$x_{q}$
0
1
2
4
4
4
1
3
1
1x$
1
2
0
2
2
2
由于$ζ_{20$^{0$，$因此x}==$
1
T
,0,
,0,0
不再是新问题的最优解,需继续进行
2
4
迭代以求解新问题.
58

============================================================
第 77 页
============================================================

2.改变右端向量b
设右端向量b变成b',则由表1.6.1可知,只需修改单纯形表中最右端的一
,便得到了新问题的单纯形表.新表中的b和$_{}可按下式计算:
b^{=Bb^{}，z{=cb$
如果只改变右端向量中的一个分量b_{，且B^{}是已知的，则计算还可简化为
$b{=Bb^{=Bb+B}(b{}-$
=b+（b{-b₁）B1$
(1.6.6)
这里B{1表示矩阵B^{1}的第s列向量，而新$目标函数值为$z_{}=c{}b^{.显然，在新问
题的单纯形表中检验数向量不变，仍有$^{=${≤0.如果b^{≥0$,则已找到新问题的
最优解;否则单纯形表对应的是新问题的一个基本(不可行)解和对偶问题的一
个可行解,故可用对偶单纯形法继续求解.
例1.6.2仍用上面例1.4.1中的问题,现在右端向量b=
其他数据不变.由于原问题约束系数矩阵A为
1
-1
6
-1
0
A =
1
2
0
-1
变量x_{4},x_{对应的一个二阶单位矩阵乘(-1).在单纯形法迭代过程中，实际上我
们在表上进行的是行初等变换,由线性代数知
行初等变换
(B,I )
→（I，B{-1})
因而也有
行初等变换
(B，-  )
(I，-B^{1
1
1
T
因而原问题的最优解x=
,0,
,0,0
所对应$的可行基B=(A_{₃2}A_{1})$
2
4
6
1
的逆矩阵B^{}可以在它的最优单纯形表上直接读出,即有
2
1
1
4
4
$B^{ =
1
3
2
2
（注意符号!)，故
59

============================================================
第 78 页
============================================================

3-45-2
1
1
4
4
$b^{}B^-}^{}=
2
二
1
3
1
2
2
3
4
13
$z^{=c_{3},_c1)b'21，
5
4
2
从而新问题对应的单纯形表为
$x_{sqr }$
RHS
$x_1}$
$x_{q2}$
$x_{}$
$x_{}$
1
11
6
13
z
0
0
2
4
4
4
1
1
1
3
$x_{q}$
0
1
2
4
4
4
1
3
5
$x__$
1
2
0
2
2
2
5
3
山
它对应了新问题的一个基本不可行解x=
,0,-
,0,0
和对偶的可行解
2
4
(5≤0),可用对偶单纯形法继续求解.
根据表1.6.1的结构,类似的分析可以针对改变矩阵A中的某些元素，增加
新变量或增加新的约束情况下解的变化.
从以上讨论可知,当原问题只有个别数据改变,特别是变化幅度不大时,用
灵敏度分析要比对新问题从头开始求解简便得多,而这正是许多具体问题在修
改数据时常会碰到的情况.
*
1.7参数线性规划
当LP问题中的某些数据发生连续变化时,研究最优解随参数的变动情况，
这是实际中经常要遇到的.譬如原材料的供应量或价格随时间(或其他因素)不
断改变.这时,用上节的灵敏度分析的方法处理不方便,而要采用新的方法.本节
先讨论目标函数是某个参数线性函数的 LP问题(Parametric Cost Programming，
简记为PCP)，然后讨论约束右端向量是某个参数线性函数的LP问题
60

============================================================
第 79 页
============================================================

(Parametric RHS Programming,简记为PRP).这些问题统称为含参数的LP问题.
1.目标函数含参数的线性规划问题
(PCP)问题可表述如下(其中λ是实参数):
,minz(λ)=（(C^{'+λC")x
(PCP)s.t. Ax=b
(1.7.1)
x ≥0
假定(PCP)问题的可行区域非空.
求解(PCP)问题，可以先取定一个λ值，如令λ=0，求解对应的(PCP)，再
求出使该解保持为最优解的λ区间[λ_₁，λ₂].如果给出的问题已经是典式，则可
以立即求出与该基本可行解对应的使检验数向量非正的λ区间[λ_₁，λ_}]，然后
对λ>λ_，和λ<λ_{求解.继续这一过程，当λ∈(-∞，+∞)都找到最优解或判定在
λ的某些区间问题无界时，也就求解了(PCP)问题.
设在λ=λ时，已求解了相应的(PCP)问题，最优解为x，对应的最优基为
B，于是有
（C{+λC）TBA-（C'+λ°C）≤0
即
^+λ^=（CBA-C）+（C"BA-C）≤0
为了求得x为最优解的λ区间，只需求解满足$_^{+λ{$^"≤0的λ区间，即对
所有j=1，2，…，n，必须满足下列条件：
$ζ_{}{,
若$ζ^{ }==0$
(1.7.2)
$-\r}$
λ≤
若$\{00$
.1
(1.7.3)
λ≥
若$ζ{0$
(1.7.4)
区
$5,>0
$λ_{2}=mn-\f}$
(min∅}=+∞)
1
$5}$
{0>1$
_{B}=max{}$
(max=-∞)
15
由于$x{$是λ=λ{时的最优解，故(1.7$.2)式必定满足$.显然有λ_{B≤λ^{≤_{B}，这样
就得到了使x为最优解的λ区间[λ_B，λ_{B}]，称为基B的特征区间.
$5_r{}$
若$λ_{B=+∞$，则基B$的特征区间为[λ_{B}，+∞).设λ{
<+∞，则当λ>λ_{}时
$\_{{}$
61

============================================================
第 80 页
============================================================

有$_{2}^}_{c>0，此时若A{k≤0，则(PCP)问题无界；否则可取x{k为进基变量，作旋
转变换,迭代得到新的最优基B，再求出B的特征区间，可以证明B的特征区间
的下界λ_{}={n}，_需再求λ_{b}{即可$$
在实际计算中,我们把C{和C{T对应的两行元素都放在表上，一起迭代.在
可行区域不空的前提下(用两阶段法可判定),对任一λ值，(PCP)问题要么有
最优解,要么无界.
开始解(PCP)问题时如果选定了一个λ值，比如λ=λ_{1}，若此时有最优解，
则总可用上述办法求解(PCP)问题.但若λ=λ_{1时(PCP)问题无界，此时必定存
在下标k，使_{+λ_{1}_{>0，而A_k≤0.这时对所有满足_{+λ_{>0的λ值，(PCP)问
题均无界，即若$^{=0，则_{>0，此时对任意实数λ{，(PCP)问题均无界；否则令
$λ_{2}$
问题无界.总之，在$_{}+λ_{1}^{>0而A_{≤0$，且$^{≠0时，可以改取λ=λ_{2$继续求解，
若当λ=λ_{2时(PCP)问题仍然无界，则可以再改取λ的值，如此进行，必能在有
限步之内判定(PCP)问题对所有实数λ都无界,或者对某一固定的λ值找到最
优解和最优基,从而可对所有实数λ求解(PCP)问题.
例1.7.1 求解下面的(PCP)问题
min$z=(1+2λ)x₁+(1-λ）x2
$s.$t_-2x_{,2+$x_{2≤1$
$x_{1}-2x{2}≤2
$x_{1},x{2}= 0$
解将目标函数表示成
z=z{+λz=x₁+x2+λ（2x₁-x₂)
形式，即有C{=(1，1){，C^"=(2，-1)^{1}引入松弛变量x_₃}，x_{4}，可得单纯形表如表$1.7.1
所示.
表1.7.1
$x_{1}$
$x_{2}$
$x_{q}$
$x {}$
RHS
z^{}$
-1
-1
0
0
0
$z}$
-2
1
0
0
0
-2
.1
1
0
$x_{q}$
1
1
-2
0
1
2
$x_{4}$
62

============================================================
第 81 页
============================================================

此时由-1-2λ≤0和-1+λ≤0，立即可求出当λ∈[-
1，2)，其基B=（A_₃3，A_2），优值z（λ）=z_{+λ{}=0$.
当λ>1$时，变量x{2的检验数$^_{2}+λ^{2=-1+λ>0，以a{12为转轴元进行旋转变
换,得表1.7.2.
表1.7.2
$x_{}$
$x_{}$
$x_{}$
$x_}$
RHS
$,2$
-3
0
1
0
1
$2
0
0
-1
0
-1
$x_{2$
-2
1
1
0
1
$x{4}$
-3
0
2
1
4
由表1.7.2知，当λ∈[1$,+∞)时，非基变量x_{3的检验数1-λ≤0,非基变量x{$的检
验数-3+λ·0<0.因而λ∈[1，+∞)$时最优解为(0,1，0$,4)^{，最优基为(A_2}，A_{4})$，最
优值为$$z(λ)}1-λ.
1
当λ<-时,由表1.7.1知，非基变量x{的检验数为-1-2λ>0,在表1.7.1上
2
以${a_{21}为转轴元，旋转变换得表$1.7.3.
表1.7.3
$x_{}$
$x_{2}$
$x_{q}$
$x}$
RHS
$z^}$
0
-3
0
1
2
2
0
-3
0
2
4
$x_{q}$
0
-3
1
2
5
$x_{}$
1
-2
0
1
2
在表1.7.3中，由-3-3λ≤0和$1+2λ≤0，求得最优基(A_3}，A_{1})的特征区间为
,其对应的最优解为(2,0,5$,0){}最优值为$z(λ)=2+4λ.
当λ<-1时，由表1.7.3知ζ^{2+λ^2=-3-3λ>0，但A_{2<0$，故(PCP)问题的无
界区域为λ∈(-∞，-1).
图1.7.1给出了函数z(λ)的图形.
63

============================================================
第 82 页
============================================================

$z(λ)
1
-1
2
1
γ
0
(A{2}}A4)$
(A3}，A4})
$(A_{3},}A{1}}$
图1.7.1
上述结果给了企业生产组织者一个有意义的信息:在例1.7.1中,如果当前
1
产品$x_{1}，x_{2不生产;但当预测到不久的将来λ值会超过1时,当前就要计划未来
$x_{2} 产品的生产.
2.右端向量含参数的线性规划问题
(PRP)问题可表述如下:
min$z= c^{x$
(PRP){s.t.Ax=b{+λb"
$x≥0
其中λ是实参数.(PRP)问题的对偶问题是(PCP)问题,因而本小节所得结论与
上小节类似.
$xB}$
设在λ=λ*时，找到了最优基B和最优解x=
,这里
$Nx}$
=b{}+λb{=0$
$x {}= 0$
现在要决定λ的取值范围，使得在此范围内B仍为最优基.由于检验数与λ的取
值无关，故只需根据b^{+λb{≥0，即由b_{₁+λb{≥0i∈{B_{₁}，，Bm}，决定λ$的取值
范围.因此，令
64

============================================================
第 83 页
============================================================

(max|}=-∞)
$\{r{0}$
(min||=+∞)
则当λ∈[_{B}，λ_{B]时，B为最优解，即B$的特征区间为[_{B}，_{B}]，在此区间内，最
优解$的基变量为$$x{b}=b^{2}+b^{}，最优值$z(λ)=z_{0+λ{_{0}$
$\ra{}{}$
$\{{{0}$
=min{-$
若$λ_{B<+∞$，则当λ>_{B}$时对应$的检验数仍为非正$，而-$
$}$
$b^{{}{}$
故有b^{}+λ{b{<0.此时可用对偶单纯形法进行迭代，或者判定（PRP)问题无解，或
者找到新的最优基B及其特征区间.当λ_{B>-∞时,有类似的讨论，直至对所有实
数λ都求解了(PRP)问题.
例1.7.2 求解如下问题
min$z=x_{1+x_{2$
s.t.-2x,2+x_₂2≤1+λ
x_{1- 2x{2≤2 -$
$x_{1}，}x{2}}0$
解引入松弛变量_{}和$x_{_}后，得到表$1.7.4.
表1.7.4
$x_{}$
$x_{}$
$x_{3q}$
$x_{}$
RHS
-1
-1
0
0
0
0
z
$x_{q}$
-2
1
1
0
1
1
1
-2°
0
1
2
-1
$x_{4}$
和
20
这里,我们把右端向量分成两列
.由于检验数向量$^{=(-1,-1,0,0)≤0,
$q
故由右端的$1+λ≥0和2-λ≥0可求出基(A_3}，A_4})的特征区间为[-1,2]，此时最
优解为(0,0,1+λ，2-λ)^{，最优值$z(λ)=0.
当λ>2时，b_{2+λb^{2}=2-λ<0$以$a{22为转轴元，用对偶单纯形法迭代，得
到表1.7.5.
65

============================================================
第 84 页
============================================================

(此页无文本内容)

============================================================
第 85 页
============================================================

$z(λ)
(A_₁1,A4})→
(A_{3},}A{4})$
(A_₃，A_{2}$
-1
0
2
λ
图1.7.2
问题均无界.
为了寻找(PRP)问题的一个可行基，可以使用两阶段法求解右端向量
含参数的辅助问题.对一个固定的入值来说,辅助问题的可行域非空，且目
标函数有下界,所以总是可解的.一旦找到使min g=0的λ值，也就找到了
(PRP)问题的一个可行基;若对所有实数λ，均有min g>0$，则(PRP)问题
无解.
在(PRP)问题的每一个特征区间中,其对偶问题的最优解固定，w{}c{B^{}1}}$
利用对偶变量的经济解释和对右端向量参数值变化范围的研究,使我们得到一
些很有意义的信息.例如下述(P)问题是一个存在资源限止约束,求利润或产值
极大的问题:
max $z= c^{xx$
(P){s.t.$Ax≤b^{'+λb"}$
x\0
其对偶问题(D)为
,min$z{=(b'+λb")
(D）s.t. AW≥C
w≥0$
(P)问题的第i个约束对应(D)问题中的第i个变量w_{.当两个问题同时达到
最优时，w;的值表示第i项资源额外增加一个单位，可得到的目标值的贡献
增量.但要注意的是,资源i的值只能在当前最优基的特征区间范围内变化，
由此决策者可确定增加额外资源的单位数或约束的松弛范围，以调整生产
计划.
有关参数线性规划更详细的内容,请参见[2].
67

============================================================
第 86 页
============================================================

进制代码序列(即只由0和1组成的序列)，把这个序列中所包含的0和1的个
数L叫做这个具体问题的输入规模(size).例如输入的信息仅为一个简单的正整
数5时,将5写成二进制序列为101，它的输入规模L=3.对一般的正整数n，它
的输入规模$L=[log^{2n]+1（[x]表示小于或等于$x$的最大整数)或者是[log_{2}n]+
2.因而一个具体问题的输入规模L是对这个问题“大小”的一种度量.但对有些
问题,我们也采用一些容易计算的、有代表性的量作为它的输人规模.例如给定
一个图_=(V_，E)，V表示图G的顶点集合，E表示边的集合.将这个图G输入到
计算机中时,采用不同的数据结构，其输人规模是不同的.习惯上我们往往用
|V或|E|(|V|表示集合V中所含元素的个数)作为这个图的规模.对于算法复
杂性的主要理论来说,这两种规模定义是不矛盾的.
输入规模均为L的不同的具体问题用同一个算法来计算,需要执行的基本
运算总次数也往往不同.为此,我们采取的办法是设法计算出该算法对同一种问
题输入规模均为L的所有可能的具体问题在最坏情况下需要执行的基本运算总
次数，记为f(L)，称函数f(L)为该算法的计算时间复杂性，简称为该算法的复杂
性.因而算法复杂性是输人规模的函数,用它来衡量这个算法的好坏.精确计算
f(L)是不可能的,也没有这个必要,因而我们一般是估计基本运算总次数f(L)
的一个上界.而且在算法复杂性的研究中,仅在输入规模很大时,我们才对其计
算行为感兴趣.这是因为只有规模大的输人，才能确定算法可应用性的限制.像
复杂性为$10L{3}和9L{3的算法间的差别可以忽略不计，因为这可以通过科技进
步，使计算机速度提高10倍而补偿.另一方面，当输人规模足够大时，在复杂性
函数中，增长速度较慢的项，如在$L{}+5$L中的5L这一项,终将被增长速度较快的
项超过.在上式中，当$L>>1000时,显然有L{>5$L.因此我们仅对算法复杂性的增
长速度感兴趣.例如当我们说某个算法的复杂性是0(L3)时,其含义是存在一个
常数$c>0$，当$L足够大时有$ff($L)≤cL^{}.
一般地,要求出一个算法所需基本运算总次数的比较好的上界并不是一件
简单的事情,它可能与算法的设计一样需要相当的技巧和艺术.这种工作称为算
法复杂性分析.
什么样的算法认为是实际有效的呢？现今人们有一个总的看法,认为解一
种问题的某个算法,仅当其复杂性随输入规模的增加而呈多项式增长时,这个算
法才是实际有效的.即这个算法的时间复杂性函数为0(P(L))，其中L为输入
规模，P为L的一个多项式，称这样的算法为多项式时间算法.例如复杂性为
$0({2})$,}0(L3})的算法是多项式时间算法$另有一些算法其复杂性比如是
O(L{2})或O（Llog2}L），,L和Llog2L虽不是L的一个多项式，但它在L充分大
以后可以有一个L的多项式为其上界,具有这种复杂性的算法也称为是多项
69

============================================================
第 87 页
============================================================

进制代码序列(即只由0和1组成的序列)，把这个序列中所包含的0和1的个
数L叫做这个具体问题的输入规模(size).例如输入的信息仅为一个简单的正整
数5时,将5写成二进制序列为101，它的输入规模L=3.对一般的正整数n，它
的输入规模$L=[log^{2n]+1（[x]表示小于或等于$x$的最大整数)或者是[log_{2}n]+
2.因而一个具体问题的输入规模L是对这个问题“大小”的一种度量.但对有些
问题,我们也采用一些容易计算的、有代表性的量作为它的输人规模.例如给定
一个图_=(V_，E)，V表示图G的顶点集合，E表示边的集合.将这个图G输入到
计算机中时,采用不同的数据结构，其输人规模是不同的.习惯上我们往往用
|V或|E|(|V|表示集合V中所含元素的个数)作为这个图的规模.对于算法复
杂性的主要理论来说,这两种规模定义是不矛盾的.
输入规模均为L的不同的具体问题用同一个算法来计算,需要执行的基本
运算总次数也往往不同.为此,我们采取的办法是设法计算出该算法对同一种问
题输入规模均为L的所有可能的具体问题在最坏情况下需要执行的基本运算总
次数，记为f(L)，称函数f(L)为该算法的计算时间复杂性，简称为该算法的复杂
性.因而算法复杂性是输人规模的函数,用它来衡量这个算法的好坏.精确计算
f(L)是不可能的,也没有这个必要,因而我们一般是估计基本运算总次数f(L)
的一个上界.而且在算法复杂性的研究中,仅在输入规模很大时,我们才对其计
算行为感兴趣.这是因为只有规模大的输人，才能确定算法可应用性的限制.像
复杂性为$10L{3}和9L{3的算法间的差别可以忽略不计，因为这可以通过科技进
步，使计算机速度提高10倍而补偿.另一方面，当输人规模足够大时，在复杂性
函数中，增长速度较慢的项，如在$L{}+5$L中的5L这一项,终将被增长速度较快的
项超过.在上式中，当$L>>1000时,显然有L{>5$L.因此我们仅对算法复杂性的增
长速度感兴趣.例如当我们说某个算法的复杂性是0(L3)时,其含义是存在一个
常数$c>0$，当$L足够大时有$ff($L)≤cL^{}.
一般地,要求出一个算法所需基本运算总次数的比较好的上界并不是一件
简单的事情,它可能与算法的设计一样需要相当的技巧和艺术.这种工作称为算
法复杂性分析.
什么样的算法认为是实际有效的呢？现今人们有一个总的看法,认为解一
种问题的某个算法,仅当其复杂性随输入规模的增加而呈多项式增长时,这个算
法才是实际有效的.即这个算法的时间复杂性函数为0(P(L))，其中L为输入
规模，P为L的一个多项式，称这样的算法为多项式时间算法.例如复杂性为
$0({2})$,}0(L3})的算法是多项式时间算法$另有一些算法其复杂性比如是
O(L{2})或O（Llog2}L），,L和Llog2L虽不是L的一个多项式，但它在L充分大
以后可以有一个L的多项式为其上界,具有这种复杂性的算法也称为是多项
69

============================================================
第 88 页
============================================================

式时间算法.如果一个算法的复杂性函数不能被输人规模的一个多项式所界
定，称其为指数时间算法.如复杂性为O（_{0{2)，O(2^{1)或0（L!)的算法均为指
数时间算法．
多项式时间算法具有很多优点.首先，当输入规模增大时,任意一个多项式
时间算法终将变得比任一个指数时间算法更有效.如$L=100时，Llog{₂2L≈664,
L=10；而2≈1.27×10³0,L！≈1018;当L=1000时，Llog2L≈9966，L=10°;而
2^{≈1.05×10^{01，,L！4×1^{567.其次，多项式时间算法在某种意义上很好地利用
了技术进步性.例如每次技术突破,计算机速度提高10倍,那么多项式时间算法
原来在一个单位时间内所能解例题的最大规模，现在可以增加c倍，其中
1<c<10;而指数时间算法所能解例子的最大规模，只能增加一个常数.如算法复
杂性是$L{2}$的算法，当前一个单位时间的解题规模是$N_{2的话，当计算机速度提高
10$倍后，在单位时间$的解题规模设为$${2}，则有${2}=1O{2}，所以$_{2}3.16$_{2；而
对复杂性是2{的算法,原来的解题规模为N,计算机速度提高10倍后的解题规
模为N_{₂}，则有2^=102{^，所以N{=l}g₂210+N{≈3+N_{.最后，多项式时间算法具
有“封闭”的性质,即某一个多项式时间算法调用了若干个多项式时间算法作
为其子程序,则整个算法的复杂性仍是多项式的.因而，一种问题如果已有了
一个多项式时间算法，我们就认为这种问题是“容易”解决的，称它属于P类
问题.
2．解线性规划问题的进一步研究
算法好坏的这种衡量标准得到了不少实际问题的验证.对于许多类型的问
题，多项式时间算法确实明显地优于指数时间算法.解LP问题的单纯形算法一
般是相当有效的,几十年的实践经验已证明了这一点.那么,根据计算复杂性理
论，它是否是一个多项式时间算法呢？1972年,美国学者Klee和Minty[]发表了
一个出乎人们意料之外的例子,他们构造的例子,按通常的单纯形方法，在最坏
情况下迭代次数是指数,因而说明了单纯形方法的时间复杂性是指数阶的.这个
例子激起了人们强烈的兴趣，因为它是对指数时间算法是无效率方法这一观念
的一个挑战.究其原因，算法复杂性的取值是在最坏情况下所需基本运算次
数,但是这种最坏情况出现的可能性有多大并没有得到反映.一部分学者研究
了在某些概率分布条件下,单纯形方法迭代次数的数学期望值是输人规模的
多项式.这说明了单纯形方法的平均运算次数是多项式.另一部分学者则研究
LP问题是否存在多项式时间的算法.第一个这样的方法是由苏联数学家].r.
XayngH(哈奇扬)于1979年提出的,他根据解非线性规划问题椭球算法的思想，
70

============================================================
第 89 页
============================================================

给出了一个解线性规划问题的椭球算法,并证明了其时间复杂性函数是多项
式的.
椭球算法从理论上说是一个重要的突破,因为它提供了解LP的第一个多
项式时间算法,从而证明了线性规划问题属于P类问题,解决了这个长期悬而未
决的问题.但遗憾的是广泛的实际检验表明其计算效果比单纯形方法差,在实际
使用方面尚不能取代单纯形方法.
1984年,在美国贝尔实验室工作的印度裔数学家N.Karmarkar(卡玛卡)提
出了可以有效求解实际线性规划问题的多项式时间算法——Karmarkar算法，引
起了学术界的极大关注,掀起了继单纯形方法、椭球算法之后研究线性规划的第
三次高潮.
Karmarkar算法是一个基于非线性规划方法设
计的迭代算法,它的思想完全不同于单纯形方法.单
七*
纯形方法是从可行区域的一个顶点沿某条边转移
到相邻的顶点，直到达到最优顶点或判定问题无
$1+y^}$
界，其移动轨迹是在可行区域的边界上.Karmarkar
算法是从可行区域多面体内部的一个点(称为内
点)出发,产生一个直接穿过多面体内部的点列而
x
+0
到达最优解，如图1.8.1所示.Karmarkar证明了该
图1.8.1
算法迭代次数的上界是0(nL)，每次迭代的平均计
算量是O(n^{5})}，因而其算}法总$的时间{杂性 $${O（n}L)$，其中$n$是}L}P}问题的
维数，L为其输人规模.关于该算法的详细论述可参看[8].
由Karmarkar算法的发表,激发的内点法热催生了一些实际效果极好的算
法，如仿射尺度(affine- scaling)法、路径跟踪(path following)法等，统称为解LP
问题的内点算法.目前,这些算法中最好的时间复杂性函数是O(n{}_).
解LP问题的内点算法已在一些商业软件中实现(如CPLEX)，被视为最强
有力的方法.这些方法还能很好地并行化,相较于并行化不很成功的单纯形法，
更凸显其优势.但是,内点法固有的弱点严重制约了其应用.其弱点之一是仅提
供近似最优解,对于要求顶点最优解的实际应用,需另外增加一个所谓“纯化”
(purification)过程.更重要的是,单纯形法有“热启动”特征,从最后求得的基再
开始能大大缩短求解时间，而内点法不具有这种特征,难以处理整数线性规划产
生的大量相互关联的线性规划问题,只能将它们留给单纯形法.因而内点法难以
撼动单纯形法在实际中的统治地位.
目前，单纯形法和内点法的竞争并未停止，没有对所有线性规划问题都适用
的单个方法.商业软件通常提供多个方法备选.有些学者建议将内点法和单纯形
71

============================================================
第 90 页
============================================================

法结合起来,先用内点迭代后用单纯形法迭代求解问题,可发挥两类方法各自的
优势从而实现互补.这些均有待进一步研究.
第1章习题
(A)
1.某商业集团公司在A_{}，A₂2，A₃三地设有仓库，它们分别库存40，20,40个
单位产品，而其零售商店分布在地区B_{,i=1,2，…，5，它们需要的产品数量分别
是25,10,20,30，15个单位.产品从A{到B;的每单位装运费列于下表：
$B_{1}$
$B_{2}$
$B_{3}$
$B_{4}$
$B_{s}$
$A_{}$
55
30
40
50
40
$A_{_}$
35
30
100
45
60
$A_{}$
40
09
95
35
30
试建立装运费最省调运方案的数学模型.
2.从数学观点分析，在标准的运输问题中，为什么要假设总的供应量必须
等于总的需求量(收发量平衡)?
建立一个总的供应量大于总的需求量的运输问题的数学模型.
3.某企业生产需要m种资源，记为$A_{1}，…，A_{m}，其拥有量分别为b_{1}，，$b_}，
现用来生产n种产品，记为$B_{1}，._，B{}产品B_{$的每个单位的利润为$c_{}又生产每
单位的B_{需消耗资源$A_{}的量为$$a_{，j=1，…，n，i=1，…，m_.在现有资源条件下$，
企业应如何安排生产,使利润最大？建立这个资源利用问题的数学模型，然后将
其化为标准形式的线性规划问题.
4.将下面的线性规划问题化成标准形式
maxx_₁1-x_2+2x_3
s.t.$x__2-2x_2+3x_{32}≥6$
2x₁+x₂2-x₃3≤3
$0≤x_{1≤3
-1≤x{2}≤6
(提示：$$x_{2}=x2}+1)$
5.用图解法求解下列线性规划问题：
72

============================================================
第 91 页
============================================================

(1)min $x₁1}+3x2
s.t.x_1+_₂2≤20
s.t.x_{1+x_{2}≤20
6≤x{1}≤12
6≤x{1}≤12
$x_{2 2$
$x_{2 2$
(3)max 2x,-2x{2
(4)max x₁1}+2x2
s.t.-2x_{2+x_{2} ≥2
s.t. $2x__2}+5x{2}≥} 12
x_1-x__2}≥1$
x_{1}+2x{2} ≤8
$x₁1}≥0，x{2}≥0
$0≤x_{,≤4
$0≤x_{_2≤3$
n
6.证明集合S_={d∈^{|Ad=0,d≥0，d{=1$是-个凸集.
I
7.（1）证明任意多个凸集的交集还是凸集；
(2) 举例说明两个凸集的并集并不一定是凸集.
*8.（1）写出题5（4)的可行区域D中的所有顶点；
(2) 证明若一个线性规划问题在两个顶点上达到最优值,则此线性规划问
题必有无穷多个最优解.
9.某线性规划问题的约束条件是
-2x__2+2x2}+x_3
=4
$3x_{1}+$_{2}$
+x_{4}}=6
$x_{i}≥0
j=1,2,3,4
问变量$x_{2}{x_{4}所对应的列向量$A_{₂2}A_{4}$是否构成可行基？}$若是，写出B，_{}并求出
B所对应的基本可行解.
*10.证明线性规划
min c^{x$
s.t.Ax=b
在可行区域不空的条件下只有两种可能结果：（1）目标函数值无下界；（2）所有
可行解对应的目标函数值都相等,从而都是最优解.
*11．设有线性规划问题
$c^{ $
min
s.t.
Ax=b$
x≥0
及
73

============================================================
第 92 页
============================================================

min μc^{x$
s.t.Ax=λb
x≥0
这里λ，μ均为大于0的实数，说明这两个问题的最优解的关系.当λ<0或u<0
时，这两者关系如何?
12.对于下面的线性规划问题，以B=(A_{2}，A_₃}，A_{6)$为基写出对应的典式.
minx₁1-2x__2+_3
s.t.
3x_{}-$x_2}+2x_{3}+4}$
=
7
-2 x₁+4x_{2$
+ x_q$
= 12
-4 $x__1+3 $x_2+8 x3}$
+ x_{}  1$
x{}≥0,j= 1, . ,6
13.证明非退化的基本可行解x是唯一最优解的充要条件是这个基本可
行解x的所有非基变量的检验数$ζ_{1<0$.
14.用单纯形法求解下面的线性规划问题,并在平面上画出迭代点走过的
路线.
min $z=-2x_,-_2
s.t.$2x},2}+5x_2}≤} 6$
$x1+x_2≤ 18$
3x₁1+x2}≤ 44$
$x_{2}≤} 0$
$x_{1}x{2}} 0$
*15.有一线性规划问题，目标函数为min(-5x{}-3x_2})$，约束条件为≤类型的
线性不等式，x_{和x₄为松弛变量，经过一次迭代后得到下表
$x_{}$
$x_{}$
$x_{q}$
$x_{}$
RHS
b
1
f
g
-10
2
1
$x_{3}$
0
1
2
c
5
$x_1}$
d
e
0
1
a
试写出原问题，并写出这张单纯形表所对应的B和B^{}.$
16.用单纯形法求解下列线性规划问题：
74

============================================================
第 93 页
============================================================

minz=-2x₁-x_2+x_3
s.t.
3 x_1+x_{2+$x_32≤6
(1)
x₁-x{2+2x3≤10$
x₁1+x_2-x_{3≤20
x₁≥0，j=1,2,3
minz=3x₁1+x₂2+x3+x4
s.t.
-2$x__2+2$x_₂2+x_3
=4
(2)
3x{1}+_2$
+ x_{4}=6
x₁≥0，j=1,2,3,4
min
z=x₁-x₂+x₃3+x-x6
= 6
s.t.
3 $_{}$
+x_{5}+_$
= 10
x_2 +2x3-_4$
(3)
+ x_$
= 0
-x_1$
$x_{3}$
+x_₀+x_=6
x₁≥0，j=1,…,7
17.用两阶段法求解下列问题：
max
z=3x1+4x₂2+2x3
s.t.
x{1+x2+_3+x4≤30
(1)
3x₁2+6x2+x_3-2x4≤0
$x_{}$
≥ 4
x₁≥0，j=1,2,3,4
(mi
z=2x{1+4x_2$
s.t.
2 x__-3 $x__2≥2
(2)
-$x__1+x_{2≥3
$x_{1，x{2}=0$
(n
z=4x{1+x{2}$
s.t.
3 x{1+x_{2=3
(3)
4 x_₁+3 x_2}≥6
x_{1}+2x_2}≤3
$x_{1，x{2}=0$

============================================================
第 94 页
============================================================

maxz=2x₁-4x2+5x3-6x4
s.t.
x₁1+4x₂-2x3+8x=2
(4)
-_₁+2x2+3x3+4x=1
$x{≥0,j=1,2,3,4
18.写出下面线性规划的对偶规划：
min
10x_{2}+10$x2$
S.1.
5 $x{2+2$x₂2≥5
x₁1+4x₂2 ≥3$
(1)
x_₁1}+3x{2}≥2
8 $x__2+2$x__2≥4
$x_{}{x_{2为$自由变量
$minx₁1+2x_2+4x3
s.t.
2x_₁1+3x2+4x_3≥2
(2)
2 x1+x_2+6x3 =3
x1+3$x2+5x_3≤5
$x_{1}≥0$x_{2}≥0$x_3}为$自由变量
m
"
min
$1D ={$
n
(i=1,2, . ,m)
s.t.
(3)
${}$
m
(j =1,2,.,n)
$x_{j}}0$
(i=1, …,m;j=1,..,n)
其中a_{}=
m
n
b_}.
i=
三
19.证明下面的线性规划问题要么无解,要么最优目标函数值为零，其中
c∈R"，b∈Rm，A为m×n矩阵.
min$c^{x-b^{y$
s.t.
Ax≥b$
$A^{y}≤cc
x≥0,y≥ 0
20.把线性规划问题
76

============================================================
第 95 页
============================================================

min$x_1+_3$
≤5
s.t.x_{1}+2x_2}$
1
$x_{2+x{3}    $
2
$x1}，x2}，x3}≥0$
记为P，
(1)用单纯形算法解P；
(2)写出P的对偶D；
(3)写出P的互补松紧条件，并利用它们解对偶D.
通过计算P和D的最优值,检查你的答案.
21.设b_{>0,i=1，，m；c{≥0,j=1，…，n,m<n.写出下面线性规划的对偶问
题,证明对偶问题有唯一最优解,并找出对偶问题的这一最优解.
n
min
∑c_,_
j=m+11$
n
s.t.x_{1}+∑a{_,}=_{}
i=1, .,m
j=m+1
x{}≥0,j=1,.,n
22.判断下列说法是否正确，为什么？
(1)如果线性规划的原问题存在可行解，则其对偶问题也一定存在可
行解；
(2)如果线性规划的对偶问题无可行解,则原问题也一定无可行解；
(3)在互为对偶的一对原问题与对偶问题中,不管原问题是求极大还是
极小，原问题可行解的目标函数值一定不超过其对偶问题可行解的目标函
数值；
(4)任何线性规划问题具有唯一的对偶问题.
23.用对偶单纯形法求解下列问题：
min 2x₁}+3x₂2+4x3
s.t.
x₁+2x2+x_3≥3
(1)
2x₁1-x2+3x₃3≥4
x_1}，_2，x₃3≥0$
77

============================================================
第 96 页
============================================================

$min$3x_{1}+2x_2}+x_3$
s.t.x_₁+x_2+x₃3≤6
(2)
$x_}$
-$x_{3}}≥=4$
x_{2 -x_3} ≥$
x1}，x2，x3≥0$
{min2x₁+3x₂2+5x₃+6x4
s.t.
$x_{1}+2x{2+3 _3}+$x{4} 2
(3)
-2 $x__2+$x_2- x_3+3 x4}≤-3
x_{≥0,j
j=1,2,3,4
24.考虑第20题中的线性规划P，在下述每一种情况下，试利用解问题P所
得到的最优单纯形表继续求解.
5
-，{C_{3}由$1变为2;
3
25.用单纯形法直接求极大问题的LP如下：
max
z=5x₁+x₂2+2x3}$
s.t.
x_{1}+x2+x3≤6$
6x{1$
$+x_{3}≤8$
$x_{2}+x3}2$
x,≥0,j=1,2,3
其最优单纯形表(为什么是最优的?)如下：
$x_{}$
$x_{2}$
$x_{q}$
$x{4}$
$x_{sq }$
$x_{6}$
RHS
1
z
0
5
0
0
7
6
6
9
6
1
$x{$
0
1
0
1
5
9
6
3
6
1
1
1
0
0
1
$x_{1$
6
9
6
1
0
1
1
$x_{3$
0
0
1
2
78

============================================================
第 97 页
============================================================

(1) 从表上直接读出该问题的对偶问题的最优解和最优值；
(2)使当前基保持最优时,求目标函数中x{的系数_{1的取值范围.
*26.解下面的参数线性规划问题，画出z(λ)与λ的变化关系.
（minz=(6-λ)x₁+(5-λ)x₂+(-3+λ)x₃+(-4+λ)x₄
s.t.x_₁1-x2-x_3≤1$
(1)
-x1}+x2-x411$
-x__2}+x3}≤1$
x₁≥0,j=1,.,4
(min$z=2x₁2+6x2+15x3}$
s.t.
-2x₁-3x₂-5x3≤6-λ
(2)
$x{1}+x{2+_3≤-2+λ+$
$x_2+2x3≤-3+2λ$
x₁,≥0,j=1,2,3
(B)
1.一个资源利用问题的数学模型如下：
max$z=100x₁1+180x2+70x3
s.t.40x₁2+50x{2+60x3≤10000
3x{+6x2}+2x_3≤60$
$x_}$
≤130
$x_{2}$
08
$x_{3}≤ 200$
$x1}，x2}，x3}≥00$
用LINDO软件包解之，并从LINDO的输出表中回答下列问题：
(1)在现有资源约束条件下,企业管理者应如何组织生产,使利润最大?
(2)为改善现状，以获取更大利润，管理者应该如何做?
(3)若希望增加某种资源的供应量,需支付额外的费用,这笔费用应控制在
什么范围内,对企业才是有利的？此时(即增加某些资源供应量，同时支付相应
的额外费用)，企业的总利润的增量是多少?
2.一个工厂生产两种产品，甲产品每单位利润为0.5单位，乙产品每单位利
润为0.3单位，产品仅能在周末运出.产品的生产量必须与工厂仓库容量相适应，
仓库容量为400000单位.包装好的每单位产品占用仓库容量2个单位.两种产
79

============================================================
第 98 页
============================================================

品通过相同的系统生产(例如烟厂生产不同品牌的香烟)，产品甲的生产率为
2000单位/小时，产品乙的生产率为2500单位/小时，系统每周可使用的工时是
130小时,市场预测表明,在目前市场状态和广告宣传作用下，甲产品每周最大
的需求量为250000单位，乙产品为350000单位.另外,根据合同规定，工厂每
周至少要生产50 000单位乙产品,提供给某特殊用户.
(1)在现有状态下，工厂应如何安排每周的生产计划，以获取最大利润?
(2)工厂为获取更大利润,应如何改革？比如增加系统的生产时间(需新增
生产线);增加宣传力度，以提高市场需求量(需增加宣传费用);增加仓库的库
容量(要付出额外租金);不满足乙产品合同规定的部分生产量(要付罚金),哪
些措施能使利润增加?
*(3)能使利润增加的措施,在多大的范围内是可取的(在影子价格不变的前
提下)，此时实际的利润是多少？（提示:利用参数规划,所需的参数可能不止
一个.)
*3．自动化储药柜的优化设计
储药柜的结构类似于书橱,通常由若干个横向隔板和竖向隔板将储药柜分
割成若干个储药槽(如图1所示).为保证药品分拣的准确率,防止发药错误，一
个储药槽内只能摆放同一种药品.药品在储药槽中的排列方式如图2所示.药品
从后端放入,从前端取出.
一储药柜宽度
(即储药槽长度）
储药柜长度
-----储药柜高度------
竖向隔板
横向隔板
传达装度
图1 储药柜立体示意图
80

============================================================
第 99 页
============================================================

一储药柜长度(即储药槽长度）
药盒长度
方向
药品1
药品1
药品药品1
2
药品
药盒高度方向
储药柜补药端
药品2药品2药品2药品2药品2药品2药品2
储药柜出药端
药品3
药品3
药品3
药品3药品3
药品3
药品药品5药品5
药品5
药品5所
传送装置
药品6药品6药品6药品6药品6药品6
中
药品7药品7药品7药品7药品药品7药品7
图2 储药柜的侧剖面及药品摆放示意图
为保证药品在储药槽内顺利出入,要求药盒与两侧竖向隔板之间、与上下两
层横向隔板之间应留2mm的间隙，同时还要求药盒在储药槽内推送的过程中
不会出现并排重叠、侧翻或水平旋转.在忽略横向和竖向隔板厚度的情况下，建
立数学模型，给出下面几个问题的解决方案.
(1)药房内的盒装药品种类繁多，药盒尺寸规格差异较大，附件1中给出了
一些药盒的规格.请利用附件1的数据,给出竖向隔板间距类型最少的储药柜设
计方案，包括类型的数量和每种类型所对应的药盒规格.
(2)药盒与两侧竖向隔板之间的间隙超出2mm的部分可视为宽度冗余.增
加竖向隔板的间距类型数量可以有效地减少宽度冗余,但会增加储药柜的加工
成本,同时降低了储药槽的适应能力.设计时希望总宽度冗余尽可能小,同时也
希望间距的类型数量尽可能少.仍利用附件1的数据,给出合理的竖向隔板间距
类型的数量以及每种类型对应的药品编号。
(3) 考虑补药的便利性,储药柜的宽度不超过2.5m、高度不超过2m,传送
装置占用的高度为0.5m，即储药柜的最大允许有效高度为1.5m.药盒与两层
横向隔板之间的间隙超出2mm的部分可视为高度冗余，平面冗余=高度冗余×
宽度冗余.在问题(2)计算结果的基础上,确定储药柜横向隔板间距的类型数量，
81

============================================================
第 100 页
============================================================

使得储药柜的总平面冗余量尽可能小，且横向隔板间距的类型数量也尽可能少.
(4) 附件2给出了每一种药品编号对应的日需求量(单位:盒/日，附件2的
第2一5列为每个季度的平均日需求量，第6列为全年的平均日需求量).在储药
槽的长度为1.5m、每天仅集中补药一次的情况下，请根据第6列，计算每一种
药品需要的储药槽个数.为保证药房储药满足需求,根据问题(3)中单个储药柜
的规格,计算最少需要多少个储药柜。
(5) 根据每个季度的平均日需求量,重新讨论第(4)问.如果每个季节的方
案存在不同,给出合理的调整计划。
附件1药盒型号(单位：mm)
药品编号
长
高宽
1
120
76
24
2
125
72
20
3
125
76
21
4
91
71
15
:
…
…
…
1918
115
66
16
1919
62
45
25
附件2
药品需求量(单位:盒/日)
药品编号
季度1
季度2
季度3
季度4
年
1
268
244
238
429
273
2
223
244
66
6
155
3
93
155
155
167
139
4
73
172
148
78
124
…
:
…
…
…
…
1918
0
0
0
1
1
1919
0
1
0
1
1
参考文献
[1]管梅谷，郑汉鼎.线性规划[M].济南：山东科学技术出版社，1983.
[2]张建中，许绍吉.线性规划[M].北京:科学出版社,1990.
3] Papadimitriou CH,Steigliz K.CombinatorialOptimization:Algorithms and Com-
plexity [M].New Jersey : Prentice-Hall,1982.
[4]王金德.随机规划[M].南京:南京大学出版社,1990.
82

============================================================
第 101 页
============================================================

[5]胡运权,等.运筹学基础及应用[M].6版.北京:高等教育出版社,2014.
[6] Klee VL, Minty G J.How Good is the Simplex Algorithm?[C].InequalitesI
New York :Academic Press,1972.
[7]越民义.椭球法介绍[J].运筹学杂志，1983,1.
[8] Karmarkar N.A New Polynomial—Time Algorithm for Linear Programming[J].
Combinatorica,1984,4(4):373-395.
[9]《运筹学》教材编写组.运筹学[M].4版，北京:清华大学出版社,2012.
[10]潘平奇.线性规划计算(上)[M].北京:科学出版社,2012.

============================================================
第 102 页
============================================================

第2章
整数线性规划
要求变量取整数值的线性规划问题称为整数线性规划，其中变量只取0
或1的线性规划称为0-1规划只要求部分变量取整数值的线性规划称为混
合整数线性规划
整数线性规划与线性规划有着密不可分的关系，它的一些基本算法的设
计都是以相应的线性规划的最优解为出发点的，但是变量取整数值的要求本
质上是一种非线性约束因此解整数线性规划的“困难度”大大超过线性规
划，一些著名的“困难”问题都是整数线性规划问题
本章主要介绍整数线性规划的一些实际背景及常用算法
2.1 整数线性规划问题
整数线性规划(Integer Linear Programming,简记为ILP)是下述形式的优化问题:
minz= c{x
s. t.Ax = b
(2.1.1)
x≥0
x;∈I,i ∈JC |1,2,.,n}
其中A为mxn矩阵，c∈R"，b∈R，x=（x₁，…，x₂)，1=10，1,2，.|.
若I={0,1}，J={1，.，n}，则(2.1.1)为0-1规划问题;若J是{1,2，.，n
的非空真子集，则(2.1.1)是混合整数线性规划问题;若J={1，…，n}，则(2.1.1)
是纯整数线性规划问题.
规范形式和一般形式的ILP也可以类似地定义,并且在1.1中的那些等价
性的说明仍然是对的.
本节我们先举例介绍整数线性规划的广泛实际背景,然后分析解LP的困难所在.
1.整数线性规划问题举例
在许多实际问题中我们所研究的量具有不可分割的性质,如人数、机器
84

============================================================
第 103 页
============================================================

数、项目数等;而开与关、取与舍、真与假等逻辑现象都需要用取值仅为0或1
的变量来数量化描述.涉及这些量的线性规划问题,非整数的解答显然不合乎
要求.
例2.1.1投资决策问题
某部门在今后五年中可用于投资的资金总额为B万元，有n(n≥2)个可以
考虑的投资项目，假定每个项目最多投资一次,第j个项目所需的资金为b万
元,将会获得的利润为_万元.问应如何选择投资项目，才能使获得的总利
润最大.
解设投资决策变量为
(cid1  ,
决定投资第j个项目，
$x_}=$
j = 1, . , n
{0,
决定不投资第j个项目，
设获得的总利润为z，则上述问题的数学模型为
1
max
三
"
0<∑b，x,}≤B
(2.1.2)
s.t.
三
x,=0或1，j=1，.,n
显然,问题(2.1.2)是一个0-1规划.决策变量取值为0或1这个约束是可以
用一个等价的非线性约束
x(1-x₁)=0，j=1,.,n
来代替的.因而变量限制为整数本质上是一个非线性约束,它不可能用线性约束
来代替它.
例2.1.2某建筑公司承包建两种类型的住宅楼.甲种住宅楼每幢占地面积
为0.25×1^3}(m^2)；$乙种住宅楼每幢占地面积为$0$.4×1^{}(m^{2).该公司已购进
3×10^{}(m^2)的建筑用地.计划要求建甲种住宅楼不超过8幢，乙种住宅楼不超过
4幢.建甲种住宅楼1幢可获利10万元,建乙种住宅楼1幢可获利20万元.问应
建甲、乙种住宅楼各几幢，公司获利最大?
解设建设甲种住宅楼x{1幢、乙种住宅楼x{2幢，则该问题的数学模型为
maxz=10x,+20x_2
s.t.
0.25x_+0.4x{2≤3
$x_{1≤ 8$
$x_{2} }≤4$
$x_{1}_{2}≥0$且为整数
85

============================================================
第 104 页
============================================================

这是一个纯整数线性规划问题.
例2.1.3旅行售货员问题(又称货郎担问题)
有一推销员，从城市v_{。出发，要遍访城市v_{₁}，_{2}，…，_n各一次，最后返回_0
已知从v{到;的旅费为c_j,问他应按怎样的次序访问这些城市,使得总旅费最
少？(设c=_，M为充分大的正数，i=0，1，…，n_.)
解对每一对城市v_{}，v_，我们指定一个变量x_{j，令
1 ,
，如果推销员决定从v；直接进入v；
$x_{ij}$
=
0,
其他情况
该问题的数学模型为
n
ij=00$
∑x_{}= 1,
n
s.t.
j= 0,…,n
i=0
"
(2.1.3)
$x_{j}11,
i=0,.,n
u_-u₁+nx₁≤n-1,
1≤i≠j≤n
x₁=0或1，i,j=0，…,n
u_{；}为实数，i=1,,n
对于求目标函数的极小而言，c_{=M(M为充分大的正数)，迫使x{}=0，i=0$，
1，…，n.因而第一组约束条件表示各城市恰好进入一次；第二组约束条件表示各
城市恰好离开一次;第三组约束条件用以防止出现多于一个的互不连通的旅行
路线圈，且不排除任何可能的旅行路线.例如，对于6个城市(n=5)的货郎担问
题，若令
x01=x₁2=x20=1
x34=x4=x53=1
其他x_{=0
即取图2.1.1中所示的两个互不连通的旅行路线圈，
v_0
这样的一组{x_}满足第一、二组约束条件，但不满足
$v_{2$
第三组约束条件,因为其中的三个不等式为
$u_₃3-u₄+5≤4
$v_{}$
${4-u_+5≤4
$v_{3}$
$v_{s}$
$lu_{-u_3+5≤4
这三个不等式相加，不论$u_3}，u_₄}，u_{}取任何实数值均导
U4
图2.1.1
86

============================================================
第 105 页
============================================================

致5≤4的矛盾.第三组约束所起的这个作用是可以严格证明的，见[1].
根据定义,货郎担问题是一个混合整数线性规划问题.
有许多实际应用问题的数学模型都是(2.1.3)的形式.如生产顺序表问题、集
成电路的布线问题,等等.货郎担问题是著名的“困难”问题之一.还有很多著名
的“困难”问题,如背包问题、数理逻辑中的适定性问题等均可归结为一个ILP
问题,这里不再一一列举.
2.解整数线性规划问题的困难性
考虑如下形式的ILP:
z = c{ x$
min
s.t.Ax = b
(2.1.4)
x≥0
x为整数向量
在(2.1.4)问题中除去x为整数向量这一约束后,就得到一个普通的LP问题，而
对于LP问题已有有效的算法.因此，人们对ILP提出的第一个问题是:为什么不
解对应的LP,然后将其解舍人到最靠近的整数解呢？在某些情况下,特别是当
LP的解是一些很大的数时(因此对舍人误差不敏感)，这一策略是可行的.但在
一般情况下,要把LP的解舍入到一个可行的整数解往往是很困难的,甚至是不
可行的.图2.1.2说明了这一方法是不可行的.另一方面，在以上的几个例题中我
们看到,很多ILP中的整数约束是用来描述某种组合限制条件或各种类型的非
线性约束,根据这样一些ILP的本质,舍入方法是不可取的,因为那样做将破坏
用ILP来描述问题的目的.如某些0-1规划问题,实行舍入与解原问题是同样困
难的.
$x_{22}$
LP的可行集合
0
。
。
0
O
0
。
o
0
0
。
ILP的最优解
0
0
0
。
0
费用下降方向
0
。
。
。
0
o
o
0
0
0
0
0
0
Ox
LP的最优解
。
$x_{}$
图2.1.2
97

============================================================
第 106 页
============================================================

从图2.1.2我们还可以看到,ILP的可行集合是一些离散的整数点,又称为
格点,而其相应的LP问题的可行集合是包含这些格点的多面凸集.对有界的
ILP问题来说,其可行集合内的格点数目是有限的.于是人们对ILP提出的第二
个问题是:可否用枚举法来解ILP呢？即算出目标函数在可行集合内各个格点
上的函数值,然后比较这些函数值的大小,以求得ILP的最优解和最优值.当问
题变量个数很少,且可行集合内的格点个数也很少时,枚举法是可行的.但对一
般ILP问题,枚举法是无能为力的.如50个城市的货郎担问题,所有可能的旅行
49！
路线个数为(请读者考虑为什么？留作习题)，如用枚举法在计算机上求解，
2
即使对未来的计算机速度做最乐观的估计,那也将需要数十亿年！
由上可见,求解ILP比求解LP要困难得多.究其原因,ILP是一个非常一般
的数学模型,许多不同种类的问题都可归结为它.正由于这个一般性,而使其表
现出内在的困难性.从1959年R.E.Gomory 提出解整数线性规划的割平面算法
至今,经过几十年的努力,目前发展起来的一些常用算法,如各种类型的割平面
算法、分枝定界法、解0-1规划的隐枚举法、分解方法、群论方法、动态规划方法
等,因需要较大的计算量，一般只能用来解中小型的ILP问题.最近三四十年,对
一些著名的“困难”的ILP问题发展了一些有效的近似算法.1993年7月在美国
费城召开的美国工业与应用数学学会(SIAM)年会中，加拿大的W.J.Cook报告
了他从超大规模集成电路应用中提出的一个10907064个城市的货郎担问题，
他用平行计算求得了这个问题的近似解,并证明了近似解的目标函数值不多于
最优值的4%.还有人用计算机模拟法，如 MonteCarlo(蒙特卡罗)方法解ILP问
题,也取得了很好的效果[5].关于计算机模拟的理论和方法可参看[6].
下面我们介绍由解LP的单纯形法导出的割平面法，以及基于巧妙枚举的
分枝定界法.这是目前解整数线性规划的两种基本途径.
2.2 Gomory 割平面法
解整数线性规划问题的割平面法有多种类型,但它们的基本思想是相同的.
本节我们介绍Gomory 割平面算法.它在理论上是重要的,被认为是整数线性规
划的核心部分.
1.Gomory割平面法的基本思想
考虑纯整数线性规划问题
88

============================================================
第 107 页
============================================================

$z = c{ x$
min
s.t.
Ax=b$
(P)
x≥0
x为整数向量
其中A，b_,c中的元素皆为整数.(P)的可行区域记为D，当D≠时它是由有限
个或可数的格点构成的集合.现在我们放弃x为整数向量这个约束,称线性规划
问题
min$z = c^{x
s.t.Ax=b
(P_0$
x≥0
为(P)的松弛问题，记为问题(P_{0).(_{0)的可行区域D_{0是一个多面凸集.这两个
问题之间具有如下明显的关系：
(1) DCD{0;
(2)若(P_{。)无可行解，则(P)无可行解；
(3)(P_{0)的最优值是(P)的最优值的一个下界；
(4)若(P_{0)$的最优解$x^{$是整数向量，则$x^{$是(P)$的最优解.$
割平面法的基本思想是:用单纯形法先解松弛问题(P_{0)，若(P_{。)的最优解
$x^{}$是整数向量，则$x^{是$ILP问题(P_)的最优解，计算结束$；若(_{)$的最优解$x^{0$
的分量不全是整数,则设法对(P_{0)增加一个线性约束条件(称它为割平面条
件)，新增加的这个割平面条件将(P_{0)的可行区域D_0割掉一块，且这个非整数
解x{恰在被割掉的区域内，而原ILP问题(P)的任何一个可行解(格点)都没有
被割去.我们把增添了割平面条件的问题记为(P_{)，可将(P_{1)视为ILP问题(P)
的一个改进的松弛问题，用对偶单纯形法求解LP问题(P_{}).若(P_{1)的最优解$x^{
是整数向量,则x^{'$是原ILP问题(P)的最优解，计算结束;否则对问题(P_{1)再增
加一个割平面条件，形成问题(P_2)，……如此继续下去，通过求解不断改进的松
弛LP问题,直到得到最优整数解为止.图2.2.1说明了这个过程.
费用减少方向
0
0
。
。
0
0
**
0
$0^}$
(a)
(b)
(c)
图2.2.1
89

============================================================
第 108 页
============================================================

如果在增加约束的过程中,得到的LP没有可行解，则原ILP没有可行解；如
果得到的LP问题无界,可以证明原ILP问题或者无可行解或者问题无界,计算
均可停止.
下面我们描述 Gomory生成割平面条件的代数方法:给定一个ILP问题
(P)，用单纯形方法解它的松弛问题(P_{0)，得到最优基本可行解x^{}，设它对应的
基为B=（A_B₁，…，ABm）$，_B₁，…，_B为x^{°的基变量，基变量的下标集合为S，非基
m
变量的下标集合为S.最后一张单纯形表中问题(P_{0)的典式为
z+∑5,x=z0
j∈ \q$
$x_{B{}$
+∑a1x,=b{},
i= 1,  ,m
(2.2.1)
j∈\sqr5}$
为使符号简便计，令xB{=z，a0=_b{0=0.如果b（i=0，1，，m）全是整数，我们
已经得到了${LP问题(P)$的最优解$x{$.否则至少有 个${b{}不是整数(0≤$l≤m){
设b，所对应的约束方程是
_B1+∑a₁x=1$
(2.2.2)
∈ \qr}$
我们用[a]表示不超过实数a的最大整数.如[2.3]=2；[-3.5]=-4；[0]=0等，
则有
$a=[a]+f，
j∈s
(2.2.3)
b_1=[b1]+f}$
其中f_}是a{}的分数部分，有0≤$_<1,j∈S_{；f_{1}$是b{,$的分数部分，有0<$_{11.
由于方程(2.2.2)中的变量是非负的,因此有
∑[a]_₁≤∑a{
(2.2.4)
$∈s}$
∈ \sqr}$
从而方程(2.2.2)变为
$x{B_{1$
∑[a]x₁≤b1
+
(2.2.5)
j∈s$
因为在ILP中x限制为整数向量，故(2.2.5)式左端为整数，所以右端用b，的整
数部分去代替后，(2.2.5)式的不等式关系仍成立，即有
x{B$
+
∑[a₁]x₁≤[b₁]
(2.2.6)
j∈\s$
(2.2.2)减(2.2.6）得
06

============================================================
第 109 页
============================================================

∑（a-[a₁]）x₁≥b₁-[b，]
(2.2.7)
$j∈ \s}$
注意到(2.2.3)式,我们得到线性约束
∑$f_{{,}}$
(2.2.8)
j∈ \sq}$
并称它为对应于生成行l的 Gomory 割平面条件.
将割平面条件(2.2.8)加到前面已得到的最后一张单纯形表中,为得到对应
新的松弛问题(P_{1)的基本解，用(-1)乘(2.2.8)的两端后再引进一个松弛变量s，
从而(2.2.8)就变为
-Σf_{x+s=-f$
(2.2.9)
j∈\}$
(2.2.9)是一个超平面方程,称它为割平面.
下面的定理证明了将割平面（2.2.9）加到前面已得到的最优单纯形表后所
产生的影响.
定理2.2.1如果把割平面(2.2.9)加到松弛问题(P_{0)的最优单纯形表中，
那么没有割掉原ILP的任何整数可行点，当b_{不是整数时,新表中是一个原始
基本不可行解和对偶可行解.
证由于割平面(2.2.9)是由原ILP的整数约束推出来的,所以它不会割掉
整数可行解；松弛变量$s$是新的基变量，并且它与原来的基变量$x{_{_}，…}，x{B$起
构成了新松弛问题的基变量，当b_{不是整数时，$_{>0,因此新松弛问题的基本解
中有s=-f<0.因此它对应的是新松弛问题的原始基本不可行解.由于表中第0
行(检验数行)没有改变,所以它仍保持对偶可行性。
2.Gomory 割平面法计算步骤
现在我们可以给出解纯整数线性规划问题(P)的计算步骤.
Gomory 割平面法步骤
第1步用单纯形法解ILP问题(P)的松弛问题(P_{0).若(P_{0)没有最优解，
则计算停止，(P)也没有最优解.若(_{0)$有最优解$x^{}，假若$x{}$是整数向量，则$x^{$
是(P)的最优解，计算停止，输出x{；否则转第2步.
第2步求割平面方程
任选x{的-个非整数分量b_{(0$lm)，按关系式(2.2.2)和(2.2.3)得到割
平面方程
91

============================================================
第 110 页
============================================================

-∑f_₁x2+s=-_1
(2.2.10)
$j∈\sqra}$
第3步将割平面方程(2.2.10)加到第1步所得最优单纯形表中,用对偶
单纯形法求解这个新的松弛问题.若其最优解为整数解,则它是问题(P)的最优
解，计算停止，输出这个最优解；否则将这个最优解重新记为$x{，返回第2 步.若
对偶单纯形算法发现了对偶问题是无界的,此时原ILP是不可行的,计算停止.
例2.2.1求解ILP问题
max
$$x_}$
$s.t.$3x__2+2x_2≤6
(2.2.11)
-3x{2+2x₂2}≤0$
$x_{1}，_{2}≥0$，且为整数
解这个问题及其松弛LP问题的可行区域如图2.2.2所示.显然(2.2.11)
的整数最优解是$x^{}=(1,1)^{
$x_{2}$
$max _{}$
20
0
O
第二个割平面
第一个割平面
$x}$
2262
0
0
ω
1
2
$xra{{}$
图2.2.2
下面我们用Gomory 割平面法解这个题,以说明算法的全过程.
增加松弛变量$x_{3}和$x_{}得到了松弛LP问题的第-张单纯形表
$x_{}$
$x_{}$
$x_{q}$
$x_{}$
RHS
0
1
0
0
0
z
(2.2.12)
3
2
1
0
$x_{}$
6
$x_{}$
-3
2
0
1
0
经过两次旋转变换得最优单纯形表为：
92

============================================================
第 111 页
============================================================

$x_}$
$x_{2}$
$x_{q}$
$x_{}$
RHS
1
1
3
0
0
z
4
4
2
(2.2.13)
1
1
0
1
$x_{}$
1
6
6
1
1
3
$x_{}$
0
1
4
4
2
1
3
3
由于x^{不是整数向
,最优值为($极$小)$z*}=-
2
1
1
3
1
量,所以生成割平面.第0行和第2行均可生成割平面.由于
=0+
=1+
4
4
2
2
1
3
3
1
=-2+
,我们已将所需要的数分解为整数和分数部分.第2行
=-1+
4
4
2
2
生成的割平面条件为
1
1
1
$x_{3}$
≥
(2.2.14)
+
$x}$
4
4
2
由表(2.2.12)的约束,我们解得
$x_₃3}=6-3x,2-2x2$
x_4}=3x_-2x2$
将它们代人(2.2.14)得到等价的割平面条件
(2.2.15)
$x_{2} }≤ 1$
见图2.2.2上的第一个割平面.
由第0行也可以生成割平面条件为
3
3
1
$x_{3}$
+
4
4
2
其等价的割平面条件为
4
$x_{2}$
$\fr3 }$
由于x，要求为整数，因此上述条件等价于
$x_{_2}≤ 1$
第0行与第2行生成的割平面条件是一样的.
现在我们选取第2行生成的割平面条件(2.2.14),然后把方程
1
1
1
$x_{3}$
$x4$
+S_1}$
一=
(2.2.16)
4
4
2
加到表(2.2.13)中,得到下表
93

============================================================
第 112 页
============================================================

$x_{1$
$x_{22}$
$x_{}$
$x_{}$
$s {}$
RHS
1
1
3
z
0
0
0
4
4
2
1
1
1
0
0
1
$x}$
(2.2.17)
6
6
1
1
3
$x_{2$
0
1
0
4
4
2
1
1
1
$S {}$
0
0
1
4
4
2
利用对偶单纯形算法解上表中的松弛问题(_{1)，得到关于问题(_{1)$的最优单纯
形表为
$x_{}$
$x_{}$
$x_{3}$
$x_{}$
$S_{}$
RHS
z
0
0
0
0
-1
-1
1
2
2
$x_{1}$
1
0
0
(2.2.18)
3
3
3
$x_{}$
0
1
0
0
1
1
$x_{}$
0
0
1
1
-4
2
2
T
它的最优解$x^{} }$
,1
仍不是整数解.
3
由第一行生成的割平面条件为
2
2
2
-xA
+
$-s{_1$
(2.2.19)
3
3
3
由(2.2.17)$的约束中解出s_{1}，已知x3=6-3x₁}-2x_2}，x_4=3x₁}-2x2}，将它们代入(2.2.19)
得等价的割平面条件
$x_{1}}≥_{}$
见图2.2.2上的第二个割平面.
将方程
2
2
2
x4
S{1
+S_{}$
3
=一
3
3
加到(2.2.18)中,并用对偶单纯形算法求解,得到最后的最优表如下
94

============================================================
第 113 页
============================================================

$x_1}$
$x_{2}$
RHS
$x_{3}$
$x_{4}$
$S}$
$s2}$
0
0
0
0
-1
0
-1
2
1
1
0
0
1
1
$x_{_}$
0
2
0
0
1
0
1
$x_{2}$
0
1
3
0
0
1
0
-5
1
$x_{3}$
2
3
0
0
0
1
1
1
x4
2
其最优解x{=(1，1)^{为原ILP问题(2.2.11)的最优解.
由以上解题过程可见,表中含有分数元素且在算法过程中始终保持对偶可
行性，因此这个算法也称为分数对偶割平面算法.
按照一定的规则选取非整数b，所在的行作为割平面的生成行,再运用对偶
单纯形算法避免循环的规则,则可以保证分数对偶割平面算法在有限步内结束
运算(证明见[2]).
分数对偶割平面算法涉及两个主要问题:一个它是分数的;另一个它是对偶
的.这两个问题都给它带来一定的局限性.首先,该算法要进行乘除运算,1除以
3,再乘以3,在计算机上进行数值运算时得到的不是原数1,而是0.9999999;且
从一个阶段到另一个阶段的误差要累积.这使我们很难判定一个给定的元素是
否为整数,但是这一点对生成割平面却是必须的.为克服这一困难，人们提出了
全整数算法,这个算法保证了转轴元始终为整数1.其次,这是个对偶算法,因此
在达到最优性以前不可能得到原始可行解.由于分数对偶割平面算法一般需要
较多的运行时间，如果我们因故在中途停止计算,此时既得不到原始问题的整数
解，也得不到原始问题的可行解,计算毫无结果.为克服这一局限性，人们提出了
原始整数割平面算法,它是始终保持原始问题整数可行的割平面算法,如果用户
提前停机，可以得到ILP问题的次最优解.
2.3分枝定界法
分枝定界法可用于解纯整数线性规划和混合整数线性规划，它是目前求解
整数线性规划的成功方法之一.本节介绍该方法的基本思想和计算步骤.
95

============================================================
第 114 页
============================================================

1.分枝定界法的基本思想
有界ILP问题的可行集合中的格点数目是有限的.分枝定界法是以“巧妙”
地枚举ILP问题的可行解的思想为依据设计的.给定一个ILP问题,我们记为
(P)，去掉整数约束条件，求解(P)的松弛LP问题(P_{0).若(P_{0)无解，则ILP问
题(P)$无解$；若(_{0)$$的最优解$x{i$是满足整数要求的向量，则x^{是$ILP$的最优
解;若x{不满足整数的要求,则有两条不同的途径:一是不断改进松弛问题,以
期求得(P)的最优解,上节讲过的割平面法就属于这一类;另一条途径是利用分
解技术,将要求解的ILP问题(P)分解为几个子问题的和,如果对每个子问题的
可行域(简称为子域)能做到:或者找到了这个子域内的最优解，或者明确原问
题(P)的最优解肯定不在这个子域内,这样原问题就容易解决了.分解是逐步进
行的,这个过程称为分枝,分枝的具体做法如下.
考虑整数线性规划问题(P)
min
$z = c{x$
s.t.
Ax≤b$
(P)
$x≥0
x为整数向量
A为整数矩阵，b,c为整数向量.若(P)$的松弛_P问题(P_{0)$$的最优解为$x^{}，c^{x^{}是
(P)的最优值的一个下界.若x^{i的某个分量x{不满足整数要求，由于(P)的整数最
优解的第i个分量必定落在区域x{₁≤[x{]或x₁≥[x{}]+1中，([a]表示不超过数a
的最大整数),因此可将原问题(P)分解为两个子问题来求解.这两个子问题是：
{min z = c{x
s.t.Ax≤b
(P_{1}$
x≥0，x为整数向量
$x_{≤[x$
和
$min $z = c^{x
s.t.
Ax≤b
(P_{2})
x≥0，x为整数向量
x₁≥[x{1]+1$
这两个子问题将(P)的可行域分成两部分，且把不满足整数要求的(P_{)的
最优解$x^{}排斥在外$.对于整数线性规划(P_{1})和(P_{2})，仍然是求解它相应的松弛
LP问题.比如说问题(_{1})$的松弛问题的解x{1}是满足整数要求的，这个子域就查
96

============================================================
第 115 页
============================================================

清了，不需要再分枝;若问题(P_{2})$的松弛问题的最优解$x^{2}不满足整数要求,我们
又可根据它}某个不满$k整数要求的分量x{2}，}按x{k2}≤[x{2}]}或x{2}≥[x{2}]+1$问题
(P_{2)像分解问题(_)一样分解为问题(P_{3)和(P_{4)，如此继续下去.我们可以把这个
过程想象为一棵树,如图2.3.1所示,树根代表原问题,而每个点代表一个子问题.
用增加两个互斥且穷举的不等式约束将一
(P)
个问题分解为它的两个子问题作为该问题的两
$x1[x{]$
$x{1}[x{+1$
个后代.对第i个子问题,我们有一个松弛解x^{，
(P_{1$
(P_{2)
及相应于这个子域的ILP问题的目标函数下界
$xk≤[x{}$
$x_{a≥[x{+1$
$z_{}=c^{x.这样的树称为分枝树.
(P_{3}$
$o(P{4}$
如果原整数线性规划(P)的可行域是有界
$x{1[x{}}$
$x_1≥[x{1+1$
的,那么这个分枝过程不可能无限地继续下去.
(P_{5}o$
$o(P_{)
分枝过程在某个点上由下述两个原因之一而停
图2.3.1
止:(1)相应松弛LP问题的解是满足整数要求
的;(2)相应松弛LP问题是不可行的.这样的点称为树叶.
上面我们描述的是分枝定界法的分枝部分.如果我们仅用分枝过程,直到所
有的点都是树叶为止,那么目标函数最小的树叶一定是原ILP问题(P)的最优
解,但这样做计算量太大.下面我们描述定界部分.利用对ILP目标函数界的一个
估值,可以“巧妙”地删去不必要的一些点的分枝,使计算量大大减少.假设在某
一时刻，到当时为止所得到的最好的满足整数要求解的目标函数值是zm，而且我
们正打算由某-点$x{}分枝，该点子域对应的}LP$的下界为$z{k=c^{x^{}.若$z_{kn≥_{m}$
意味着点x{的所有后代得到的各个解x的目标函数值均有
$c^{x≥z}
因此无需由x继续分枝.在这种情况下，我们说x{已被剪枝，并把它称为死点
(也称为已查明的).其余的点称为活点,从活点那里分枝仍可能改进值z_m
2.分枝定界法的计算步骤
我们先看一个例题.
例2.3.1
minz=-(x_₁1+x_{2)
s.t.-4x,+2x2
≤-1
$4x_{1+2x_2}
≤11
-2x_{2≤-1
$x_{1}，}x_{2}≥0$，且为整数
97

============================================================
第 116 页
============================================================

解其可行域如图2.3.2(a)所示.易求得其松弛LP问题(P_{0)的最优解为
T
3
是非
,最优值为$z_{0}=c^{^{}=-4，$它}原I_}P最优值的-个下界$.$x{1
二
2
整数分量.
$x_{2}$
$min-(x_{1}+x_{2)
$x_{22}$
0
0
o
0
。
。
O
+0
0
。
0
O
七
t2
0
O
0
0
。
问题(P_{1}$
问题(P_{2})$
$x_{1}$
。
0
O
0
$x_{{{}$
0
(a)
(b)
$x_{22}$
$x_{2}$
0
。
0
。
0
。
$x_{2}2$
0问题(P{4)
9
0
o
0
0
0
0
0
x}
$x{1}≥3 $
O
o
。
0
问题(P_{)$
问题(P_{}
问题(P_{3)$
。
$xr{}$
0
0
Q
$x_{2 }$
(c)
(d)
图2.3.2
引进两个约束
$x_{1}≤1和$x_{1}≥2$
生成两个子问题
$(min$z= -(x_{1+x_2)$
-4x_$
+ 2x_{_}$
≤-1
s.t.
$4x__}$
+ 2x__}$
≥
11
(P_1$
-2x_{2}$
≤-1
$x__}$
≤1
$x_{1}x_{2}≥0$,且为整数}$
和
98

============================================================
第 117 页
============================================================

min
z=-(x{1+x_{2$
s.t.
-4x__1}$
+2x__}$
≤-1
4x$
+ 2x_}$
≥
11
(P_{2)$
$-2x__}$
≤-1
≥2
$x_{}$
$x_{1},_{2}≥0$,且为整数
问题(P_{})，(_{2})$的可行域如图2.3.2(b)所示.$I_P问题(P_{1)$的松弛$_P问题的最
3
T
5
，最优值$z_{1}=c{^{}=-
，(_{2})$的松弛$LP问题的最优解$x^{2}}
2
3
1
2，
,最优值$z_{}=c^{x^{2}=-7}两个问题均可继续分枝.-般我们选取$目标函数
7
2
2
较优的那个点先分枝.这里将问题(P_{2)用增加约束$x_{2}≤1$和$x_{2}≥2分解成两个问
题(P_{₃3})和(P_{4).(P_{3)和(P_{2)的可行域如图2.3.2(c)所示.解(P_{3})和(P_{4})$的$相应
松弛LP问题,其结果我们用图$$2.3.3的分枝树表示,问题(P_{4})无解，(P_{3)的松
弛LP问题的解为x^{3}=(2$.25，1)^，_{₃2}=c{x^{3}=-3$.25；将问题(_{32)分解为问题(P_{)
和(P_{)，(P_{)和(P_{₀)$的可行域如图2.3.2(d)所示.(P_{)无解，(P_{₂)的松弛LP
问题的解为x³=（2，1），_=cx^=-3.点（P_{₄2），（_₂），（P_{6)均为树叶.现在我们返
回来看左半分支,当前我们所得到的最好的整数解为x}=(2},1){，其目标函数值为
$Z_{}=-3.而问题(P_{1})的松弛LP问题的最优值z_{1}=-2.5>z_{₃}=-3.因此点(P_{₁1)被点
(P_{)剪枝，点(P_{1})为死点.由于没有其余的活点，因而点(_{3)$的解$x^}=(2，$)^{
一定是原ILP问题的最优解.
$x^{=(\2/=4$
$x{1≤1(P)
$x_{1}2$
$\frac{}{}$
5
$x^{1}(1,/)）
7
$z_{2}$
$z{1$
2
2
$x_{2}1$
$x{2}2$
z₃=-3.25x=(2.25，1）（P3)
$O(P_{4})
$x{12r$
$x{1}r= 3$
无解
z=-3x^=(2，1^o（P_5}
$o(P_{6)
无解
图2.3.3
解整数线性规划问题的分枝定界法步骤：
第1步令活点集合:=0}（注：“0”代表原问题，下面的正整数“k”代表
99

============================================================
第 118 页
============================================================

子问题(P_{k))$，上界U：=+∞$，当前最好的整数解：=$;
第2步若活点集合=，则转向第7步，否则，选择一个分枝点k∈活点集
合，从活点集合中去掉点k；
第3步解点k对应的松弛LP问题,若此问题无解，转回第2步；
第4步 若点$k对应的松弛LP问题的最优值$z_}≥U，则点$k被剪枝，转回第
2步；
第5步 若点k对应的松弛LP问题的最优解x^{}满足整数要求(此时一定
有$z_{<U)，则
当前最好整数解：=$x}
上界U：=z_k
转回第2步；
第6步若点$k对应的松弛LP问题的最优解x^{}不满足整数要求，按x^{的
某个非整数分量生成点k的两个后代点,令这两个后代点为活点,并加人到活点
集合中，转回第2步；
第7步若当前最好的整数解=，U=+∞，则原ILP问题无解，否则，当前
最好的整数解就是原ILP的最优解，U就是最优值.计算停止.
分枝定界法的思想不仅适用于解ILP问题,也适用于几乎任何组合最优化
问题.在生成分枝树时只需要两种运算:(1)分枝:一个解集合,用一个点表示它
可按某种规则被划分成一些互不相交的集合.划分后的每个子集用原来点的一
个后代点代表.划分的规则可视具体问题而异.一个活点的后代点不一定非是两
个不可,可以是有限多个.(2）定界：选择一种合理的算法可用于计算一个给定
子集中任何解的目标函数下界.如在解ILP的分枝定界法中,定界的算法是解该
点相应松弛LP问题的单纯形法.当然,对不同的问题,松弛问题的选择可以不
同,定界的算法也随松弛问题的改变而有所改变.
上述方法没有利用整数线性规划的其他性质,因此我们可以给任何可利用
(1)和(2)的最优化问题描述一个分枝定界法,而不管目标函数和约束是否是线性的.
类似于解ILP问题的分枝定界法,我们容易给出一般意义的分枝定界法的
基本步骤.用活点集合存储各个活点,而用变量U存储任何给定时刻得到当前最
好解的值(即原问题最优值的一个上界).需要说明的是,当我们从活点集合中取
点时，一般采用“先进后出”的原则,即采用深探法分枝,以便减少存储量.如果存
储不是一个决定因素,那么从下界最低的活点分枝似乎是一个合理的选择.除此
之外，还有另一方面的选择,即如何生成当前分枝点的后代，如在ILP问题中,当
前点$x^{中有多个非整数分量时,选择哪一个非整数分量以便增加约束生成它的
两个后代.关于这两方面的选择,目前没有理论告诉我们最好的策略是什么,计
100

============================================================
第 119 页
============================================================

算经验和直觉是设计目前已知的这类分枝定界法的仅有的指南.
有一种特殊的分枝定界法,它适用于解0-1规划问题,称为隐枚举法.详细
介绍可看文献[3],[4].
第2章习题
(A)
1.某厂生产A,B两种产品，每件产品均要在甲、乙、丙各台设备上加工.每件
第j种产品在第i台设备上加工消耗工时为a{，i=12，3；j=1，2.现在各台设备可用
于生产这两种产品的工时分别为b_{}，i=1，2，3.每件第j种产品可以提供利润c_{}j=
1,2.根据需要A，B产品的生产量不能少于k(>0)件，j=1，2.而生产的A,B产品数
量必须取整数.问如何安排生产能使该厂利润最大？试建立该问题的数学模型.
2.指派问题
设有n项任务要完成，恰有n个人都有能力去完成任何一项任务.第i个人
完成第j项任务需要的时间为$c_{，i=1，，n；j=1，…，n.试写出一个使总花费时
间最少的人员分配工作方案的数学模型。
3.给定ILP问题如下：
min z=x_₁-5x_{2
$s.t.$x_{₁2+2x__2}≤8
$x{1}-x_{2 ≥4$
$x_{1}，}x{2}≥0$，且为整数
（1)用图解法求出该ILP问题的所有可行解及最优解与最优值；
(2)用割平面算法求解.
4.考虑下述的ILP:
max
$z= c^{x$
s.t. Ax≤b
x≥0$，且为整数向量
其中A$，b$和c{中所有元素为正整数$设$x^{}是ILP_$的最优解，x^{1}是其松弛$LP问题
的最优解.证明[x^{]=（[x1}]}，…，[x1}])1是ILP的可行解，并且有
n
$c^{x^{°-c[x{²]≤
$c_}$
=
5.证明(2.2.9)式割平面方程中的松弛变量s可以表示成变量x的整数系数
的线性组合再加上一个整数常数,即有
101

============================================================
第 120 页
============================================================

π
其中k₁,j=0,1，，n均为整数.
6.用分枝定界法解下述ILP问题：
(1)max $z=3x{1}+2x2
(2)min
z=-11x₁-4x2
s.t.$2x{2}+3x{2≤14
s.t.
-x_₁2}+2x_2}≤4
$2x_{1}+x_{2}≤9$
$5x{2}+2x_{2}≤16
x_{1}，}_{2}≥0$，且为整数
$2x_{1}-x_{2} }4$
$x_{1}_2}0$，且整数
7.用分枝定界法求解下面的混合整数线性规划问题：
max
z=3x,+2x2
s.t.
2x_,2+3x{2}≤14
$2x_₁+x_{2≤9
x_{₁1}，_{2}≥0，x}为整数
（B)
1.选址问题
某大企业计划在几个地点建厂，可供选择的地点有A_{}，，A_，它们的生产能
力分别是$a_{₁}，，a_(为简便计算，假设生产同一种产品)，在A_{}地建厂费用为f_{},i=
1，…$，m.需要销售这种产品的地点有n个，设为$B_{₁}，…$，B_{n}，其销量分别为$b_{}，…$，$b_{$.
从设在A_{地的工厂运往销地B_,的单位运费为c_.试决定应在哪些地方建厂，使得
既满足各地的需求,又使总建设费用和总运输费用最省？写出该问题的数学模型.
2.某大学计算机实验室聘用了勤工俭学的4名大学生(代号为1,2,3,4)和
两名研究生(代号为5,6)值班.已知每人从周一至周五每天最多可安排的值班
时间及每人每小时值班的报酬如下表所示：
报酬
每天最多可安排的值班时间/小时
学生代号
/(元·小时^)
周一
周二
周三
周四
周五
1
10.0
6
0
6
0
7
2
10.0
0
6
0
6
0
3
9.9
4
8
3
0
5
4
9.8
5
5
6
0
4
5
10.8
3
0
4
8
0
6
11.3
0
6
0
6
3
102

============================================================
第 121 页
============================================================

该实验室每天开放14个小时，开放时间内须有且仅有一名学生值班.规定大学
生每周值班不少于8小时,研究生每周不少于7小时，每名学生每周值班不超
过3次,每次值班不少于2小时,每天安排值班的学生不超过3人，且其中必须
至少有一名研究生.试用本书提供的软件为该实验室安排一张人员值班表,使总
支付的报酬最少.
3.世界著名的日本数独(sudoku)游戏共有9×9个方格，再划分成9个3×3
的子网格.游戏要求把1~9的数字填入这些格子,使得每行、每列以及每个子网
格中的数字都不相同,有些格子中事先已经填入了数字.事先已经填入的数字的
多少及其位置很大程度上决定了这个游戏的难易程度.将这个问题表示为一个
整数线性规划.(提示；如果数字k填入格子(i,j)中(i=1，2，…，9,j=1，2，…,9)，
令x_₁,j,k=1.)
加拿大滑铁卢(Waterloo)大学研制的软件Maple中有专门解数独游戏的
软件.
民间有很多做数独游戏的高手,他们是用逻辑分析和聪明智慧(即某种启
发式算法)解决问题的.下面给出一个比较容易的具体问题,试一下，您是如何解
决的.
4
6
6
7
ω
6
1
9
8
7
5
ω
7
6
4
8
9
3
1
5
2
7
6
1
5
9
6
7
3
8
5
7
4
9
参考文献
[1] Garfinkel R S,Nemhauser G L.Integer Programming[M].New York :John Wiley &
Sons,1972.
[2] Papadimitriou C H,Steiglitz K.Combinatorial Optimization: Algorithms and Com-
103

============================================================
第 122 页
============================================================

plexity[M].New Jersey : Prentice-Hall,1982.
[3]许国志，马仲蕃.整数规划初步[M].沈阳：辽宁教育出版社,1985.
[4]卢向华，侯定丕，魏权龄.运筹学教程[M].北京:高等教育出版社,1991.
[5 Bonomi E,Lutton J L.The N-City Travelling Salesman Problem:Statistica Me-
chanics and the Metropolis Algorithm[J].SIAM Review,1984,26(4):51-5.
[6]赵玮，王荫清.随机运筹学[M].北京:高等教育出版社,1993.
[7]胡运权，等.运筹学基础及应用[M].6版.北京:高等教育出版社,2014.
[8]哈姆迪·A.塔哈(Hamdy A.Taha).运筹学导论(基础篇)[M].刘德刚，朱建
明，韩继业，译.9版.北京:中国人民大学出版社,2014.

============================================================
第 123 页
============================================================

第3章
非线性规划
非线性规划（NonlinearProgramming）研究的对象是非线性函数的数值最
优化问题它的理论和方法渗透到许多方面，特别是在军事经济管理生产
过程自动化工程设计和
等方面都有着重要的应用
处理非线性的
像线性规划中单纯形法那
样的通用算法，而是
点给出不同的解法，因而这些解法均有
各自的适用范围本章将简洁地介绍有关非线性规划的基本概念和理论、某些
重要算法以及相应的流行软件
3.1基本概念
本节给出非线性规划数学模型的一般形式,非线性规划问题的解及最优解
集的初步概念,以及解非线性规划问题基本的数值迭代法的一般性描述.
1.非线性规划问题
非线性规划问题大家早已在微分学的学习中接触过，这里仅举几个简单的
例子.
例3.1.1曲线的最优拟合问题
在实验数据处理或统计资料分析中,常常遇到这样的问题:如何利用有关变
量的实验数据资料去确定这些变量之间的函数关系.例如,已知某物体的温度φ
与时间t之间有如下形式的经验函数关系：
φ=c1+c_2t+e
c3t
(3.1.1)
其中$c_{},c_{2}，c_3$是待定参数$.现通过测试获得$n组$φ与t之间的实验数据($_{}_{)，
i=1$…，n.试确定参数$$c_{1}，c_{2}c_3}，使理论曲线(3.1.1)尽可能地与$$n个测试点
(t₁}，φ₁),i=1,.，n拟合，见图3.1.1.
当t= _i时，由(3.1.1)式确定的温度φ的理论值与实验数值$φ_{之间的平方
偏差为
105

============================================================
第 124 页
============================================================

[φ₁-（c_₁+_₂₁+e²1）}²
利用最小二乘法原理，应该选择$c_{1},c_{2，c_3}，求$以下函数的最小值：
n
min∑[φ₁-（c_1+_2₁2+e^341)）
(3.1.2)
三
这就是关于温度曲线(3.1.1)的最优拟合问题的数学模型.一般的曲线拟合
问题的数学模型可类似地导出.
例3.1.2构件容积问题
若要设计一个如图3.1.2所示的由圆锥面和圆柱面围成的构件,要求构件的
表面积为$S$，圆锥部分的高h和圆柱部分的高x{2之比为$a.确定构件尺寸，使其容
积最大.
φ
某大企业计划在几个地点建厂，可供选择的地点有A_{}，，A_，它们的生产能
1，…$，m.需要销售这种产品的地点有n个，设为$B_{₁}，…$，B_{n}，其销量分别为$b_{}，…$，$b_{$.
时间及每人每小时值班的报酬如下表所示：
$x_{q2}$
x_{1}
0
图3.1.1
图3.1.2
构件的尺寸取决于其中圆柱体的底半径x{}和高$x_{₂}.此时，圆锥体的高$h_=$a$x_{
构件的容积为顶部的圆锥体容积和下面的圆柱体容积之和，因此其容积为
每天最多可安排的值班时间/小时
a
$πx^{2x2}+πx2}
2
2
3
构件的表面积为圆锥体的侧面和圆柱体的侧面与底面之和，所以要使构件的表面
积为定值应满足条件：
$πx1√x{2}+a^2x{2}2π2}2}+x^2=
显然，还要满足x_{1≥0$,x_{}≥0的条件.因此该问题的数学模型为
xV=1+
a
$π{22}$
7.用分枝定界法求解下面的混合整数线性规划问题：
$\fra{} {3}$
(3.1.3)
S.t.π_1√x{2+a^{2x{2+2πx₁x2+πx{2=
$x {1≥0，x{2≥0
涉及多种应用学科的例题可以举出很多个,它们归结出来的数学模型具有
某种共性:或者类似于(3.1.2),是一个无条件极值问题；或者类似于(3.1.3),是
6.用分枝定界法解下述ILP问题：

============================================================
第 125 页
============================================================

一个条件极值问题.下面我们给出这种数学模型的一般形式.
令x=(x_{₁}，，xn){是n维欧氏空间^{中的-个点.f(x），g{(x)，i=1，，p
和h_，}x)$，j=1}，…，q$是定义在^{}上的实值函数.我们称如下形式的数学模型为
数学规划(Mathematical Programming，简记为MP):
min $f(x)
s.t. g₁(x)≤0，i=1, .,p
(MP)
h,(x)=0，j=1,…,q
\
g{(x)≤0,i= 1,.,p
x ={x∈ ^
h(x）=0，j=1,.,q
称X为(MP)的约束集或可行域.对任意的x∈X，称x为(MP)的可行解或可行
点.故(MP)可简记为
min$f(x)
(MP)
$x∈x
当目标函数f(x)，约束函数g(x)，i=1，…，p和h_(x),j=1，…，q皆为x的
线性函数时,数学规划(MP)就是我们在第一章已熟知的线性规划;若(MP)中
的目标函数和约束函数中至少有一个是x的非线性函数，称（MP）为非线性规
划.本章讨论的皆为非线性规划.特别地，当p=0，q=0，即(MP)的可行域X=R_"
时，将它简记为
min $f(x)
(UMP)
称它为无约束非线性规划或无约束最优化问题.若在（MP)中X≠R"，则对应的
(MP)称为约束非线性规划或约束最优化问题.例题3.1.1是无约束非线性规划
问题,而例题3.1.2是约束非线性规划问题.
下面给出非线性规划(MP)最优解和极小点的定义.
定义3.1.1对于非线性规划(MP)，若x*∈X，并且有
$f(x)≤f(x)，∀x∈X
则称x是(MP)的整体最优解或整体极小点，称f(x)是(MP)的整体最优值或
整体极小值.如果有
$f(x{)<f(x)，Vx∈X，x≠x
则称x是(MP)的严格整体最优解或严格整体极小点，称f(x*)是(MP)的严格
整体最优值或严格整体最小值.
定义3.1.2对于非线性规划（MP)，若x∈X，并且存在x的一个邻域
N_（x）=x∈Rx-x<δ}（δ>0是实数），使
$f(x)≤f(x)，∀x∈N(x)∩X
107

============================================================
第 126 页
============================================================

则称x是(MP)的局部最优解或局部极小点，称f(x)是(MP)的局部最优值或
局部极小值.如果有
$f(x*)<f(x)，∀x∈N(x）∩x，x≠x
则称x是(MP)的严格局部最优解或严格局部极小点，f(x)是(MP)的严格局
部最优值或严格局部极小值.
求解一个非线性规划问题就是希望求得它的整体最优解和整体最优值.但
在很多情况下,我们这个愿望往往难以实现,而只能得到它的局部最优解和局部
最优值，甚至是只能得到它的满足某些条件的解.由于大型计算机的普遍使用，
使我们有可能求得多个满足某些条件的解,或多个局部最优解后,从中选择一个
“好”的解,作为(MP)问题整体最优解(值)的一种较好的近似.因此在非线性规
划的计算中,使运算结束的最优解,以及最优解集的概念是广义的,依具体类型
的问题和采用的具体算法而定.关于这一点,看了下面几节内容后会有较深的
理解.
现在我们通过一个简单的例题说明非线性规划问题及其最优解的几
何直观.
例3.1.3用图解法求解下面的非线性规划问题：
$s.t.$1-$x_{_1-x_{2}≤$
(3.1.4)
x_{1-1≤0
$x__2 1≤$
解该问题的可行区域X是二维平面中的一个集合，由图3.1.3的阴影部
分表出.f:X→R^{}是三维空间中的一个曲面，为
$x{}}
使目标函数$f(x_{1}{x_₂2)与可行域X的关系更清
楚起见，我们在二维平面0x_{x₂上画出
1
$f(x_{1}x_{2}）=x^2}+x{2的等值线族.显然等值线族
$x{2}+x^{2}=c(c为常量) 一些同心圆，如图3.1.3$
的虚线所示.容易明白，与可行区域有交点的、
$x{{2}$
值最小的等值线所表示的目标函数值就是该
问题的整体最优值,而这个交点就是整体最
优解.如图3.1.3所示,该问题的整体最优解是
T
1
,整体最优值$$f(x^{ )=\$$
图3.1.3
2
108

============================================================
第 127 页
============================================================

数$f:X→^{$是n+1维空间中的-个曲面，我们可以在n维空间中画出$f(x)=c
的等值面，进而研究可行区域X与等值面族$f($x)= c之间的关系，以求得(MP)
的最优解和最优值.
我们已经知道一个线性规划问题的最优解（若存在的话)总可以在可行域多
面凸集的一个顶点处达到,而多面凸集顶点的个数是有限的,这就是单纯形法的基
本出发点.从例3.1.3看到,对于非线性规划问题,即使约束函数都是线性的,其最
优解也不一定能在顶点处达到，它可能在可行域边界上达到，也可能在可行域内
3
2
部达到$(如在例3.$1.3中$将目标函数改为$f($x_{1，x_{2})=
3
2
$x_{1}$
+
$x_{2}$
,其他条件
3
T
不变，其最优解为$x^{}=
,是可行区域的内点，这就给我们求解非线性
4
4
规划问题带来困难.
2.非线性规划方法概述
给定一个(MP)问题用什么方法求解呢？在微分学中给出了求无条件极值
的必要条件和一些充分条件,也给出求条件极值的经典Lagrange(拉格朗日)乘
子法.在某些情况下,这些方法是行之有效的，但它们有很大的局限性:首先，它
们要求函数是连续的、可微的，而实际问题中出现的函数很可能不具备这些条
件，甚至可能没有解析表达式；其次，对无约束优化问题,根据必要条件，我们先
要求目标函数$f(x_{1}，…，x_{n)$的驻点，即要求解使
fe fe
∂f
T
∇f(x)
=0
$∂x_{1{∂x{}$
$ax_{}$
的点，其中∇f(x)是函数f(x)的梯度向量，这是n个变量的、一般是非线性的，
由n个方程组成的方程组，除非在简单情况下，一般无有效算法求解这样一个方
程组;第三,微分学中讨论的条件极值问题所出现的约束均为等式约束，而实际
应用中存在着大量带不等式约束的极值问题.把不等式约束引人最优化问题,标
志着最优化“经典”时代的结束和数学规划“现代”理论的开始.不等式约束的出
现使最优性条件的分析和处理复杂化,但能表达极为丰富的一类问题.另外,解
条件极值的经典 Lagrange乘子法也存在解一个高维方程组的问题.因此我们要
对(MP)问题给出一种实用的解法,即数值方法.一种数值方法,本质上都是一种
特定的迭代法.下面我们介绍迭代法的基本思想和基本格式.
首先，按某种方法给出目标函数$f(x)极小点x"的一个初始估计$x^{∈R^{"}，称
$x^{}为初始点.然后按照某种特定的迭代规则产生-个点列{x^{}，使得{x^{}是有
穷点列时,其最后一个点是(MP)的某种意义下的最优解，当{x{}是无穷点列
109

============================================================
第 128 页
============================================================

时,它有极限点,其极限点是(MP)的某种意义下的最优解(此时称该方法是收敛
的).一般地，若已知x^{}，我们分析如何产生下-个迭代点x{1}_设^{}，^1∈R^{}，令
$k+1-x{_}
x
则Δ_x{是一个以x^{}为起点，x+}为终点的n维向量，故
$k+ 1=x^{2+_x
$x}$
若$p^{∈}R^{}$}向量$_x^{}$方向的单位向量，则存在数量$t_{>0$，使
$Δx^{2}l$
k
因此我们有
x+=x^+l$
k
(3.1.5)
(3.1.5)是求解(MP)问题迭代法的最基本的迭代格式.称p为第k轮搜索方向，
tk称为第k轮沿p方向的步长.由(3.1.5)式知，使用迭代法求解(MP)的关键在
于，如何构造每一轮的搜索方向和确定步长.
根据不同的原理产生了不同的{p{和$，就形成了各种不同的解(MP)的算
法.而其中{p^{的产生又是形成算法的关键.经常使用的决定p{性质的有下面两
个定义.
定义3.1.3设f:R^{→R^{，x∈R^,p∈R^{,p≠0，若存在δ>0,使
$f(x+tp)<f(x)，∀i∈(0,δ)
则称向量p是函数f(x)在点x处的下降方向.
若f(x)在点x处可导，则-∇$f(x)就是f(x)在点x处下降最快的方向.
定义3.1.4设XC^"，x∈X,p∈R^{，p≠0，若存在t>0$，使得
$x+tp∈X
则称向量p是点x处关于X的可行方向.
由这个定义知,在一点处关于可行区域X的可行方向是使这个方向上存在
可行点的方向，如图3.1.4所示.
$xovx$
不可行方向
$\ovx $
可行方向
可行方向
X
X
图3.1.4
若一个向量p既是目标函数f在点x处的下降方向，又是该点处关于可行
区域X的可行方向，则叫做函数f在点x处关于区域X的可行下降方向.
现在给出用基本迭代格式(3.1.5)求解(MP)的一般步骤：
110

============================================================
第 129 页
============================================================

第1步
选取初始点$x^{}，k{:=0$;
第2步
构造搜索方向p{；
第3步
根据p{}，确定步长$；
第4步$x^+1}=x{3}+t₁1^{}
若x{+1}已满足某种终止条件，停止迭代，输出近似最优解x{1.否则令$k{=k+1，转
回第2步.
上述过程不是一个算法，而是一个算法模型.对该内容赋予具体程序,就可
得到一个具体算法.对无约束优化问题一般要求搜索方向p是下降方向,对约
束优化问题一般要求p是可行下降方向.
在非线性规划中,对同一类(MP)问题已发展了多种算法.评价和比较这些
算法，一般我们有两方面的准则:从理论上能够证明一个算法是收敛的且具有好
的收敛速度;从实际计算的数值经验上看,可靠性强且效率高.所谓算法的可靠
性是指一个算法以合理精度求解一类问题中大多数问题的能力.目前，有一些专
门设计的为鉴别算法用的各具特点的题目作为试验题,从实际求解这些为世界
公认的试验题的成功情况,可以得到算法可靠性的经验估计.所谓算法的效率，
可以用解题的平均工作量来度量.工作量的计量有多种指标，如迭代次数、函数
和梯度求值次数、CPU(中央处理器)时间等，一般使用多个指标综合加以评价.
当然，也可按照算法复杂性理论(在第1章1.8中有简介)估计在最坏情况下
算法所需要的基本运算次数的上界,来比较评价一些算法.
3.2 凸函数和凸规划
求解(MP)问题的算法虽多，但一般求出的仅是(MP)的局部最优解，而我
们的目的是求问题的整体最优解,这就产生了矛盾.为解决这个矛盾，一般从两
个方面着手:(1)寻求整体极值的计算方法;(2)从理论上确定在哪些情况下,求
出的局部极值一定是问题的整体极值.对前者,到目前为止工作很有限,而对后
者,已经证明了对(MP)问题的一种特殊类型——凸规划问题来说,局部最优解
一定是整体最优解(对求极小问题而言).
本节我们在1.2已定义了凸集的基础上，先介绍凸函数的概念及其性质，
然后给出凸规划的定义及其性质.
1.凸函数及其性质
定义3.2.1
设SCR"$是非空凸集，f:S→^{，如果对任意的$α∈(0$，1)$有
111

============================================================
第 130 页
============================================================

f（ax'+（1-α）x）≤af（x）+（1-α)f（x2），∀x，x²∈S
则称f是S上的凸函数，或$f在S上是凸的.如果对于任意的α∈(0，1)有
f(ax{+(1-α)x{2)<af(x1)+(1-α)f(x{2)）
$x^{2,x^{2}  S{}x^{1≠x^{}$
则称f是S上的严格凸函数，或f在S上是严格凸的.若-f是S上的(严格)凸函
数,则称f是S上的(严格)凹函数，或f在$S上是(严格)凹的.
当n=1时，凸函数和凹函数的图像如图3.2.1所示.对凸(凹)函数来说任意
两点间的曲线段总在弦线的下(上)方.
$f(x)}$
$f^(x)$
$f(ax^{1}+(1-a)x^{2)
$af(x{1)+(1-a)f(x2))
$af(x{¹)+(1-a)$f(x{})
$f(ax{2}+(1-a)x{2)
0
$1}$
a$x^{}}(1-a)$^{}$
$x ^{2}$
x
0
x^{ax1}+(1-a)x^{2x^{2
(a)凸函数
(b) 凹函数
图3.2.1
例3.2.1线性函数f(x)=α^{x+β，其中α，x∈R^{，β∈^{1}，在R^{"上既是凸函
数也是凹函数.
对于x∈^{n，函数fx)=‖x∥（x∥表示向量x$的模)是^"上的凸函数.事
实上，^{}，^{2∈R_^，a∈(0}，1)$$有
$f（ax'+（1-a）x2）=∥ax+（1-α）x²2|≤∥ax'|+∥（1-α）x
=α|x²+（1-α）x²2‖|=af（x）+（1-α)）f（x)
根据凸函数的定义,易证凸函数有如下的基本运算性质.
定理3.2.1设SCR"是非空凸集.
(1)若f{:_^{}→^{1$是S上的凸函数，α≥0，则$af$是$S上的凸函数$；
(2)$若$f_{}$_₂2:R_{}→R^{1都是$S}的凸函数，则f_{}+f_{2}$是$S}$的凸函数.
注意,两个凸函数的乘积不一定是凸函数.
下面的定理建立了凸集与凸函数的关系.
定理3.2.2设SC^{是非空凸集，{S→^{1}$是凸函数，c∈R^{1，则集合
Hs(f,c)=x∈S|f(x)≤c}
是凸集.
112

============================================================
第 131 页
============================================================

证任取x，x2∈H_3}$f,c)$，则有x'∈S，x^²2∈_S以及
f(x^{1)≤c，f(x{2)≤c
任取α∈(0，1)，因为S是凸集，故有
$ax+(1-α)x^{2∈S
由于f是S上的凸函数，由定义3.2.1知
f(ax{+（1-α)x^2)≤af(x)）+(1-α)f(x2)≤ac+（1-α）c=c
由集合$H_s(f,c)$的定义知
ax{+(1-α)x^²∈H(f,c)
根据凸集的定义,定理得证。
一般地说,上述定理的逆定理并不成立.我们称集合H_{(f{c)为函数f在集
合S上关于数c的水平集.
现在我们研究如何判断一个函数是凸函数.当然,可以按定义直接判别,但
对于可微函数可按下述法则判别.
定理3.2.3设SCR^{是非空开凸集，f:S_→R^{}可微，则
(1)f是S上的凸函数的充要条件是
∇f（x1)（x^{²2-x1}）≤f（x^{2）-f（x1），x}，x{²2∈$
]
(3.2.1)
$af(x^{1}）af(x{})
其中∇$f(x^{}=$
是函数f在点x{处的一阶导数或梯度.
$ax_1}$
$ax_{}$
(2）f是S上的严格凸函数的充要条件是
∇f（x1)（x²-x1）<f（x²2）-f（x1），x，x²2∈S，x'≠x²（32.2)
证（1)必要性.设f是S上的凸函数，根据凸函数的定义，对任意的
α∈(0,1)有
f(ax{2+（1-a)x^1)≤af（x2）)+（1-α)f(x1），x¹，x^{2∈S
f(x+a（x²-x¹）)）-f(x1)
故
≤f(x^{2})-f(x{)
(3.2.3)
α
由多元函数的 Taylor(泰勒)展式可知
$f(x^{1+a（x^²2-x1））-f(x)
=αf（x)）（x^²-x1）+（a（x²-x1）∥)
将其代人(3.2.3)式有
$o0(α（x{²}-x1）∥)
∇f（x1）（x^{²-x）+
≤f(x^{2})-f(x1))$
α
令α→0+，便得到
∇f（x{1）（x²2-x¹}）≤f（x²2）-f（x1)
充分性.设
113

============================================================
第 132 页
============================================================

∇f（x{1})（x²2-x1）≤fx^{2）-f（x^{1），x2}，x^²2∈$
对任意的α∈(0，1)，取x=ax^{1+(1-α)$x^{2，则因S是凸的，故x∈S.由(3.2.1)可
知，对x^{1}，x∈S和$x^{2}，x∈S_$，分别有
f（x）+∇f（x)（x-x）≤f(x），x∈S
(3.2.4)
和
f(x）+∇f（x)）（x²2-x)≤f(x^2），x{²∈S
(3.2.5)
将(3.2.4)式乘以α，(3.2.5)式乘以(1-α)，两式相加得到
$f(ax'+(1-α)x{2）=f(x）=f(x)+∇f(x)(ax+(1-a）x{2-x)
≤af(x{1）+（1-α)f(x²），∀x，x²2∈S
因为上式对于任意的α∈(0，1)成立，由定义3.2.1知，是凸函数.
(2)证明与(1)类似。
1
f
当n=1时，定理3.2.3的几何意义是
明显的:一个可微函数是凸函数的充要条
件是,函数图形上任一点处的切线不在曲
$∇f(x{1)^{(x^{2}-x})$
线的上方，如图3.2.2.
对于二阶连续可导函数，有下面的判
别定理.
0
$1x
$x^{2}$
定理3.2.4设SCR是非空开凸
x
集，f_:S_→R^{1二阶连续可导，则f是S上的
图3.2.2
凸函数的充要条件是，f的Hessian（黑赛）
矩阵∇^{2}f(x)在$S上是半正定的.
当∇^{}f(x)在$S上是正定矩阵时，f是S上的严格凸函数.(注意，该命题的逆
命题不成立.)
一个函数$f:R^{→R^1在一点x∈R^{"处的$Hessian矩阵的定义是
$(a^{2}x)
$a^{2}fx)$
$a^{2}fx)
$ax^{{}{}$
$∂x_{∂x{}$
$∂x_{1}∂_{}$
$a^{}fx)
$a^{2}x)
$a^{}fx)
$ax{ra{{2}$
∇^{}fx=
$∂x_{2}x}$
$ax_{2__}$
:
…
$a^{}fx)
$a^{2}x)$
$a^{}fx)$
$1{e^{ex$
$ax_{x{}$
$x{{}$
在数学分析中已知,当f在点x处的所有二阶偏导数连续时有
114

============================================================
第 133 页
============================================================

$a^{2f(x)_a^²f($
i,j=1, .,n
$∂x{a_{
ax{∂x{}$
此时∇^{}f(x)$是$个$n阶对称矩阵$.∇^{2}f(x)在$S上半正定(正定)$的含义对任意
取定的x∈S{$，∇^{2}f(x)$是-个半正定(正定)矩阵.
(证明略.)
1
2
b∈$R^{2}，c∈R^{}.验证$f(x)$是^{"上的凸函数$.称它为$次凸函数.
证设A=（a{）nxn，b=（b₁，…，b{n），此时
1
"
n
n
$a{{x₁}+b,x{1}+c
2
j
$5
将它对各变量x，求偏导数，有
∂f
n
∑
a_{₁x₁+b₁，i=1,.,n
$ax{i}$
三
它的各二阶偏导数为
$a^{}f }$
=a{j
i,j=1,., n
$ax{_}$
因而函数f(x)的梯度向量为
∇f(x）=$
$∂x_$
=（\a，ax)）+（b1，，b
1
1
T
或记为
∇f(x)=Ax +b
f(x)的Hessian 矩阵为
$a1$
$a_{}$
$a\n}$
$a_{2$
$a{22$
$a_{2}$
$∇^{}f=
=A
:
:
$a_{}$
$a_{n2}$
$a_{n$
由于A是一正定矩阵,因此$f(x)在R"上是严格凸函数.
2.凸规划及其性质
给定一个非线性规划问题

============================================================
第 134 页
============================================================

min $f(x)
(MP)
s.t. g₁(x)≤0，i=1,…，p
h(x)=0，j=1,…,q
记(MP)的约束集为
g{(x)≤0,i=1,.，,p1
X ={x ∈ R{}$
h(x）=0，j=1,.,q]
如果(MP)的约束集X是凸集，目标函数f是X上的凸函数，则(MP)叫做非
线性凸规划，或简称为凸规划.
下面的定理给出用目标函数和约束函数来描述凸规划的条件.
定理3.2.5对于非线性规划(MP)，若$g_{₁}(x)(i=1，…，p)皆为^{上的凸函
数，h_,(x)(j=1，，q)皆为线性函数，并且$f是X上的凸函数，则(MP)是凸规划.
证记
$S₁1=|x∈R|g(x)≤0,i=1，.,p|
$S2=x∈R|h₁(x)）=0，j=1，.，q}
则有$X=S_{₁}∩n$S_{2.因为各$g{(x)是凸函数，由定理3.2.2知，各水平集
H（g₁，0)=|x∈R|g(x)≤0}，i=1,.,p
是凸集，故又由定理1.2.2知
r
S₁=∩H(g₁,0)
i=1
是凸集.容易验证，S_{₂也是凸集，因而X=_{₁}∩$S_{₂$是凸集.又因为$f是X上的凸函
数，所以（MP）是凸规划。
凸规划的最优解具有以下的重要性质
定理3.2.6凸规划的任一局部最优解都是它的整体最优解.
证设x是凸规划（MP)的一个局部最优解，由定义3.1.2知，存在x*的邻
域N_(x），使
$f(x{)≤f(x)，∀x∈X∩N_(x{)
(3.2.6)
若x不是(MP)的整体最优解，由定义3.1.1知，存在x∈X，使
f(x)<f(x)
又因为f是凸函数，因此有
f(ax+（1-α)x）≤af(x)+(1-α)f(x)
(3.2.7)
<af（x）+(1-α)f(x*）=f(x)
显然，当α>0充分小时，有
αx+(1-α)x∈X∩N(x)
116

============================================================
第 135 页
============================================================

此时(3.2.6)式与(3.2.7)式相矛盾.
1
由此可见,对于凸规划问题,一旦求得了它的一个局部最优解,实际上就得
到了它的整体最优解.
例3.2.3验证下列(MP)是凸规划.
minf（x₁}，x2，x₃3）=2x2+x2+2x32+x₁x3-x₁x₂2+x₁1+2x2
s.t.g_1}x）=x^2+x2-x3≤$
$g2}(x)=x1+x2+2x3≤16
g3（x)）=-x₁-x2+x₃3≤0
解将二次目标函数改写为
$（_}$
$（_}$
4
-1
1)
1
$f（x₁1}，x_{2}，x3}）$
（x_{1}，x{2，})）
-1
2
0
$x_{2$
+(1,2,0)
$x_{2}$
2
1
0
4
$x_{3})
$x_{3}$
由例3.2.2知，f的Hessian 矩阵为
4
1
1
∇{f(x)=-1$
2
0
1
0
4
{2}fx)的一、二、三阶顺序主子式分别为
4
-1
1
4
-1
4 > 0,
=7>0,
-1
2
0
=26 > 0
-1
2
1
0
4
因而^{}f(x)为一正定矩阵，f是严格凸函数.
12
0
0
$而∇{2}g1}x)=$
0
2
0
.显然它是一个半正定矩阵，因而g_{(x)是凸函数，
0
0
0
其他的不等式约束均为线性的.由定理3.2.5知,该非线性规划是一个凸规划.
3.3 一维搜索方法
一维搜索问题又称为线性搜索问题，它是指目标函数为单变量的非线性规
划问题,其数学模型为
min φ(t)
(3.3.1)
1≥0
(0≤1≤1max)
其中t∈R_^{.对t的取值为t≥0的(3.3.1)问题称为一维搜索问题.当t取值为
0≤1≤t_mx时的(3.3.1)问题称为有效-维搜索问题.
117

============================================================
第 136 页
============================================================

按照求解问题(3.3.1)的不同原则，算法分为两大类:精确一维搜索或最优
一维搜索,及非精确一维搜索或可接受一维搜索.
本节介绍两种精确一维搜索方法:不用导数的0.618法和使用导数的
Newton(牛顿)法.对于非精确一维搜索方法可参见参考书[1].
1.0.618法(近似黄金分割法)
本方法是寻求单谷函数极小点的一种方法.因此先给出单谷函数的定义.
如果存在一个t∈[a，b]，使得φ(t)在[a,t]上严格递减，且在[t，b]上严格
递增，函数φ(t)称为在[a，b]上是单谷的，区间[a，b]称为φ(t)的单谷区间.
由单谷函数的定义知，t是φ(t)在[a，b]上的唯一的极小点.单谷函数可以
是不可微的,甚至是不连续的.
求(3.3.1)问题的大多数方法，都要先设法给出一个区间[a，b]c[0,+∞]
([a，b][0,_])，使得t∈[a，b]，称[a，b]为问题(3.3.1)的搜索区间.然后
我们通过迭代不断缩小该区间的长度，当区间长度充分小时,可取这个小区间中
的一点作为φ(t)的一个近似极小点;当φ(t)可微时，也可根据这个小区间上导
数的绝对值充分小终止迭代.因此,对单谷函数φ(t)来说,它的一个单谷区间就
是一个搜索区间.一般地求搜索区间可以凭经验或用加步探索法，见[1].
现在我们给定问题
min φ(t)
(3.3.2)
a≤1≤b
其中[a,b]是φ(t)的单谷区间.我们的目的是通过不断缩小区间[a，b]求φ(t)
的唯一极小点t的一个近似解.
在[a，b]上任意取两点$_₁}，t_{2.设_₁1<i_{2}，由于$φ(_)是单谷函数，由其定义可知
若φ（t₁1）≤φ（t₂），则t∈[a，2];
若φ（c₁)≥φ（₂)，则t∈[_₁，b].
因此，通过比较$φ(t_₁1})与$φ(t_{2)的大小，可将搜索区间[a，b]缩小为[a，t_{2]或
[_₁}，b]，继续计算函数φ(l)在一些点(这些点称为探索点)上的值,可以使搜索
区间的长度达到任意小.方法的有效性依赖于如何选取探索点.因为在缩小区间
后总有一个已计算过的探索点落在该区间内,它可以作为下一次迭代的探索点
之一.因此,除了第一次迭代要计算两个探索点的函数值外,以后各次迭代都只
需计算一个函数值,故n-1次迭代共计算n个探索点的函数值.
现在我们分析如何选取探索点.首先,我们事先并不知道缩小后的搜索区间
是[a，_₂]还是[t_₁}，b].因此使二者长度相等,即有
$t_2-a=b- 1
令
118

============================================================
第 137 页
============================================================

$t_{2}-a b-l1$
(3.3.3)
ω
二
b-ab -a
它表示搜索区间缩小的比,则有
$_₁=a+(1-ω)(b-a)
(3.3.4)
$l2=a+ω(b-a)
我们希望在下一次迭代中,区间仍缩小相同的比例ω,是否可能呢？不妨设新的
搜索区间为[a，2}]}，并且其中已有一点$_{1已计算过函数值.在新一轮迭代中,我
们取两个探索点$l_{<t{2}，要求其中的一点即是$t_{₁}，并且满足
$t^{2-al2-_t
=ω
$t_2-al2-a
由(3.3.3)式，得
$l{2-a=ω{2(b-a)，l2-l{1=ω²}(b-a)
若令t{=t₁}，则由_{2-t₁1=ω(b-a)以及（3.3.4)式推出
ω^{22 -1
或写为
$ω{2- 2ω+1=0
这个二次方程的根是ω=1，显然这是不可能的，按(3.3.3)式知，应有0<ω<1.现
令l{=₁，则由₁-a=^2（b-a)及(3.3.4)式得到
(3.3.5)
因ω>0，故二次方程(3.3.5)的根为
$\sqr 1
ω =
≈ 0.618
2
对搜索区间为[$_₁}，b]}的情况，可以同样讨论，这时应取$t_{1}=$_{2}，而取$_{2}为新的探索点
$\sqrt{} 1$
称=
为黄金分割数,通常采用0.618作为ω的近似值,因此我们将这
2
种方法称为0.618法或近似黄金分割法.
解问题(3.3.2)的0.618法步骤：
第1步确定单谷区间[a，b]，给定最后区间精度ε>0$；
第2步计算最初两个探索点
$t1=a+0.382(b-a）=b-0.618(b-a)
(3.3.6)
$t2 =a +0.618(b-a)
并计算φ_₁=φ（l₁1），φ2=φ（t₂)）；
第3步若$φ_{₁1≤$φ_2}，转第4步.否则转第5步$；
119

============================================================
第 138 页
============================================================

第4步若$t₂2-a≤ε，停止迭代，输出t₁}否则令$b：=₂，₂=₁1，_1=
b-0.618（b-a)，φ2:=φ1}，计算φ₁=φ(c₁1)，转第3步；
第5步若b-1₁≤eε，停止迭代，输出$t{2.否则$a:=₁，₁=₂，2:=a+0.618(b-a）,
$φ_{1：=φ_{2}，计算φ_{2=φ（t2)，转第3步$
例3.3.1用0.618法求解
minφ(t)=t{³-2t+1
1≥0
φ(t)的单谷区间为[0，3]，ε=0.5.
解第1轮迭代.按(3.3.6)式有
₁=0+0.382(3-0)=1.146
$t2=0 +0.618(3-0)=1.854
求得φ₁=φ(1）=0.2131，φ2=φ（t₂）=3.6648.因为φ₁1≤φ2，2-a=1.854-0≠0.5.
令b：=t=1.854,2:=₁=1.146,₁:=1.854-0.618（1.854-0)=0.708,φ2:=φ₁=
0.2131,计算φ_1=φ(0.708)=-0.0611.
第2轮迭代.因为φ_₁1≤φ2，2-a=1.1460.5，令b：=t2=1.146，2：=t1=0.708，
t1：=1.146-0.618(1.146-0)=0.438,φ2:=φ₁=-0.0611,计算φ1=φ(0.438)=
0.208 0.
第3轮迭代.因为φ_₁1>φ2，b-t₁=0.7080.5，令a:=t₁=0.438,l₁:=l2=0.708$，
t2：=0.438+0.618(1.146-0.438）=0.876，φ1=φ2=-0.0611，计算φ2=φ(0.876)=
-0.079 8.
第4轮迭代.因为φ_{1>φ_{2}，由于b-t_{=1.146-0.708=0.438<0.5，停止迭代，输
出近似最优解$t{2}=}0.}876$.
用求导的方法可知该问题的精确最优解为$t{}=
2-3
≈0.816 5.
以上迭代过程也可以简便地用下表给出.
0
一
2
3
4
a
0
0
0
0.438
0.708
b
3
1.854
1.146
1.146
1.146
$t_$
1.146
0.708
0.438
0.708
$t_{2}$
1.854
1.146
0.708
0.876
φ_{1$
0.213 1
-0.0611
0.208 0
-0.0611
V
V
V
V
$φ_{2}$
3.664 8
0.213 1
-0.0611
-0.079 8
换a
J
换b
√
1
L
120

============================================================
第 139 页
============================================================

第4轮迭代开始有b-a=1.146-0.708<0.5，此时区间长度已小于给定的ε.
在0.618法中每次迭代搜索区间按常比例ω缩小,所以要使给定的单谷区
间减少到所要求的精度ε，需要的迭代次数是可以预估的.另外，若每次迭代按不
同比例缩小搜索区间,但仍要求每次迭代只计算一个函数值,且希望在探索点个
数相同的情况下(即同样的迭代次数下),使最终的搜索区间的长度最小.按此要
求设计的方法就是Fibonacci(斐波那契)法(参见[1]).从理论上说，Fibonacci 法
比0.618法好,但由于0.618法实现比较简单,所以在实践中更为有用.
0.618法和Fibonacci法全部依靠函数单谷性的假设.在许多问题中，这一假
设不成立或者难以验证.解决这一困难的方法,尤其当初始搜索区间很大的时
候,是将它分成较小的几个子区间,在每个子区间上寻求极小,然后在所有子区
间的极小中选取最小的一个.
无论是0.618法还是Fibonacci法,对于所计算的各个探索点上的函数值，仅
仅用来比较其大小,而具体数值，这些非常有用的信息却没有被利用，因此所得
到的算法收敛都较慢.为了充分利用信息量,我们有插值法或称为多项式逼近法
(参见[4]).方法的基本思想是利用几个探索点的函数值或者还有一阶导数的
值,产生一个二次或三次多项式用来逼近φ(t)，然后用这个多项式的极小点作
为新的探索点,用来逼近φ(l)的极小点.这类方法的有关公式我们安排在习题
中.当目标函数φ(t)有较好的解析性质(连续性、可微性)时，插值法比0.618法
和Fibonacci 法效果好.但因插值法不保证方法具有收敛性,对“性能差”的目标
函数采用0.618法将是适宜的.
2.Newton 法
考虑如下的一维搜索问题
min φ(t)
(3.3.7)
其中φ(t)是二次可微的，且φ"(t)≠0$.
Newton(牛顿)法的基本思想是:用φ(l)在探索点tk处的二阶Taylor展开式
g(t)来近似代替φ(i)，即有φ(t)≈g(t)，其中
$φ_{"(t{k)$
g(t)=φ（tk）+φ'（t）（c-tk）+
(t -tk)^{}$
2
然后用g(t)的最小点作为新的探索点$lk+1.据此，令
g'（t）=φ'（）+φ（）（-t）=0
$φ^{(t)）
求得
$t{k}+1}kk$
(3.3.8)
$φ_"(tk)$
开始时给定一个初始点$t_{1}，然后按公式(3.3.8)进行迭代计算，当$lφ{'(tk)1<8
121

============================================================
第 140 页
============================================================

时(ε>0为计算终止误差)，则迭代结束，此时$tk为$φ(t)的最小点的近似.
求解(3.3.7)问题的 Newton 法步骤:
第1步 给定初始点$_₁}，ε>0$,k$=1$;
第2步如果$lφ{(_k)1<ε，停止迭代，输出$；否则，当$φ(_k)=0时，停止，
解题失败;当$φ{}(t_{k})≠0时，转第3步;
$φ^{(l{k)
第3步计算$t+1}_k
，如果l+1-_|<ε，停止迭代，输出k+1；否则
$φ_^{(lkk)$
k:=$k+1,转第2步.
例3.3.2用Newton 法求函数的最优解.
min φ(t) =
arctan xdx
0
解先求出
1
$φ{(t)=arctan t,
$φ{(1)=$
$1+t^{}$
取$t_{}=1$，计算结果列于下表.
k
$t_ k$
$φ{'}(k)
$1/φ³(l{k$
一
1
0.785 4
2
2
-0.570 8
-0.5187
1.325 8
3
0.1169
0.1164
1.013 7
4
-0.0011
用数学分析的方法，我们可以求得$φ(t)的精确最优解为$t=0.用Newton法
迭代三次后得到的{4已经非常接近最优解$t^.
但是，如果初始点我们取$_{₁=2,则有如下结果:
k
$72
$φ{(tk)$
$1/φ{(ckk$
1
2
1.107 1
5
2
-3.535 7
-1.295 2
13.50
3
13.95
所得到的点列{t_{}并不收敛于$t^{}=0$.
从任意初始点开始的Newton法产生的点列{t}，一般来说，不一定收敛,即
使收敛,其极限点也不一定是φ(t)的极小点，而只能保证它是φ(t)的驻点.但是
当初始点充分接近于t时,可以证明Newton法是收敛的,且收敛速度很快(参
122

============================================================
第 141 页
============================================================

见[8]).只有当初始点充分接近最优解时，由该方法产生的点列才收敛于最优
解，该方法叫做具有局部收敛性.若对任意的初始点，由方法所产生的点列都收
敛于最优解,该方法叫做具有全局收敛性.因此解问题(3.3.7)的 Newton法是一
个具有局部收敛性的方法.
Newton法的思想可以直接地推广到求多变量函数$f($x_{1}，…$，x_{n)$的无约束极
1
值问题，_ 代替φ^{(t_{k)$的是f(x^{})，代替
的是[^{²}fx^{)]}1}，其中x^{=
$φ{(t{)$
$(x_{1}，·，x{k}^}$.
3.4无约束最优化方法
本节我们讨论n元函数的无约束非线性规划问题
min $f(x)
(UMP)
的求解方法，其中x=（_₁1}，…，x_{n)^∈^，f:^}→^{1}这些方法通常称为无约束最
优化方法.
无约束最优化方法大体上分为两类:解析法与直接法.解析法就是在计算过
程中要用到函数$f(x)的一阶导数，即梯度∇f(x)或其二阶导数即$f(x)的Hessian
矩阵∇f（x）及其性质的方法.直接法就是在计算过程中仅用函数值的方法.
本节介绍两种解析法:最速下降法和共轭方向法.希望了解直接法的读者请
参见[1].
1.无约束问题的最优性条件
(UMP)问题的最优解所要满足的必要条件和充分条件是我们设计算法的
依据,为此我们有以下几个定理.
定理3$.4.1设$f:R^{→R^{在点x∈R^{处可微$.若存在p∈_^{,使
∇f(x){p$
则向量p是f在点x处的下降方向.
证因为f在点x处可微，根据f在x处的Taylor展开式，对任意的$t>0$，有
$f(x+tp)=f(x)+f(x)p+(‖tp|)
(3.4.1)
由于∇f(x)p<0,t>0，因而t∇f(x)p<0.据此，存在δ>0，对任意的t∈(0，δ)，有
t∇f(x)p+（tp∥）<0
由(3.4.1)式得到
$f(x+tp)<f(x)，∀t∈（0,δ)
123

============================================================
第 142 页
============================================================

根据定义3.1.3知，p是f在点x处的下降方向.
根据定理3.4.1,用反证法即可得到无约束非线性规划问题(UMP)的最优解
所满足的必要条件.
定理3.4.2设$f:R^"→^{'在点x∈R^{"处可微.若x是(UMP)的局部最优
解，则
∇f(x{)} 0
证明留作习题.
在数学分析中我们已经知道，使∇f(x)=0的点x为函数f的驻点或平稳
点.函数f的一个驻点可以是极小点;也可以是极大点;甚至也可能既不是极小点
也不是极大点，此时称它为函数f的鞍点.以上定理告诉我们，x是(UMP)的(局
部)最优解的必要条件是:x是其目标函数f的驻点.
现给出(UMP)问题局部最优解的充分条件.
定理3.4.3设$f:R^{}→R^{'}在点x{∈R^{"}处的$Hessian矩阵{f(x^{)存在.若
∇f(x{)=0，并且∇^{²}f（x)正定
则x是(UMP)的严格局部最优解.
（证明略.）
一般而言，（UMP)的目标函数的驻点不一定是(UMP)的最优解.但对于目
标函数是凸函数的无约束凸规划（UMP），下面的定理证明了，它的目标函数的
驻点就是它的整体最优解.
定理3$.4.4设$f{R^{→R^{}，x∈R^{，f$是R^"上的可微凸函数.若有
∇f(x{)）= 0
则x是(UMP)的整体最优解.
证因为f是R上的可微凸函数，由定理3.2.3知
∇f(x)（x-x）≤f（x)-f(x），∀x∈R$
由于∇$f(x^{)=0，因而推知
$f(x)≤f(x)，Vx∈R
由此，x*是(UMP)的整体最优解.
1
例3.4.1求无约束非线性规划问题
minf（x₁，x₂，x₃3）=x2+42+x3-2x1
的最优解.
解目标函数的梯度向量为
∇f（x）=（2x₁-2，8x₂，2x₃)
令∇$f（x)=0,求得f的驻点是x=(1,0,0).目标函数f的Hessian 矩阵为
124

============================================================
第 143 页
============================================================

2
0
0)
$∇^{2}fx) =
0
8
0
0
2
对任意的x∈R^{，∇²f（x)为一正定矩阵，因此$f是R^{"上的凸函数，由定理3.4.4
知，x^{}=(1，0,0)^{1为问题的整体最优解.
2.最速下降法
最速下降法又称为梯度法,是1847年由著名数学家Cauchy(柯西)给出的.
它是解析法中最古老的一种,其他解析方法或是它的变形,或是受它的启发而得
到的,因此它是最优化方法的基础.
设(UMP)问题中的目标函数$f:^{→R^{-阶连续可微.
最速下降法的基本思想是:从当前点x^{}出发，取函数$f(x)在点x{处下降最
快的方向作为我们的搜索方向{p{.什么方向是使f(x)下降最快的呢？回答是容
易的.因为由$f(x)的Taylor展开式知
f（x）-f（x+tp）=-l∇f（x）p+（ltp)
略去$t的高阶无穷小项不计，可见取p{}=-∇$f(x^{})时，函数值下降得最多.于是，
我们可以构造出最速下降法的迭代步骤.
求解(UMP)问题的最速下降法步骤:
第1步 选取初始点x^{，给定终止误差ε>0$，令$k:=0$;
第2步计算∇$f(x{2})，若∥∇$fx^{2})∥≤ε，停止迭代，输出$x^{；否则进行第$
3步；
第3步取p=-∇$f(x{);
第4步进行一维搜索，求t，使得
f（x+tkp）=minf（x+tp)
1≥0
令x=x+kp，k：=k+1，转第2步.
由以上计算步骤可知,最速下降法迭代终止时,求得的是目标函数驻点的一
个近似点.
例3.4.2用最速下降法求解如下(UMP)问题
$min$f(x{₁}，x2})=x{2}+22}$
取初始点x^{}=(2，2)1，止误差ε=10^{}.
解显然，该问题的整体最优解为$x^{=(0,0)^{}
下面我们用最速下降法求解.
因为
125

============================================================
第 144 页
============================================================

Je Je
7
∇f(x）=$
=（2x{1，50x{2}）
$∂x_{1{2}$
因此，∇$f(x^{0)=(4100)^{，构造负梯度方向
p^{0=-∇f(x{0)=-(4，100)
2
由于
$x^{}+c {0}=$
+t
=
100
2 - 100t)
因而
$f(x{0+tp{0)=(2-4t)^{2+25(2-10t$
今
d
$f(x{+tp{0)=-8(2-4t)-5000(2-100t)=0
dt$
解得
10 016
$_{o= =$
≈ 0.020 031
500 032
所以
2
- 4
1.919 877
$x^{=x^{}+l{0^{0=$
+ 0.020 031
2
-100
(-0.003 072)
重复上述过程,经$10轮迭代可得到满足误差$ε=10^{}要求的解.这$10轮迭代的全
部计算数据见[11]，其中x^²=(0.078 869，0.070887)，$f(x^）=104,
f(x^{)=3.686144，f(x)=0.131 844.其迭代过程如图3.4.1所示，图中虚线为目
标函数的等值线.
$x_{2}$
$x ^{ }$
${22}$
X
$x{{}$
图3.4.1
从图3.4.1中可知，{x{}随着迭代次数的增加，越来越接近于最优解(0，0)^同
时也看到,随着迭代次数的增加,收敛速度越来越慢,在极小点附近沿着一种锯齿
形状前进，即产生所谓“拉锯”现象:x{沿相互正交的方向小步拐进，趋于解的过
程十分缓慢.事实上，这种情况的出现不是偶然的.因为$lk$是$φ(1)=$f(x^{+tp{)的极
小点，故有
φ'（tk）=∇f（x+lkP)p=0
由于$p^{}=-∇$f(x^{)，因而得知
126

============================================================
第 145 页
============================================================

$∇f(x{+1)^∇fx{2）= 0$
即最速下降法的相邻两个搜索方向是彼此正交的.
以上的分析似乎与“最速下降”的名称相矛盾,其实不然.因为梯度是刻画函
数变化的一种局部性质,从一点的邻域来说函数值下降最快,但从求解极小点的
整体过程来看未必最快.
最速下降法虽有以上分析的缺点,但因方法简便,计算量、存储量少,无论从
任何初始点x{0∈R"开始，所产生的点列{x^{}均收敛,即该方法具有全局收敛性.
因此它仍具有巨大的活力.如果将最速下降法与其他方法结合使用,在开始几步
使用最速下降法,在接近极小点时,使用其他收敛较快的方法,效果较好.此外，
若确定步长t时采用非精确一维搜索方法，如在[3]中介绍的Armijo法,避免了
相邻两个迭代点的梯度向量的正交性,计算效果较好，且可以证明采用Armijo
步长的最速下降法仍具有全局收敛性(参见[3]).
3.共轭方向法
共轭方向法是一类方法的总称.它原是为求解目标函数为二次函数的问
题而设计的.这类方法的特点是:方法中的搜索方向是与二次函数的系数矩
阵有关的所谓共轭方向;用这类方法求解n元二次函数的极小问题,最多进
行n次一维搜索便可求得极小点.因为可微的非二次函数在极小点附近的性
态近似于二次函数，因此，这类方法也能用于求可微的非二次函数的无约束
极小问题.
我们先给出共轭方向的概念.
定义3.4.1设A为n阶实对称矩阵，对于非零向量p，q∈R^{，若有
$p^{}A{q}}=}$
(3.4.2)
则称p和$q$是相互A共轭的.对于非零向量组p^{∈^{",i=0$，1，…，n-1，若有
(p{)Ap=0,i,j=0,1,…,n-1,i≠j
(3.4.3)
则称p^{0}，p^{}，…，p{}是A共轭方向组，也称它们为-组A共轭方向.
显然，当A是n阶单位矩阵I时，(3.4.2)式为p^q=0，即p，q是正交向量.
因而共轭概念是正交概念的推广.同理，由(3.4.3)式知，共轭方向组是正交方向
组的推广.以后所用到的定义3.4.1中的矩阵A通常是正定矩阵.
2
量(0)和(2$
例3.4.3
设A=
,则向量
是A共轭的，因为有
(1 0)({2}2)-2=0
127

============================================================
第 146 页
============================================================

≠0.而向量
显然是正交的,易证它们
1
不是A共轭的.向量
既是正交的，又是A共轭的.
-1
+
关于共轭方向组,有如下的重要性质.
定理$3.4.5设A是n阶实对称正定矩阵，p^{}∈^{}(i=0$，1，…，n-1)是非零
向量.若p^{，p^}，…，p{"}是一组A共轭方向，则它们一定是线性无关的.
证若存在-组实数$α_{}，α₁1}，…$α{-{1}，使得
n-1
∑α,p{}0=
=0
依次以(p{1)A(i=0，1，…，n-1)左乘上式得到
$n-$
∑α,（p1)Ap=0,i=0,1,…,n-1
(3.4.4)
j=0
因为p0，p}，，p是一组A共轭方向，故有
(p)Ap=0,i,j=0,1，,…,n-1,i≠j
又因为A是正定矩阵，而p{≠0，i=0，1，…，n-1，所以有
(p)Ap>0,i=0,1,·,n-1
把以上两式用于(3.4.4)式，便可推知
α;= 0,i=0,1, .,n - 1
因此，p{0，p，…，p是线性无关的.
1
由定理3.4.5即知，A共轭方向组中最多包含n个向量，n是向量的维数.
反之，可以证明，由n维空间的一组基出发可以构造出一组A共轭方向p^，
p，…，p（见习题).当我们在R"中取A共轭方向组p{0，p{，…，p为基时，对
我们求无约束极小问题带来什么好处呢？下面的分析,就是共轭方向法的基
本思想.
考虑二次严格凸函数的无约束最优化问题
1
min$f(x)=-x^{}Ax+b^{x+c
(AP)
2
其中A$是$n阶实对称正定矩阵，b∈R_{}，c∈_^{}.
定理3.4.6对于问题(AP)，若p^{0}，p{}，…，p为任意-组A共轭方向，则
由任意初始点x{∈^出发，依次沿p{},p{}，…,p{}进行精确-维搜索,则最多经
n轮迭代可达（AP)的整体最优解.
(证明略.)
128

============================================================
第 147 页
============================================================

通常,我们把从任意点x{∈R{出发，依次沿某组共轭方向进行一维搜索求
解(UMP)的方法，叫做共轭方向法.若用某种方法求解(AP)问题，经过有限轮迭
代可以达到最优解,称它为具有二次终止性的方法.由定理3.4.6知，共轭方向法
是具有二次终止性的方法.
由于A共轭方向组$p{}，p{}，…，,p{'的取法有很大的随意性，用不同方式产生
一组共轭方向就得到不同的共轭方向法.如果利用迭代点处的负梯度向量为基
础产生一组共轭方向,这样的方法叫做共轭梯度法.下面,对于问题(AP)，我们
讨论形成A共轭梯度方向的一般方法.
任意取定初始点^{∈R^"，若∇$f(x{0)≠0$，第-个搜索方向取
p^{}=-∇f(x{)
(3.4.5)
从x^{}点沿方向p^{0进行精确-维搜索求得$_0}，则
x^{=x{+t0p0$
若∇$f(x^{1})=0$，则已获得(AP)$的最优解x{=^{；否则，第$个搜索方向采用如下
形式
$p{}=-∇f(x{1）+λ0p{0
(3.4.6)
其中λ_{0的选择要使方向p{1}与p^{$是A共轭的.利用(p{1)^{}Ap{0=0$，由（3.4.6)式
得到
(p{){A∇f(x{1)$
$λ_{} =$
(p^{){A{P$
一般地,若已获得A共轭方向p^{0}，p{，…，p{和依次沿它们进行一维搜索所
得到的迭代点x^{'}，…，x1}\若$f（x^1）=0，则（AP)的最优解x=x1；否则下-
个搜索方向为
k
$p+1=-f(x²+1）+}ap
=0
为使p{1与p{°}，，p1}是A共轭的，可以证明（见[3])必有aα_{0=α₁=…=αk-1=0，
从而有
$p+1=-∇f(x+)+λ
中
为使p{与p{$是A共轭的，由（p+1)1}A=0，可求得
(p{)A∇f（x+1)）
$λ_{k}=$
，k=0,1,.,n-2
$(p^{}){A{p{P}$
综合起来，我们得到的一组A共轭方向如下：
129

============================================================
第 148 页
============================================================

$p^{0}=-∇f(x{)$
p+=-∇f（x²）+λ₁P
6
(k= 0,1 ,. ,n -  2)
(3.4.7)
（p）A∇f（x+1)$
其中λ_{k}$
$(p{4)^{}A{{}$
对于二次严格凸函数的极小化问题(AP)，利用(3.4.7)式确定A共轭的线
性搜索方向的方法就是共轭梯度法.但在(3.4.7)的第三个式子中含有目标函数
的系数矩阵A，A的出现一方面不利于在计算机中的存储，另一方面不便于推广
到非二次函数的极小化问题.为此,我们希望仅用梯度向量来简化第三个式子:
∇f（(x^{{1)$
k
$λ{k}=$
k= 0,1,..,n-2
(p{2){}{P}$
(3.4.8)
k
利用二次凸函数$f(x)=-x^{}Ax+b{x+c$的结构及精确-维搜索的性质，可以证明
1
2
（见[1])(3.4.8)式可简化为便于记忆的公式：
∥∇f（(x^{¹}{}$
当k=0时，
λ{
=
（0x）f△∥$
∥∇f（x{+1）²}$
2
当1≤k≤n-2时，
λkk$
=
2∥（₁x）∫△
从而将公式(3.4.7)简化为
$p^0=-qf(x^{$
+1=-∇f（x+¹）+λk$
d
h
(hk= 0,1,..,n - 2)
(3.4.9)
∥∇f（x{+1）
2
$入λ_k$
二
∇f（x{}{}$
(3.4.9)式仅用到梯度信息产生了n个搜索方向,将此式称为F-R公式.当f
是以对称正定矩阵A为系数矩阵的二次函数时，利用F-R公式可以产生一组A
共轭方向.以(3.4.9)式确定搜索方向,然后依次进行线性搜索来求解无约束非线
性规划(UMP)问题的方法,是由Fletcher和Reeves(1964年)提出的,通常称为
Fletcher-Reeves 共轭梯度法，简称F-R法.
由定理3.4.6知，用F-R法求解(AP)问题时，它具有二次终止性质.但用
F-R法来求解非二次函数的(UMP)问题时，在n轮迭代后，一般不能得到目标函
数的驻点，要采用重新开始的技巧.带有再开始技巧的F-R法如下:
F-R法步骤：
第1步 选取初始点$x^{，给定终止误差$ε>0$;
130

============================================================
第 149 页
============================================================

3步；
第3步取p^0=-∇f(x^0)，令k：=0;
第4步进行一维搜索求t，使得
f（x+kp）=minf（x+lp)
1≥0
令x=x+t₁$
第5步计算$fx1)，若∥$f(x1})）∥≤ε，停止迭代，输出x1；否则进
行第6步；
第6步若$k+1=n，令$x^{:=x$，转第3步；否则进行第7步$；
第7步用F-R公式取
p+1=-∇f（x+）+λP$
4
∥∇f（x+1）²}$
其中λ_{k}=$
2
令k：=k+1，转第4步.
$||∇f(x{}){}$
例3.4.4用F-R法求解例3.4.2
min$f（x₁，x₂2）=x²2+25x2
取初始点x^{0}=(2，2)，终止误差ε=10^{}.
解F-R法的第一轮迭代与最速下降法的第一轮迭代相同，由例3.4.2,我
们已有
p^=-∇f(x0)）=-(4,100)
x{=(1.919 88,-0.003 07)
∇f(x')=(3.839 75,-0.15359)
下面利用F-R公式(3.4.9)来构造新的共轭方向，其中
∥∇f（x{1)}$
14.767 32
$λ_{0}=$
= 0.001 472
∥∇f(x{0}$
2
10 016
所以有
p^{=-∇f(x{¹})+λ0{$
0
-3.83975
3.845 65
=
+0.001 472
0.153 59
=
-100
0.006 15
由此有
1.919 88 - 3.845 65t
$x{+p{=$
-0.003 07+0.006 15t)
并且由
d
$f(x^{+lp)=29.57997t-14.76730
131

============================================================
第 150 页
============================================================

令上式为零,我们求得
14.767 30
=0.499 23
$t$
29.579 97
因而得到下一个迭代点
1.919 88
3.845 65
一
$x^{2=x1}+l}^{}=$
+ 0.499 23
-0.00 307
0.006 15
由于∥∇$f(x^{2})}=0<ε，停迭代，输出问题的整体 优解$x^{2}=(0$,0)^{$$
F-R法具有二次终止性.对一般可微函数f(x)的无约束非线性规划问题，
当f(x)满足一定条件时,可以证明F-R法具有全局收敛性，其收敛速度比最速
下降法快.因为F-R法简单、存储量少,因而是求解(UMP)问题的行之有效的方
法之一,但F-R法强烈地依赖于一维搜索的精确性.当一维搜索不保证有精确
性时，我们可用Polak-Ribiere-Polyak共轭梯度法，简称为P-R-P法.P-R-P法
公式与公式(3.4.9)相比，不同处仅是λ由下式给出：
∇f(（x1})[{+f(x+1）)-∇fx{）
λk
=
k= 0,1 ,.. ,n -2
∥∇f（x{）{}$
其他公式皆不变，迭代步骤也与F-R法相同.由于F-R公式和P-R-P公式推导
原理相同，故对于目标函数是二次严格凸函数的问题(AP)来说，当初始点x{相
同时，得到的迭代点列{x^{也相同.然而，对于非二次函数的极小化来说，由于不
同的共轭梯度法计算λ的公式不同,所以产生的迭代点列并不相同.在有些情
况下P-R-P法比F-R法有效.但参考文献[9]中给出的反例则说明:即使目标
函数f(x)二阶连续可微，水平集{x∈R^{}f(x)≤$f(^{0)}$有界，并且采用精确线性
搜索，P-R-P法也可能不收敛.而对F-R法，在同样条件下，可证明它具有全局
收敛性.因此,应当继续研究共轭梯度算法中关于参数λ_k的选择策略.
在实践中证明十分有效的无约束最优化方法,除了共轭梯度法以外,还有变
尺度算法.它们的结构原理都是基于二次函数模型产生下降方向,然后由线性搜
索选择在该方向上的步长.变尺度算法也是一类方法的总称,使用比较普遍的有
DFP方法及BFGS方法.这些方法相当于迭代的每一轮的度量是变化的最速下
降法,因而得此名.数值实验指出,BFGS算法是最好的变尺度算法.当变量个数n
不超过100时,通常BFGS法比共轭梯度法效果好.但对变量个数超过100的大
规模无约束最优化问题,共轭梯度法因其不要太大的存储量而更具优势.
信赖区域法是目前正在发展中的一种无约束最优化方法.它是针对共轭梯
度法和变尺度法的缺点设计的.前面介绍的两种方法所基于的二次函数模型有
时并不充分近似于原来的目标函数,因而在根据该二次函数模型所确定的搜索
方向上,常常无法找到一个有满意下降值的迭代点.信赖区域法的基本步骤是首
132

============================================================
第 151 页
============================================================

先指定一个步长界，然后用带约束的二次函数模型来确定搜索方向和步长.这个
步长界提供了一个使该二次函数模型成为ff(x)的可信赖近似模型的区域,信赖
区域法因此得名.近来很多人都认为,这种方法将提供非常有效、并具有十分精
致的全局收敛性质的最优化算法(参见[2]、[12]).
3.5 约束最优化方法
本节我们讨论约束非线性规划问题
min f(x)
s.t. g₁(x)≤0，i=1,.,p
(MP)
h₁(x)=0，j=1,…,q
的求解方法.其中x∈R，:R→R^，g₁R→R^},i=1，…,p，h_₁:R"→R,j=1，，q.这
些方法通常称为约束最优化方法.
约束最优化问题的求解要比无约束问题的求解复杂得多,也困难得多,因而
求解方法也更多种多样,内容更为丰富.我们仅介绍可行方向方法中的简约梯度
法，增广目标函数方法中的惩罚函数法.
1.约束最优化问题的最优性条件
设（MP）问题的可行域为
g₁(x)≤0，i=1,…，p
$X ={x ∈R{
h,(x）=0，j=1，.,q
对(MP)问题的 个可行点x^{∈X，它应满足所有的等式约束，若令J=
{1,2，，q，即有
h₁(x)=0，j∈J
但它所满足的全部不等式约束则可能有两种情况：对某些不等式约束有$g{(x{)=0，
而对其余的不等式约束有g_{(x^)<0.这两种约束起的作用是不同的.对前者，x
在x*处的微小变动都可能导致约束条件被破坏；而对后者，x在x”处的微小变
动不会破坏约束.因此我们称使$g{(x)=0的约束$g_{}(x)≤0为点x的-个积极
约束.令I={1，2，，p，关于点x的所有积极约束的下标集记为
1（x）={i|g₁（x）=0，i∈l}
下面我们介绍由Kuhn 和 Tucker 在1951 年提出的关于约束非线性规划问
题(MP)最优解的著名必要条件.而且对于一些具有凸性要求的凸规划问题.
133

============================================================
第 152 页
============================================================

Kuhn和 Tucker的条件也是它的最优解的充分条件.
定理3.5.1设f:R^→R^{和$g{:R^→R^{'，i∈l(x)，在点x处可微，g_{},i∈
\l（x)，在点x”处连续，_₁:R^→R^{}，j∈J，在x处连续可微，并且各∇$g{(x{)$
i∈$l(x{)，∇h_₁(x)，j∈J，线性无关.若x是(MP)的局部最优解，则存在两
组实数λ{，i∈l(x{)和u{2，,j∈J，使得
∇f(x)+∑λ∇g₁（x°）+∑μ∇h,（x）=0
i∈1(x)
j∈J
(3.5.1)
λ≥0，i∈ (x)
定理证明从略.
向量组{g{₁(x)，i∈I(x)，∇h_₁}(x*)，j∈J线性无关这个条件，称为是一
个约束规范条件.有各种不同的约束规范条件,这里所述的条件是较为简单
的一种.
(3.5.1)称为(MP)的Kuhn-Tucker条件，简称K-T条件.凡是满足K-T条
件(3.5.1)的点叫做(MP)的K-T点.定理3.5.1说明(MP)的局部最优解一定是
(MP)的K-T点.所设计的很多约束最优化方法寻找的均是(MP)的K-T点.
特别地,对于仅带不等式约束的非线性规划问题
min f(x)
(3.5.2)
s.t. g(x)≤0,i=1, .,p
若x是(3.5.2)的局部最优解，则存在λ，i∈1(x)，使得
∇f(x)+∑λ∇g₁(x*)=0
iel(x
(3.5.3)
λ≥0，i∈l(x{)
我们来看问题(3.5.2)的K-T条件(3.5.3)的几何意义.由(3.5.3)的第一个
式子,我们有
-∇f(x)=∑λ∇g₁(x{)
(3.5.4)
i ∈l(x
而λ{≥0$，i∈l(x).由此可见，若x是问题(3.5.2)的K-T点,则目标函数在点
x处的负梯度向量-∇$f(x^)落在由向量{$g_{(x^{)，i∈l(x{)的非负线性组合
所构成的集合中.称这样的集合
C={y∈R|y=∑α∇g（x°），α₁≥0，i∈I（x)}
i∈l(x)
为由向量$g_{(x)，i∈1(x^)所张成的锥.K-T条件（3.5.3)意味着
-∇$f(x)∈C.图3.5.1画出两个点x*和x{.注意-∇f(x)位于由x*点的积极
约束(I(x^{)={1$，2})$的梯度向量张成的锥中，因而x是K-T点；而-∇$f(x^{c)位
于由x'的积极约束(I(x^{)={2，3})的梯度向量张成的锥之外，于是^'不是K-T
134

============================================================
第 153 页
============================================================

点,图中虚线为目标函数的等值线.
-∇f(x{)$
∇g{(x*)、↑1∇g{2(x*)
-\f(x{)
七*
_{2}x{)
x
X
$_{1(x{)}=0$
$8_{2}(x)=$
$Vg_{3}x{)
$g_3(x)}=0$
图3.5.1
对于仅带等式约束的非线性规划问题
min $f(x)
(3.5.5)
s.t.h,(x)=0,j=1, …,g
若x是(3.5.5)的局部最优解,则存在u_{，j∈J,使得
∇f(x°）+∑μ∇h,(x°)=0
4
(3.5.6)
=
(3.5.6)是问题(3.5.5)的K-T条件.这与我们在数学分析中已学过的求解条件
极值问题的Lagrange 乘子法是一致的.由(3.5.6)式,我们有
4
(3.5.7)
它说明，若x是问题(3.5.5)的局部最优解，目标函数在x的负梯度向量落在由
向量∇h_₁(x)，…，∇h_{(x^{)所生成的子空间中.这与(3.5.4)的含义是截然不
同的.
若在定理3.5.1中，进一步要求各个g_{(x)，i∈I在点x处均可微，则(MP)
的K-T条件可写为更方便的形式
∇f(x）+∑λg（x)）+∑μh（x）=0
d
9
日
j=
λ；g₁(x)）=0，i=1,·,p
(3.5.8)
λ≥0，i=1,.,p
135

============================================================
第 154 页
============================================================

其中λ{}g_{(^{})=0，i∈$1，称为互补松紧条件.
我们可以对带一般约束的非线性规划问题(MP)，引进(MP)的Lagrange 函
数如下：
P
2
4
L(x，λ，μ)=f(x）+
λg{(x)+
∑
$μ,h,(x)$
(3.5.9)
=
三
其中λ=（λ₁，…，λp)，=（μ_₁}，…，₂)叫做Lagrange乘子.
利用(MP)的 Lagrange 函数，K-T条件(3.5.8)可写为
∇L（x*，λ，μ）=0
λg₁(x）=0,i=1,…,p
(3.5.10)
λ≥0,i=1,..,p
∇x}L(x，λ，)表示函数$L(x，λ，)对变量x的梯度向量.
在一定的凸性条件下，上述K-T条件亦是(MP)最优解的充分条件.
定理3.5.2对于(MP)问题，若$f，g{(i∈I)，_(j∈J)在点x”处连续可微，
若(MP)的可行点x满足(MP)的K-T条件，且f，g{，i∈I（x)是凸函数，h_{j∈
是线性函数,则x*是(MP)的整体最优解.
定理证明从略.
例3.5.1用K-T条件解下列问题：
minf(_₁}，x₂2）=(x1-1)^²+(x_2-2)^{
s.t.g_1(x)=x₁1+x2-2≤0$
$g_{2}(x)=-x,≤0
(3.5.11)
$g3}(x)=-x{2≤
$h1(x)=-x₁+x2-1=0$
解问题(3.5.11)的 Lagrange 函数是
L(x，λ，μ）=（x₁-1）2+（x₂-2^²+λ₁（x₁+x₂-2)）+λ₂（-x₁）+
λ3（-x₂）+μ（-x₁+x₂-1)
因为
7e
=2（x{-1)）+λ₁-λ{2-μ
$ax_{1}$
Te
=2（x₂-2)+λ₁-λ₃3+μ
$ax_{}$
故问题(3.5.11)的K-T条件是
136

============================================================
第 155 页
============================================================

2（x_₁-1)+λ₁1-λ2-μ=0
2（x2-2)+λ₁1-λ3+μ=0
λ₁（x₁1+x₂-2）=0
$λ_{2}x2}} 0$
$A_3_{2}  0$
λ1}，λ₂}，λ3≥0
作为K-T点,除满足以上条件外,当然还应当满足可行性的条件
x₁1+x2-2≤0
-x₁1+x2-1=0
x_{1≥0，x_2≥0
要求满足所有这些限制条件的K-T点一般是不容易的.为使求解易于进
行,我们从互补松紧条件入手进行讨论:
(1)设x₁1≠0$x{2≠0，λ{1}=0$
由互补松紧条件知λ_{2}=λ_3=0，由$K-T条件得
2(x₁-1)-μ=0
2(x2-2)+=0
再考虑其中的一个可行性条件
-x₁+x₂-1=0
解以上三个方程，求得x_{₁}=1}，$x_2=2},μ=0$，但此解不满足可行条件中的不等式
约束
$x₁1+x2-2≤0
故此解被舍弃.
(2) 设λ_≠0.
由互补松紧条件知，必有
$x{1+x2-2=0
再加上可行性条件中的一个方程
-x₁+x2-1=0
1
3
解以上两个方程,$得$x{}=
$，$x_{2$
对于这个解，由互补松紧条件知$，λ_{2}=λ_3}=0$.
2
2
将这些值代入K-T条件的前两个方程有
2(\f-=0$
2$3f-2}=0$
137

============================================================
第 156 页
============================================================

3
T
解得$λ_{1}=1，μ=0$.检$验$x^=
1
，λ=(1，0，0)，μ°=0均满足K-T条件和
1
3
T
可行性条件，因而$x^{=
为其K-T点.
2
2
易验证f，g{，i=1,2,3均为凸函数，而h{，为线性函数，由定理3.5.2知，x}=
T
为其整体最优解.
2.简约梯度法
可行方向方法是一类处理带线性约束的非线性规划问题的非常有效的方
法.这种方法是将无约束优化方法推广应用于约束问题,即产生一个可行点列
${x^{2}，满足
$f(x+1）<f（x)
使得{x{}l收敛于约束问题的极小点或K-T点.为了使x^{}点保持可行，且满足目
标函数不断下降的要求,在x点的搜索方向不仅像无约束方法那样是一个下降
方向,而且还要是一个可行方向.所以,这类算法总称为可行方向法.根据不同的
原理构造了不同的可行下降搜索方向，也就形成了各种不同的算法.
简约梯度法的每一次迭代都通过积极约束消去一部分变量,从而降低最优
化问题的维数，而且每次迭代都产生一个可行下降方向,因此简约梯度法是属于
可行方向法这一类的算法.有各种不同的简约梯度法，它们的差别在于为达到简
约问题和保持可行性这两个目的,使用了不同的具体途径.大量的数值试验证
明,简约梯度法对于大规模线性约束的非线性规划问题是最好的,并且在大规模
带非线性约束的最优化问题的数值实验中也取得了相当的成功,是当前世界上
很流行的约束最优化算法之一.
简约梯度法的基本思想是Wolfe在1962年作为线性规划单纯形方法的推
广而提出来的.为了说明这个方法的基本原理,我们考虑如下的问题
min $f(x)
S.t.Ax=b
(3.5.12)
x≥0
这里x∈R^{f:R^{→^{1}，A为-个秩为m$的m×n矩阵$，b∈^{"$.
问题(3.5.12)的可行域为
$X{1={x∈R"|Ax=b，x≥0}
对X{}作如下约束非退化假设：
(1) 每一个可行点至少有m个大于零的分量；
138

============================================================
第 157 页
============================================================

(2) A的任意m列线性无关.
仿照线性规划中的单纯形方法，在每一轮迭代的当前点x处，将x的m个
最大的正分量确定为基变量,余下的n-m个分量作为非基变量,那么目标函数f
可作为非基变量的函数求负梯度方向，并依据这一方向构造从x到^迭代用
到的可行下降搜索方向,这就是简约梯度法的基本思想.
首先,考察目标函数f如何作为非基变量的函数求梯度.设x分解为两部分:
$(xbB)$
x=
$xN$
其中x_{B∈^"，x_{B>0，称其为基向量，其分量称为基变量，x_{n}∈R^{"称为非基向量，
其分量称为非基变量.不失一般性，假设矩阵A的前m列对应于基变量，则可把
A分解为
A=(B，N)
其中B是一个满秩方阵，N是对应于非基变量的一个m×(n-m)矩阵.由Ax=b
可得
$Bx_{B}+Nx{N}=b$
因为B存在，从而基向量x{B可用非基向量x表示为
$x_B=B1b-B}Nx$
这样，目标函数f(x)=$f(_{n}，x{n)可表示为x{2$的函数，记为
F(xn）=f（Bb-B1NxN，xn)
利用复合函数求导法则，求∇F(x)，我们有
rn=∇F（xn）=-（BN)∇Bf（x)+∇Nf(x)
(3.5.13)
称r{2为函数f在点x处对应于基矩阵B的简约梯度.其中∇_Bf(x)是f对基变量
的偏导数组成的向量，∇nf(x)是f对非基变量的偏导数组成的向量，即有
∇Bf(x)$
∇f(x)=$
(3.5.14)
$∇n(x)$
其次，考察在每个迭代点x{∈X{处如何依据它的简约梯度r构造搜索方向
p，使x=x²+₁P∈X₁1，且f（x²1）<f（x）
设x{}的m个最大的分量组成的向量为$x^_{>0$，并记这些分量的下标集为$I_{.
相应地，矩阵A分解为
A=(Bk,Nk)
(3.5.15)
由(3.5.15)知，f在点x^{处对应于Bk的简约梯度为
（₁x）fΔ+（₁）fΔ₁（N₁a）-=
(3.5.16)
搜索方向p相应于(3.5.15)的分解为
139

============================================================
第 158 页
============================================================

$P$
k
k
(3.5.17)
p
二
容易想到，取{p=-能保持方向的下降性，但并不确保方向的可行性.这是因为
若r{2}的第i(i} f$_{2})个分量r^{>0，而此时x^{2$的第i$个分量(非基变量)$_{}=0$，对
$t_{>}0$有
$k{+1$
=x_{2}-t{a{1=-t1}
$x$
不满足问题(3.5$.12)$变量非负的要求$.因此，对$p{h$ 我们选取它的分量$p{}({i≠$_{)
如下：
-r{}，r{≤0$
k
$p_{}$
=
$-x_{}}，r{0$
(3.5.18)
现在来看如何确定p{.为使p^{是一个可行方向，它应满足
Ax+=A（x+t₁p）=Ax+Ap=b
已知$x{}为可行点，因此有A^{=b.又因$_k>0，因此必有
$A{}= 0$
由(3.5.15)和(3.5.17)式知
B{{+Np}=0$
因而应取
pB{=-B{}N}$
(3.5.19)
$p{}$
k
总之，利用简约梯度r构造出的搜索方向p
k
如下：
一
$p$
k
k
r{，
0≥
$i ∈${}$
$P{n}:}P_{}$
k
k
∴
=
k_k
r$
-x_{1r{}
>0
(3.5.20)
k
所得搜索方向p具有如下定理所述性质.
定理3.5.3
对于非线性规划问题(3.5.12)$，设$f是可微函数，x^{∈X{}，并且
$x{{{}$
有分解x^{}=$
，x_{>0.若$p^{$是由(3.5$.20)式所确定的向量，则
$x{}$
y
(1)当$p^{≠0$时，p^{$是$f在点$x^{$处关于$_{1}$的可行降方向.
(2) p{}= 0的充要条件是x{是问题(3.5$.12)$的K-T点.
140

============================================================
第 159 页
============================================================

证(1)对于$t>0，由于x{∈_{1，由(3.5.15)和(3.5.17)及p{的构造(3.5.20)
可得
A（x+tp）=Ax+lAp=b+t（Bkp+Nkp)
=b+t[Bk（-BNkP₂）+N]=b
另外，从x^{>0知，x>0，i∈$_{.并且对于i$_{}，由（3.5.20)式知p{仅当x{>0时才
可能是负值，因而若x{=0，则有p{≥0$，据此，当$t>0取得适当小时，有x^{}+tp^{}≥0$.
因而p{是点x{处关于X_{的可行方向.
为了证明p是下降方向，由(3.5.14)、(3.5.17)、(3.5.16)和(3.5.20)我们有
∇f（x）p=∇Bf（x）+∇nf（x）p
d[₁（₁）f△+N₁₁（₁x）√Δ-]=
=（r{n）p{=∑rp≤0
$}$
又因为p{≠0，因而p≠0，故推知∇f(x^{){p{<0.由定理3.4.1知，p是f在点x$
处的下降方向.
(2) 先证明充分性，由(3.5.10)式，x{是问题(3.5.12)的K-T点意味着存在
λ∈R"和u∈R^，使得
∇f(x{2）-λ+A^=0
$λ^{{2=0$
λ ≥0
$λ{}$
按(3.5.15)，设λ相应的分解为λ=
,则上式可写为
$λ}$
∇Bf（x）-λ+B=0
∇nf(x{2）-λ+N=0
(3.5.21)
λBx=0，λx=0
$λ{≥0，λ{≥0
因为x^{>0，由上式的互补松紧条件知λ{=0，代人(3.5.21)中的第一个式子，有
μ=-（B1）∇Bf（x）
将上式代入(3.5.21)中的第二个式子，由(3.5.16)式得到
λn=-N（B1）∇Bf（x）+nf（x）=r
于是，由(3.5.21)的第三行第二式和第四行第二式,可知
（r{2)^{x{200$
(3.5.22)
${r^{}≥0$
141

============================================================
第 160 页
============================================================

由于x{}≥0，由上式可推知r₁x=0，i≠{，据此，再由r≥0，从(3.5.20)知p{=0，
因而p{=0.由（3.5.17)知p{=0$.
为了证明必要性，设p{=0，由(3.5.20)可知(3.5$.22)式成立.由此，取λ{}=0,
λ{=r^}，μ=-(B1)）∇_f(x)，则（3.5.21)式成立.于是，x是问题(3.5.12)的
K-T点.
最后,我们考察如何从点x{∈X_{1出发沿由(3.5.20)式所确定的可行下降搜
索方向p进行有效一维搜索.
由上面的分析，我们已知$A{p{}=0}，因此对任意的$t_{k>0$，均有$A_{x^{{}
A（x+l₂p）=b.为使
$hk+1
$x^{}$
因为总有x{≥0，i=1，，n，故当$p{≥0时，上式总成立；但当$p{<0时，为使$x{≥
0,应要求
$t_k}≤-$
k
$P_{}$
因而可取
+∞，
$p^{}}=0$
k
$x{
k
<0}，
(3.5.23)
max
min
k
一
$pi$
$1≤i≤n$
k
$p{i$
作为有效一维搜索时变量t的上界.
我们把按(3.5.17)和(3.5.20)式构造搜索方向p，而按(3.5.23)式确定有效
一维搜索变量上界的简约梯度法称为Wolfe简约梯度法，简称Wolfe法.在一般
假设条件下，可以证明Wolfe法是收敛的.
解问题(3.5.12)的Wolfe法计算步骤：
第1步选取初始可行点$x^{∈X_{1}，给定终止误差ε>0$，令$k：=0$;
第2步设$_{是x{的m个最大分量的下标集，对矩阵A进行相应分解
A=(B,Nk)
$∇{Bf(x{))$
第3步计算$f(x^{})}=
,然后计算简约梯度
$(（{,)\$
（，x）Δ+（₁x）△₁（N₁a）-=
记rh的第i(i_{)个分量为r；
第4步按(3.5$.20)式构造可行下降方向p.若∥p{≤ε，停止迭代，输出
$x}，否则进行第5步；
第5步进行有效一维搜索,求解
142

============================================================
第 161 页
============================================================

$min f(x^{2}+tp{)$
$0≤1≤$
max
得到最优解$tk其中x由（3.5.23)式确定，令x^=x+t₁p,k:=k+1，转第2步.
例3.5.2用Wolfe 法求解约束极小化问题
minx2+x2+2x₁x₂2+2x2+6x2
s.t.x_{₁1+x2≤4
(3.5.24)
-x_{1}+x_{2}≤ 2
x_{1}，x2}}≥0$
取x^{=(1，1),ε=10-6.
解首先将问题(3.5.24)化为形如(3.5.12)的问题
minx2+x2+2x₁x₂2+2x1+6x2
s.t.x_₁1+x__2}+_3
=4
(3.5.25)
-x_{_1}+_{2}$
+x4$
=2
x₁≥0，j=1,2,3,4
取x{=(1,1，2，2),ε=10{-6
第1轮迭代.对于x{0=(1,1，2，2)}，有I{={3，4，故矩阵
A=(-111
相应分解为
B_{=(0,
$N_{0= -{1}$
因为
∇f(x)）=（2x,+2x2+2，2x2+2x₁2+6，0,0)
所以∇$f(x{0)=(6$，10，0，0)7.由(3.5.16)式可求得x{°点的简约梯度
r=-（BN₀）∇Bf（x）+∇n（x0)
=-[(0)(-1)]
) (10) = ((60)
由公式(3.5.20)有
因此得到可行下降方向
p{=(-6,-10,16,4)
由于‖p{0∥10^6，要沿p{°进行有效-维搜索.先据(3$.5.23)式确定
143

============================================================
第 162 页
============================================================

1
11
1
=min{
$\fa{0}$
二
6
10
求解
$min$f(x{0+tp0)=256t²-136t+12
$≥1\0
$\fvra{} {10 }$
得最优解$_{0}=$
,于是得到下一个迭代点
10
1
x'=x+l0p0=（1，1，2，2)
+
(-6,- 10,16,4)
10
2
1812
1.
,0,
5
5
5
第2轮迭代$.对于x^{1}，有$_{={3，4}.故对矩阵A的分解仍有
$N_{} -)$
14 34
T
经计算，$$f($x^{}=$
,0,0
，由(3.5.16)式得到简约梯度
5
5
$rn=-（BN₁）∇Bf（x1）+∇nf（x{)
14
14
)](0
5
5
=- [(0$
+
34
345
5
由公式(3.5.20)有
28
28
25
$P^{}$
=
25
PB=-B{}N{₁p{=$
1
28
0
25
所以可行下降方向为
28
28
28
T
,0,
25
25
,
25
由于‖p{1∥10^}，为计算简便计，不妨重取p^{为
p=(-1,0,1,-1)
根据(3.5.23)式确定
2
12
5
5
2
=min
21
mas
1
1
二
5
144

============================================================
第 163 页
============================================================

求解
$minf(x2}+0^/-^+/
$21n
0≤1≤
$求得$t_{}=$
2
，所以
5
2
18 12
T
2
$x^{2=x{2}+,=$
,0,
(-1,0,1,- 1)
+
5
5
5
5
5
=(0,0,4,2)
第3轮迭代.对于$x^{2}仍有$I_{}={3，4}，故A$的分解仍为
1
0
$B{2}=$
1
因为∇f(x^2)=(2，6，0，0），由(3.5.16)式求得r
,按(3.5.20)求得
2
0
0
$P^{2}$
2
,p
$B
.因而有
0
0
p{2}=0<106.由定理3.5.3知x=(0$，0,4，2)为问题(3.5.25)的K-T点.显然
(3.5.25)是一个凸规划,因此所求得的x^{2}为其整体最优解.原问题(3.5.24)的整
体最优解为$x{=(0,0).
求解带线性约束的非线性规划问题的其他形式的简约梯度法见[2].特别要
指出的是，Abadie 和 Carpentier 在1969年成功地把Wolfe(沃尔夫)的简约梯度
法推广到求解带非线性等式约束的非线性规划问题,提出了著名的广义简约梯
度法(Generalized Reduced Gradient Method),简记为 GRG 法.它的基本思想与
Wolfe 法类似，取代Wolfe 法中的等式线性约束的系数矩阵，在GRG法中用等式
向量约束函数的Jacobi（雅可比)矩阵来计算简约梯度.但是，由于这时的约束函
数是非线性的,故用非基变量来表示基变量一般需要求解非线性方程组,这使求
解变得不那么简单.GRG法经后人不断的改进，目前已是求解(MP)问题的最有
效的方法之一.
作为可行方向方法的代表,我们介绍了简约梯度法.还有其他的一些行之有
效的可行方向法，如近似线性化法、Zoutendijk 法、Topkis-Veinott 可行方向法、投
影梯度法等等，见[1]，[4].但一般的可行方向法，对于带非线性约束的(MP)问
题求解效果不理想.原因是当迭代点进人可行域的边界之后,如何让它在“非线
性”的边界上继续进行有效的移动会遇到困难.回避这种困难的另一类求解
(MP)的途径,就是增广目标函数方法.这类方法的特点是,利用问题的目标函数
145

============================================================
第 164 页
============================================================

和约束函数的某种组合构造出所谓增广目标函数,把约束优化问题的求解转换
为相应的增广目标函数的无约束优化问题的求解.限于篇幅，下面我们仅介绍利
用所谓惩罚函数来构造增广目标函数的惩罚函数法.
3.惩罚函数法
惩罚函数法求解(MP)问题的思想是,利用问题中的约束函数作出适当的带
有参数的惩罚函数,然后在原来的目标函数上加上惩罚函数构造出带参数的增
广目标函数,把(MP)问题的求解转换为求解一系列无约束非线性规划问题.这
种把一个(MP)问题的求解归结为一系列无约束优化问题求解的方法，也叫做序
列无约束极小化方法.
惩罚函数法有许多类型,这里将介绍最基本的两种:一种是罚函数法，也称
为外部惩罚法；另一种是障碍函数法，也称为内部惩罚法.
(1) 罚函数法
考虑(MP)问题
min $f(x)
s.l. g{(x)≤0,i=1, ,p
(MP)
h，(x)=0，j=1,…,q
这里x∈R"，并假设出现的所有函数都是连续的.（MP）问题的可行域是
g；(x)≤0，i=1,.,p
X=x∈ R^{}$
h₁(x)=0,j=1,…,q]
将带约束的(MP)问题转换为无约束极小化问题求解的原始想法是,设法适
当地加大不可行点处对应的目标函数值，使不可行点不能成为相应无约束极小化
问题的最优解.具体地说,是预先选定一个很大的正数c,构造一个如下的罚函数
0，x∈X
p(x)=$
(3.5.26)
c，x≠X
然后利用p(x)构造一个(MP)的增广目标函数
F(x)=f(x)+p()
(3.5.27)
由于在可行点处F的值与f的值相同,而在不可行点处对应的F值很大,所以相
应的以增广目标函数F为目标函数的无约束极小化问题
min F(x)=f(x)+p(x)
(3.5.28)
的最优解，必定也是（MP)问题的最优解.
上述原始想法虽然可以将带约束的(MP)问题转换为无约束的(3.5.28)问
题求解，但构造的罚函数(3.5.26)未必能保持各约束函数g_{,i=1，.，p，h_{
146

============================================================
第 165 页
============================================================

j=1，…,q所具有的连续性或者是光滑性等良好性态,致使转换后的问题(3.5.
28)一般无法采用各种无约束最优化方法求解.
要使构造的增广目标函数F(x)保持原来的目标函数f(x)及各约束函数所
具有的良好性态,关键在于罚函数不能在可行域的边界处发生跳跃.为此,对于
(MP)问题可选取罚函数如下：
P
C
"
Pp(x)）=c∑[max(g，(x)，0)}{+
∑
[h，（x)]{}$
2
目
=1
其中c叫做罚参数或罚因子，相应地构造增广目标函数为
F(x）=f(x）+p(x)
可以证明，当目标函数$f(x)及各约束函数均为连续可微时，F_{(x)也是连续可微
的.当c充分大时，总可使(MP)问题转换为无约束的极小化问题
$min {(x
在实际计算中，选取大小合适的c并不简单.为此，人们做了效果相同的一
点改变:先选取一递增且趋于无穷的正罚参数列{c，此时，随着k的增大，罚函
数p_{(x)对每个不可行点x施加的惩罚也逐步增大，且在每个不可行点x处，当
k趋于无穷时惩罚也趋于无穷.这样，求解(MP)问题就转换为求一系列无约束
极小化问题
minF_(x)=f(x)+p（x），k=1,2,.
(3.5.29)
的解,其中
p
C_kk$
b
P（x）=ck∑[max（g（x），0）]+
∑[h_，(x)}{}$
(3.5.30)
2
司
=
设当k取定时，(3.5.29)的最优解为x^{}，我们自然期望点列{x^{}会逼近(MP)的
最优解.这就是罚函数法求解(MP)问题的过程.
罚函数法在企业管理中可作如下解释.
我们把目标函数f（x)视为产品的成本，把约束条件视为对产品质量的某些
规定，企业管理人员可在质量规定的范围内通过各种办法降低成本.对违反产品
质量规定的工作人员制定了一系列惩罚办法:如果符合规定，免于惩罚，反之，就
给予惩罚.这时工作人员所追求的总目标应是产品成本和所受惩罚的总和为最
小,这就是上面所说的无约束极小问题.当惩罚条件规定得很苛刻时,违反产品
质量规定所付出的代价也就很高，这就迫使工作人员尽可能不违反规定.在数
学上就表现为当罚参数ck充分大时，上述无约束问题的最优解应满足约束条
件,而成为约束问题的最优解.
罚函数法计算步骤
第1步 选取初始点x^{}，罚参数列{ck}($k=1,2，…)$，给出检验终止条件的
147

============================================================
第 166 页
============================================================

误差ε>0$，令$k：=1$;
第2步按(3.5.30)构造罚函数p(x)，再按(3.5.29)构造(MP)的增广目
标函数，即
F（x）=f（x）+p（x)
第3步选用某种无约束最优化方法，以x为初始点，求解
min F(x)
设得到最优解$x^{.若$x^{}}已满足某种终止条件，停止迭代，输出$x^{.否则令$k{：=$k+1，
转第2步.
在罚函数方法中,对递增且趋于无穷的正罚参数{c的选取，常常采用先取
定一个初始罚参数c_{>0和一个增大系数α≥2，而令
$Ck+1}=ack
k=1,2,.
递推产生.令
1
P
1
∑
7
[h_,(x)}{}$
C_k}$
2
终止条件可采用S(^{})≤ε，也可令
g
k
=max|g；(x）},
h
=max{lh,（x{}）1}
max
1≤i≤p
max
≤j≤q
例3.5.3用罚函数法求解
min
22
(3.5.31)
s.t. 1-x≤0$
取ck=k，k=1，2，….
解罚函数为
（x）=ck[max（1-x，0）}=k[max（1-x，0)]
相应的增广目标函数为
F（x)=x{²+k[max（1-x，0）]{2
$x^{2+k(1-x)^{2}，x<1$
$x^{2}2},
x≥1
原问题转换为求解一系列无约束最优化问题
min F(x),k=1,2,.
如图3.5.2所示.用解析方法求解上述问题.
$d_{2x)
2x-2k(1-x)，x<1
=
dx$
{2x,
x≥1
148

============================================================
第 167 页
============================================================

令
=0$,求得
dx
k
k
k = 1,2,..
$x}
1+k{}$
可以看到,当k无限增大时x{}是从问题(3.5.31)
$y= _{k}x)
y
可行域外部趋于它的最优解x{=1的.
对于约束最优化问题(MP)，除非它的最优
解x也是$f(x)的无约束最优解，一般x*总位
k=2
1
于(MP)的可行域边界上，采用罚函数法，所得
$k= 1$
点列x^总是从可行域外部趋于(MP)的最优
解x*.正因为如此，也称罚函数法为外部惩罚法
0.5
或外点法.这一方法通过对不可行点施加惩罚构
造增广目标函数,并使增广目标函数的最优解
0
$x^{}$
1
x
随惩罚的无限增大而趋于原(MP)问题的最
1
优解.
图3.5.2
(2)障碍函数法
罚函数法产生的点列{x{}从可行域外部逐步逼近(MP)问题的最优解.当我
们在某个充分大的ck处终止迭代时,所得到的点x^{一般只能近似满足约束条
件.对于某些实际问题来说,这样的近似最优解是不能被接受的.为了使迭代点
总是可行点,可以采用障碍函数法,或称为内部惩罚法.它的基本思想是,在可行
区域的边界上筑起一道“墙”来,当迭代点靠近边界时,所构造的增广目标函数
值陡然增大,于是最优点就被“挡”在可行区域内部了.
为使可行区域的内点与边界能一目了然,使我们易于构造障碍函数,考虑仅
带不等式约束的(MP)问题
[min $f(x)
{ s.t. g₁(x)≤0,i= 1,…,p
(3.5.32)
令
g(x)=（g₁(x），…，gp(x))
(3.5.32)问题的可行域X的内部可记为
X{°={x∈R|g(x)<0}
当点x从可行域内部趋于可行域边界时，至少有一个g(x)趋于零.因此函数
d
1
B(x)=-$
M
P
B(x)=-∑ln[-g₁(x)]
$g_{(x)
三
就会无限增大.于是,若在原目标函数f(x)上加上B(x)，就会使极小点落在可行
149

============================================================
第 168 页
============================================================

域内部.因此函数B(x)的作用是对企图脱离可行域的点给予惩罚.然而，我们最
终目的是逐步逼近f(x)的带约束条件的极小点，且这种极小点通常位于可行域
的边界上，因此要在迭代过程中逐步减弱B(x)的影响
为此，构造障碍函数为：当x∈X^{时，有
P
1
1
B_1k(x)=-d
或
(3.5.33)
$g_{(x$
=
其中称dk为罚参数或罚因子，d_k>0.当$g_{(x),i=1，…，p均为连续函数时，B_(x)
在X{}上是非负连续函数.
选取一递减且趋于零的正罚参数列{d_}(k=1，2，…)，对每一个d_k可作一
对应的障碍函数B_(x).利用B_(x)构造出定义在X^{上的(3.5.32)$的增广目标
函数
$F(x)）=f（x）+B()
(3.5.34)
由B_{}(x)$的结构可知，当-个点从$X^{}中向X$的边界趋近时，_2}(x)$的值将无限
变大，由此,无约束最优化问题
$min F_})$
(3.5.35)
的最优解必落在可行域的内部.这样,我们把约束优化问题(3.5.32)的求解转换
为一系列无约束优化问题
minF_(x)，k=1,2,…
的求解.如果(3.5.32)的最优解在X内部,则当d取到某一适当的值时，(3.5.35)的
最优解可以达到它.如果(3.5.32)的最优解在X的边界上,则随着罚参数d的减
小，障碍函数B_{(x)影响的减弱，相应的(3.5.35)的最优解点列将向X的边界上的
最优解逐渐逼近.据此,我们给出求解(3.5.32)问题的障碍函数法如下.
障碍函数法计算步骤
第1步 选取初始点x^{∈X{°,罚参数列{d_k}(k=1$，2，)$，给出检验终止条
件的误差ε>0$，令k:=1$;
第2步按(3.5.33)作障碍函数B_d(x)，再按(3.5.34)构造问题(3.5.32)的
增广目标函数，即
（x）=f（x)+B（x)
第3步选用某种无约束最优化方法，以x^为初始点求解
minF_(x)，x∈X{°
得到最优解$x{.若$x{}已满足某种终止条件，停止迭代，输出$x^{.否则，令$k{=_k+1$，转
第2步.
在上述障碍函数法中,初始点必须选取可行域的内点.罚参数列{d}常由如
$d_kk$
下形式产生:先取定-初始罚参数d1>0和一个减小系数β≥2，令$$d{+ 1$
,通常
β
150

============================================================
第 169 页
============================================================

取β∈[4，10]}.终止条件可采用Bd_2(x^)≤ε或min|g;（x^2)|≤ε.当然，也可选取
1≤i≤p
与函数(3.5.33)能起到相同作用的其他形式的障碍函数.
例3.5.4用障碍函数法求解例3.5.3.
1
取dk{$
k=1，2，…，采用对数形式的障碍函数.
k
解取
1
k
相应的增广目标函数为
ln(x-1)，
x >1
k
用解析方法求∇_(x)=0得到无约束优化问题
$min _d(x)
的最优解为
$k+\k^{2}+2kk$
k = 1,2,.
2
2k
由上式可见，当k无限增大，即dk无限减小时，x^{从问题(3.5.31)的可行域内部
趋于最优解$x{}=1.
问题(3.5.31)是个非常简单的一元函数求带不等式约束的极值问题.但从中
我们可以体会到用惩罚函数法求解(MP)问题的思想和一般过程.因为问题简
单，因此我们得到的是无约束问题
min_(x)(或min_(x))
的解析解.在给定精度ε>0后,只要取c_2(d_)足够大(小)，由解的解析表达式，仅
计算一次就可以求得满足精度要求的近似最优解.但当无法得到无约束优化问
题的解析解时，就必须用迭代法.此外，罚函数法适用于一般的(MP)问题.上面
介绍的障碍函数法仅适用于带不等式约束的非线性规划问题.对一般的（MP)问
题,还有将罚函数法与障碍函数法相结合的混合惩罚函数法.它们都是将一个带
约束的优化问题转化为一系列无约束优化问题的方法.
罚函数法的优点是方法结构简单，对初始点的选取比较自由；障碍函数法同
样有结构简单的优点，但初始点必须是可行内点，因而随之产生的每个迭代点也
均为可行点.这两个方法的缺点:一是收敛速度慢,例如对问题(3.5.31)，若要求
第k轮迭代得到的近似最优解$x{与最优解$x{=1之间的误差达到|{x{}-x^{≤
3
10^-3，用罚函数法从
--1
≤10^{3}可推知迭代要进行1000轮，用障碍函数法，
$k+1$
$k+\k^{2}+2k
从
-1
≤10^{3}推知迭代也要进行500轮;二是工作量大,每轮迭代都
2k
151

============================================================
第 170 页
============================================================

要求解一个无约束优化问题;三是方法本身造成了数值困难性,这是因为在求解
过程中,要求罚参数无限增大或无限减小,这会导致相应增广目标函数的
Hessian 矩阵变得越来越病态,因而往往使求解在实际应用中失败.
为了利用惩罚函数法的思想并克服它的缺点,我们考虑把问题的惩罚函数
和Lagrange函数结合起来，构造出更适当的增广目标函数的方法.由于这种方法
要借助于Lagrange乘子的迭代进行求解，故统称为乘子法.有多种乘子法，一般
这些方法也是将问题转换为一系列无约束优化问题求解,但乘子法产生的迭代
点列比惩罚函数法产生的迭代点列更快地接近原问题的最优解x”，因而乘子法
不需要过分地增大罚参数,一般可避免因罚参数过大造成的数值困难.数值试验
表明,它远比惩罚函数法优越,至今仍是解约束最优化问题的最好算法之一.然
而，一般的乘子法因无法预先知道最优Lagrange乘子,因而仍是将问题转换为一
系列无约束优化问题来逼近最优乘子和最优解.自然我们希望通过其他途径构
造出一个函数，它不需要依赖某些确定的而又未知的参数,但它的无约束极小点
恰好就是原来约束问题的解.由于这样的函数往往也是在目标函数上加上一些
惩罚项而构造的,所以称为精确罚函数.目前人们的研究兴趣主要集中于两类性
质不同的精确罚函数:可微精确罚函数和不可微精确罚函数.这些方法避免了将
问题转换为一系列无约束优化问题,而直接使约束最优化问题转换为单个无约
束最优化问题(见[2]，[4]，[12]).
序列无约束极小化方法的效率和可靠性等方面在很大程度上依赖于所采用
的无约束最优化算法.近年来,随着对带线性约束的非线性规划算法的研究,特
别是对带线性约束的目标函数是二次函数的二次规划算法的研究,发展了序列
线性约束极小化方法,以及序列二次规划方法.这些方法是将一个(MP)问题的
求解转换为一系列带线性约束的非线性规划问题求解.这方面的研究是近30多
年来非线性规划研究领域最突出的进展.这些不同层次的序列约束最优化方法
的有效性高,可靠性强,已成为当前世界上很流行的约束最优化数值方法之一.
目前,先进的大型通用数学软件的普及和使用,使我们求解大规模最优化问
题变得更为方便和可行.随着新的、更好的优化软件的不断开发,随着最优化问
题在解题环境上的不断改善,最优化的应用前景是非常广阔的.
第3章习题
(A)
1.设有半径为R的圆.试列出使圆内接三角形面积最大的极大化数学模型.
152

============================================================
第 171 页
============================================================

2.写出下述问题的数学规划模型.
若将机床用来加工产品A，6小时可加工100箱.若用机床加工产品B,5小
时可加工100箱.设产品A和产品B每箱占用生产场地分别是10和20个体积
单位,而生产场地(包括仓库)允许15 000个体积单位的存储量.若机床每周加
工时数不超过60小时，产品A生产x_{1}(百箱)的收益为(60-5{x_{1})$x_{1}元，产品B生
产x_2}(百箱)的收益为($8$0-4$x_2)x_{2}元，又由于收购部门的限制，产品$A$的生产量
每周不能超过800箱.试制定最优的周生产计划,使机床生产获最大收益.
3.试在同一平面坐标系中画出下列(MP)的可行域及目标函数的等值线，
并在图中标出其局部最优解或整体最优解.
(1) min(
1
$x_{2}2}$
1
15
$_{1}-x2+$
4
2
4
(3)minx^2+（x₂2-1^²2+1
≤4
s.t.$x__2}-x^{2+2}≥0$
$x_{_1}≤ 0$
$x_{2}≤ }$
1
x_{1}，_{2}}0$
$x_{2}=
2
1
4.试证二次函数$f(x)=$
-x{}Ax+b^{x+c(A为对称矩阵)$是严格凸函数的充
2
要条件为A是正定矩阵.
5.判别以下函数哪些是凸的，哪些是凹的，哪些是非凸非凹的.
(2）f（x₁1，x₂2）=-x2-5x2+2x₁x₂2+10x₁-10x₂；
(3)）f（x1}，x2，x3）=x2+3x+9x2-2x₁x2+6x2x3+2x₁x₃
6.考虑规划问题
$min  $c^{$
(MP){s.t.g₁(x)≥0,i=1,2,.，m
Ax≥b$
其中$g_{(x)为可微的凸函数，i=1，2，，m；若$x^{}$是(MP)的一个可行解，且存在
向量$z{}满足
{∇g:(x³)z{≥0，i=1，…,m
${A_{}0,
$c^{0$
求证(MP)的目标函数无下界.
7.证明下列规划为凸规划
153

============================================================
第 172 页
============================================================

$min$x{2}+2x₁x₂2}+2x{22
(1）
s.t.x₁1}≥1$
问:该问题是否存在最优解?
min
∥Ax-b|
2
(2)
s.t. x≥0
其中A$是-个m×n矩阵，秩(A)=n.符号$x∥^{2}表示向量x$的模的平方，
即‖x2=x^{x
8.设$f（x_1}，x_2）)=4x2}+x{2，已知x^{
(1),p=(-)$
.试用解析方法求
min$f(x^{+tp{)的极小点.
1≥0
9.用0.618法求以下问题的近似解
minφ(t)=-2t{3+21t{²-60t+50
1≥0
已知函数的单谷区间[0.5，3.5]，要求最后区间精度ε=0.8.
10.用Newton 法求以下问题的近似最优解
minφ(t)=t{4-4t³-6t{2-16t+4
给定$t_{1}=6$，ε=1^{3.并用解析方法求出该问题的精确最优解,然后比较二者结果.
11.设$φ:R^{1}→R^1}连续，[a_k}，_k]}是问题
min φ(t)
(*)
l≥0
的搜索区间，已知$_,∈(a_，b_k)，在[a_，b_]上取二次插值多项式
p(t）=at+β+γ
要求p（a）=φ（ak),p（b）=φ（b）,p（k）=φ（tk).
(1)求证一维极小化问题
min p(t)
$ak}≤1≤bk$
的最优解为
1φ（a,）（b-t2）+φ（bk）（t²2-a）+φ（t）（a-b)
$tk+1$
二
2φ（ak）（bk-lk）+φ（bk）（tk-ak）+φ（tk）（ak-bk)
(2) 用二次插值多项式的极小点$_+1来缩短搜索区间，建立一个求解问题
(*)的近似最优解的一维搜索方法(三点二次插值法)，写出其计算步骤.
12.证明定理3.4.2.
13.求以下无约束非线性规划问题的最优解：
（1）minf（x₁，x₂）=2x+x+（x₁+x₂）²-20x₁-16x₂；
(2)minf（x₁1，x2）=x+x2-12x1
14.当参数α取何值时，x^{}=(0，0,0)^{$是问题
2
$^{3}}+$
w2
e
$^1$
的局部最优解.
15.用最速下降法求解以下问题,要求迭代进行三轮.
154

============================================================
第 173 页
============================================================

1
(1)min
2
2
,取初始点$x^{}=(3，2)^；
$x_{2}+$
$x{{2}$
3
2
(2)max（4x₁+6x₂-2x-2x₁x-2x2}），取初始点x=（1，1)）.
16.对例3.4.2中的变量x=(x_₁}，x2}）作线性变换：y_{₁=x_1}，y{2=5x2}，则原来的
无约束优化问题变为
minF（y₁，y₂）=y+y2
(**)
证明:从任意初始点y{°出发,用最速下降法对问题(**)迭代一轮即可求得最优
解.从中你可以得到什么启示?
17.设A是$n×n对称正定矩阵，并设U_{{(i=0，1，，n-1)为线性无关的一
组向量.令$p{(k(k=0$，1，…，n-1)按如下方式生成：
$p^{)}0)
$y(k+1^{Ap$
k
U
(i)
∑
p
(i)
-p
k=0,1,..,n -2
(i)T
=0
Ap
(i)
p
证明方向p{({(k=0，1，，n-1)是A共轭的.
上述过程称为共轭化，它从一组线性无关方向出发，产生一组A共轭方向.
18.对于
minf（x1，x2）=1-2x₁+3x₂2+x-4x12+5x
若从某个初始点x^{°出发，第-次沿方向{p^{=(1，1)^{作$f的精确线性搜索得迭代
点x^{2}，试问下一次从x^{出发，应沿什么方向作$f的精确线性搜索可得最优解.
19.用F-R法求解
$mi$n(1-x₁1)^²2+2(x{2-x^2)^{
取初始点$x^{=(0$，0),ε=10^{-6
20.设c_{x∈R^{，A$是m×n矩阵，b∈^"}，试写出线性规划问题
$min$c^{$
s.t.Ax ≥b
x≥0
的K-T条件.
21.用K-T条件求下列问题的最优解及相应的Lagrange乘子.
$min$f(x₁1},x_2)=-x1x_{2
s.t.$x_₁}+4x_{2}≤4
4x{}+x_{_2}≤44$
22.写出下列问题的K-T条件，并求出它们的K-T点.
155

============================================================
第 174 页
============================================================

min
（x₁1-3)²}+(x2-2^
s.t.
$x^{2}+^2=0$
(1)
$x_{1}+2x{2}-4=0$
$x{1}≥0，x{2}≥0$
min
-（x_₁1+1^²-（x2+1）
(2)
s.t.
$x^{2}+x{2}=0$
$x_{2} 0$
23.设$_{}由下列式子确定，点x∈$X_{1}试写出向量p∈^{}，p≠0$是点$x$处关$
X{}的可行方向的充要条件：
(1)X_1={x∈^"|Ax=b，x≥0}，其中A为m×n矩阵，b∈R^{}.
(2)X_1}={x∈R^{}lAx≥b，x≥0}，其中A为m×n矩阵，b∈R^{m.
(3)X_{}={x∈R{|Ax≤b,Cx=d，x≥0}，其中A为m×n矩阵，b∈^m，C是
$lxn矩阵，d∈R^{1}
24.用Wolfe法求解以下问题
minf(x₁1}，x₂2）=2x²2+2x2-2x₁x2-4x1-6x2
s.t.x_₁+x_{2≤2
x1+5x_2}≤5
x₁,≥0，j=1,2
取初始可行点x{}=(0，0)，ε=10^{6.
25.用罚函数法求解问题
min (x-1 )^{$
ls.t. 2-x≤0
(1)写出c_=0，1,10时相应的增广目标函数，并画出它们对应的图形.
(2)$取c_=k-1(k=1,2，…)，求出近似最优解的迭代点列.
(3)利用(2)求问题的最优解.
26.用对数形式的障碍函数法求解问题
min__+2x2
$x^{2}x{2}0$
s.t.
$x_{_}≥ 0$
(B)
1.证明不等式
$nx{}=（x){
1
n
2
n
156

============================================================
第 175 页
============================================================

并证明当且仅当$x_{1}=$_{₂}=·=$x{n$时$$成立.
(提示:利用K-T条件，解如下凸规划
n
min$f（x₁}，，xn1)）=
∑
$x_{{2}$
国
"
s.t.
∑
$x_{i}  c
7
i
2.一个投资股票决策问题的数学模型(见[13]，p659)如下,利用本书所提
供的软件解之.
minf（x1，x，x₃3）=0.20x+0.08x2+0.18x3+0.10x₁x2+
0.04x₁x₃3+0.06x₂x_3
{s.t.0.14x,+0.11x2+0.10x₃3≥120
$x₁+x2+x3=10
$x1，x2，x3≥0
3.求曲面4z=3x{2}-2xy+3y^{2到平面$x+y-4z=1的最短距离.
(提示：设A（x_₁1}，y_{1}2_{1}），B（x_₂2，y_{2}2z_{2})分别为曲面和平面上的任意-点，求解
问题
minf（x₁，y₁，₁，₂，y₂，²）=（x₁-x₂）²+（₁-y₂）²+（z₁-₂）²
s.t3x-2x₁y₁+3y²-4z1=0
$x2+y2-4z2-1=0
)
参考文献
[1]胡毓达.非线性规划[M].北京:高等教育出版社，1990.
[2]赵瑞安，吴方.非线性最优化理论和方法[M].杭州：浙江科学技术出版
社,1992.
[3]陈开明.非线性规划[M].上海:复旦大学出版社，1991.
[4]席少霖.非线性最优化方法[M].北京:高等教育出版社,1992.
[5]徐光辉,刘彦佩，程侃.运筹学基础手册[M].北京:科学出版社,1999.
[6]M.阿佛里耳.非线性规划——分析与方法[M].李元熹，等译.上海:上海科学
技术出版社，1979.
[7]《运筹学》教材编写组.运筹学[M].4版.北京:清华大学出版社,2012.
[8]鲁恩伯杰DG.线性与非线性规划引论[M].夏尊铨，等译.北京:科学出版
社,1980.
157

============================================================
第 176 页
============================================================

[9] Powell M J D.Nonconvex Minimization Calculations and the Conjugate Gradient
Method[J].Numerical Analysis.Berlin Heidelberg : Springer-Verlag,1984,1066
(3):122-141.
[10] Murtagh B A,Saunder M A.MINOS 5.0 User's Guide.Technical Report SOL
83-20R.2nd ed.Stanford University,1987.
[11]席少霖，赵凤治.最优化计算方法[M].上海:上海科学技术出版社,1983.
[12]袁亚湘,孙文瑜.最优化理论与方法[M].北京:科学出版社,1997.
[13 Wayne L,Winston.Operations Research: Applications and Algorithms[M].2nd
ed.Boston:PWS-Kent Publishing Company,1991.

============================================================
第 177 页
============================================================

第4章
动态规划
在实践中有许多决策问题与时间有关系，决策过程分成若干阶段，各阶段
的决策相互关联，共同决定最终的目标，我们称之为多阶段决策问题，针对多
阶段决策问题的特点
是出了解决该类问题的动态规划模型和求解方法
本章首先介绍多阶
问题，然后给出最优化原理和动态规划模型，最
后介绍动态规划方法在实践中的一些应用
4.1多阶段决策问题
本节将通过各种不同类型的实例引出多阶段决策问题,并给出该类问题的
一般描述和概念.
1.最短路问题
最短路问题就是从某地出发,途经若干中间点最后到达目的地,要求找出路
程或费用最小的路线,根据途经中间点的情况,最短路问题可分成两类：
（1）每个路线包含的边数相等；
(2）不同路线包含的边数不一定相等.
下面首先介绍一个边数相等的例子，在4.4将重点解决第二类最短路
问题.
例4.1.1管道设计
如图4.1.1给出一个网络，从A点铺设一条煤气管道到E点，必须经过三个
中间站，第一站可以在B{,B_2，B_3中选择.类似地，第二站，第三站分别可以在C_{_}
$C_{2}，}C_{3}和D_{_，_2，D_3中选择.能用管道相连的两站之间的距离已经给定，两点之
间没有连线的表示这两点之间不能铺设管道.要求选择一条由A到E的铺管路
线,使总距离最短.
找一条从A到E的管道路线问题与确定三个中间站的位置本质上是一样
的,当三个中间站的位置都确定了，一条从A到E的路线也就确定了，整个决策
159

============================================================
第 178 页
============================================================

,
B
D
A
$B^{22}$
$C_{22}$
$D_{2}$
E
$B^{3}$
$D{3}$
$C_{3}$
图4.1.1
可以看成三个阶段,每个阶段确定一个中间站的位置,最终选择的路线由三个阶
段的决策共同决定.
2.资源分配问题
资源分配问题主要是考虑把有限的资源在不同生产活动和不同时段上分
配，以在特定的时期内获得最大的收益.
多阶段资源分配问题的一般提法是：
设有数量为x的某种资源，将它投入两种生产方式A和B中，以数量y投入
生产方式A，剩下的量投入生产方式B，则可得到收入g(y)+h(x-y)，其中
g(y)和h(y)是已知函数，并且g(0)=h(0)=0.再假设以y与x-y分别投入两种
生产方式A,B后可以回收再生产，回收率分别为$a与$b(0≤$a≤1$0≤b≤1)$.试
述几个阶段总收益最大的资源分配计划.
例4.1.2今有1000台机床，要投放到A,B两个生产部门，计划连续使用
5年，已知对A部门投入u_{台机器的年收益为$g(u_{})=u2}，机器完好率$a=0.8$;
相立地，B部门的年收益与机器完好率分别为$$h}(_{3)=2_{2}，b}=}0.4$.
试建立5年间总收益最大的年度机器分配方案.
对于多阶段资源分配问题,由于当期投入两个生产活动若干资源后,当期会
有部分收益，同时当期结束时资源可部分回收或可再利用，因而下期可利用这些
资源继续生产.每期可利用资源量由上期可利用资源量、资源在两种生产的分配
情况共同决定，每期都有当期的收入，而总收益是多期收益之和.
3.生产-库存问题
一般生产-库存问题的提法为:设有一生产部门,生产计划周期为几个阶
段,已知最初库存量为$X_{}，第i个阶段产品需求量为$d_{,i=1，2}，…，n.生产的固定
成本为C，单位可变成本为L，单位产品的阶段库存费用为h，库存容量为M，阶
段生产能力为B,问应如何安排各阶段的产量,在满足需求的条件下使计划期内
160

============================================================
第 179 页
============================================================

的总费用最小.
例4.1.3某工厂生产某种季节性商品,需要做下一年度的生产计划,假定
这种商品的生产周期需要两个月,全年共有6个生产周期,需要作出各个周期中
的生产计划.设已知各周期对该商品的需要量如下表所示：
周期
1
2
3
4
5
6
需要量
5
5
10
30
50
8
假设这个工厂根据需要可以日夜两班生产或只是日班生产，当开足日班时，
每一个生产周期能生产商品15个单位,每生产一个单位商品的成本为100元.
当开足夜班时，每一生产周期能生产的商品也是15个单位,但是由于增加了辅
助性生产设备和生产辅助费用,每生产一单位商品的成本为120元.由于生产能
力的限制，可以在需求淡季多生产一些商品储存起来以备需求旺季使用，但存储
商品还需要存储费用,假设每单位产品存储一个周期需要16元，已知开始时存
储为0,问应如何安排生产和存储计划使总费用最小?
对于生产-库存问题,每期的产品供给量由当期初的存储量和当期的生产
量决定,每期初的库存水平影响着当期的生产决策和期末的库存水平,而每期末
的库存水平就是下期初的库存水平，各期通过这种关系产生联系，同时每期都有
生产成本和存储成本,而目标是各期生产成本和存储成本之和最小.
4.一般多阶段决策问题
与上述问题类似的还有许多，诸如设备更新问题，系统可靠性问题，背包问
题……，这些问题可以统一描述如下：
有一个系统,可以分成若干个阶段,任意一个阶段k的系统状态可以用xk
表示(_k}可以是数量、向量、集合等).在每一阶段k的每一状态x_,都有一个决策
集合Q_k(_k)，在Q_k(_k)中选定一个决策$q_k∈Q_k(_{2)，状态x{k就转移到新的状态
$x_+1}=}_k（_k，qk)，并且得到效益R_{k_k，qk).我们的目的就是在每}个阶段都在它
的决策集合中选择一个决策，使所有阶段的总效益∑R_{}_{}，q_{k)达到最优.我们
1
称之为多阶段决策问题.
一个多阶段决策问题包括阶段数、状态变量、决策变量、状态转移方程和目
标函数等基本要素,描述一个多阶段决策问题就要从以上基本要素人手,只要这
些基本要素刻画清楚了，整个决策问题就明了了.下面以多阶段资源分配问题为
例说明如何确定一个多阶段决策问题.
对于多阶段资源分配问题,其阶段数就是其投资进行的阶段个数,具体在例
161

============================================================
第 180 页
============================================================

4.1.2中就是5.在每个阶段开始就必须已知,且直接影响本阶段决策的因素就是
每个阶段开始时所有的资源量，所以每阶段的状态变量就是对应的开始时的资
源量，记为x{_,k=1，2，…$，n.
对于例4.1.2就是每年开始时可利用的机器台数x_，k=1，2，，5.而每期的
决策变量就是资源在两种生产方式上的使用量.由于两种生产方式使用资源量
之和等于可利用资源总量，因而只需确定第一种生产方式使用的资源数量即可，
所以每阶段的决策变量就是每阶段安排第一种生产方式使用的资源量,对于
例4.1.2就是每年开始时安排A部门使用的机器台数，设为y_{k}，k=1,2，…，5.
当确定了每期开始时可利用资源量及A部门使用的资源量后,就可以计算
出期末回收(或可利用)的资源量,例4.1.2中每年的期末保持完好的机器数为
(x,-yk)×0.4+y,×0.8，k=1,2， ·,5
显然,第k期末保持完好的机器数就是第k+1期可利用的机器数,即
xk+1=（x-y）×0.4+y,×0.8，k=1,2，·，4
这就是该问题的状态转移方程.
同时每阶段的收益是两种生产方式收益之和,总收益是每阶段收益之和,在
例4.1.2中总收益为
5
∑[y+2（x₁-yk）)²]
=
这就是总的目标函数.
不同问题的要素不尽相同,根据要素的差异,多阶段决策问题可以分成不同
类型：
(1) 根据阶段数可分为：
有限阶段决策问题,其阶段数为有限值；
无限阶段决策问题,其阶段数为无穷大,决策过程可无限持续下去.
（2）根据变量取值情况可分为：
连续多阶段决策问题,决策变量和状态变量取连续变化的实数；
离散多阶段决策问题,决策变量和状态变量取有限的数值.
(3)根据阶段个数是否明确可分为：
定期多阶段决策问题,其阶段数是明确的,不受决策的影响；
不定期多阶段决策问题,其阶段数是不确定的,不同的决策下阶段数不同.
(4)根据参数取值情况可分为：
确定多阶段决策问题,其参数是给定的常数；
不确定多阶段决策问题,其参数中包含不确定因素,如随机参数,区间取值
参数等.
162

============================================================
第 181 页
============================================================

本章下面着重介绍确定有限多阶段决策问题.
4.2最优化原理
许多优化问题既可以写成一般线性(或非线性)规划模型，又可以看成是多
阶段决策问题,这类问题的线性(或非线性)规划模型往往变量或约束很多,用
前几章讲过的方法求解很麻烦.例如第二章介绍的旅游售货员问题,虽然可以写
成整数线性规划,但用整数规划方法求解并不合适.因而必须针对多阶段决策问
题的特点,考虑好的求解方法.本节首先以最短路问题为例介绍递推方法,然后
给出动态规划的最优化原理.
1.用递推法解最短路问题
现在我们来讨论图4.2.1 所表示的网络.联结各点的线段上的数字表示它们
之间的弧长.我们从A。出发要走到目的地A_{，问经过哪些点，走什么路线使总路
程最短.
$A{2}$
2
6
$A_{A
2
3
8
3
$A_{{}$
A
3
2
5
A_s
5
6
$B_{2}$
5
4
5
$B_{3}$
1
$B_4}$
$A_{6}$
3
2
$C_{2}$
2
3
8
7
3
3
$Bs}$
B
16
8
$C_{3}$
4
3
6
6
D2}$
CA}$
图4.2.1
由上图可知从$A_{。到A_{。的最短路第一步要么到A_{1}，要么到B_{}，然后由A_{₁}(或
B_{1})到A_{}，而且必然沿着A_{₁(或B_{})到A_{。$的最短路走，因而如果知道A{}和B_{1}到
A_{6的最短路，然后分别加上A_{0A_{}和A_{0}B_{1就得到两条从A{0到A_{。的路，其中长度
小的就是从A_{。到A_{。$的最短路，由于A_{0到A{。$的每条路含6条边，A_{}和B{}到A_{}$
的路有5条边，分别说它们到A_{。$的最短路长度为f_。(A_{0)，f_(A_{1})和$f_{}(B_{1})，则显
然有：
f（A₀）=mind（A0，A₁）+（A₁），d（A₀，B₁）+（B₁）
所以要求$f_{(A_{0)$的关键是求$f_{}(A_{1})和$f_{}(B_{1})，即找出A_{1}和B_{}到A_{$的最短路.
从A_{}到A_{$的最短路要么$到$A{2}，要么$到$$B_{2$或先到$C_{2}，然后再由$$A_{2}(}或
$B{2}$或$_{2})$$沿最短路到A_{.}由于$A_{2}B_{2$和$C_{2到A_{$的路有4}边，记它们到A_{$的最
163

============================================================
第 182 页
============================================================

短路长度分别为f_{（A_₂2)，f_（B_2)f_₂（C_2)，则有
f（A₁）=mind（A₁，A2）+f₄（A₂），d（A₁，B2）+f₄（B₂2），d（A₁，C₂）+f（C₂）
同理，
f（B₁）=mind（B₁,B₂）+（B₂），d（B₁,2）+f₄（C₂），d（B₁，D₂）+f₄（D₂）}
依此类推，
f（A₂）=min{d（A₂，A₃）+₃（A₃），d（A₂，B₃）+₃（B₃3）I
f₄（B₂2）=mind（B₂，A₃）+₃3（A₃），d（B₂，B₃）+f₃（B₃）}
f（C2）=mind（C₂,B₃）+₃（B₃3），d（C₂2，C₃）+f₃（C₃）
f（D₂2）=min{d（D₂,B₃3）+₃（B₃），d（D₂，C₃）+f₃（C₃3）}
f₃（A₃）=mind（A₃，A₄）+₂（A₄），d（A₃,B）+₂（B）}
f₃（B3）=mind（B₃，B4）+f₂（B₄），d（B₃,4）+₂（C₄）}
f₃（C₃）=mind（C₃，B₄）+₂（B），d（C₃，C₄）+f₂（C₄）}
f₂（A₄）=mind（A₄,A）+f₁（A₂），d（A₄,B₂）+f₁（B₂）}
f₂（B4）=mind（B₄，A₃）+f₁（A₂），d（B4,B）+f₁（B）}
f₂（C₄）=mind（C₄，A₂）+f₁（A₂），d（C,B₃）+f（C₂）}
显然从A_{₂到A_{₀$的最短路就是弧A_{A_{}，所以
f₁（A₂）=d（A₂，A6）=4
同理f_（B₂₃）=d(（B_₂，A{)=3.
其中$f{(i)表示从i点经过k条边到A_{。的最短路长度.
由于f_₁（A_{₂)和f_(B_₂)已知，所以
f₂（A₄）=mind（A₄，A₂）+₁（A₂），（A₄,B）+f₁（B₃）}
=min{3+4,5+3}=7
这说明由$A{4}至终点$A_{。$的最短路程是7，其最短路线是A_{₄}→A_₂}→A_{}$x_₂2}A_{₄2)=A_.
如果从B_{4}出发，则
f₂（B4）=mind（B₄，A₂）+f₁（A₂），d（B₄，B）+f₁（B₃）}
=min{5+4,2+3}=5
$x_{2}(B_{2})=B_{₂，最短路线是B{4→B{→A_{6}，最短路程是5.同理我们可得
f₂2(C4）=mind（C₄，A₃）+₁（A₃），d（C₄，B）+fB₃）
=min{6+46+3|=9
$x_{₂2}C_{42}}=B_{，最短路线是$C_{4→B_{→A_{6}，最短路程 9$$
现在讨论n=3$的情况，我们分别以A_{3}，B_{3，C_{3为出发点来计算.
f₃3（A₃3）=mind（A₃，A）+（A₄），d（A₃3，B4）+2B）
164

============================================================
第 183 页
============================================================

= min{2 +7,2 +5} = 7
$x3(A_3)=B}，最短路线是A_3→B→B→A_{6}，最短路程是7.
上式表示由$$A_{3}$出发有两种选择:到A_{}$或B_{}如果选A_{}，$那么到达$$A_{4}以后，
一定要走A_{4}到A_{6$的最短路线；如果这$步选B_{}，那么到达B{4}以后，$定走B{4
到A_。的最短路线.所以$A_{3→A_{6$的最短路线就是这两条中较短的一条.同理
₃（B₃）=mind（B₃,B）+₂（B），d（B₃，₄）+₂（C）
=min{1+5,2+9}=6
$x_3}(B_3})=B_{₄，最短路线是B_3→B_{→B→A_{6}，最短路程是6.
f₃（C3）=mind（C₃,B）+₂（B），d（C₃，C₄）+₂（C₄）
=min|3+5,3+9}=8
$x_3}(C_3})=B{，最短路线 $C_3→B_4→B→A_{6，最短路程 8.$
n=4的情况完全类似，我们可以得到
f₄（A₂）=mind（A₂，A₃）+f₃（A₃），d（A₂，B₃）+f3（B₃）}
= min{6+7,8+6}=13
$x_{4}(}A{2}=A3}，同理
$f_{2}B{2})}}1
$x4}B{2)=A_3}$
$f_{4}_2})}=9,
x4C2)）=B3$
$f_{4}} {2)}=1
x(D2）=C3$
当n=5时，有A_{}B_{}两点，在A_{}处有3个决策A_₂2，B_{2}，C_{}供选择，如果选择
$A_{2}，那么从$A_{2}出发-定是走由A_{2}到A_{6$的最短路线；同样，如果选B_{2}，那么从B_{2}$
点以后一定是走由B_{到A_。的最短路线；选C_{2点也是如此，所以只要在这三条
路线中选一条最短路线，就是A，到A。的最短路线.
_（A₁）=mind（A₁，A₂）+₄（A₂2），d（A₁,B₂）+f（B₂），d（A₁，C₂）+f₄（C₂）}
=min{2+13,3+10.6+9}=13
$x(A_₁1)=B_₂2，最短路线是A_₁→B2→A_3→B→B_₂→A_{6，同样
f（B₁）=min|d（B₁,B2）+₄（B2），d（B₁，₂2）+₄（C₂），d（B₁，D₂）+f₄（D₂）}
=min{8+10,7+9,16 +12|=16
$x_（B_₁)=C_₂2，最短路线是B₁→C_₂→B3→B→B_→A_{6
当n=6时，出发点只有一个A_{点，有两种选择，因此
f（A0）=mind（A₀，A₁）+₃（A₁），d（A0,B₁）+（B₁）
=min{5 +13,3 +16}=18
$x_{(A_{0）=A{$.
至此，图$4.2.1$的短路线}经求得，为A_{0→A_1→B_{2}→A_3}→B_4→B_{5tA_{6}$
165

============================================================
第 184 页
============================================================

从上面的计算过程中,我们可以看出，在求解的各个阶段,我们利用了n阶
段的最优值与n-1阶段的最优值之间的如下关系：
f（s）=min|d（s，x（s））+fn-₁（x（s））}，n=2，3，·,6
$x_)
$f_{(s)=d(s,A{)
对于一般的多阶段决策问题同样可以得到这种递推关系式，
设$f_{n{k+}1}(x_{k})表示第k个阶段的状态为xk}经过n-k+1个阶段的最优目标函
数值,则有
$fn-k+1（xk）=minRk（x2，gk）)+k（Tk（xk}，qk）
9k∈Q_k(xk)
:
$f₁（x{）=minRn（xnqn）
$9_{n∈Q{n（x{
根据该递推关系，从后面开始分别求出f{₁}（x_n)$_{2}（_n-1），…，f_{n}（x_₁1})，其中f{n（_1)就
是该多阶段决策问题的最优目标函数值.
利用这种递推关系式求解多阶段决策问题的方法我们称为动态规划方法，
这种递推关系是根据动态规划的最优化原理推导出来的,下面我们来叙述什么
是最优化原理.
2.最优化原理
从多阶段决策问题的数学模型可以看到，一个多阶段决策过程的极值函数
可以看做是过程的初始状态与阶段数目的函数.任意给定一个决策序列（或称为
策略)，如果是最优的,那么从任何最后k阶段开始,对由这个策略形成的后面k
阶段的初始状态组成的k阶段问题而言这个策略的后面k个决策一定是这个k
阶段问题的最优策略,与这k阶段以前的决策无关.这个必要条件是很显然的.这
样，动态规划的最优化原理可叙述如下：
动态规划最优化原理
一个过程的最优策略具有这样的性质，即无论其初始状态及其初始决策如
何,其以后诸决策对以第一个决策所形成的状态作为初始状态而言，必须构成最
优策略.
现在,我们来讨论多阶段资源分配问题的递推关系式.系统的状态用拥有资
源的数量x{k表示，在每个阶段k的每个状态x_{k}，都有一个决策集合[0_，_{k}]，选定一
个决策y_k∈[0_，xk]}，就是取y_{k从事A生产，x}-y_{k从事B生产，这样就转移到新的
状态xk+1=ayk+b（x_-y{2），x+1是下-阶段的资源量，效益为g（y_2)+h(x_-_k），我们
的目的是选择一系列决策y_{₁}，…_，_-{1}，使每一个阶段的效益合起来达到最大.利
用最优化原理来列出递推公式.
166

============================================================
第 185 页
============================================================

令$f_k}(x)表示开始有资源x，再进行$k个阶段生产并采取最优分配策略后得
到的最大总收入.当k=1时，f{}(x)=maxg(y)+h}(x-y)}，当k=2时，于前一
$0≤y≤x
个阶段分别以y，x-y投人A、B，生产以后可以回收x_{=ay+b(x-y)作为下$阶段
开始时可以投入生产的资源数量，若采取最优方式投入生产，由最优化原理，后
一个阶段的收人是$f_{}(_{})，所以
$f₂(（x)=max|g（y）+h(x-y)+f₁（ay+b(x-y))
0≤y≤
对任意的k,2k≤n,同样的分析可得
$fk(x)=maxg(y)+h(x-y)+fk-₁(ay+b(x-y))}
$0≤y≤x
因此，我们得到递推关系式如下：
$f₁(x)=maxg(y)+h(x-y)}
$0≤y≤x
$f(x）=maxg（y)+h(x-y)+f-1（ay+b(x-y)）)1，k≥2
0≤y≤x
上面所述的递推关系是用动态规划的最优化原理得到的,对最优化原理可
以作这样的直观解释：
在图4.2.2中，如果路线Ⅰ-Ⅱ是从A到C的最优路线,那么路线Ⅱ一定是
从B到C的最优路线，这是很容易用反证法来证明的.如果Ⅱ不是从B到C的
最优路线，Ⅱ'是比Ⅱ好的从B到C的路线，那么I-Ⅱ就是比Ⅰ-Ⅱ更好地从A
到C的路线,这与I-Ⅱ是最优路线矛盾.
B
I
II
C
A
I'
II'
图4.2.2
很容易想到，如果I-Ⅱ是A到C的最优路线，那么Ⅰ就是A到B的最优路
线.如果存在A到B的更好的路线I{，显然I'-Ⅱ将是比Ⅰ-Ⅱ更好的A到C的
路线,这与假设矛盾.
所以最优化原理也应该包括下述性质：
对于多阶段决策问题的最优策略,如果用它的前i步策略产生的情况(加上
原有的约束条件)来形成一个前i步问题,那么所给最优策略的前i阶段的策略
构成这前i步问题的一个最优策略.
有的书上称上述性质为前向最优化原理,而称前面所述的性质为后向最优
化原理,我们都统称为最优化原理.现在我们利用前向最优化原理来找例4.1.3
167

============================================================
第 186 页
============================================================

生产和存储问题的递推公式.
如果一开始的存储量u_。已经给定，要求最后一个周期结束时有存储量u_，
那么最优生产和存储费用就完全由u_{0}，u_{n}决定了.对某一个周期k，如果这个周
期开始时有库存量$u_{k_{1}，要求结束时有库存量$u_k，那么它的生产数量x_{k}=_+
$u_}-}u_{k}-_1}，$_$是这个周期的商品需求量，所以它的生产和存储费用为$f({_{）+
16u_k{1}，其中
i100xx,
0≤x≤15
$f(x)=$
120x- 300,
15 <x≤ 30
用_{（u_，u_)表示开始的存储量为u_{0}，第k个周期结束时存储量为u_{的满
足前k个周期需要的前k个周期的最优生产和存储费用，由最优化原理
Fk（u0，uk）=mink-₁（u0，uk-1）+f（x₁）+16uk-₁
$"-1=0$
xk=sk+u-uk-1，k=2，3，…，6
F₁（u_0，u₁1）=f（x1)）+1u0$
x₁=s₁1+u₁-u0$
令k=2,3，…，6，求出F_{(u_，u_{₀)，就得到问题的解.
由上面的分析可知用动态规划方法求解多阶段决策问题的一般步骤为：
第1步
明确问题,找出阶段数；
第2步
确定变量,找出状态变量和决策变量；
第3步
找出状态转移方程；
第4步
写出递推关系式；
第5步
求解递推关系式.
在这些步骤中关键是写出递推关系式，而难点则是求解递推关系式，不同的
问题递推关系式不同，求解递推关系式的方法也不同.所以动态规划不像线性规
划或整数规划那样有固定的算法,动态规划只是提供了求解多阶段决策问题的
思路，具体的算法要根据问题的特点去设计，下面将分别介绍运用动态规划求解
几类问题的方法.
4.3确定性的定期多阶段决策问题
这一节将讨论几类确定性的阶段数给定的多阶段决策问题,包括决策集合
是有限的或者无限的，利用最优化原理找出它们的递推公式，并且给出解法.
168

============================================================
第 187 页
============================================================

1.旅行售货员问题
旅行售货员问题是图论中的一个著名问题,就是在网络N上找一条从v。点
出发，经过$v_1}_2}，}，v_n各一次最后返回_0的最短路线和最短路程.现把它看成
一个多阶段决策问题.从。出发,经过n个阶段,每个阶段的决策是选择下一个
点.如果用所在的位置来表示状态,那么状态与阶段数就不能完全决定决策集合
了,因为走过的点不需要再走,所以决策集合与以前选的决策有关.用(_{,V)表
示状态，;是所处的点，V是还没有经过的点集合.在状态(_{，V)的决策集合V
中，取决策v{;∈V，获得的效益是{到_,$的距离d_{，转入下$个状态(_₁，V\{_,})
现在用最优化原理来找递推公式.
用$f_{}(_{}，V)表示从v;点出发，经过V中的点各一次，最后回到_0点的最短路
程，V是一个顶点集合，lVl=k，d_是v{到v;的弧长，则
f（v₁,V）=min{d+fk-₁1（v₁,V|v,}）}，k=1,2，·，n
"j∈V
(4.3.1)
$f_{(_₁}，）=d
例4.3.1对图4.3.1，求出从v_{出发，经过v_{}，_₃3，v{4各一次，又返回到_}的
最短路线和最短路程.也可以用一个矩阵表示v;到v;的距离，矩阵D的每一个
元素为$d{.
7
6
v
9
8
6
$v_{}$
7
S
DA
6
5
8
8
$v_{3}$
5
图4.3.1
0
8
5
6
6
0
8
5
D =
L
9
0
5
9
7
8
0
$f_₃(_{₁}，v_2}，_₃}，_4})表示从_{₁出发，经过_{₂}，_₃}，4$各-次，最后回到_{1的最短
路程,则利用(4.3.1)式,得到
$_₃3(v{1}，v2}，v3}，v4})
169

============================================================
第 188 页
============================================================

=mind₁₂+f（v₂，₃，v₄），d₁₃+f₂（v₃，₂，v}），d₁4+f₂（v，v2，v₃|）
同样
$f₂（v₂，v₃，v₄）=mind₂₃+f₁（v₃，|），2+f₁（v₄，v₃31）1
现在先从最后一个阶段解起：
$_{(v2}，})=d21}=$
$f_{0(v₃2，)=d31}=7$
$f_{(v₄}，)=41}=9
以上分别是从$v_{2}，v_₃3}，_{4直接到v_{1$的距离.
$f₁（v₂，v₃3|）=d₂3+f0（v₃3，）=8+7=15
$f（v₂，v₄|）=24+f₀（v₄，)）=5+9=14
f（v₃3，v₂21）=d₃2+f₀（v₂，）=9+6=15
f₁（v₃，v₄1）=d₃₄+0（v₄，）=5+9=14
f₁（v₄，₂}）=₄₂2+f_（v₂，）=7+6=13
f₁（v₄，v₃1）=d₄3+f₀（v₃，）=8+7=15
进一步求
$_2（v2，v₃，v₄）=mind₂3+f₁（v₃，{v|），d₂₄+f₁（v₄，v₃3}）}
=min{8+145+15}=20，x{2(v_2)=v4
f₂（v₃，|v₂，v₄）=mind₃₂2+f₁（v₂，v₄}），d₃+f₁（v₄，₂）
=min{9+145+13=18，x2(v3）=4
f₂（v₄，v₂，3）=mind₄₂2+f₁（v₂，v₃3|），d4₃+f₁（v₃3，v₂}）}
=min{7+15,8+15|=22，x2(v₄)=v
最后求
$_₃3（v1}，}}v2，v3}，v}）$
=mind₁₂+₂（v₂，₃，v₄}），₁₃+₂（v₃，v2，v₄），d₁₄+₂（v₄，v，3}）
=min{8+20,5+18,6+22}=23,
$x3（v1）=v3}$
最优路线为$v_{₁→v_₃3→v_{₄4→v_2→v_{1}，路程长为23$
这个例子与4.1的最短路问题中每一个阶段的决策个数都是有限的.这
时，可以利用递推公式把所有的f_{($x)以及所有可能的状态x都求出来，从而得
到最优解.
现在来估计用动态规划方法找旅行售货员问题的算法复杂性.为了计算
$fn（v_{，V)），需要计算f₂（v₁，)）_₁（v₁，V），，f_₁（v₁，V），共有n个_（_₁，），
170

============================================================
第 189 页
============================================================

n-
个f，（₁，V），…，n（n
$n-1$
n
个f_（_₁，V)，…，n
个f_{1}(_{₁}，V).而计算
k
$n-1$
$_{}{_{}，V)共需要k次加法，k-1次比较运算，计算$_{n}（_0，V)共需要n次加法运算，
$n-1$
n-1次比较运算.因此加法运算的次数总和为T=n+
∑
k·n.
n
.因为
$k }0$
2
n-1
(n-1）（1+x）⁻²=[（1+x）}]=∑
n
k=0
k
$n-1$
∑h
n-
1
=
k-1
x}$
k
k=1
取x=1就得到
$n-l
=（n-1)2^-}$
∑
k
k
k=
所以加法次数
T=n+n(n-1)2^-
再计算比较运算次数
"-1
S=(2n-1)+∑n(k-1)
1
k
用类似的方法可求出$S=(2{n-1)+n(n-2)2^2}$无论加法次数T还是比较运算次
数S都是n的指数函数,不是多项式算法.但是它比穷举法还是要好.如果用穷举
法，从v_{经过v_{₁}，_}，…，{n，再回到_0，共有n！条不同的路线，计算每条路线要作
n+1次加法,所以总共要作（n+1)n！次加法运算，再作n！-1次比较运算，才能
找到最短路线.显然,动态规划方法要比穷举法好得多.
2.多阶段资源分配问题
在每个阶段的决策集合不是有限的情况下，用最优化原理得到的递推公式
就不能用上述方法把所有的f(x)都解出来，逐个比较，而要用其他方法来解.一
般说来,没有统一的解法.现在来讨论有限资源分配问题，它的递推公式是这
样的：
f(x)=maxg(y)+h(x-y)+fk-₁1(ay+b(x-y))|，k≥2
0≤y≤x
$f{₁(x)=maxg(y)+h(x-y)}
0≤y≤x
在一般情况下，g(y)，h(y)是很复杂的函数时,这个问题的解不容易找.当
g(y)，h(y)为凸函数，且h(0)=g(0)=0时，可以证明在每个阶段上y的最优决
策总是取其端点的值.
171

============================================================
第 190 页
============================================================

引理4.3.1设g(y)，h(y)是凸函数，则对任何固定的x，F(y)=g(y)+
$h(x-y)是y的凸函数.
证$只需证明对任何aα₁1}≥0，a_{2≥0，$α_{1+2=1与$y_₁}，y_{2都有
F（α₁y₁+α₂y₂2）≤α₁F（y₁）+α₂F（₂）
由g(y)，h(y)的凸性，可得
F（α₁y₁+α₂₂）=g（α₁y₁+α₂y₂2）+h（x-（α₁y₁+₂₂）)
=g（α₁1y₁+α₂y2）+h（α₁（x-y₁1）+α₂（x-y₂2）)
≤α₁g（y₁1）+α₂2g（y₂2）+α₁h（x-₁1）+_₂h（x-₂)
=α₁F（y₁）+α₂2F（y₂)
所以F(y)是y的凸函数.
一
引理4.3.2设F_{₁}(x)，_2}(x)是x$的凸函数，则
F(x）=maxF₁（x），F₂（x)}
也是x的凸函数.
证设α_1}≥0，a_{2≥0，a{₁+a2=1，若x_₁}，x_{2$是F（x)的定义域中任意两个
点,则有
F（α₁x₁+α₂x₂2）=maxF₁（α₁x₁+α₂₂），F2（α₁x₁+α₂x₂2）}
≤maxα₁F₁（x₁）+α₂F₁（x₂），α₁F₂（x₁）+α₂F2（x₂）}
≤α₁maxF₁（x₁），F₂（x₁）+α₂2maxF₁（x₂2），F₂（x₂）}
=α₁F（x₁1）+α₂F（x₂)
所以F(x)也是x的凸函数1$
定理4.3.1设g(y)，h(y)是凸函数，且h(0)=g(0)=0，则n阶段资源分
配问题的最优策略y在每个阶段总取0≤y≤x的端点的值,并且
$f（x）=max|h（x)+fk-₁（bx），g（x）+fk-₁（ax)}
$f{(x)=maxh(x),g(x)}
证因为，f{(x)=maxg(y)+h(x-y)|，由引理4.3.1知道，g(y)+h(x-y)
0≤y≤x
对固定的x为凸函数，其极大值一定在y=0或y=x点上达到，所以
$f₁(x)=maxlg(x)+h(x-x)，g(0)+h(x-0)}
=maxlg(x)，h(x)1
由引理4.3.2可知，$_{₁}(x)是x$的凸函数，易证$f{₁}(ay+b(x-y))也是y$的凸函数，
所以
$f₂(x)）=max|g（y）+h(x-y)+f₁（ay+b(x-y）)}
$0≤y≤x
=maxh(x)+f₁(bx)，g(x)+f(ax）}
172

============================================================
第 191 页
============================================================

$f_{₂2}x)也是x$的凸函数，用归纳法可得
f_（x）=maxh（x)+fn-₁（bx），g(（x）+f-1(（ax)）
1
例4.3.2在有限资源分配问题中，$g(x)=-2cx+x^{2}，h(x)=-cx+x^{2(0≤
x≤c)，0<a，b<1，而且0<b-a≤1-b.求f_{(x).
解显然g(x)和h(x)都是凸函数.
$f₁(x)=max-2cx+x2，-cx+x^{2}=-cx+x{2
$₂（x)=max-2cx+x²-cax+a2x，-cx+x²-cbx+bx²}
=max}(a{²2+1)x²-c(a+2)x，(b^²2+1)x²2-c(1+b)x}
=-c(1+b)x+(b^{²+1)x2
$f3（x)=max-2cx+x2-c（1+b)ax+（b^²2+1)a{2x^{2，
-cx+x{2-c(1+b)bx+(b^²+1)b{2x^{2}
=max{-c[（1+b)a+2]x+[(b^²+1)a^²2+1]x2，
-c[（1+b)b+1]x+[（b^²+1)）b^²+1]x2}
=-c(1+b+b^2)x+(（1+b^2+b)x
应用数学归纳法，可得
$c(1-b^{$
$1 -$b^{}$
$f_{}$
x+
1-b
$1 - b^{}$
2
例4.3.3在有限资源分配问题中，设g(y)=cy，h(y)=dy，并且c>d>0,
0<a<b<1，求fk（x)，k=1，2，…，n及最优策略y，y_{₁}，，y_{n-1°
解已知c-d>0$，若存在$1≤s≤n-2$,使
c-d≥c(1+a+…+a^1)(b-a)
(4.3.2)
(4.3.3)
c-d<c(1+a+.+a{)(b-a)
则由定理4.3.1及(4.3.2)式
$f₁(x)=max|cx,dx}=cx,
γ_{-1x{$
$f{2(x)）=maxcx+cax,dx+cbx|=c(1+a)x,
y_{n-2=x{n}-22$
f₁+₁（x）=maxcx+c（1+a+·+a)ax，dx+c（1+a++a）bx}
=c(1+a+·+a^）x，y_n--1={--1
由(4.3.3)式
$f₁+2(x)=max|cx+c（1+a+…+a)ax，dx+c(1+a+…+a)bx}
=[d+c(1+a+·+a2)b]x,
$γ_{n-s2}= $
173

============================================================
第 192 页
============================================================

$f（x）=[d（1+b+…+b-²²）+c（1+a+…+a)）b]x，y=0
若c-d<c（b-a），则yn-=1，y-2=…=y₁=y=0若c-d≥c（1+a+…+a-²）（b-a），
则y-1=n-1，yn-2=-2，，y₁=x₁，=x
3.可靠性问题
某种机器的工作系统由n个部件组成，如图4.3.2所示,这些部件是串联关
系，只要其中任一部件失灵,整个系统也就不能正常工作.
部件1
部件2
部件n
图4.3.2
假设部件i(i=12，，n)的正常工作与否取决于其中主要元件.而主要元
件失灵的概率又相当大.为了提高系统工作的可靠性,在每个部件上装有主要元
件的备用件,并且设计了这样的装置,使正常工作的元件一旦失灵，备用元件能
自动顶替原来工作的元件工作，这样各部件中装上的备用元件越多，整个系统维
持正常工作的可靠性也就越大.但另一方面，备用元件装多了，系统的成本、重
量、容积等就会增加.于是,出现了这样的问题,如何在考虑到上述各种因素的限
制条件下,选择各部件的备用元件的数目，使整个系统的可靠性达到最大.
设在部件i(i=1，2，…，n)上装有z；个备用元件时，它正常工作的概率为
$p{}(_{1)，于是系统正常工作的概率为
n
p= ∏p{_
=1
部件i装一个备用元件的费用为c_{,要求总费用不得超过c,求使p达到最
大的z，的选取方法,这问题的非线性规划形式是
n
max
p=∏pi(_）
=$
n
∑c_{_{≤c
s.t.
=
z_{}≥0，且为整数，i=1,2，.,n
这类问题也可以用最优化原理找它的递推公式.
用$f_{}{x)表示有k}个部件总费用不超过x$的最优可靠性，则
f_（x）=maxpk（z₁)f-1（x-c2k），k=2，3，,n
${ 0$
$z_{为整数$
f_(x) p,(])
174

============================================================
第 193 页
============================================================

例4.3.4已知x₁+x₂+…+xn=C，c>0，x₁≥0，i=1，2，…，n.求z=
$x_{1x_{2·x{n}$的最$大值.
解用递推公式，设
$f（x）=maxx₁x₂·xk｜x₁+x₂+·+xk=x，
x{≥0,i=1,2, .,k
则
f{(x)）=maxxk·fk-1（x-xk），k=2，,n
$0≤xk≤x
$_1}(x）=x$
$f₂(x)=maxx₂2·f₁(x-x₂)
0≤x2≤x
2
=max x_{2(x-x{2})=
x
x
$x_{2}$
$0≤x{2$
2
$f_₃(x)=maxx₃3·f2}（x-x3)
$0≤x3≤x
$x-x{3$
2
x
3
x
= max x_3$
=
$x_{3}$
2
3
3
$0≤x3≤x$
$f{n（x）=maxxnfn-₁（x-xn)
$0≤x{}≤x$
$x-x{n$
n-1
n
x
=maxx
Ⅱ
$x_n}$
x{≥00$
n
n-1
n
所以$f_n(c{)=)$
n
n
现在再来求最优解.
第一阶段,状态变量$x= c{,最优解$x_{n}=$
C
n
c
(n-1)c
第二阶段，状态变量x= c-
,最优解
n
n
x
1
(n -1 )c
C
$x_{1}1$
二
n-1
$n-1
n
n
(n-2)c
C
C
第三阶段,状态变量
x= \c
,最优解
一
n
n
n
x
1
(n-2)c
C
$x_n}2$
$n-2$
$n-2$
n
n
17

============================================================
第 194 页
============================================================

最后阶段，状态变量x = c-
n
C
C
C
,最优解
u
n
n.
n
C
x_{1}x =$
n
所以最优解是
C
C
C
1
,最优值是
n
n
[
n
n
例4.3.5
某工厂生产3种产品,各产品每件的重量与利润见下表.现将此3
种产品运往市场出售，运输能力(总重量)不超过6吨,问如何安排运输使总利
润最大.
种类
一
C
x
重量/吨
C
x
C
利润/百元
80
130
180
解设3种产品分别运输x_{1}，{x_{2}，x_{3}件，得模型为
80x₁+130x2+180x3
max
2x₁+3x₂2+4x₃3≤6
s.t.
x_{≥0,且为整数，i=1,2,3
下面用动态规划方法求解，设$f(s{2)为载重量$sk时，采取最优决策装载第1
种至第k种货物所得的最大利润.
$_{3}}6)=$
{180$x_{3+
max
max
(80x₁+130x₂2)}
2x₁+3x₂+4x3≤6
2x₁+3x2≤6-4x3
x12，x3≥0，且为整数
x{1，{2≥=0$.且为整数
max
{180x₃3+f2(6-4x₃3）}
=
2x₁1+3x₂2+4x3≤6
x1，x2.x3≥0$.且为整数
=max{_2}(6),180+$f{2}(2)}
而
$f_{2}}6)=
80x{,+130x2}
max
$2x1}+3x{2}≤66
x1，x{2}≥=0$.且为整数
|130x₂2+f(6-3x{2)
=
max
$2x{1≤6-3x2
x{1x2≥0.且为整数
=max{f,(6),130+f(3),260+f,(0)}
$f_{2}}2)=
80x,+130x2}
max
$2x₁1}+3x2}≤22$
x1，x2≥0.且为整数
{130x₂+f₁（2-3x₂2)}
二
max
2x{1≤2-3x2
$x{1，{2}≥0，且为整数
176

============================================================
第 195 页
============================================================

=fs2)
而由$f_₁}(w)=$
{80x{}=80
$\or{}$
max
知
$2x_{_1≤$
$\fa}$
x{1≥0，且为整数
f(6)=80×3=240,f(3）=80,（2)=80，f(0)=0
故f₂（2）=80，₂（6）=260,（6）=260.
所以最优方案有两个：(x_{₁}，x₂}，x₃3)=(02，0)或(1，0，1).
4.4确定性的不定期多阶段决策问题
有的多阶段决策过程，给定一个状态集合X{，当状态$x∈X{}$时，过程停止，
这是阶段数不确定的多阶段决策过程.如果经过有限阶段,状态χ一定能进人
X{，就是阶段数有限,否则就是阶段数无限.这类问题通常利用最优化原理得到
一个函数方程来求解.
1.最优线路问题
4.2已经讨论了最优路线问题的一种类型,现在讨论另一种类型的最优路
线问题.给定N个点p_{}(i=1，2$，.，N)组成集合{p{}|，由集合中任一点p_{}到另$
点_{}$的距离用c_{表示，如果p{i到p{}没有弧联结，则规定$c_{=+∞，又规定c_=$
0(1≤i≤$N)，指定一个终点p{n，要求从p{点出发到p_{x的最短路线.这与4.2讲
的最优路线问题的不同点是阶段数不定,是个不定期多阶段决策问题.用所在的
点_{i}表示状态，决策集合就是除p{以外的点，选定一个点p_{以后，得到效益_{并
转入新状态p，当状态是p{时,过程停止.
定义f(i)是由p;点出发至终点p{n的最短路程，由最优化原理可得
[f(i)= min|c,+f(j)},i=1,2,…,N-1
j
(4.4.1)
$f(N)= 0$
$f(i)是定义在p_{₁}，_{₂}，，P{上的函数，所以(4.4.1)是个函数方程，不是4.2所
列出来的递推公式.
下面介绍两种迭代法来解这个函数方程.
（1）函数空间迭代法
作初始函数f_(i)，i=1,2，…，N.
f₁(i)= cin,i=1,2,…,N-1
(4.4.2)
$$_₁}(N)=0$
177

============================================================
第 196 页
============================================================

然后用下列递推关系求{f(i)}.
f（i)=min|+f₁(j）|，i=1,2，.,N-1
i
(4.4.3)
fkN)=0
这里f_k}(i)实际上表示由$_{;点出发至多经过k个点到达$p{n的最短路程(如果经
过k个点，还不能到达$p{n点，则$f($i)=+∞).
定理4.4.1由(4.4.2)，(4.4.3)确定的函数列{f_(i)单调下降收敛于
f(i),f(i)是函数方程(4.4.1)的解.
证
f（i)=min+fk-₁(j）}≤c+fk-₁（i），1≤i≤N，k=2,3，.
所以{_(i)是单调下降序列，因为c{≥0，所以fk（i)≥0，有下界，从而{f_{（(i)}有
极限,设极限为f(i).
现在来证明f(i)是(4.4.1)的解.
由于$f(i)只有有限个，故存在$k_{0}，使得对任意的ε>0，当k≥k_{0时，对所有i
都有
$|fk(i)-f(i)|<ε
一致成立，即-ε+f_(i)<f(i)<ε+f(i)，所以
f（i）<ε+fk+₁（i）=ε+minc₁+fk(j）}
≤ε+minc₁+f（j）+ε
=min|+f(j）|+2ε
j
f(i)>fk+₁（i)-ε=minc+f(j）-ε
≥min{c₁+f(j)-ε}-ε
=min{c₁+f(j)]-2ε
j
这就证明了$f(i)=min|c_{+f(j)}.
I
j
(2)策略空间迭代法
一个策略{_s(i)就是给定在点p;时，选定下一步的位置是s(i).
给定初始策略s_0（i）}，{0（i）|是一个无回路的策略.无回路的策略就是不
存在这样的回路：
i1→i₂=s0（i1）→i3=s0（i2）→→i₁=s0（i)
在此策略下作方程组：
f（i）=is0(i)+f₀（s（i）），i=1，2，…，N-1
(4.4.4)
f_{0(N)=0$
178

============================================================
第 197 页
============================================================

解出$f_{(1)$_。(2)，_0(N-1)，由于s_0(i)是无回路的初始策略，可以证明方
程组(4.4.4)有唯一解.解出$f_{。(i)以后，求
min{c+f。(j)}，i=1,2,…,N-1
设minc_+f₀（j）}=c₁+f（i₁），则令
j
$s ₁(i)=i₁，i=1,2,.,N-1
这就得到一个新的策略{s_(i)|，用这个策略再作方程组(4.4.4)，重复上面的做
法，直到对所有的i,都有sk（i)=-{1}(i)，{s_k（i)就是最优解.
可以证明如果策略s_。（i)}是无回路的，那么由上面的方法得到的策略
{s_{1}(i)|也是无回路的，并且由此得到的{f_{(i)是单调下降序列，它的极限是函
数方程(4.4.1)的解.
例4.4.1设有1,2,3,4,5共5个城市，相互距
5
离如图4.4.1所示,试用函数空间迭代法和策略空
3
间迭代法求各城市到城市5的最短路线和最短
2
7
5
2
路程.
4
5
5
解用函数空间迭代法先给定一个初始函数
6
一
$f₁(i)=cis,i=1,2,3,4
2
3
$f_{1}(5)=0$
0.5
由图4.4.1得到
图4.4.1
f₁（1)=c₁=2，f₁（2)=c₂5=7
f₁(3）=5=5，f₁（4）=45=3
再求$f_{2}({i)$.
f₂（1)=minc₁+f(j)|=min{0+2,6+7,5+5,2+3,2+0|=2
₂(（2）=min2+f(j）}=min{6+2,0+70.5+5,5+37+0=5.5
类似地，可得到f{2}(3)=4，$f_{2}(4)=3$.
再计算$f_3}(i)$.$.
$f（1)=minc₁+2(j)|=min{0+2,6+5.5,5+4,2+3,2+0}=2
j
类似地，可得到f_{3(2)=4.5，$_3(3)=4，$_3}(4)=3.
再计算f{}(i).
$f_{（1)=2，f(2)=4.5，f(3)=4，f(4)=3
计算结果说明f_{₄(i）=$_3(i)，i=1，2，3，4.计算停止$f_（1)，$f_{(2)，$f_{}(3){
$f}(4)分别是1城，2城，3城，4城到达5城的最短路程.然后再求最优策略
s(i).在f_{(i)$的计算中有
179

============================================================
第 198 页
============================================================

$f₄（1)=c₁+f_3（5），所以s（1）=5
$f_₄(2）=c_23+_3（3），所以s（2）=3
$f₄(3）=_34+_3（4），所以s（3）=4
$f_（4)）=c4s+_₃（5），所以s(4）=5
这样,我们就得到各城到5 城的最短路线和最短路程为
①→⑤
最短路程为2
②→③→④→⑤
最短路程为4.5
③→④→⑤
最短路程为4
④→⑤
最短路程为3
再用策略空间迭代法求解.
任选一个没有回路的初始策略s_0(i)}，如取s_{0(1)=5，s_{0(2)=4，s_{0(3)=5,
$s0（4)=3，s（5）=5.由s（i)求{f_（i），解下列方程组
f0（1）=₁s0(1)+0（s0（1））=c₁+0（)
$f_{（2)=_24+₀(4)$
$f_{(3）=c_3+_₀(5)$
$f_{0(4)）=c43+_₀(3)
解出f_{0(1)=2，f_{0(2)=11，$f_{(3)=5，$f_0(4)=6$.
再把$f_(i)代人minc_+f_{(j)中解出s{₁}(i)
j
i=1时，
min{c₁+f_0(j)}
/
=minc₁+f（1），₁₂+f₀（2）,₁₃+₀（3），c₁₄+（4），c₁₃+f₀（5）}
j
=min{0+2,6+11,5+5,2+6,2+0}
=c₁5+f_0(5)=2
所以s{₁1)=5.类似地，可以求得s₁(2)=3，s₁}(3)=5，s{1}(4)=5.
把{s₁(i)代人方程组(4.4.4).
$f_{}(1)=₁+f}($
f₁(2）=c_₂3+f₁(3)
$f_{1}(3)= 3+}($
f₁(4)）=c₄s+f₁(5)
$f_{(5)}=0$
解出f_(1)=2，f₁(2)=5.5，(3)=5，f(4)=3，f₁(5)=0.再把f₁(i)代人
min{c_+f₁(j)}中解出s{2}(i).
180

============================================================
第 199 页
============================================================

i= 1时，
min{c₁1+f₁（1），c₁2+f₁（2），c₁3+f₁（3），c₁4+f（4），c₁+f（5）
=min{0+2，6+5.5，5+5，2+3，2+0}=c₁1+f(5)=2
一
所以$s_2}（1)=5.类似地，可以求得s2(2)=3，s_2(3)=4，s_2(4)=5$.
再由s_{2（i)，求f_{₂（i)，得f₂2（1)=2，f_2(2)=4.5，f_2}（3）=4，$f2(4）=3.
由f2（i)求s₃（i).s₃3（1）=5，s3（2）=3，s3（3）=4，s3（4）=5.这时
$s₃3(（i)=s₂(i)，=1,2，3，4.所以最优策略为s(i)}={5，3，4,5,5}.最短路线及
最短路程为
①→⑤
最短路程为2
②→③→④→⑤
最短路程为4.5
③→④→⑤
最短路程为4
④→⑤
最短路程为3
策略s0、{₁1}、2、3即为各城市到城市5的方案，分别对应图4.4.2的(a)、
(b)、(c)、(d).
5
5
2
3
2
3
(a)
(b)
5
5
2
3
2
3
(c)
(d)
图4.4.2
用这两种方法得到的解是一样的.
从上例中可以看出函数空间迭代法可以认为是策略空间迭代法的一种特殊
情况，如果对于策略空间迭代法的初始策略都指定为N,即：_{0(i)=5，i=1,2,3,
181

============================================================
第 200 页
============================================================

4,则对应的方程组的解就是函数空间迭代法的初始函数.
2.有限资源分配问题
设有数量x的某种资源，将它投人两种生产方式A和B，若以数量y投入生
产A，剩余数量x-y投入生产B，则可得效益
g(y)+h(x-y)
其中g(y)与h(y)是已知函数，并且g(0)=h(0)=0.显然，对不同的y值，收入不
同，再假设投人A,B生产后，可以回收后再投人生产,设其回收率分别是0<a<1,
0<b<1.因此在第一阶段生产后回收的总资源为
x_1=ay+b(x-y)
再将x，分成_{和x_{₁-y_{1分别投入生产A和B.与第-阶段一样，获得效益
g（y_₁1)+h(x₁1-y_₁1})，回收资源x_2=ay₁+b(x_₁}-y_₁).再将x{2投入生产A，B，这样无限
制下去，直到资源用完.要求y，_{1，y_}，…，使获得的效益总和达到最大.这是一个
阶段数无限的多阶段决策问题.先假设无限次效益的总和是收敛的，存在最大
值.用f（x)表示从资源x开始，经过无限次最优分配以后的最优效益，那么根据
最优化原理，可以得到下列函数方程.
$f(x)=maxg(y)+h(x-y)+f(ay+b(x-y))|(4.4.5)
$0≤y≤x
下面的定理将证明这个函数方程在一定条件下解存在且唯一，同时定理的证明
过程也给出解这个函数方程的一个迭代法.
定理4.4.2在有限资源分配问题中函数方程
$f(x)=max|g(y)+h(x-y)+f(ay+b(x-y))l
$0≤y≤x
如果满足下列条件：
(1) g(x)，h(x)在x≥0范围内连续，h(0)=g(0)=0.
(2)设m（x）=maxmax[|g(y)|，|h(y)|]}，c=maxa，b}，对所有的
0≤y≤x
8
$x≥0，有∑m(c{x)<+8.
$n= 0$
那么(4.4.5)式有唯一的一个这样的解，它在x=0点连续,并且$f(0)=0.又这个
解必然对所有的x≥0连续.
证规定
T(f,y)=g(y)+h(x-y)+f(ay+b(x-y))
$f_{}(x)}=0$
$f_{+1(x)）=maxT({n,y
0≤y≤x$
首先证明$f_{n}(x)(n=1,2，…)连续.
182

============================================================
第 201 页
============================================================

f₁(x）=maxg(y)+h(x-y)}
$0≤y≤x$
f₁（x+Δx）=max|g（y）+h（x+Δx-y)1
由假设可知，g(z)，h(z)在任意闭区间[0,x]中一致连续，所以有性质：对于任给
$0≤≤x+Δ
的ε>0$，存在δ=δ(ε)>0，使对任何|Δz|<δ都有
ε
|g(z+Δz)-g(z)|≤
$2a}$
(0≤z≤x-δ)
ε
|h(z+Δz)-h(z)|≤
2
由此，当|_x|<δ$时就有
(1) 当0≤y≤x时
2
(2)当x≤y≤x+Δx时
g(y)+h(x+Δx-y)≤g（x)+h(x+Δx-x)+
3
ε
+
≤f₁}(x)+ε
2
2
总之，都有
g(y)+h(x+Δx-y)≤f_₁(x)+ε(0≤y≤x+Δx)
另一方面，如果使g(y)+h(x-y)在[0，x]达到其最大值的-个y是y=_{0}，则显
然有
g（y{）+h（x+Δx-y_0）+8≥g（y）+h（x-y₀）=f₁(x)
因此得
$f₁（x)-ε≤max|g(y)+h(x+Δx-y)≤f₁(x)+ε
0≤y≤x+Δx
这就证明了$f_{(x)是连续的.依照上面的方法，用归纳法就可以证明$f_{n(x)
(n =1,2,…)是连续的.
再证明函数序列f_(x)，f_₂(x)，…-致收敛.设y_{n(x)$是使T(f_，y)在0≤y≤x
内取最大值的一个y值(如果有多于一个y值使T($f_{n，y)达到最大值，就任取一
个),则有
fn+₁（x）=T（f，n）≥T（，n+1)
$fn+2（x）=T（f+₁，y_n+₁1）≥T（n+1，y{)
$fn+1（x）-f+2（x）≥T（fn，yn+1）-T（+1，yn+1)
$f{n+1（x）-fn+2（x）≤T（f，yn）-T（n+1，y{n)
所以
|fn+₁1（x）-f+2（）
183

============================================================
第 202 页
============================================================

≤maxT（f，y+1）-T（f+1，yn+1）|，|T（f，yn）-T（f+1，y{）|}
由T(f，y)的定义，有
|T（f，yn）-T（f+₁，y{n）1
=|f（ay+b（x-yn））-f+₁（ay+b（x-y）)
T（，yn+1）-T（+1，yn+1）
=|（ayn+1+b（-yn+1））-f+1（ayn+1+b（-y{n+1））
对0≤y≤x，有ay+b(x-y)≤cx，所以
$|f{n+1（x）-fn+2（x）|≤max|z）)-f{+z)
0≤=≤cx
设
u₁（x）=max|（z）-f{n+1（z)
(4.4.6)
0≤:≤x
就有
un+1（x）=max|fn+₁（z）-fn+2（z)
0≤z≤x
≤maxmax|（y）-fn+₁（y)|}
0≤=≤x0≤y≤c$
=max|f{n（z)-f{n+₁(z)|
0≤:≤cx
=u{n}cx)$
(4.4.7)
u_0(x)=max|（z)-f₁(z)|=max|-f₁(z)|
0≤≤x
0≤≤x
=maxmax|g(y)+h(z-y)|}
0≤:≤x0≤y≤
≤max|2 max[|g(y)|，|h(y)|]}
0≤≤x
0≤y≤:
=2 max {max[|g(y)|，|h(y)|]}
0≤y≤x$
=2m(x)
由(4.4.7)得到
$u{n(x)≤2m(c{x)，n=0,1,2,..
8
8
由假设Σm(c^{x)收敛，所以Σu_{n}x)收敛，并且在有限区间内-致收敛,再由
n=0
$n=00$
(4.4.6)式，函数序列$f_}(x)，$_₂2}(x)，…$致收敛.所以函数极限
$f(x)=lim$_{}(x)
n-→∞
是存在的,并且对所有的x≥0点连续，由一致收敛的性质知，f(x)是方程(4.4.5)的
解.又显然f($x)在x=0点连续,并且$f(0)=0$.
再来证明解的唯一性.
设F(x)是(4.4.5)的任一个解，F(0)=0并且在x=0点连续.我们来证明
F(x)=f(x).
184

============================================================
第 203 页
============================================================

设使T(f，y)在0≤y≤x区间取最大值的-个y值是y(x)，使T(F_，y)在0≤
$y≤x区间取最大值的-个y值是Y(x)$，则
f(x)= maxT(f,y)=T(f(x),y(x))≥T(f,Y)
0≤y≤x
F(x)=maxT（F,y)=T(F(x),Y(x))≥T(F,y)
$0≤y≤x$
所以
|f(x）-F(x）|≤max|T(f,y）-T(F,y)|,|T(f,Y)-T(F,Y)|
=max{|f(ay+b(x-y))-F(ay+b(x-y))|，
|f(aY+b(x-Y))-F(aY+b(x-Y))|
设u(x)=sup|f(z)-F(z)|，则由上式得
0≤z\x
|f(x)-F(x)|≤u(cx)
因此u(x)≤u(cx)，u(cx)≤u(c{2x），·
u(x)≤u(cx)≤…≤u(c"x)≤·
因为当n→∞时,c{→0，u(c{x)→0，所以
|f(x)-F(x)|≤u(cx)=0,
,f(x)=F(x)
这就证明了定理.
一
证明定理所用的逐次逼近法，可看做函数方程(4.4.5)的一种解法,也就是
函数空间迭代法.
我们也可以用策略空间迭代法求解.
设y_{0(x)是最优策略的初次近似，由
$f_{0(x）=(f0(x），y0(x))
(4.4.8)
可以解出$f_0(x)，设_{₁}(x)$是使T($_₀(x)，y)在0≤y≤x中取最大值的-个函数，即
maxT（₀（x），y）=T（f₀（x），y₁(（x))
$0≤y≤xx$
设由
f₁（x）=T(f₁（x），y₁(x))
(4.4.9)
能解出$f_{}(x)，如此继续下去，就得到-串策略{y_{n(x)和-串值函数{f_{n}_)}，在
一般情况下，如果能有
limy{（x）=y（x），lim（x）=f(x)
$n-
n-o∞
那么$f(x)便是所求的解，y(x)为最优策略.但在y_{(x)$_{(x)已确定的情况下，由
于$y_{n+{1x)的取法不一定唯一，所以{y_{(x)}的收敛性很难保证.不仅如此，求函
数方程(4.4.8),(4.4.9)的解，也不是很容易的事,因此这种方法在一般情况下很
难应用.
动态规划可被视为一种逐步改善法，它把原整体优化问题化为一系列结构
相近的最优化子问题,每个子问题的变量个数比原问题少,约束集合比原问题简
185

============================================================
第 204 页
============================================================

单,故较易于确定全局最优解.在过去的若干年里,动态规划得到了许多发展,它
在海量数据分析中发挥了重要作用,在本世纪初成为生物信息研究的一个基本
工具.新的动态规划模型也随着社会的发展而出现,如多目标动态规划,及描述
随机性决策过程和模糊性决策过程的模型.然而,动态规划的一个重要弱点为常
规算法的维数灾，此方面至今尚无突破性进展.所以寻求克服维数灾的有效算法
将有助于推广动态规划在高维问题中的应用,相关的并行算法、人机交互算法已
被引人到相关研究之中.
第4章习题
(A)
1.在图1中，求A点到E点的最短路线和最短路程.
$B1$
4
$D_{1}$
2
3
3
3
$C_{}$
5
2
1
-B_{2}$
$D_{2}$
1
A
3
E
1
$C_{22}$
4
5
3
$B_{}$
2
D{3}$
5
图1
2.某人外出旅游，需将n个物品供他选择装入行李袋，但行李袋的重量不能
超过w.第i件物品的重量为$a{,价值为_{，求这人应装哪几件物品使总重量不超
过w,但总价值最大.把这个问题看成多阶段决策问题并利用最优化原理找出递
推公式.
3.有个畜牧场，每年出售部分牲畜，出售y头牲畜可获利φ(y)元.留下t头
牲畜再繁殖，一年后可得到at(a>1)头牲畜.已知该畜牧场年初有x头牲畜，每年
应该出售多少，留下多少，使N年后还有z头牲畜并且获得的收入总和最大.把
这个问题当做多阶段决策问题,利用最优化原理找出递推公式.
4.给出下列距离矩阵,解下列旅行售货员问题.
0
10
8
1814)
10
0
7
11
4
D =
8
7
0
6
5
18
11
6
0
9
14
4
5
9
0
186

============================================================
第 205 页
============================================================

5.如图2，从0点到V点只能走平行或垂直的边，边长是图上每条边旁边
的数.
K
P
S
V
F
2
3
1
2
2
1
2
2
3
G
7
Q
T
C
2
3
4
5
3
4
1
2
3
D
H
M$
R
A
2
2
1
4
2
2
1
3
4
0
1
B
3
E
2
J
3
N
图2
（1)用最优化原理求0点到V点的最短路程和最短路线.
(2)求出用穷举法求0点到V点的最短路线的加法次数和比较次数,求出
用最优化原理求最短路线的加法次数和比较次数.
6.某单位有资源100单位，拟分4个周期使用，在每个周期有生产任务A，
2
6
生产任务，每单位能获利7元，资源回收率为一.问每个周期应如何分配资源，使
10
总收益最大?
7.设有5个城市1,2,3,4,5相互的距离如图3所示，试用函数空间迭代法
和策略空间迭代法求各城市到城市5的最短路线及最短路程.
2
3
4
2
5
1
s
4
3
4
3
图3
(B)
1.设备更新问题
现有一工业设备,其使用年限为10年,设备的购置价格为40万元，随着使
187

============================================================
第 206 页
============================================================

用时间的延长，其生产效益会不断降低，而使用成本会不断上升，下表给出其生
产效益和使用成本随使用时间变化的情况，第一行的0~1为使用时间多于0年
且少于1年.
6~7
7~8
8~9
9~10
使用时间/年
0~1
1~2
2~3
3~4
4~5
5~6
生产效益/万元
26
26
25
4
23
23
22
21
21
27
使用成本/万元
15
15
16
16
16
17
18
18
19
20
如果把设备进行处理的话,其处理价格随使用年限的增加而减少,具体变化
情况如下表：
使用时间/年
0~1
1~2
2~3
3~4
4~5
5~6
6~7
7~8
8~9
9~10
处理价格/万元
32
28
20
15
10
6
3.5
2.3
1.5
1
试确定设备更新的最佳方案.
2.二维背包问题
现有一辆载重5t,最大装载体积为9m^{3}的卡车作为运输工具,运输三种不
同的货物，这些货物可挤压，可变形，已知每种货物现有8件，其体积，重量及价
值如下表所示,试求携带货物价值最大的装载方案.
货物品种
重量/t
体积/m^³}$
价值/万元
1
0.2
0.3
4
2
0.3
0.5
7.5
3
0.25
0.2
9
参考文献
[1] Bellman R.Dynamic ProgrammingM]. New Jersey: Princeton University
Press,1957.
[2]
Nemhauser G L.Introduction to Dynamic Programming [M]. New York:
Wiley,1966.
188

============================================================
第 207 页
============================================================

[3] Sven D.Nonlinear and Dynamic Programming[M].New York:Academic Press,1974.
[4]罗伯特·E.拉森.动态规划原理[M].陈伟基,等译.北京:清华大学出版社，1984.
[5]马仲蕃，魏权龄,赖炎连.数学规划讲义[M].北京:中国人民大学出版社，1981.
[6]徐渝，贾涛.运筹学.北京：清华大学出版社，2005.
[7]胡运权，等.运筹学基础及应用[M].6版.北京:高等教育出版社,2014.

============================================================
第 208 页
============================================================

第5章
图与网络分析
日常生活和生产中的许多问题都可以用一个网络来描述，例如，交通网
络计算机网络工程进度网络生物信息网络和互联网等而网络通常可以用
一个图来表示图论方法
快网络优化中的问题也称为图与网络技
术某些特殊的线性规划
方法来解决，则会得到一些更有效的算
法本章主要介绍图
和用图论方法解决的一些典型问题，并介绍
几个基本的网络优化问题利
和算法，特别是图与网络技术的应用这些方法可用
来解决实际中的许多大型优化问题，最后简单介绍复杂网络的几个基本问题
5.1图与子图
本节主要介绍有关图与网络的基本概念，包括图与网络、图的关联矩阵与邻
接矩阵、子图等.它们是后面各节的基础.
1.图与网络
随着高科技时代的到来，图与网络技术的应用越来越广泛，特别是计算机科
学和生物信息科学的发展提出了许多新的问题需要用图论方法来解决.现实生
活中的许多问题都可以用一个图来表示.例如,用点表示城市，若两个城市之间
有一条铁路相连，则在两个点之间连一条边，这样一个交通网络就可以用一个图
来表示.同样地，用点表示计算机,用边表示两个计算机之间有信息传递，则计算
机网络就可以用一个图来表示.类似地，化学中的分子结构，物理学中的电网络，
生物信息学中蛋白质之间的相互作用都可以用一个图来表示.更一般地,用点表
示物体,两个物体之间存在某种关系,则对应的顶点之间连一条边,所形成的图
便表示物体之间的关系.将实际问题用一个图或网络来表示,通过研究图的性质
来解决这些问题,这就是图与网络技术,也称为网络分析.由于我们感兴趣的是
物体之间的关系,所以我们只关心图中两个点之间是否有边,而边的曲直和长短
190

============================================================
第 209 页
============================================================

示,而是在边上标上数字来表示线路的长短.这种图也称为赋权图或赋权网络.
下面我们用数学语言给出图的严格定义.
一个无向图G是一个有序二元组(N，E)，记为_=(N，E)，其中
N=n₁，n₂，,n{}
称为G的点集合，
E={e,j}
称为G的边集合，并且e{是一个无序二元组{n_₁，n}，记为e=n₁，n,.图5.1.1就
是一个无向图，为了简便起见，以后我们将无向图称为图.
若e{={n₁}，n，则称e{}连接n{；和n{}，点n{}和n,}称为e_{}的端点.
一个图可以用一个图形来表示,在保持图的点和边的关系不变的情况下,图形
的位置、大小、形状都是无关紧要的.因此,在图的讨论中,我们常常画出图的一个
图形来表示它,并且把它作为这个图的本身.以后,我们将用圆圈表示点，用线表示
边.图论中大多数概念都是根据图的表示形式提出来的.一条边的端点称为与这条
边关联;反之，一条边称为与它的端点关联.与同一条边关联的两个端点称为是邻
接的.如果两条边有一个公共端点,则称这两条边是邻接的.两个端点重合为一点
的边称为环(如图5.1.1中的e_{1).两个端点都相同的边称为重边(如图5.1.1中的
e_{3{4).不与任何边关联的点称为孤立点(如图5.1.1中的n_{).
e1
$n_$
e_12
e14
e_{24
$n_{}$
na
5u
e_{3}4
e_23
e_{4
$n_{3}$
图5.1.1
任何图G=(N，E)，若N和E都是有限集合，则称G为有限图；否则称G为
无限图.本书只限于讨论有限图.没有任何边的图称为空图,只有一个点的图称
为平凡图.
一个图，如果它既没有环，也没有重边，则称为简单图.例如图5.1.2中(a)是
一简单图，(b)就不是简单图.
设G=(N，E)是$个简单图，若设|N|=n，|E|=m，则显然有m≤n(n-1)/2.
一个简单图，若每对点之间均有一条边相连,则称为完全图.具有n个点的
191

============================================================
第 210 页
============================================================

完全图记作_{.显然K{n有n(n-1)/2条边.
图5.1.3所示的图就是一个完全图K_.
(a)
(b)
图5.1.2
图5.1.3
一个图G=(N，E)，若存在N的一个$分划(S,T)，使得G的每条边有一个
端点在S中，另一个端点在T中，则G称为二分图.这时记为_=(S,T_,E).
设G=(S，T，E)是一个简单二分图，如果S中的每个点与T中的每个点都邻
接，则称G为完全$分图.若|$S|=p，T|=q，则这个完全二分图记为K{_{
图5.1.4$的(a)和(b)分别为$K_3}{2和K_{3,{3{
(a)
(b)
图5.1.4
一个简单图G的补图G是与G有相同点集合的一个简单图，并且G中的两个点
邻接当且仅当它们在G中不邻接，图5.1.5的(a)和(b)就是互补的两个图.
O
(a)
(b)
图5.1.5
一个有向图G是一个有序二元组(N,A)，记为_=(N，A)，其中
N=n₁1,n₂2，·,n{}
称为G的点集合；
192

============================================================
第 211 页
============================================================

A=|a}
称为G的弧集合，并且$a{是一个有序二元组（n₁，n₁），记为$a_=（n{，n{₁），如
图5.1.6就是一个有向图.
若a=（n₁，n），则称a从n;连向n₁，点n{称为a的尾，n,称为a{的头，n{}称
为n_{的前继，n{;称为n_{的后继.
类似地可以定义有向图中点和弧的关联关系和简单有向图、完全有向图、二
分有向图和有向图的补图等概念.
$n__$
n2
nA
n_3
图5.1.6
在有向图G中,对于每条弧我们可以用一条边来代替它，于是得到一个无向
图.这个无向图称为G的基本图.
设G=（NA)是-个简单有向图，设N=n，A=m，则显然
有m≤n(n-1)$.
若K_{n是一个完全有向图，则K{n显然有$n(n-1)条弧.
设G是一个图（有向图)，若对G的每一条边(弧)都赋予一个实数，并称为
这条边(弧)的权，则G连同它边(弧)上的权称为一个(有向)网络或赋权(有
向)图，记为C_=(N，E，W)，其中W为G的所有边(弧)的权集合.本章将着重讨
论网络上的各种最优化问题.
0
2
3
4
5
图5.1.7
2.图的关联矩阵和邻接矩阵
如何将一个图输入计算机？通常用矩阵来表示一个图并输人计算机进行
193

============================================================
第 212 页
============================================================

(此页无文本内容)

============================================================
第 213 页
============================================================

1
2
3
4
5
1
0
1
1
1
0
2
1
0
1
0
1
3
1
1
0
1
1
4
1
0
1
0
1
5
0
1
1
1
0
一个简单有向图$_=(N，A)还对应着一个|N|×|N|矩阵A=(a{)$，其中
1，
当有弧从i连向j
aij
=
{0,
否则
称A为G的邻接矩阵.图5.1.8的邻接矩阵为
1
2
3
4
1
0
1
1
0
2
1
0
1
1
3
0
1
0
0
4
0
0
1
0
读者易验证下面的结论成立.
定理5.1.1G是二分图，当且仅当G的邻接矩阵可表示成如下形式：
0
A
/
A =
$A{}$
一个简单图G_=(N,E)的点i的次是指G中与点i关联的边数，记为d{.于是有
bik
其中B=(b_)是G的关联矩阵.
不难证明下面的两个命题成立.
一个简单有向图G=(N，A)的点i的入次是指G中以点i为头的弧数，记为
d_{;点i的出次是指G中以点i为尾的弧数，记为d{.于是有
$d_{2-d{2}= ∑bk
k
其中B=(_k)$是 G$的关联矩阵.
定理5.1.3
3.子图
设G=(N$,E)是一个图，并设N{N和E{⊆E$，如果对E'中任意的一条边
195

============================================================
第 214 页
============================================================

$e{={n{₁}，n}，都有n₁∈N{和n∈N{'}，则称G_{=（N{'，E{')是G的一个子图.图5.1.9中
(b)是(a)的一个子图.
0
0
2
4
2
3
3
(a) G
(b) G'$
图5.1.9
设G_{}=(N{，E{)是G=(N，E)$的$个子图，若N{=N，则称$G_{为G$的支撑子
图.若N'是N的一个非空子集，则以N'作为点集、以两端点均在N'中的所有边为
边集的子图称为由N'导出的G的子图，记为G[N{]，简称点导出子图.若E'是E
的一个非空子集，则以E'作为边集，以E'中边的所有端点作为点集的子图,称为
由E'导出的G的子图，记为G[E']，简称边导出子图.
图5.1.10中(b)是(a)的一个支撑子图，(c)是(a)的一个由点集{1，2，3，4}导
出的子图，(d)是(a)的一个由边集{{1，3}，{2，3}，{2，4导出的子图.
0
2
③
5
2
3
5
4
(a) G
(b)G的支撑子图
2
3
2
4
(c) G[{1,2,3,4}]
(d) G[{{1,3},{2,3},{2,4}}]
图5.1.10
设G_{1和_{₂是G$的子图，若_{1和$G_{2没有公共点，则称它们是不相交的，若
_{1和_{2没有公共边，则它们的边是不重的.例如，图5.1.11中(b)和(c)是(a)的
196

============================================================
第 215 页
============================================================

两个不相交的子图，而(d)和(e)就不是(a)的两个不相交的子图,但它们是(a)
的两个边不重子图.
设_{1}$和G_{2}$是$G_$的}图，以G_{1}$和$_{2}$的点集的并为点集，以$G_{}$和$G_{2$的边集
的并为边集的子图称为$_{1}和$_{2$的并，记为_{1}__{2；以$G_{}$和_{2}$的点集的交为点
集，以$_{}和$G_{2$的边集的交为边集的子图，称为$$_{1}$和$_{2$的交，记为$_{₁}n$_{2}.例
如，图5.1.12中(b)和(c)是(a)的两个子图，(d)是(b)和(c)的并，(e)是(b)和
(c)的交.
1
2
1
2
3
3
4
5
6
5
6
(a) G
(a) G
2
2
3
4
3
4
3
4
5
6
5
6
(b) _}$
(c) G_{}$
(b) _{}$
(c) G_{}$
1
2
2
3
4
3
4
3
5
6
5
6
(d) G{1}$
(e) G{}$
(d)G{1UG{2}$
(e) G_{1}∩G{}$
图5.1.11
图5.1.12
类似地，我们可以定义有向图的子图、支撑子图、点导出子图和弧导出子图，
并建立有向图的两个子图的并和交等概念.
5.2图的连通性
本节主要介绍与图的连通性有关的基本概念，包括路、回路、割边、割集等，
并用于刻画图的连通性特征.这些概念在后面的优化问题中有重要应用.
197

============================================================
第 216 页
============================================================

1.图的连通
在图G中，一个点和边的交错序列
（n_{,e_₁j，n，，nk,ek1}，n1)
称为G中由$n{到n1}的一条路，记为{n_{，n{1}路.如果该路中的边不重，则称为简
单路.如果该路中的点不重,则称为初级路.当G为简单图时，由n;到n{i的一条
路可以用点的序列
(n₁}，n₁}，…，nk，n1)
表示.例如，图5.2.1中(1,2,3,4,2,3,5,6)是一条{1,6路，(1,2,4,5,3,4,6)是
一条{1,6简单路，(1,2,3,5,6)是一条{1,6)初级路.
2
4
6
3
5
图5.2.1
在G中，一条至少包含一条边并且n_{=n_{1$的{n_{₁}，n{}路，称为G$的一条回路.
如果该回路中的边不重，则称为简单回路.如果该回路中的点不重，则称为初级
回路.例如图5.2.1中(1,2,4,3,2,4,5,3,1)是一条回路，(1,2,3,4,5,3,1)是一
条简单回路，(1,2,4，5，3,1)是一条初级回路.
G中若存在一条{i，j路，则称点i和点i是连通的.显然连通是点集N上
的一个等价关系.如果G中任意两点都是连通的，则称G是连通的.G的极大
连通子图称为G的一个连通分支.显然，G连通当且仅当G仅有一个连通
分支.
图5.2.2中(a)是一个连通图，(b)是一个具有三个连通分支的非连通图.
0
(a)
(q)
图5.2.2
198

============================================================
第 217 页
============================================================

定理5.2.1设G有p个连通分支，则G的邻接矩阵可以表示成如下
形式：
$（A_}$
0
$A_{2}$
A=
…
0
$A_{p}$
在有向图G中，一个点和弧的交错序列
（n₁，a₁，n，，nk,a，n_₁）
称为G中由n;到n_{}的一条有向路，记为(n_{₁，n_{₁})有向路.如果该有向路中的弧不
重，则称为简单有向路.如果该有向路中的点不重，则称为初级有向路.当为简
单有向图时，由n，到n，的一条有向路可以用点的序列
(n_₁}，n₁}，…，nk,n1)
表示.例如图5.2.3中(1,2,4,3,2,4,6)是一条(1,6)有向路，(1,2,4,5,3,4,6)
是一条(1,6)简单有向路，(1,2,3,4,6)是一条(1,6)初级有向路.
G中一条至少包含-条弧，并且n_{}=n_{1}$的（n_{₁}，n_{1)$有向路，称为G$的一条有向
回路.如果该有向回路中弧不重，则称为简单有向回路.如果该有向回路中点不
重，则称为初级有向回路.例如图5.2.3中(1,2,4,3,2,4,5,3,1)是一条有向回
路，(1,2,3,4,5,31)是一条简单有向回路，(1,2,4,5,3,1)是一条初级有向
回路.
2
3
5
图5.2.3
G中若存在一条(i，j)有向路，也存在一条(j，i)有向路,则称点i和点j是强
连通的.如果G中任意两点都是强连通的，则称G是强连通的.G的极大强连通
子图称为G的一个强连通分支.显然，G强连通当且仅当G仅有一个强连通
分支.
图5.2.4中，(a)是一个强连通图，(b)是一个具有三个强连通分支的非强连
通图.
199

============================================================
第 218 页
============================================================

(a)
(b)
图5.2.4
2.图的割集
在图G中，如果从G中删去一条边，使图的连通分支数严格增加,则称它为
图G的割边.显然 G的一条边是割边当且仅当这条边不包含在G的任何简单回
路中.例如图5.2.5中{2,4和{6,7都是割边.
5
©
4
7
3
6
图5.2.5
设C=(N,E)是一个图，对于N的两个不相交子集S和T{，我们用|S,T}表
示一个端点在S中，而另一个端点在T中的边的集合.所谓G的一个边割指的是
E的形如{S_，S}的一个子集，其中S是N的非空真子集，S_=N\S_$，从G中删去这
些边以后，G的连通分支数严格增加.G的极小边割称为割集.显然，每条割边都
是一个割集.
图5.2.6(a)中，边集{2，1，{2，4|，{2,3|和边集{{2，3}，2,4，
{1,4}，{1,5}均为割集，因为分别删去它们后，图的连通分支数刚好增加
1(见图5.2.6(b)和(c));边集{{2，3}，12,4|，1，4|既不是割集，也不
是边割,因为删去它后，图仍连通(见图5.2.6(d))；边集|{2,3}，{4,3，
{4,5}，{1,5不是割集，因为它包含一个更小的边割{{2,3}，{4，3，但
它是一个边割(见5.2.6(e)).
易验证下面的命题成立.
定理5.2.2任何边割都是不相交割集的并.
定理5.2.3
任给图G_，设C是G的一条简单回路，Ω={S$，T}是G的一个割
集，并用E(C)，E(Ω)分别表示C，Ω所包含的边集合.若E(C)∩E(Ω)≠，则
200

============================================================
第 219 页
============================================================

2
3
5
(a)
2
2
3
3
4
5
5
(c)
(q)
2
2
3
3
1
4
5
5
(d)
(e)
图5.2.6
|E(C)∩E(Ω)|≥2
设_=(N，A)是一个有向图，我们用(S，T)表示尾在$S中，而头在T中的弧
集合.所谓 G的一个弧割是指A的形如(S_，S)的一个子集，从G中删去这些弧
后，G的强连通分支数严格增加.G的极小弧割称为有向割集.
图5.2.7中，弧集1(1,2)，(1,4)|和弧集1(2,3)，(1,4)均为有向割集，因
为分别删去它们后,图的强连通分支数刚好增加1(见图5.2.7(b)和(c));弧集
{(23)则不是有向割集，也不是弧割，因为删去它后，图仍是强连通的（见
图5.2.7(d));弧集{(1,2)，(4,2)，(5,3))不是有向割集，因为它包含一个更小
的弧割{(1,2)，(4,2)1，但它是一个弧割(见图5.2.7(e)).
201

============================================================
第 220 页
============================================================

3
(a)
2
2
3
3
S
(b)
(c)
2
2
3
7
3
5
(d)
(e)
图5.2.7
5.3树与支撑树
树是图与网络中一个重要的基本概念，它是一类最简单、但又是十分重要的
图.本节将着重讨论树和支撑树及其基本性质.
1.树及其基本性质
一个树是一个连通且无回路(除非特别声明,以后皆指初级回路)的图.如果
一个图无回路,则称为森林.
设_{}和H_{₂2是图G_的两个子图，e是G_$的一条边，i是G_的一个点.为了以后
叙述方便，我们不加区别地用H_{1}UH_{₂2和H_{₁1∩H_{₂2分别表示H_{}和$_{₂2$的边的并集
和交集，用_{}\$H_{2表示在$H_{}中但不在$H_{₂2中的边的集合，用_+e表示在G_中加
连边e，用G-e表示在G中去掉边e，用G-i表示在G中去掉点i及与点i关联的
所有边.
定理5.3.1设T=(N,E)是|N|≥3的一个图，则下列6个定义是等价的:
（1）T连通且无回路；
202

============================================================
第 221 页
============================================================

(2)T有N|-1条边且无回路；
(3)T连通且有N|-1条边；
(4)T连通且每条边都是割边；
(5) T的任两点间都有唯一的路相连；
(6) T无回路,但在任一对不相邻的点间加连一条边,则构成唯一的一个
回路.
证我们现在按(1)→(5)→(6)→(4)→(3)→(2)→(1)的顺序来讨论它
们的等价性.
(1)→(5).设T连通且无回路，任给T的两个点i和j，因为T连通，所以
和j之间至少存在一条路.又因为T无回路,所以i和j之间又不能有两条或两条
以上的路.于是i与j之间有唯一一条路.
(5)→(6).设T的任两点间都有唯一的路相连，显然T无回路,否则对回路
上任一对点都至少存在两条路相连.又对T的任一对不相邻的点i和j加连一条
边e={i，j|，并设T中i与j间的唯-一条路为P(i，j)，则P(i，j)）+e就是T+e的
唯一回路.
(6)→(4).设T无回路,但在任一对不相邻的点间加连一条边，则构成唯一
的回路.因为T无回路，所以T的每条边一定是割边.又T必定是连通的，假若不
然，不失一般性，设T有两个分支T_{1}和T_{2}，并设点i属于T_{1}，点j属于T_{2}则在
和j之间加连一条边就不会产生回路,矛盾.
(4)→(3).设T连通且每条边都是割边，下面对点数归纳证明T有|N|-1
条边.
当|N|}1和2时，T为平凡图和K{2}，显然有E|=|N|-1.
当N|≤k$时,假设结论成立，须证|N|=$k+1时结论亦成立.
事实上，当|N|=_k+1时，任取T的一条边e，因为e为割边，所以T-e分成
两个分支T_{1}$和T_{2}.又因为T_{1}$和T{2$的点数均≤k，所以由归纳假设知
|E₁|=|N₁|-1，|E2|=|N₂2|-1
于是得到
|E|=|E₁|+|E2|+1=|N₁|+|N2|-2+1=|N|-1
(3)→(2).设T连通且有N|-1条边,下面对点数归纳证明无回路.
当N|=2时,因为|=1，|N|=2并且T连通，所以T={₂2}，显然无
回路.
当|N|=$k时，假设结论成立,须证|N|=k+1时,结论亦成立.
事实上，因为T连通，所以T中任一点的次≥1.又T中至少存在一点，它的
次为1.假若不然，设T中每一点的次均为≥2，则有
203

============================================================
第 222 页
============================================================

2|N|≤∑d(i)=2|E|=2|N| -2
e
N
此式矛盾.不失一般性，设d(i)=1，令T{'=T-i,显然T'仍然连通，并且
|N'|= |N|-1，E'|=|E| -1
于是
|E′|=|N′| - 1
根据归纳假设T'无回路,因此T也无回路.
(2)→(1).设T有|N|-1条边，且无回路.因为T无回路，所以T的每条边
都是割边.现用反证法证明T连通.
假若不然，设T有k个连通分支(k>1)，则可在这些连通分支间加连k-1条
边得到T，使T连通且每条边都是割边，根据(4)→(3)的证明知
|E|=|N|-1=|N|- 1
这与
|E′|=|E|+k-1=|N|-1+k -1
矛盾．
定理5.3.2每个树至少有两个次为1的点.
证任给树T=(N,E)，因为T连通，所以T中每个点的次至少为1，即任给
i∈N,都有d(i)≥1,但
∑d(i)=2|E|=2|N|-2
$N}$
因此至少有两个点的次为1.
I
从定理5.3.2的证明中可以看出，若T恰好有两个次为1的点，则其他点的
次必都为2，因此T是一条路
2.支撑树及其基本性质
给定图G和G的一个支撑子图T，若T是一个树，则称T为G的一个支
撑树.
定理5.3.3G有支撑树当且仅当G是连通的.
证设G有支撑树T，因为T连通，所以G具有连通的支撑子图，因此G
连通.
反之，设G连通，考虑G的极小连通支撑子图T，显然T的每条边也都是割
边，因此T是G的一个支撑树．
设T=(N，E{)是_=(N，E)的一个支撑树，令
T=G\T
则T称为G的反树.对T的任一条边e，T-e将不连通.若记T-e的两个连通分支
204

============================================================
第 223 页
============================================================

网等设计中均有广泛的应用,本节主要讨论最小树的性质和求最小树的几个
算法.
1.最小树及其性质
给定网络G=(N，E，W)，设T=(N，E{)为G的一个支撑树，令
W(T)= ∑W(e)
C∈E
则称W(T)为T的权(或长).G中权最小的支撑树称为G的最小树.
定理5.4.1设T为G的一个支撑树，则T是G的最小树当且仅当对任意
边e∈T有
W(e) = max W(e')
e^'∈C(e
其中C(e)⊆T+e为一个唯一的回路.
证必要性.设T是G的最小树，首先因为e∈C(e)，所以有
W(e)≤ max W(e^{)
e'∈C(e)
假若
W(e)< max W(e^')
r^'∈ C(e
则存在一边e∈C(e)，使得
W(e)>W(e)
那么
$T^{ = T + e-
也是G的支撑树，且
W(T')<W(T)
这与T为最小树矛盾.
充分性.设T{和T_2是满足定理条件的任意两个支撑树.由必要条件知，只要
证明W(T_₁）=W（T₂)即可.
设e∈_{₁}\T_{2，则T_{2+e包含唯一一个回路C(e)，那么C(e)上至少有一条边
e^{T_{₁.按定理条件，有
W(e) ≥ W(e')
设
T₁1\T₂2=e₁1,e₂2，,ek
而
T2\T₁={e₁,，e2·,e}
那么存在1-1映射φ，使得$φ(e_{₁)=e_{，且e_;和e_{在T_{₂+_;的回路C（_{)上，那么由
定理条件，有
W(e₁1)≥W(e_{1)
因此T_{2经过k次迭代后就变为T_{1}，故有
W(T_₁1)≥W（T2)
206

============================================================
第 224 页
============================================================

网等设计中均有广泛的应用,本节主要讨论最小树的性质和求最小树的几个
算法.
1.最小树及其性质
给定网络G=(N，E，W)，设T=(N，E{)为G的一个支撑树，令
W(T)= ∑W(e)
C∈E
则称W(T)为T的权(或长).G中权最小的支撑树称为G的最小树.
定理5.4.1设T为G的一个支撑树，则T是G的最小树当且仅当对任意
边e∈T有
W(e) = max W(e')
e^'∈C(e
其中C(e)⊆T+e为一个唯一的回路.
证必要性.设T是G的最小树，首先因为e∈C(e)，所以有
W(e)≤ max W(e^{)
e'∈C(e)
假若
W(e)< max W(e^')
r^'∈ C(e
则存在一边e∈C(e)，使得
W(e)>W(e)
那么
$T^{ = T + e-
也是G的支撑树，且
W(T')<W(T)
这与T为最小树矛盾.
充分性.设T{和T_2是满足定理条件的任意两个支撑树.由必要条件知，只要
证明W(T_₁）=W（T₂)即可.
设e∈_{₁}\T_{2，则T_{2+e包含唯一一个回路C(e)，那么C(e)上至少有一条边
e^{T_{₁.按定理条件，有
W(e) ≥ W(e')
设
T₁1\T₂2=e₁1,e₂2，,ek
而
T2\T₁={e₁,，e2·,e}
那么存在1-1映射φ，使得$φ(e_{₁)=e_{，且e_;和e_{在T_{₂+_;的回路C（_{)上，那么由
定理条件，有
W(e₁1)≥W(e_{1)
因此T_{2经过k次迭代后就变为T_{1}，故有
W(T_₁1)≥W（T2)
206

============================================================
第 225 页
============================================================

交换T_{}和$$T_{2}$的位置同样可得
W(T_₂)≥W(T_{1)
从而
W(T₁)=W（T₂)
一
定理5.4.2
设T为G的支撑树，则T为G的最小树当且仅当对任意边e∈T，有
W(e) = min W(e^')
e'∈Ω(c)
其中Ω(e)⊆T^{+e为一个唯一割集.
证必要性.设T为最小树.首先,因为e∈Ω(e)，所以有
W(e)≥ min W(e')
r^'∈Ω(e)
假若
W(e) > min W(e')
e^'∈S2( e)
则存在一边∈n(e)，使得
W(e)<W(e)
于是
T = T+ e -e
也是G的支撑树，且W(T^1)<W(T).这与T为G的最小树矛盾.
充分性.设T^{°}是满足定理条件的支撑树.假设T^{°不是最小支撑树则可推出矛盾.
设G的所有最小支撑树的集合为，并设最小支撑树T满足
|T∩°|=max|T∩T°|
T∈
因T°不是最小的，故有
W(T{0)>W(T)
设e∈^{°\T，Ω(e)是G的一个割集，按定理条件
W(e) = min W(e{)
e^'∈Ω(e)
那么，T+e包含一个回路C(e).由定理5.2.3知
|C(e)∩Ω(e)|≥2
因此，存在e∈(Ω(e)∩C(e)).令
$T^{=T +e -
因为
W(e)≤W(e)
故
W(T{1)≤W(T)
因此，T'∈.但有
U|<|U|

============================================================
第 226 页
============================================================

这与的假设矛盾.
从以上两个定理的证明,不难得到如下两个定理：
定理5.4.3设T是G的支撑树,则T是G的唯一最小树，当且仅当对任意
的边e∈G\T,e是C(e)中的唯一最大边.
定理5.4.4设T是G的支撑树，则T是G的唯一最小树，当且仅当对任意
的边e∈T,e是Ω(e)中的唯一最小边.
我们可以用破圈法来求图的最小树.对一个连通赋权图G,若G中不存在回
路(有的文献中也称为圈)，则图G本身是一棵最小树.否则，在图G中找一个回
路，去掉回路上权最大的边.重复这个过程，直到剩下的图不含回路为止.不难验
证剩下的图就是图的最小树.上述过程可作为一个算法来求图的最小树,并用计
算机进行计算.但从算法复杂性的角度来看,该算法计算复杂性较高,后面我们
将给出计算复杂性较低的更好的算法.
2.求最小树的Kruskal算法
Kruskal 算法是1956年首次提出的求最小树的算法{{.后来Edmonds把
这个算法称为贪心算法.其基本思路是从G的m条边中选取n-1条权尽量
小的边,并且使其不构成回路,从而构成一个最小树.下面我们就来叙述这
个算法.
第1步开始把图的边按权的大小由小到大地排列起来,即将图的边排序为
$a1，,a2，…，a，使W（a₁1）≤W（a₂2）≤…≤W（am)
置S=∅，i=0,j=1.
第2步若|S|=i=n-1$,则停止.这时G[S]}=T即为所求;否则，转向第3步.
第3步若G[SUa}]不构成回路，则置ei+1=a₁，S=SUe+}，i:=i+1,
j：=j+1，转向第2步;否则，置j：=j+1，转向第2步.
例如在图5.4.1所示的网络中,求一个最小树.计算的迭代过程如图 5.4.2所示.
②
1
3
4
2
2
4
5
4
2
4
3
图5.4.1
现在让我们来分析一下算法的复杂性.首先在第1步中把边按权的大小由
208

============================================================
第 227 页
============================================================

2
2
1
5
1
4
2
3
3
2
2
3
1
1
2
2
5
1
4
5
1
4
2
2
3
3
图5.4.2
小到大地排列起来，这大约需m·log{2m次比较;其次第2步最多循环n次;在第
3步中，要判断G[SUa,}]是否构成回路，就必须确定$a_{}的端点是否在G[S]的
不同连通分支中,这可用下列方法实现:在任意一步中,这样来标记点，当且仅当
两个点有同一标记时,它们才属于G[S]中的同一个连通分支.最初，点l赋以标
号$l(1≤$l≤n)$，按这一标记方案，当且仅当$a;的端点有不同标记时[SU{a{}]
才不构成回路.若是这种情况，则取$a_{}作为$e{+1};否则就抛弃a_{，再检验$e_{i+{1}$的下一
个候选者$aj+1.一旦$e_{+{1}加进S，在含有$e{i+{1}的端点的G[S]$的两个连通分支中用两
个标号中的较小者,对点重新标号.对每条边，一次比较就足以判断它的端点标
号是否有相同的标记,所以判定加边后是否构成回路总共约需m次比较,而加
边后点的重新标号最多需n(n-1)次比较.所以总的计算量为
$mlog{2m+n+m+n(n-1)-0($n{}l}$g{2n$
由定理5.4.1易见上述算法的正确性,但这个算法的效率不太高,我们下面
介绍一个较好的算法.
3. Dijkstra 算法
这个算法是Dijkstra1959年提出的[]，其基本思路是从图G的n-1个独立
割集中的每一个都选取一条权最小的边，从而构成一个最小树.现叙述如下：设
图G的点综合为{1，2，…，n}，边e$的权为.
第1步置u=w₁，T=∅，R={1}，S={2,3，…，n}；
第2步取u=minu₁}=w，置T=TUe}，R=RUk，S=S\{k}；
j∈s
第3步若S=∅$，则停止；否则，置u_=min{u_₁，w,j∈S$，返回第2步.
209

============================================================
第 228 页
============================================================

例如用 Dijkstra 算法求图5.4.1中所示网络的最小树,其迭代过程如图 5.4.3
所示.
不难看出,Dijkstra算法的实质是在n-1个独立割集中,取每个割集的一条
权最小的边，构成一个支撑树.由定理5.4.2知,它是一个最小树.
下面简单分析一下Dijkstra算法的复杂性.第一次执行第2步是n-2次比较，
第二次为n-3次比较，第三次是n-4次比较……，因此总的比较为$($n-2).
1
2
(n-1)次.在执行第3步时,第一次是n-2次比较,第二次是n-3次比较……，因
此总的比较为($n-2)($n-1)$次.由此算法的总计算量约为$0$($n^{2).
1
2
2
3
3
4
1
8
8
4
4
2
3
2
4
5
2
2
4
5
4
2
4
4
2
4
3
3
2
2
2
2
3
1
3
4
1
4
3
4
2
1
2
5
2
4
2
2
4
2
4
2
4
4
3
3
图5.4.3
5.5 最短有向路问题
给定一个有向网络_=(NA，W)$，其中N={1,2，…，n}，设P为G中的-条
有向路，令
W(P) = ∑W( a)
a∈l
则W(P)称为P的权(或长).
一个自然的问题是寻求有向网络中自某一指定点i到另一指定点j间的最
短有向路.本节将介绍求最短有向路的Dijkstra算法.
210

============================================================
第 229 页
============================================================

1.最短有向路方程
众所周知，如果x，y和z是欧氏空间的任意三个点，若用$l(x，y)表示x和y
之间的距离,则有“三角不等式”：
$l(x,y)≤l(x,z)+l(z,y)
并且等式成立当且仅当$z在x和γ的连线上.
同样在不含权为负或零的有向回路的有向网络G=(N，A{，W_)中，其中N_{=
{1，2，…，n|为点的集合，而A为弧的集合，若用u_,}和uk分别表示自点1到点j
和点k的最短有向路的长度，而w_表示弧(k，j)$的长度(若（k,j)≠A，w_=+∞)
则显然对一切j≠k,j,k=2,3，…，n，有
$u_{1} 0$
(5.5.1)
$u_{}≤u{+2wk
且u_{}=u_+wk，当且仅当弧（k，j)在自点1到点j的最短有向路上.
因为诸u，是G中自点1到点j的最短有向路的长度，因此这条最短有向路
必有最后一个弧（k，j)，而且该有向路上自点1到点k的一段也必然是最短有向
路，从而(5.5.1)可写为
${u{1}= 0$
(5.5.2)
u₁=min{uk+wk,j=2，3，…,n
k≠j
这就证明了，自点1到各点的最短有向路的长度必须满足(5.5.2),即它们是方
程(5.5.2)的一组解.
现在我们要问：(5.5.2)的解是否是自点1到其余各点的最短有向路的长
度？下述的定理5.5.1就回答了这个问题.
定理5.5.1设有向网络G中不含非正有向回路(权为负或零),并且从点1
到其余点都有有限长度的有向路，那么(5.5.2)有唯一有限解u}.
证设{u_{1}，u_2}，…，u{n}为(5.5.2)的任一组有限解，对任一$u_{，我们可以在G
中找出自点1到点j的有向路：
P=（1，i₁），（i₁}，i₂），…，（i-₁，ik），（k,，j）|
使得
$m+n=²1nm+n=n$
²1mn+n=nm+-²{n=$
若(5.5.2)中的解不唯-，设u_{1}，u_2}，…，u{n是自点1到其余各点的最短有向路的
长度，因此它是（5.5.2)的-组解，设u_1}，u2，…，u_{是不同于u_{₁}，u_2，_，u_{n}的另一
组解，那么必存在某一j，使u_{；≠u_{因u;是自点1到点j的最短有向路的长度，而
211

============================================================
第 230 页
============================================================

u_{是点1到点j的某一有向路的长度，故有u_{>u，在u{>u,的所有j中，总可以选
取某个j，使(k，,j)是自点1到点j的最短有向路上的弧，且u_{=uk(因为u_{=u_{1}所
以这样的弧一定存在)，从而有
m+n=mn+n=n<n
这与u_{1}，u{2}，…，u_{}为（(5$.5$.2)的解矛盾_
I
然而，直接求解方程(5.5.2)是困难的.目前几乎所有求最短有向路的算法，
都是围绕着怎样解这个方程的问题.
对于某些特殊的有向网络，方程(5.5.2)可以简化，从而变得较容易求
解.
定理5.5.2设u是有向网络G中自点1到点j的最短有向路的长度，并且
对所有的j=2，3，，n，u_为有限值，若网络G中的点能编成如下的序号2，，
n,使得
若i<j，有u_{₁≤u,且w_≥0，但等号不同时成立或者u_₁>u₁且w=+∞，即
(j，i)A.则方程(5.5.2)可简化为
$u_{1}} $
(5.5.3)
u₁=min}uk+wk，j=2,3，,n
k<j
显然(5.5.3)比(5.5.2)更容易求解，因为u_{₁=0是已知的，而u_2只依赖于
$u_₁1}，}u_{3}只依赖于u_₁1}，u_₂}，…-般地，u_{；只依赖于
$u_₁1}，u2}，，u
所以可以用代换方法依次求出u_2}，u_₃}，…，u_由此可见，找出有向网络中点的顺
序是问题的关键.但是,若找出有向网络中点的这样一个顺序比求最短有向路还
要难的话,那就失去意义了.
2.求最短有向路的Dijkstra算法
Dijkstra算法{仅适用于在弧权为正值的有向网络中求最短有向路.一个弧
权为正值的有向网络显然具有如下性质：
定理5.5.3设G=(N,A，W)是一个弧权为正值的有向网络，则在G中，任
意一条最短有向路的长都大于它的真子有向路的长.
根据定理5.5.3知，G中自点1到其他各点最短有向路的长可按大小排列如
下
$"n≥.≥n≥n=0
于是，它满足定理5.5.2的条件，因此可以用方程(5.5.3)来求解.从而在
算法实现中我们可以将点的排序与用代换法解方程同时进行,具体算法
如下：
212

============================================================
第 231 页
============================================================

第1步(开始)
置u₁=0，u₁=w₁y,j=2,3，…,n,P=|1,T={2,3，…,n1.
第2步（指出永久标号）
在T中寻找一点k，使得
$u_{=min{u,}
j∈T
置P=PU{k}，T=T-k|.若T=，终止；否则，进行第3步.
第3步（修改临时标号）
对T中每一点j，置
u₁=min}u₁，uk+w,}
然后返回第2步.
这个算法经过n-1次循环必结束.整个算法过程中,第2步要做一(n-1).
2
1
1
(n-2)次比较，而第3步要做(n-1)(n-2)次加法和(n-1)(n-2)次比较.因
2
2
此，总的计算量为$0($n^{2})$.$
例如,求图5.5.1自点1到其他各点的最短有向路.用Dijkstra算法的迭代过
程如图5.5.2所示.
2
3
3
5
2
2
4
一
]
4
3
7
6
4
5
5
图5.5.1
10
5
5
ω
8
3
3
2
3
2
2
2
5
4
5
0
4
2
1
0
2
1
4
6
4
6
1
1
7
4
6
7
4
3
6
3
4
5
5
5
4
5
8
8
3
3
213

============================================================
第 232 页
============================================================

5
10
5
8
3
2
3
ω
2
3
S
2
2
0
2
5
4
0
4
1
2
1
6
4
9
3
7
6
3
7
4
4
5
5
5
5
3
8
8
3
5
8
5
8
2
3
3
3
2
5
2
2
2
5
1
4
0
4
2
1
4
一
6
1
6
3
7
4
6
3
7
4
6
A
5
5
4
5
5
8
3
3
8
图5.5.2
至于求一般无负有向回路网络的最短有向路和求网络中所有点对间的最短
有向路的算法可参见文献[4]，[5]，[6]和[7].
5.6 最大流问题
本节我们将介绍有向网络中的最大流问题,如果把有向网络看做一个交通
网，其中点表示车站，弧表示道路,则弧权就表示两个车站间道路的通过能力.给
定一个有向网络,一个很自然的问题是如何求指定两点间的最大流量,即最大流
问题.本节将分别介绍最大流问题的基本理论和解最大流问题的算法.
1.最大流最小割定理
给定一个有向网络_=(N，A，C)，其中$c_{表示弧(i,j)∈A$的容量，并设G$有
一个发点s和一个收点t(s,t∈N).令
_=通过弧(i,，j)的流量
显然有
0≤x₁≤c
(5.6.1)
214

============================================================
第 233 页
============================================================

另外，流x=(x_)要遵守点守恒规则，即
+v，i=s$
∑
$x_{$
{0，
i≠s,l
(5.6.2)
-v，i=t
(5.6.2)被称为守恒方程.它表示除点s和t以外,对每个点i,流入i的流量等于
流出i的流量，而发点s和收点t分别具有值为ν的出流和入流.(5.6.1)是对每
个弧的流量限制.满足(5.6.1)和(5.6.2)的流被称为可行流，或简称为(s,t)一流.
我们的目的 求 个可行流x^{=(x_{),使得
∑
∑x{}$
v=
x_{sj
*
=
(5.6.3)
达到最大值.
求从s到t的最大流问题,实际上就化成解上面这样一个线性规划问题.当
然我们可以用单纯形方法来解它,但是由于这一问题的特殊性,所以可以用比单
纯形方法简单得多的图论方法来解它.在介绍算法之前,先介绍几个基本定理.
首先给出有关的概念.
设P是G中从s到$t的无向路，P的一个弧(i，j)称为前向弧，如果它的方向是从
s到t；否则称为后向弧.如果对P的每个前向弧(i，j)有x_<c_；而对P的每个后向弧
(i,j)有$x_₁>0,路P称为是一个关于给定流x=(x{)的增广路.例如在图5.6.1所示的有
向网络中，每条弧旁第一个数字表示它的容量c{，第二个数字表示弧流x{j
2,1
2
3,1
3,2
0
1,0
1,0
S
1,1
6
2,2
2,1
3
5
2,2
图5.6.1
容易验证，它满足式(5.6.1)和式(5.6.2),s=1,t=6,流值v=3.
关于这个流的一个增广路如图5.6.2所示.
$x{2{4}=1<c{4$
2
C_5A
$x_{21<c$
V
S
$I=x$
5
$x{6{1<c$
图5.6.2

============================================================
第 234 页
============================================================

我们可以在这条增广路的每个前向弧上增加一个单位流,在后向弧上减少
一个单位流，于是得到一个增大的流，它具有流值v= 4.新的流如图5.6.3所示.
2,2
2
3,2
3,2
①
1,0
1,0
1,0
6
2,2
2,2
3
5
2,2
图5.6.3
一个(s,t)-割被定义为弧割(S_,T)，其中s∈S_，l∈T$.
割(S,T)的容量定义为
C(S,T)= ∑ ∑
C$
ies jer
即由S到T所有弧的容量和.
由（5.6.2）并对S的所有点求和得
$("x\-ax\=a$
=∑（x₁-x₁）+∑∑（x₁-x)
ies jes
1s
=∑∑（(x₁-x$
(5.6.4)
ies jer
即任意流的值等于通过割的纯流.但
0≤x₁≤c
因此
v≤∑∑c=C(S,T)
(5.6.5)
ieS
在图5.6.3表示的流中，存在一个(s，t)-割，其容量等于流值，例如S_={1$
2|,T={3,4,5,6}.
现在我们来叙述并证明网络流理论的三个主要定理,这些定理将用来产生
最大流问题的好算法.
定理5.6.1（增广路定理）一个可行流是最大流当且仅当不存在关于它的
从s到t的增广路.
证必要性是显然的,因为如果存在增广路,流就不是最大的.
充分性.设x是一个不存在关于它的从s到t的增广路的流，并设S是包含s
的点集,使得对任意j∈S存在从s到j的增广路，且对任意j∈N-S不存在从s到
j的增广路.
216

============================================================
第 235 页
============================================================

令T是S的补集，由定义可知，对任意i∈S和j∈T_，有
x₁=c₁，x0
由(5.6.4)得
v=∑∑
$cijj
ies
jeT
即流的值等于割(S$,T)的容量.从(5.6.5)得知x是最大的.
定理5.6.2（整流定理）如果网络中所有弧容量是整数,则存在值为整数
的最大流.
证设所有的弧容量都是整数,并令
=0，对所有i和j
如果x{}=(x{0)不是最大的，则由定理5.6.1知，存在关于x^{$的从s到t的增广路，
即x^{°允许增广，因此它有-个整流x{=(x_{)$，它的值超过x{$的值.如果x{}还不是
最大的,它又是允许增广的,等等,用这个方法得到的每个可行流至少超过它前
面的可行流一个整数单位,最后达到一个不允许增广的可行流,这就是最大流.
一
定理5.6.3(最大流最小割定理)一个(s,t)-流的最大值等于(s,t)-割的
最小容量.
证由定理5.6.1的证明和(5.6.5)知该定理成立.
2.最大流算法
现在来介绍求最大流的算法，它是由Ford和Fulkerson于1957年首先给出
的[8].基本思想是从任意一个可行流(例如零流)出发，找一条从s到t的增广
路，并在这条增广路上增加流值，于是便得到一个新的可行流.然后在这新的可
行流的基础上再找一条从s到t的增广路，再增加流值……继续这个过程，一直
到找不到从s到t的增广路为止.这时，由定理5.6.1知,现行的流便是最大流.
不难看出，求最大流算法的关键是找一条从s到t的增广路,而找一条增广
路则可以用标号方法来实现.具体的标号规则如下：
在标号过程中，一个点仅可以是下列三种状态之一:标号并且检查过(即它
有一个标号且所有相邻点该标的都标号了);标号未检查(有标号但相邻点该标
的还没有标号);未标号.一个点i的标号由两部分组成，并取(+j，δ(i))和
(-j，δ(i))两种形式之一.如果j被标号且存在弧(j，i)，使得x_₁<c_j，则未标号点i
可以给标号(+j，δ(i))，其中
δ（i)=min|δ(j),c-x
如果j被标号且存在一个弧(i,，j)，使得x{>0，则未标号点i给标号(-j，δ(i))，其中
217

============================================================
第 236 页
============================================================

δ(i）=min|δ(j)，x₁}
当过程继续到t被标号时，一个从s到t的增广路已被找到，且它的流值可
以增加δ(t).如果过程没有进行到t就结束了，则不存在从s到i的增广路.这时，
通过令S是所有标号点的集合,T是所有未标号点的集合,便可得到一个最小容
量割(S_,T).由定理5.6.3知，割(S$,T)的容量就等于最大流的值.
下面我们来叙述最大流算法.
第1步(开始)
令x=(_{)是任意整数可行流，可能是零流，给s一个永久标号(-，∞).
第2步（找增广路）
(2.1)如果所有标号点都已经被检查,转到第4步.
(2.2)找一个标号但未检查的点i,并做如下检查,对每一个弧(i,j),如果
x_₁<_{}，且j未标号，则给j一个标号(+i，δ(j))，其中
δ(j）=minc₁-x₁，δ（i）}
对每个弧(j，i)，如果x_>0且j未标号，则给j一个标号(-i，δ(j))，其中
δ(j）=minx，δ（i)）}
(2.3)如果t已被标号,转到第3步;否则转到(2.1).
第3步（增广）由点t开始，使用指示标号构造一个增广路(在点t的指
示标号表示在路中倒数第二个点，在倒数第二个点的指示标号表示倒数第三个
点,等等），指示标号的正负则表示通过增加还是减少弧流量来增大流值.抹去点
s以外的所有标号，转到第2步.
第4步(构造最小割)
这时现行流是最大的，若把所有标号点的集合记为S,所有未标号点的集合
记为T,便得到最小容量割(S,T)，计算完成.
现在让我们分析一下这个算法的复杂性.设弧数为m,每找一条增广路最多需
要进行2m次弧检查.如果所有弧容量都是整数,则最多需要v次增广(其中v是最
大流值).因此总的计算量是0(mv).
例如,求图5.6.4所示有向网络中从点1到点6的最大流.其迭代过程如
图5.6.5所示.
5
2
9
8
3
6
6
6
1
5
2
3
5
8
图5.6.4
218

============================================================
第 237 页
============================================================

(+1,2)
(+2,2)
5,2
5,2
2
4
2
4
9.7
9.7
8,6
3.2
8,6
3,2
(+4,2)
(-,∞)
1
6,6
6,4
6
1
6,6
6,4
6
5,1
5,1
2,1
7,0
2,1
7,0
3
5
3
5
8,6
8,6
(+1,1)
(-2,2)
(-3,1)
(+2,1)
5,4
5,4
2
2
4
9,9
9,9
8,8
3,2
8,8
3,1
(一,∞)
(+5,1)(一,∞)
1
6,6
6,4
6
→
6,5
6,4
6
0
2,1
5,1
2,2
5,1
7,0
7,1
3
5
3
5
8,6
8,6
(+1,1)
(-2,1)
图5.6.5
关于求最大流的更有效的算法,读者可参见文献[9],[10]和[11].
5.7最小费用流问题
最小费用流问题就是求一个从s到t，其值为v的流，使得流的费用达到最
小.在这个问题中，每条弧(i，j)有两个数同它联系着，一个是弧容量，一个是单
位流通过它的费用w_{₁x=(_{)是-个流，其费用为
显然，如果v大于从s到t的最大流的值，问题无解；而v小于或等于最大流
的值，一般可能存在若干可行流，我们所要求的是其流值为v,并且费用达到最
小的流.
1.最小费用流算法
下面的算法称为求最小费用流的对偶算法[1,即由值为v_0<v的最小费用流
出发，在始终保持其费用最小的前提下,逐步增加可行流的值，使得可行流的值
越来越接近v，直到达到v为止.开始的最小费用流总是存在的，因为零流就是等
于0的最小费用流.求解最小费用流问题的原始算法见文献[1].
219

============================================================
第 238 页
============================================================

显然，最小费用流问题可以写成线性规划的形式，即
(min
∑w
(ij)∈d
$a=({x-{x}$
s.t.
∑（_₁-x1}-$
∑（x₁-x）=0,i∈N,i≠s,t
0≤x₁≤c₁，（i,，j)∈A
前两个约束分别表示在s点流出的流量和流入t点的流量都是v；第三个约
束表示在除去s，t以外的任何一点其流入的流量和流出的流量均相等;最后
一个约束条件表示在每条弧上的流量是有限制的，目标函数表示要求总费
用最小.
我们利用对偶规划来解这个问题.先把上面的线性规划问题的对偶规划写
出来,即
max {p(t)0-p(s）v-∑
(ij)∈A
s.t.
p(j)-p（i）-r₁j≤w₁,（i,，j∈A
r₁j}≥0，(i,j)∈A
p(i)无限制，i∈N
其中，p(i)为对应于点i的对偶变量，r_为对应于弧(i，j)的对偶变量，再写出这
一组对偶规划的松紧条件
p(j)-p（i)）-rij<wj→x₁=0
(5.7.1)
r₁>0⇒→x₁=
(5.7.2)
就是说，如果{p（i)，r}，{x{分别是对偶规划和原规划的可行解，那么只要
它们满足条件(5.7.1)、(5.7.2),它们就分别是最优解.
因为p(i)是没有限制的,所以我们可以任给出一组数p(i)，令
$r=max {0,p(j)-p(i)-w,}
(5.7.3)
显然有r_≥0$,于是得到对偶规划的一组可行解.
这时条件(5.7.1)、(5.7.2)就变成
p(j）-p（i）<w₁→₁=0
(5.7.4)
220

============================================================
第 239 页
============================================================

(5.7.5)
p（j）-p（i)）>w₁→x₁=
这是因为p(j)-p(i)<w,根据(5.7.3)就有r=0，所以
p(j）-p（i)-r₁,=p（j）-p（i)<w
反过来,如果
p(j)-p（i)-r₁<w
那么
rj>p(j)-p(i)-wj
由(5.7.3)-定有r=0.所以
p(j)-p（i)=p(j)-p(i)-r<w
5,2
(5.7.2)和条件(5.7.5)也是等价的.
8,6
6,4
→
始规划的后面两个约束(例如令所有的x{=0)，同时这两组解都满足条件
3,1
前两个约束.如果
（x₁-_s）=0，_{0<
那么，这时我们把原始规划约束中的υ改成_0，_就是最优解了.也就是说，如
果要求流量是_0，{x_{|就是一个最小费用流.因为现在v_{0<v，所以我们就增加流
量.在增加流量的过程中，保持|x_{}满足原始规划的后两个约束，同时让条件
(5.7.4)、(5.7.5)继续成立，一直到流量是v为止.
增加流量的办法是找增广路,这在最大流的算法中已经叙述过.增广路是在
8,6
们只能在p（j）-p(i）=w₁，_₁<c和p（j)-p(i）=w₁，_>0这样的-些弧上找增广
路.如果在这些弧上找不到增广路,我们就修改p(i).
现在把计算步骤叙述如下.
第1步(开始)
让所有的流x{=0，所有点对应的数p(i)=0$.
第2步（决定哪些弧可以改变流量）
用1表示满足下面条件的弧集合
p（j）-p（i）=wj，同时x<
用R表示满足下面条件的弧集合
221

============================================================
第 240 页
============================================================

p(j)-p(i）=w，同时x>0
用Q表示不在$IUR中的弧集合.
第3步(改变流量)
用最大流算法，在$IUR上找增广路,增加流量.如果从s到$t的流量已经是
v,那么计算停止,这时候已经得到一个流量是ν的最小费用流.
如果从s到t不能再增加流量(这就是说，在IUR上找不到一条从s到i的
增广路),那么我们就来检查在QUIUR中是不是能找到增广路.也就是说,不考
虑p(j)-p(i)=_{的限制.如果也不能找到增广路,那么这个网络的最大流就达
不到v，所以要求流量等于ν的最小费用流是无解的.当然，这时候的流量是
$_{0}(v_{0<D)的话，那么就得到流量是_{的最小费用流.如果在$QUIUR中能找到增
广路,那么就转入第4步.
第4步 (改变顶点的p(i)值)
在第3步中,找不到从s到t的增广路，回忆最大流算法中增广路的找法，是
用标号法,这就是说,把所有点分成两类:标得上号的点以及标不上号的点，S是
标得上号的点的集合，T是标不上号的点的集合.让标得上号的点p(i)值不变，
标不上号的点p(i)值全部加1,再回到第2步.
现在让我们来分析一下算法的复杂性.设网络的点数为n,弧数为m，弧的最
大容量为w.算法的循环次数取决于点的p(i)值修正的次数，而p(i)值的修改最
多进行$mw次.所以第2步的计算量为$0$(m^{2w)$.第4步的计算量为$$0(nmw).如果
最大流值为v,则流增广最多进行v次,所以第3步的计算量为0(mv).因此，总
的计算}$$0^}(m^{2}_}+mv})$.
例如求图5.7.1所示的网络中从s到$t，其值为=3的最小费用流.在
图5.7.1所示的网络中,每个弧上都有两个数.第一个数是费用,第二个数是
容量.
a
1,2
3,4
1,2
s
3,1
1,2
b
图5.7.1
其迭代过程如图5.7.2和图5.7.3所示：
222

============================================================
第 241 页
============================================================

0
a
1,2,0
3,4,0
(-,∞)
0
S
1,2,0
0
S
3,1,0
1,2,0
b
b
0
初始原始可行解$x{}=0
I=φ，R=
初始对偶可行解P(i)=0
标号找增广路
(+s, 2)
1
a
1,2,0
3,4,0
(-,∞)
0
S
1,2,0
1
3,1,0
1,2,0
b
b
1
I={(s,，a)}，R=
修改对偶变量
标号找增广路
1
a
1,2,0
3,4,0
(一,∞)
1,2,0
0
2
3,1,0
1,2,0
b
(+a,2)
2
修改对偶变量
I={(s,a),(a,b)},R=
标号找增广路
(+s,i2
1
a
1,2,0
3,4,0
(一,∞)
(+b,2)
0
S
1,2,0
3
S
3,1,0
1,2,0
b
h
2
(+a,2)
修改对偶变量
I={(s,a),(a,b),(b,t)）},R=
标号找增广路
图5.7.2
迭代过程(1)
223

============================================================
第 242 页
============================================================

224
为11.
流值达到3，所以最小费用流为x=2，x=1，x_=1，x_=1，_=2，最小费用
图5.7.3迭代过程(2)
增加流量
b
1,2,2
3,1,1
1,2,1
S
3,4,1
1,2,2
D
标号找增广路
I={(s,b),(a,t)},R={(a,b)}
修改对偶变量
(+s,1)
3
q
b
1,2,2
3,1,0
S
5
1,2,2
s
0
(+a,1)
(∞-
3,4,0
1,2,2
D
D
(-b,1)
2
标号找增广路
I={(s,b)},R={(a,b),(b, t)}
修改对偶变量
(+s,1)
3
q
b
1,2,2
3,1,0
S
4
1,2,2
S
0
(∞-)
3,4,0
1,2,2
D
D
(-b,1)
2
标号找增广路
增加流量
I=φ,R={(s,a),(a,b),(b,1)}
2
b
1,2,2
3,1,0
1,2,2
3
0
(∞^{-)$
3,4,0
1,2,2
D
a

============================================================
第 243 页
============================================================

2.特殊的最小费用流——运输问题
运输问题是一个特殊的最小费用流问题,它不考虑弧的容量限制,仅考虑弧
上流的费用.为建立问题的数学模型,我们首先令
$a{表示发点i可供应的产品数量(i=1，2，，m),
b{表示收点j所需的产品数量(j=1，2，…，n)，
w{表示从发点i到收点j的单位产品运输费用，
$x_{}表示从发点i分配给收点j的产品数量，
m
且假设
n
三
min
s.t.
(i=1,2,.,m)
(5.7.6)
∑x=b；(j=1,2，…,n)
$x_{}}0$
第一个约束表示从发点i运送到所有可能收点的产品总量应该等于这个发点的
总供应量a,第二个约束表示从所有可能发点运送到收点j的产品总量应该等
于这个收点的总需要量b,目标函数表示总的运输费用最小.
我们这里介绍的算法称为原始算法[{]，首先把上面的线性规划问题的对偶
规划写出来，即
∑a,u_{+∑b，0,}
max
(5.7.7)
s.t.u₁+v,≤w（i=1,2,.，m；j=1,2,·,n)
其中，u;为对应于发点i的对偶变量，v{为对应于收点j的对偶变量.再写出松紧
条件
xij
>0⇒u_₁+v=w
(5.7.8)
根据线性规划的对偶理论,如果{x}是原始规划的一个可行解并且它与对
偶规划的一组解{u{，_}一起满足松紧条件(5.7.8)，那么只要调整对偶解，使其
逐步达到可行,则它们就分别达到最优.
原始规划的初始可行解容易给出.我们知道原始规划的约束条件中有
(m+n)个方程，但由于假定
93=0
225

============================================================
第 244 页
============================================================

于是在约束中有一个方程是多余的.这样约束条件就由(m+n-1)个独立方程组
成.因而在非退化的情况下,基本解也正好有(m+n-1)个基变量.我们又知道原
始规划中任一个基都对应于网络中的一个支撑树，即具有（m+n)个点和
(m+n-1)条弧的连通子网络.这样,我们便得到一个简单方便的确定原始规划初
始可行解的方法,即首先任给运输网络一个支撑树,然后从它的任一个一次点开
始,先分配给与其关联的唯一弧的运输量等于该点可能达到的供应量或需求量，
然后将该点和与它关联的弧从支撑树中去掉.再继续重复这个过程,直到分配完
为止.
有了原始规划的-个可行解，我们可以找出u_，_{,i=1,2，，m；j=1,2，，
n，对基变量x_{，找u_₁}，_，使w_₁-u_₁}-_₁=0.对应于网络中，即在支撑树的(m+n)个
点上选择m个u_{;}和n个_,}，使其在(m+n-1)条弧(i,，j)上满足w_{-u_{₁}-_{}=0.这是
一个由(m+n-1)个方程确定(m+n)个未知数的简单问题.
剩下的问题就是逐步调整原始规划的可行解,使其对偶解在满足松紧条件
的情况下逐步达到可行.为此我们令
$wj$
=
${a_{n-^{}
$w_{}有时也称为检验数，对应于基变量或者说对应于支撑树上的每条弧，有w{=0$;
而对应于非基变量或者说对应于支撑树以外的弧,若能调整到w{≥0,则这时的
对偶解便达到可行,于是它们分别达到最优.否则我们可以在负的w{中选择最小
的那个变量,把这个变量改成基变量,改进当前的可行解,直到达到最优为止.
根据以上分析,现在给出算法步骤如下：
第1步（开始）
任给原始规划一个可行解{x_(即对应于网络的一个支撑树).
第2步(计算对偶解)
对于原始规划的可行解{x_，计算出对偶规划的一个解{u_{，_{}
第3步(计算检验数)
对于对偶规划的解{u_{，v，}|，计算
u…I=uI=?a-n-m=m
若所有的w_{均非负，则计算结束，这时得到的xj和{u_{，_}分别为原始规划和
对偶规划的最优解；否则转第4步.
第4步(调整原始可行解)
令
$w_{1=min|w|u
ij
即选择x{进人基.对应于网络中,即在支撑树上加入弧(s，t)，从而得到一个回路.
并选择其流量x=θ，使这个回路上的流量通过加θ或减θ以达到去掉一条弧的
226

============================================================
第 245 页
============================================================

目的，从而得到一个新的被改进的原始可行解{x_}.转第2步.
例如求图5.7.4所示运输网络的最优解.其迭代过程如图5.7.5至图5.7.7所
示.最优运输方案为x₁2=10，x₁3=25₂1=45x₂3=5x₃2=10，₃4=30，其他x=0
15
①-45
1
20
①
8
35
30
2
6
10
2
1-20
2
9
20
②
T2
3
50
13
10
14
3
-30
3
30
16
40
③
4
5
-30
初始原可行解
图5.7.4
图5.7.5
迭代过程(1)
wij
$u_i}$
$a}$
$\{{}$
8
ij
8
8
6
10
9
①
-2
8
0
0
一
一
6
2
6
12
13
7
9
6
5
5
1
一
2
1
13
9
16
5
14
3
12
4
16
2
-1
一
4
3
5
6
12
1
$u_}$
8
4
1
$fa}$
对偶解
检验数
15-0
30+θ
20
2
2
20-θ
3
10
3
30
调整原始可行解

============================================================
第 246 页
============================================================

228
a{≠∑_b时，可以化为产销平衡的问题来解.读者可参见文献[12]和[18].
上面的运输问题称为产销平衡的运输问题.对于产销不平衡的运输问题,即
图5.7.7迭代过程(3)
对偶解
$}$
2
4
n$
2
10
9
9
S
3
3
3
一
3
一
5
10
3
6
S
16
6
14
13
2
3
2
3
3
一
13
12
10
7
6
9
2
6
0
7
一
2
9
①
0
6
10
9
8
$\}$
9
1_{m$
$a}$
n$
调整原始可行解
00
3
10-0
3
S
2
15+0
θ
2
20-θ
45
迭代过程(2)
图5.7.6
对偶解
$a}$
-1
4
n$
-1
10
9
9
5
3
9
16
6
-3
2
-
10
3
5
16
6
14
13
②
3
3
5
3
一
10
6
7
13
12
6
9
2
0
9
0
0
6
2
10
10
9
8
$1m
9
1
n$
wij
${}$

============================================================
第 247 页
============================================================

解运输问题的原始对偶算法可参见文献[12].特别地,通常用表上作业法来解运
输问题,其方法简单易行.读者可参见文献[18].
5.8最大对集问题
对集是图论与网络中的重要概念之一，它在许多领域中有着广泛的应用.例
如,分派问题、时间表问题、中国邮递员问题等都需要用对集理论来解决.本节将
着重讨论对集的基本性质和求最大对集的一些算法.
1.二分图的对集
给定一个图G=(N，E)，设M是E的一个子集，如果M中任意两条边均不
相邻，则称M为图G的一个对集.M中每条边的两个端点被称为由M配了对.设
i∈N_，如果点i同M的一条边关联,则称点i是M-饱和点，否则称为M-非饱和
点.如果G的每一个点都是M-饱和点，则M称为G的完美对集.若不存在另外一
个对集M^{}，使得$M^{|>M|(其中|$M表示M$的基数)$，则称$M$是$_$的最大基
数对集.显然,完美对集都是最大基数对集.图5.8.1中的两个图分别给出最大基
数对集和完美对集(粗边表示在对集中的边，细边表示不在对集中的边，以后均
采用这种表示方法）.
(a)最大基数对集
(b)完美对集
图5.8.1
设M是G=(N，E)的一个对集.G的一条M-交错路是指其边在M和E\M中
交错出现的路.例如图5.8.2中路(1,2,4,6,5)就是一条M-交错路.G的一条M-增
广路是指起点和终点都是M-非饱和的一条M-交错路.例如图5.8.2中的路(3,1,
2,4,6，5)就是一条M-增广路.1957年Berge 给出了下面的定理[13].
定理5.8.1图G中的一个对集M是最大基数对集当且仅当G不包含M-
增广路，
证必要性.设M是G的一个最大基数对集.假设G包含一条M-增广路：
229

============================================================
第 248 页
============================================================

3
图5.8.2
P=（i，i₁，…，i2k+1）.令M=[Mi₁，₂|，i₃，，…，₂,₂}]Ui，|，
{i{2，i₃}，…，{2k，2k+1|，则M是G的一个对集，并且
|M'|=|M|+1
这与M是最大基数对集矛盾.
充分性.设G不包含M-增广路.假设M不是G的最大基数对集，而M{是G
的最大基数对集，则|M{|>|M，令H=G[M⊕M^']，其中M⊕M'表示M和M{
的对称差，H是由M⊕M'导出的G的子图(如图5.8.3所示).则H中每个点的次
不是1就是2，这是因为H中的每个顶点最多只能和一条M的边和一条M的边
关联.因此，H的每个连通分支或者是其边在M和M{中交错出现的偶回路,或者
是其边在M和M^{'中交错出现的路.又因为在C中有$M{|>M，所以在H中
也有M{|>|M，于是H中必存在一个分支P是路，起始于$M^'的边，同时又终
止于M_{'的边，即P的起点和终点在G中是M-非饱和的.因此P_是G的一条M-
增广路,这与定理条件相矛盾.
I
0
o
a
G中的M和$M{
G[M⊕M']
图5.8.3
对于图G的任意一个点的子集X，我们定义G中X的邻集为与X中的点相
邻的所有点的集合，并记为T_{(X).现在假定G是具有二分划($S_，T)的二分图
我们希望找到G的一个对集M,使S的每个点都是M-饱和点，简称对集M饱和
S的每个点.存在这种对集的充要条件由Hall(1935)首先给出[14].
定理5.8.2设G为具有二分划(S,T)的一个二分图，则G含有饱和S的每
个点的对集当且仅当对任意的X⊆S，有
|(X)|≥|X|
(5.8.1)
证必要性.假设G含有对集M，它饱和$S的每个顶点，并设X是$S的一个
230

============================================================
第 249 页
============================================================

子集.由于X的点在M中和$r(X)中的相异点配对，显然有|r(X)≥X.
充分性.假设G是满足(5.8.1)式的二分图，但G不含饱和S的所有点的对
集,则将有如下矛盾.设M*是G的一个最大基数对集.根据假定，M不饱和S的
所有点，设u是S中的一个M-非饱和点，并设Z表示通过M^-交错路与$u连
接的所有点集合.由于M*是一个最大基数对集，从定理5.8.1可知，u为Z中唯
一的M{-非饱和点.令
X= Z∩S，Y=Z∩T(见图5.8.4)
显然，X\{u}中的点在M之下与Y中的点配对，因此
|Y|=|X| - 1
(5.8.2)
$xx$
$Y =r(x)$
图5.8.4
因为(X)中的每个点均通过一个M-交错路连接于u，即Γ(X)⊆Y，以及
Γ(X)Y，所以我们有
Γ(X)=Y
(5.8.3)
于是由(5.8.2)、(5.8.3）知
|Γ(X)|=|X|-1<|X |
这与(5.8.1)式矛盾.
I
以上证明提供了寻找二分图的最大基数对集的一个可行算法的根据，这一
算法将在下面介绍.
图G=(N，E)的一个覆盖是指N的一个子集K，使得G的每条边都至少有
一个端点在K之中.一个覆盖K是G的最小覆盖是指G不存在另外的覆盖K，
使得|K'|<|K|(见图5.8.5).
若K是G的一个覆盖，并且M是G的一个对集，则K至少包含M中每条边
的一个端点.于是对任何对集M和任何覆盖K,均有
|M| ≤|K|
实际上，若M*是一个最大基数对集，且K是一个最小覆盖,则也有
|M| ≤|K|
(5.8.4)
231

============================================================
第 250 页
============================================================

(a)一个覆盖
(b)一个最小覆盖
图5.8.5
一般情况下，(5.8.4)式中的等号不成立(例可见图5.8.5).显然，若G是二
分图，则有M^°|=||，这个结果由Konig(1931)给出[15]}.它与$Hall定理紧密
相关,在给出它的证明之前,我们先给出一个引理.
引理5.8.1设M是一个对集,K是一个覆盖，它们满足M=|K|，则M
必定是最大基数对集，而K是最小覆盖.
证若M是最大基数对集,而K是最小覆盖,则由(5.8.4)式知
|M|≤|M|≤|K|≤||
由于M|=||,所以
|M|=|M|，|K|=||
即M是最大基数对集，K是最小覆盖._
定理5.8.3在二分图中,最大基数对集的边数等于最小覆盖的点数.
证设G是具有二分划(S$,T)的二分图，而M是G的最大基数对集，用U
表示S中的M{-非饱和点的集合，用Z表示通过$M{-交错路与U中的点相连
接的所有点的集合.置X=$ZnS$，Y=$ZnT.与定理5.8.2的证明一样，可知Y中的
每个点都是M-饱和的，并且(X)=Y.定义K=(S\X)UY(见图5.8.6).则G的
每条边必然至少有一个端点在K中.因为，否则就存在一条其一个端点在X中，
而另一个端点在T\Y中的边，这与(X)=Y相矛盾.
于是K是G的一个覆盖，并且显然有
|M|=|  |
由引理5.8.1知，K是一个最小覆盖．1
定理5.8.3也称为二分图对集的对偶定理,它有着广泛的应用.
232

============================================================
第 251 页
============================================================

X
u
S\X
0
$Y =\s)
图5.8.6
2.二分图的最大基数对集
求二分图最大基数对集,尽管用求最大流的算法可以解决,但鉴于这个问题
本身的重要性和以后讨论的方便，人们还是专门设计了一套算法,该算法称为匈
牙利算法{16].它的基本思想是:从G的任意一个对集M开始，若M饱和S的所
有点，则无疑M是G的最大基数对集；否则，由S的M-非饱和点出发，用一个系
统方法搜索一条M-增广路P.若P存在，则通过交换P在M和不在M中的边，
便得到一个其基数增加1的对集，然后从新的对集开始,继续迭代.若P不存在，
则现行的对集就是G的最大基数对集.
下面具体叙述这个算法.
对给定的一个二分图G=(S_,T,E)和一个给定的对集M⊆E，我们定义关于
M的交错树是满足下列两条件的树：
(1)树包含一个S中的非饱和点，这个点被称为树根.
(2)根和树的其他点之间所有路都是交错路.
计算过程由任意一个对集出发(可能是空对集)，S中的每个非饱和点都取
为一个交错树的根,借助于标号技巧增加点和边.最终,下列两种情况之一出现：
(1) 在T中一个非饱和点加到一棵树上.
(2) 不可能再加点和边到任何树上.
在前一种情况,对集被增广,然后对新的对集，重复构造树的过程;在后一种
情况，树被称为匈牙利树，可以用来构造由S中的所有树外点和T中所有树内点
组成的一个最优对偶解,即最小覆盖.
例如,考虑图5.8.7表示的对集,粗线表示在对集中的边,细线表示不在对集
中的边，以S的非饱和点Ⅰ和点5为根构造交错树，如图5.8.8所示，一个增广路
被找到.
233

============================================================
第 252 页
============================================================

7
2
10
5
6
8
8
3
9
增广路
10
图5.8.8
图5.8.7
增广对集表示在图5.8.9中;关于增广对集的一个交错树表示在图5.8.10
中，它是匈牙利树.图5.8.10的交错树可以用来构造一个最优对偶解.树外的S
点仅有3，树内的T点有7，8,10.可以证明这4个点覆盖图的所有边，并且是一
个最小覆盖.
2
8
3
10
1
7
2
8
5
10
4
图5.8.9
图5.8.10
算法步骤如下：
第1步（开始）
给定二分图G=(S,T,E)，令M是一个任意对集，可能是空对集，这时没有
点被标号.
第2步(标号)
(2.0)在S中，每个非饱和点给以标号“∅”.
(2.1)如果不存在未检查的标号点,转向第4步;否则,找一个具有未检
查的标号点i，如果i∈S，转向(2.2)$;如果i∈T，转向(2.3).
(2.2)检查点i的标号如下:对每个同点i关联的边|i，j}，除非j已经被标
号，否则给点i标号“i”，转向(2.1).
(2.3)检查点i的标号如下:如果点i是非饱和点,转向第3步;否则,辨认
234

============================================================
第 253 页
============================================================

同i关联的属于M的唯一边{i，j|，给点j标号“i”，转向(2.1).
第3步(增广)
终止在i的一条增广路被找到,通过反向追踪辨认在路上点i的前点,即如
果在点i的标号是“$l”,则路上倒数第二个点是l,如果在$l上的标号是k,则路上
倒数第三个点是k,等等.路的始点有标号“∅”，通过把路上不在M中的边加入
M，而把路上在M中的边从M中除去来增广M，抹掉所有标号，转回(2.0).
第4步(匈牙利标号)
标号是匈牙利的，这时没有增广路存在，M是最大基数对集.令L⊆SUT，表
示所有标号点的集合，则
K=(S\L)U(T∩L)
是对偶于M的最小覆盖.
现在分析一下算法的复杂性.若令|S|=m，|T|=n,且设m≤n.由于算法
能够通过交错树的生成过程而循环进行,因而在找到一个匈牙利树或找到一条
增广路之前,标号程序最多进行了0(mn)次;而在求出所需的对集之前，初始对
集最多能增广m次，所以总的计算量为$O($m^{}{n}).
例如,求图5.8.11所示的二分图G的最大基数对集,若初始对集如图5.8.12
所示,则算法的迭代过程如图5.8.13所示：
6
2
7
2
3
8
3
9
5
10
5
10
图5.8.11
图5.8.12
所求的最大基数对集为M={27,36,410,58|.
关于一般图上求最大基数对集的算法可参见文献[17].
3.二分网络的最大权对集——分派问题
这里介绍的求最大权对集的算法是原始对偶方法,H.W.Kuhn称为匈牙利
算法16].
为了简单起见，我们假设二分网络是完全的，即G=（S，T,S×T，W），其中
W=w_{}表示G中边的权$.并设|S|=m，T|=n，m≤n.最大权对集的线性规划
235

============================================================
第 254 页
============================================================

1
3
φ
2
7
7
1
2
3
8
8
3
6
3
3
D
9
9
4
10
10
3
力
5
业
增广路
标号
3
8
7
1
2
7
2
3
8
5
3
8
8
10
4
9
3
φ
5
10
3
5
10
标号
增广路
力
7
2
1
2
3
8
2
3
8
10
4
8
5
10
5
10
标号
匈牙利树
图5.8.13
迭代过程
模型是
max
s.t.
i = 1, 2 ,. ,m
∑x_{≤1
j= 1,2,… ,n
$x_{,j}}≥0,
i =1,2,.,m;j=1,2,.,n
可以理解为
$x_{}=1表示{i,，j∈M$
236

============================================================
第 255 页
============================================================

xj=0表示i,j}M
对偶线性规划是
(min
( ∑u1}+∑_vi
s.t.
$u_₁+v,≥w₁
i =1,2,.,m;j=1,2,..,n
$u_{}≥0
i =1,2,…,m;
$v_{}≥0
j = 1,2, . ,n
其中，u_i}为对应于S中点i的对偶变量；_i为对应于T中点j的对偶变量.松紧条
件是
$x_₁j}>0 ⇒u{+v₁=w$
(5.8.5)
$u_₁>0⇒∑x=1
(5.8.6)
$v_,>0 ⇒
∑x_{=1$
(5.8.7)
匈牙利算法的思想是保证原始和对偶解总是可行的,具体步骤可见[23].
关于一般图上求最大权对集的算法可参见[1].
*5.9复杂网络简介
随着以因特网为代表的信息技术的迅速发展，人类社会已经迈进了复杂网
络时代,人类生活和工具的网络化给人们带来了极大的便利,提高了生产效率和
生活水平,同时也带来了很多负面影响,如传染病和谣言的传播及爆发、社会的
区域动荡、电力网络的局部崩溃等.因此，人类社会的网络化需要我们对各种复
杂网络的行为有更好的认识.
长期以来，自然科学、社会科学等学科以社会网络、通信网络、电力网络等具
体网络作为研究对象,而图论是以点和边构成的抽象网络为研究对象,既然如
此,复杂网络科学作为一个新兴的交叉学科,具体研究内容是什么呢？抽象网络
和具体网络都已经进行了长期研究,那么复杂网络科学的研究意义何在?
事实上,复杂网络科学的研究对象不是单一网络,其旨在研究不同网络所存
在的共性和处理它们的普适方法;其次,复杂网络科学试图建立不同网络研究之
间的桥梁,使得对某一类网络的研究成果可以指导另一类网络的研究工作;最
后,很多复杂网络问题只依靠单学科很难得到有效解决,需要多学科协作完成，
而复杂网络科学正是这样一个多学科交叉的平台.
237

============================================================
第 256 页
============================================================

下面我们将介绍复杂网络科学的几个基本模型和常用指标.
1.复杂网络基本模型
我们或许有过这样的经历:偶尔碰到一个陌生人,同他聊了一会儿后发现你
认识的某个人他居然也认识,然后一起发出“这个世界真小”的感叹.那么对于世
界上任意两个人来说,借助第三者、第四者这样的间接关系来建立起他们两人的
联系平均来说最少要通过多少人呢?
这一问题源于社会学家、哈佛大学的心理学教授 Stanley Milgram(斯坦利·
米尔格拉姆)在1967年做的实验:“追踪美国社交网络中的最短路径”.他要求每
个参与者设法寄信给一个住在波士顿附近的“目标人物”,规定每个参与者只能
转发给一个他们认识的人,他发现送达信件所需要的平均长度为6个人.他把这
个结论称为“六度分离”,这个结论定量地说明了我们世界的“大小”,或者说人
与人关系的紧密程度.
那么社交网络上的“六度分离”现象在其他复杂网络上是否也存在呢？答
案是肯定的.例如用来描述好莱坞影视界一个演员与著名影星Kevin Bacon 合作
距离的“Bacon数”,用来描述数学论文中一个作者与匈牙利数学家PaulErdös
合作距离的“Erdös数”等.
基于复杂网络上的这种“小世界”性质,1998年6月,美国康奈尔大学的博
士生Watts 及其导师 Strogatz 教授在 Nature 上发表了题为 Collective Dynamicsof
Small-World’Networks 的论文,提出 WS 小世界网络模型24].
WS小世界网络生成算法如下：
第1步给定一个含有n个节点的环状规则网络,即网络中每个节点都与
K
左右一个节点相连，K是偶数；
2
第2步以概率p随机地重新连接网络中原有的每条边,即把每条边的一
个端点保持不变,另一个端点改取为网络中随机选择的另一个节点,规定不得有
重边和环.
显然,随着p增大,网络的随机性越大,如图5.9.1所示.
WS小世界网络模型能够很好地描述真实复杂网络的“小世界”特性,但是
是否可以准确刻画复杂网络的其他性质呢？显然不是.
事实上,我们发现,WS小世界网络的节点个数是不变的;这与真实网络规
模不断增长的特性相违背.另外,当网络中加人新节点时,这些新的节点通常更
倾向与那些具有较高连接度的Hub节点相连接,也就是优先连接特性.1999年
10月，继WS 小世界网络提出后一年，Barabasi 和 Albert 在 Science 上发表了题为
238

============================================================
第 257 页
============================================================

规则
小世界
随机
p= 0
p= 1$
随机重连
图5.9.1
Emergence of Scaling in Random Networks 的文章,提出 BA 无标度网络模型[25],该
模型综合考虑了网络的增长特性和优先连接特性，有关该模型的详细信息，感兴
趣的读者可以参阅相关文献.
2.几个常用的网络统计量
复杂网络连接结构看上去错综复杂、极其混乱,很多不同类型的复杂网络直
观上很难区分，下面我们将介绍描述网络信息的几个常用统计量.
给定网络G,网络中节点之间边的密集程度通常用网络密度来衡量，记为d,
2m
网络密度的计算公式为d(G)=
，其中m为网络中边的数目，n为网络中
$n(n-1
节点的数目.显然网络密度d越接近于1,网络就越稠密,网络中的节点越具有凝
聚力.
前面我们介绍了WS小世界网络模型,并且很多复杂网络,例如社交网络
等,都具有“小世界”特性.我们通常使用所有节点之间距离的平均值来衡量网络
的“小世界”特性，称为平均最短路径长度，也称为平均距离，记为l,计算公式为
∑
$d_
$l=
i≠jj
,其中d_表示节点i和j之间的距离，即连接两个节点的最短路径的
n(n-1)
边数.
以朋友关系网络为例，一个人的两个朋友很有可能彼此成为朋友,这种可能
性的大小反映了他的朋友圈的紧密程度.在复杂网络中,我们通常借用聚类系数
来描述某节点的邻居节点之间存在边的可能性.假设网络中节点i的度为k{,则
节点i的聚类系数C_{定义为
239

============================================================
第 258 页
============================================================

$E_{$
2E_{}$
$C_{1}=$
[k₁(k₁}-1)]/2k₁(k₁-1)
其中，E{表示节点i的k;个邻居节点之间实际存在的边数.网络的聚类系数为网
∑_}$
络中各个节点的聚类系数平均值，即C=
n
复杂网络中的个体对于复杂网络的结构和功能都扮演了不同的角色，
例如公司中有领导和员工之分，因特网网络中有服务器和客户端之分等，而
这些相对重要的节点就是网络中的关键节点.这些关键节点能够在更大程
度上影响网络的结构与功能.挖掘网络中的关键节点在现实生活中具有重
要意义.
我们通常用节点中心性来描述网络中节点的重要程度,节点中心性排序算
法研究受到越来越广泛的关注.由于应用领域极广,且不同类型的网络中节点的
中心评价方法各有侧重,学者们从不同的实际问题出发设计出各种各样的指标.
其中，节点中心性最直接的度量是度中心性,即
3
一个节点的度越大就意味着这个节点越重要.一
个包含n个节点的网络中,节点的最大可能的度
2
值为n-1,所以度为k{的节点的度中心性值通常
4
$k_{$
6
定义为$DC_{}=
$n-1$
5
例5.9.1分别计算图5.9.2的网络密度、平
均路径长度、聚类系数和各个节点的度中心性.
图5.9.2
解（1）图5.9.2所示网络中边数m=8，节
2m
8
点数n=6，则由网络密度的计算公式可得d=
$n(n-1)\15
2E_1$
(2)对于节点1而言，k_₁}=5，E{=3，则$C_{1}=
3
,同理$$C_{2}=1}, _3}=
$k_1}(k1}-11)
10
3
2
2
+1+
+1+0
2
+
2
10
3
3
109
,C_}$
=
，C=1，_=0，故C=
3
Ⅱ
3
6
180
22
(3) 由定义可得,网络的平均最短路径长度为$l=
15
（4）如图所示k₁=5，k₂2=k=2，k₃=k4=3，k₀=1，n=6，故DC₁=1，DC2=
2
3
DC_{}$
1
，DC_3}=DC$
，D_{6}=$
二
=
5
5
5
240

============================================================
第 259 页
============================================================

一个大规模网络中节点的度值可以小到个位数,又可以大到成千上万,我们
下面简单介绍一种基于节点度的节点中心性分类算法:k-壳分解.
不妨假设网络中不存在度为0的孤立节点,这样从度中心性的角度讲,度为
1的节点就是网络中最不重要的节点.如果我们把这些度为1的节点以及与这些
节点关联的边都去掉,这时网络中可能出现新的度为1的节点,我们再把这些节
点及其关联的边去掉,重复这种操作，直到网络中不再有度为1的节点为止.这
种操作类似于剥去了网络中的最外面的一层壳,我们把所有的这些去除的节点
以及它们之间的连边称为网络的1-壳.
在剥去1-壳后,新网络中的每个节点的度值
10
3
Q1
至少为2.我们继续前面的剥壳操作,这一轮去除
2
的节点以及它们之间的连边称为网络的2-壳.以
2
3
01
此类推,可以进一步得到指标更高的壳，直至网络
中的每一个节点最后被划分到相应的k一壳中,就
01
3
3
得到了网络的k-壳分解.图5.9.3为一个简单网络
1
的k-壳分解，图中的数字表示所对应节点的壳数，
1
1
这里k=3.网络中节点的壳数越大，则节点的中心
图5.9.3
性越高.
复杂网络的研究内容很广泛，研究方向也很多，例如链路预测、网络控制、网
络同步、社团划分问题等,读者可参见文献[27]，[28]和[29].
第5章习题
(A)
n
1.设G是简单图，证明G是完全图当且仅当G有
条边.
2
2.证明：图中次为奇数的点数必为偶数.
3.证明：完全图的每个点导出子图还是完全图
4.证明:若图G的点次的最小值≥2，则G有一条回路.
5.设图G连通，并设S是N的非空真子集，证明:边割{S,S是G的割集当
且仅当点导出子图G[S]和G[S]都连通.
6.证明:若树T的最大次≥$k，则T至少有k个次数为1的点.
7.用Kruskal算法求图1所示网络中的最小树.
241

============================================================
第 260 页
============================================================

1
2
7
6
3
3
4
8
5
4
2
5
图1
8.证明定理5.5.2.
9.用Dijkstra 算法求图2所示有向网络中自点1到其他各点的最短有向路.
2
4
4
1
3
I
2
2
4
6
3
2
3
5
5
图2
10.用Ford-Fulkerson 算法求图3所示有向网络中从s到t的最大流.
1
a
3
3
4
S
2
2
3
3
b
d
4
图3
11.用对偶算法求图4所示有向网络中从s到t其值为3的最小费用流.
4,2
a
D
2,3
1,3
s
2,1
1,2
3,1
1,2
3,2
b
d
5,2
图4
12.证明:二分图$_=(N,E)有完美对集当且仅当对每一个点子集$SN$,都
有r(s)|≥|s|.
13.计算图5中网络的网络密度和聚类系数.
242

============================================================
第 261 页
============================================================

1
2
4
2
6
3
5
图5
（B)
1.图6中的点表示8个城市,它们之间的边表示连接它们的道路.边上的数字表
示道路的长度.现在要沿着已有的道路铺设电缆,将8个城市连接起来,使它们全部
通上更新的电话线.问如何铺设电缆使总的线路长度最短？(路长的单位为km.)
②
900
7
800
200
300
300
5
500
500
1
4
400
500
200
100
600
200
3
6
8
400
100
图6
2.图7中的点表示11个小区，它们之间的边表示连接它们的路,边上的数
字表示路的长度(单位为km).其中在小区1设有一个报纸批发部.每个社区都
有一个服务员到小区1去批发报纸.求每个服务员去批发报纸所走的最短路程.
40
80
②
10
20
S
8
20
50
70
90
09
30
80
80
10
60
6
20
一
3
6
1
20
30
40
10
10
90
50
100
20
7
10
4
130
图7

============================================================
第 262 页
============================================================

3.某城市有4个化肥厂$A_{₁}A_2}，A_₃3}，A_{₄}，它们的化肥产量分别为$7}0t$
180t，60t，15Ot，它们要供应5个地区B{}，B_2，B3，B4，B{3的化肥需求.这5个
地区的化肥需要量分别为40t,110t,120t,80t,110t.从各化肥厂到各地区单
位化肥的运价如下表所示.试求一个使总的运费最少的运输方案.(运价单
位为元.）
需求地
运价/元
产量/t
$B_{}$
$B_{2}$
$B_{3}$
$B_{}$
$B_{5}$
$A_{1}$
140
150
60
130
140
70
化肥厂
$A{2}$
160
06
220
130
160
180
$A_{3}$
80
50
110
40
50
60
$A_{4}$
120
40
180
90
100
150
需求量/
40
110
120
80
110
4.设G=（X，Y，Z）=K_5是-个完全二分图，其中X={x_{₁1，_2}，，x_₂}，
Y=y_{₁}，_₂}，…，y_}分别表示5个人和5件工作.边x_{₁y；上的权w（x_{₁_{₁)=w{$
如下面的矩阵W所示，_{表示$x{;做工作_{的效率.求一个效率最高的工作
分配方案.
3
1
2
2
0
2
2
W =$
2
4
4
1
0
0
1
1
0
0
1
2
1
3
3
参考文献
[1]刘家壮，王建方.网络最优化[M].武汉:华中工学院出版社,1987.
[2] Kruskal J B.On the Shortest Spanning Subtree of a Graph and the Traveling Sales-
man Problem[J].Proc.AMS,1956,7:48-50.
[3] Dijkstra E W.A Note on Two Problems in Connexion with Graphs[J].Numer
Math,1959,1:269-271.
[4] Moore E F.The Shortest Path Through a Maze[J].Proc.Int.Symp.On the Theory
of Switching,Part II,1957,April:285-292.
244

============================================================
第 263 页
============================================================

[5] Ford L R.Network Flow Theory[J].Rand Corporation Report,1956,August:923.
[6] Yen J Y.An Algorithm for Finding Shortest Routes from all Source Nodes to a
Given Destination in General Networks [J].Quart. Appl. Math.,1970,27:
526-530.
[7] Floyd RW.Algorithm 97:Shortest Path[J].Comm.ACM,1962,5:345.
[8] Ford L R,Fulkerson D R.A Simple Algorithm for Finding Maximal Network
Flows and an Application to the Hitchcock Problem[J].Canad.J.Math.,1957,9:
210-218.
[9 Edmonds J,Karp R M.Theoretical Improvements in Algorithmic Efficiency for
Network Flow Problems[J].J.ACM,1972,19(2):248-264.
[10] Dinits E A.Algorithm for Solution of a Problem of Maximum Flow in a Network with
Power Estimation[J].Soviet.Math.Dokl.,1970,11:127-1280.
[11] Karzanov A V.Determining the Maximum Flow in a Network by the Method of
Preflows[J].Soviet.Math.Dokl.,1974,15:434-437.
[12]管梅谷,郑汉鼎.线性规划[M].济南:山东科学技术出版社,1983.
[13] Berge C.Two Theorems in Graph Theory[J].Proc.Nat.Acad.Sci.USA,1957,
43:842-844.
[14] Hall P.On Representatives of Subsets[J].J.London Math.Soc.,1935,10:26-30.
[15] Konig D.Graphs and Matrices(Hungarian)[J].Mat.Fiz.Lapok.,1931,38:116-119.
[16] Kuhn H W.The Hungarian Method for the Assignment Problem[J].Naval Res.
Logist.Quart.,1955,2:83-97.
[17] Edmonds J.Path,Trees and Flowers[J].Can.J.Math.,1965,17:44-47.
[18]胡运权.运筹学教程[M].2版.北京:清华大学出版社,2003.
[19]路正南，张怀胜.运筹学基础教程[M].2版.合肥:中国科学技术大学出版
社,2004.
[20]徐俊明.图论及其应用[M].合肥:中国科学技术大学出版社,1998.
[21]谢力同,刘家壮，刘桂真.图与组合拓扑[M].济南：山东大学出版社,1994.
[22] Bollobas B.Modern Graph Theory[M].New York :Springer-Verlag,2002.
[23]刁在筠，等.运筹学[M].3版.北京：高等教育出版社，2007.
[24] Watts D J,Strogatz S H.Collective Dynamics ofSmall-world' Networks[J].Na-
ture,1998,393:440–442.
[25] Barabasi A L, Albert R.Emergence of Scaling in Random Networks [J].
Science,1999,286:509-512.
[26] Kitsak M,Gallos L K,Havlin S,et al.Identifying Influential Spreaders in Com-
245

============================================================
第 264 页
============================================================

版社,2011.
[29]马修·0.杰克逊.社会与经济网络[M].柳茂森，译.北京：中国人民大学出
[28]吕琳媛，周涛.链路预测[M].北京:高等教育出版社,2013.
[27]汪小帆,李翔，陈关荣.网络科学导论[M].北京:高等教育出版社,2012.
plex Networks[ J].Nature Physics,2010,6(11):888-893.

============================================================
第 265 页
============================================================

心
第6章
网络计划技术
网络计划技术主要是指关键线路法和计划评审技术，它在现代管理中得
到广泛的应用，被认为是最行之有效的管理方法之一
美国是网络计划技术的发源地1957年美国杜邦公司在兰德公司的配合
下，提出了一个运用网络图来制订计划的方法取名为“关键路径法（Critical
PathMethod）简称CPM1958年，美国海军特种计划局在研制“北极星”导弹
潜艇过程中也提出一种以数理统计为基础，以网络分析为主要内容的新型计
划管理方法，称为“计划评审技术（ProgramEvaluationandReview
Technique）简称PERT20世纪60年代初，我国著名数学家华罗庚教授致力
于推广和应用这些新的科学管理方法，并把它们统一起来，定名为“统筹方
法”，在我国国民经济各部门得到广泛的应用，取得了显著的效果
网络计划技术的基本思想是首先应用网络计划图来表示工程项目中计划
要完成的各项工作，以及各项工作之间的先后顺序和相互依存的逻辑关系，然
后通过网络计划图计算时间参数，找出关键工作和关键线路，最后通过不断改
进网络计划，寻求最优方案，以最少的时间和资源消耗来完成系统目标，以取
得良好的经济效益
本章首先介绍网络计划图的编制方法，然后给出计算时间参数和关键线
路的方法，最后考虑网络计划中的优化问题
6.1 网络计划图
网络分析技术是以工作所需的工时作为时间因素，用工作之间相互关系的
“网络图”反映出整个工程或任务的全貌，并在此网络计划图上进行计算和优
化，因而网络计划图是网络分析技术的基础.网络计划图是在图上标注表示时间
参数的进度计划图，实质上是有时序的有向赋权图.表述关键线路法与计划评审
技术的网络计划图没有本质的区别，它们的结构和术语是一样的,不同的是前者
的时间是确定的，而后者的时间是不确定的,所以给出一套统一的专用术语
247

============================================================
第 266 页
============================================================

和符号.
1.基本术语
(1) 节点和箭线:节点和箭线是网络图的基本组成元素,箭线是一段带箭头
的射线,节点是箭线的两端连接点.
(2)工作(也称工序、活动或工作):是指将整个项目按需要的程度分解成
若干需要消耗时间或其他资源的子项目或单元,每个子项目或单元就看成是一
项工作，工作是网络图的基本组成部分.
(3)紧前工作：工作A必须在工作B结束后开始，则称工作B是工作A的
紧前工作,没有紧前工作的工作可以在项目开始时开工.
(4)事件:标志某项工作的开始或结束,本身不消耗时间和资源,某一事件
的发生标志着一些工作的结束和另一些工作的开始.
（5）路线：是指从开始事件到最终事件的由各项工作连贯组成的一条路.网
络计划图的关键问题是描述各项工作以及各项工作之间的先后关系,根据描述
方法的不同,网络图可以分成两类:箭线图(或双节点图)和节点图（或单节点
图),下面分别考虑箭线图和节点图的生成方法.
2.箭线图的绘制方法
在箭线图中各项工作或活动都用箭线表示，箭线的前后节点分别表示工作
的开始时刻和结束时刻,箭头边的数字表示活动的时间或成本,如图6.1.1所示.
①
a
-②
7
图6.1.1工作
:
各项活动或工作的前后关系由箭头的位置表示，例如图中有a和b两项工
作，工作b须等待其前项工作完成后才能开始，如图6.1.2所示.
a
②
b
1
3
图6.1.2 箭线图
在整个箭线图中每个节点代表着一个事件,只有一个节点表示项目开始事
件，一个节点表示项目结束事件,把表示工作的箭线和表示事件的节点根据工作
的先后关系连接起来就构成了一个完整的箭线图.
例6.1.1某项工程由11项工作组成(分别用代码A,B,C，…，K表示)，其
完成时间及相互关系如表6.1.1所示.
248

============================================================
第 267 页
============================================================

表6.1.1
工作
D
E
F
G
H
I
J
K
A
B
C
完成时间
4
4
15
21
35
25
15
20
5
10
11
紧前工作
无
B
A
C，D
B,E
B,E
B,E
F,G,I
F,G
无
无
试画出该项目的箭线图.
解第1步画出表示项目开始事件的节点,如图6.1.3.
第2步找出没有紧前工作的工作，以开始事件的节点为起始节点，分别画
出表示这些工作的箭线.如图6.1.4所示.
2
A
0
0
B
C
6
图6.1.3
图6.1.4
第3步对于有紧前工作的工作,依次找出表示其紧前工作结束事件的节
点，并以此节点为起始节点画出表示该工作的箭线.对于有多个紧前工作的工
作,为了表示几个紧前工作同时结束事件，在图中引入虚拟工作的概念，这种工
作只是表示事件的前后关系,不消耗时间和资源.如图6.1.5所示.
E
18
②
10
H
A
16
I
20
0
B
G
J
8
24
28
D
22
C
F
K
12
14
26
30
图6.1.5
第4步引入最后节点表示项目结束事件,所有没有后续箭线的节点通过
虚拟工作与项目结束节点连接.如图6.1.6所示.
第5步如果虚拟工作的前节点只有该虚拟工作以它为起始节点，此时则
可以把该虚拟工作的两个节点合并成一个节点,把虚拟工作去掉.例如节点8后
面只有一个虚拟工作,则可以把该节点和节点12合并,把对应的虚拟工作去掉，
并重新对节点编号.经过合并后箭线图变成图6.1.7:
249

============================================================
第 268 页
============================================================

E
0
18
10
A
H
一
16
20
32
0
B
28
4
8
G
24
D
22
K
F
30
6
14
26
12
图6.1.6
E
H
2
8
A
1
G
14
J
0
B
12
18
4
C
K
D
F
10
16
6
图6.1.7
在该图中工作F、G、I结束事件又可以描述为F、G结束时，I同时也结束了，
所以通过节点16到节点14的虚拟工作表示,如图 6.1.8.
②
E
H
8
A
I
G
B
14
J
0
4
12
18
C
D
K
F
6
10
16
图6.1.8
所以图形可以进一步简化为图6.1.9.
E
H
2
8
A
I
0
B
G
12
J
4
14
C
D
F
K
6
10
F
图6.1.9
250

============================================================
第 269 页
============================================================

在箭线图编制过程中应注意以下几个问题：
(1)在箭线图中,除起点和终点外,其间各项工作都必须前后衔接,不可有中
断的缺口.例如图6.1.10中的工作c不能到达整个计划的终点,所以是错误的.
2
C
终点
a
d
g
b
起点
f
3
e
5
图6.1.10含有中断缺口的错误网络图
(2) 网络图中,如果有循环现象,将造成逻辑上的错误,致使某项工作永远
无起点或终点,如图6.1.11中，f,g，h，i四项工作形成一个循环.
2
e
d
6
h
a
c
5
g
3
i
b
k
图6.1.11 逻辑上有错误的网络
(3)虚拟工作的应用
为了表达个别工作与其前项工作的关系,我们可以设计一个虚拟工作,虚拟工作
所需时间或成本为零.虚拟工作除了使工作间的关系表达清晰外,尚用于以下场合：
①表示两个工作可以同时开始，或可以并行实施,待两者完成后，再开始另
一工作，如图6.1.12所示.图中虚拟工作d协助表示a与b的并行关系.
2
d
a
b
3
C
图6.1.12虚拟工作(d)
② 表达整个计划的完成或开始.图6.1.13中的a，b_，i,g均为虚拟工作,用于
表示整个计划的完整性.
(4) 节点编号一般采用偶数顺序进行,原因是当中间需要添加节点时有预
留编号.
251

============================================================
第 270 页
============================================================

2
C
g
a
A
d
h
b
e
3
图6.1.13
表示计划开始和完成的虚拟工作
3.节点图
箭头图是统筹方法网络图的基本结构,其应用极为普遍.其最大的缺点是为
了完整地表达前后衔接关系,有时需要增加虚拟工作.工作节点图(Activityon
Node Diagram,简称AND)是一种改进的结构，可以避免使用虚拟工作.这种方法
以节点表示工作，以箭线表示紧前关系，如果工作a是工作b的紧前工作，就从
节点a到节点b画一条箭线，如图6.1.14.
例6.1.1的节点图如图6.1.15.
F
C
K
D
B
H
a
E
图6.1.14
图6.1.15
节点图相对于箭线图而言结构简单,编制方便,而且工作的先后关系一目了
然.但其缺点是不能直接表示出项目开始和结束的时刻以及不同工作起始和结
束的事件,在后面的事件计算中不很方便，因而本章后面主要采用箭线图处
理问题.
6.2时间参数与关键路线
网络计划技术的主要任务就是确定每个工作开始的时间、每个事件发生的
时间以及为了保证工期的正常进行必须按时完工的工作.为了实现上述目标就
必须计算网络图上的有关时间参数,这些时间参数主要包括节点出现时间、工作
开始时间和工作结束时间,所有这些时间都是建立在工作持续时间的基础上.
252

============================================================
第 271 页
============================================================

1.工作持续时间
工作持续时间计算是一项基础工作,关系到网络计划是否能得到正确实施.
为了有效地使用网络计划技术,需要建立相应的数据库.这是需要专项讨论的问
题.这里简述计算工作持续时间的两类数据和两种方法.
(1)单时估计法(定额法）
每项工作只估计或规定一个确定的持续时间值的方法.一般由工作的工作
量,劳动定额资料以及投入人力的多少等,来计算各工作的持续时间.
工作持续时间：
Q
D==$
R·S·n
Q——工作的工作量.以时间单位表示，如小时，或以体积、质量、长度等单位
表示；
R——可投入人力和设备的数量；
S——每人或每台设备每工作班能完成的工作量；
n——每天正常工作班数.
当具有类似工作的持续时间的历史统计资料时,可以根据这些资料，采用分
析对比的方法确定所需工作的持续时间.
（2）三时估计法
在不具备有关工作的持续时间的历史资料时,在较难估计出工作持续时间
时,可对工作估计三种时间值，然后计算其平均值.这三种时间值是：
乐观时间——在一切都顺利时,完成工作需要的最少时间，记作a.
最可能时间——在正常条件下,完成工作所需的时间,记为m.
悲观时间—在不顺利条件下,完成工作需要最多的时间,记作b.
显然上述三种时间发生时都具有一定的概率,根据经验,这些时间的概率分
布可以认为是已有分布.一般情况下可以认为工作进行时出现最顺利和最不顺
利的情况比较少，较多是出现正常情况,按平均意义可用以下公式计算工作持续
时间：
a+4m+b$
D=$
6
方差为
2
253

============================================================
第 272 页
============================================================

2.节点时间
节点时间主要是指节点出现的最早时间和最晚时间,节点的最早时间是指
节点对应事件可能发生的最早时间,记为ET；最晚时间是指为了保证工期不推
迟节点对应事件允许发生的最迟时间,或者说节点出现的事件晚于该时间后整
个工期必然推迟，记为LT.
项目开始节点的最早时间为0,而其他节点的最早时间等于其前临节点的
最早时间加上对应工作的持续时间中最大者,即
ET= max ET+D}
(i.j)∈A
b
其中D_{表示箭线(i，j)对应工作的持续时间，A表示所有箭线
集合.如图6.2.1所示.则ET=maxET₂+DET_{+Db}.
从开始节点出发，沿着箭线的方向就可以以此计算出每
个节点的最早时间，例6.1.1中节点的最早时间如图6.2.2
图6.2.1
所示.
5
10
E 4
2
H 35
8
A5
0
125
10
35
5
0
4
G21
J15
B10
12
14
D4
C11
F15
K 20
6
10
14
31
图6.2.2
其中图中箭线字母后的数字就是对应工作的持续时间,节点旁带下划线的数字
就是节点的最早时间.
显然结束节点的最早时间就是整个工期可能结束的最早时间,也称为工期
时间.为了保证工期时间的实现,显然结束节点的最晚时间就等于工期时间或者
该节点的最早时间.而其他节点的最晚时间等于其后续节点的最晚时间减去对
应工作的持续时间后的最小者，即
LT=minLT₁-D}
（i,j）∈A
如图6.2.3所示，则LT=min}L-DLT-D}
a
从结束节点出发,沿着箭线的反方向就可以计算出每个节点
的最晚时间,如例6.1.1中节点的最晚时间如图6.2.4所示.
图6.2.3
254

============================================================
第 273 页
============================================================

5
$\or0}$
E 4
H35
②
8
9
A5
10
1 25
0
35
10
10
J15
0
G21
12
B10
4
36
51
0
D4
C11
14
31
K 20
F15
10
6
31
16
图6.2.4
节点右下方带下划线的数字就是节点的最晚时间.
有些节点的最早时间和最晚时间不相等,这些节点的实际出现时间就可以
有一定的变化范围,这种变化范围就成为节点时差.而有些节点的最早时间和最
晚时间相等,其节点时差为0,这些节点出现的时间就不可以变化,为了保证工
期时间的正常进行,这些节点必须按时出现,这样的节点称为关键节点.在例
6.1.1中关键节点为0、4、8、10、14.
3.工作时间
工作时间包括：
最早开始时间:一项工作可以开始的最早时间,记为ES.一项工作的最早开
始时间等于对应开始节点的最早时间,若工作对应的箭线为（i，j)，则
ES=ETi
最早完成时间：一项工作按最早开始时间开工，所能达到的完工时间，记为
EF.最早完成时间等于最早开始时间加上工作的持续时间，若工作对应的箭线为
(i,j),则
EF=ES+D
最晚完成时间：一项工作按最晚开始时间开工，所能达到的完成时间，记为
LF.最晚完成时间等于对应结束节点的最晚时间,若工作对应的箭线为(i,j)，则
LF= LT
最晚开始时间:在不影响整个计划完成时间的前提下,一项工作可以开始的
最晚时间,记为LS.最晚开始时间等于最晚完成时间减去工作持续时间,若工作
对应的箭线为（i,j）,则
LS=LF-D
根据节点时间很容易就可以计算出工作的最早开始时间、最早完成时间、最
晚开始时间和最晚完成时间.例6.1.1的计算结果如表6.2.1所示
255

============================================================
第 274 页
============================================================

表6.2.1
工作
A
B
C
D
E
F
G
H
1
J
K
持续时间
5
10
11
4
4
15
21
35
25
15
20
最早开始时间
0
0
0
10
5
14
10
10
10
35
31
最早完成时间
5
10
11
14
9
29
31
45
35
50
51
最晚完成时间
6
10
16
16
10
31
31
51
36
51
51
最晚开始时间
1
0
5
12
6
16
10
16
11
36
31
工作最早开始时间和最晚开始时间的差或者最早结束时间和最晚结束时间
的差称为工作的时差,有些工作的时差大于0,这样的工作安排时可以有一定的
余地.而有些工作的时差为0,这样的工作最早开始和最晚开始时间相等,其必须
严格按时开工才能保证工程按工期时间完工，因而称这样的工作为关键工作，例
6.1.1的关键工作为B、C、K和节点4与节点8中间的虚拟工作.
4.关键路线
由关键节点和关键工作顺序连接形成一条路线，称之为关键路线.如果要工
程按工期时间完工，必须保证关键路线上的节点和工作按时开始.而非关键路线
上的工作和节点的开始时间有一定的活动余地,可根据情况合理安排.
例6.1.1的关键路线如图6.2.5用双线表示.
E 4
2
H 35
8
A5
125
0
G21
J15
B10
12
14
D4
C1I
F15
K 20
6
10
图6.2.5
关键路线的长度为51,正好和工程工期时间相等.
6.3 网络计划的优化
由于关键路线的存在,在现有工作持续时间限制下整个工程的工期无法减
256

============================================================
第 275 页
============================================================

少.如果要求缩短工程工期必须减少某些工序的持续时间,而持续时间的减少是
以增加投人或工作强度为代价的.同时,当关键路线上的某个工作持续时间减少
到一定程度后某些非关键路线可能变成关键路线,此时,若只改变的关键路线上
的工作持续时间不能达到缩短工期的目的.因而必须对整个工程统筹安排,以最
小成本实现缩短工期的目标.
例6.1.1中关键路线的持续时间是51天,其他路线均有机动时间.为了缩短
整个计划进程,就要设法缩短关键路线的持续时间，这就是网络图的优化或改
进.缩短网络图上关键路线的持续时间可通过以下途径实现：
(1)检查关键路线上各项作业的计划时间是否订得恰当,如果订得过长，可
适当缩短；
(2) 将关键路线上的作业进一步分细,尽可能安排多工位或平行作业；
(3) 抽调非关键路线上的人力、物力支援关键路线上的作业；
(4)有时也可通过重新制订工艺流程，也就是用改变网络图结构的办法来
达到缩短时间的目的.不过这种方法工作量大，只有对整个工作的持续时间有十
分严格的要求,而用其他方法均不能奏效的情况下才采用.
例6.3.1假如例6.1.1所列的工程要求在49天完成.为加快进度,表6.3.1
中列出了表6.1.1中可缩短工时的所有作业,表明这些作业计划完成时间,最短
完成时间以及比原计划缩短一天额外增加的费用（元/天).问应如何安排，使额
外增加的总费用为最小.
表6.3.1
计划完成时间
最短完成时间
缩短1天增加的费用
作业
代号
/天
/天
/元
(1,3)
B
10
8
700
(1,4)
C
11
8
400
(2,5)
E
4
3
450
(5,6)
G
21
16
600
(5,8)
H
35
30
500
(5,7)
1
25
22
300
(7,8)
J
15
12
400
(6,8)
K
20
16
500
257

============================================================
第 276 页
============================================================

解可按图6.3.1所列步骤进行.
列出所有可缩
短工期的作业
计算缩短单位工时
所增加的费用
找出关键路线上缩短
单位时间增加费用最
小的作业
将该项作业缩短时间的值控制取
下列三者中的最小值：
①工期要求尚需缩短的时间
该项作业最多可缩短的时间
到出现新关键路线时可缩短
的时间
1
计算并累计
增加的费用
否
是否满足
是
工期要求
停
图6.3.1
本例中关键路线上的作业有3项:B、GK,其中作业K缩短1天的费用为最
少.工期要求缩短2天,该项作业最多可缩短4天,但作业(7,8)的自由时差只有
1天，即工程的工期缩短1天将出现新的关键路线，即有min{2,4，1}=1,故决定
先将作业(6.8)的完成时间缩短至19天,比原计划额外增加费用500元.工期缩
短后的PERT网络图见图6.3.2.
重复上述步骤.但注意到图6.3.2中有两条关键路线,工期均为50天.为进一
步缩短工期，或单独缩短(1，3)工期，或在⑤一⑦一⑧或⑤一⑥一⑧两条双箭线
上同时缩短工期.由于前者额外增加的费用少,故决定单独缩短作业(1,3)的工
期.现工期还需缩短1天,该项作业最多可缩短2天,又工期再缩短1天后还将
出现新的关键路线,即min1,2,1}=1.故决定将作业(1,3)缩短1天,再增加额
外费用700元.
由于已满足工期要求,就不需要继续调整.由此要求在49天完成表6.1.1所
列工程项目,其网络计划图见图6.3.3,同时比正常施工,额外增加费用500+
700=1 200(元).
258

============================================================
第 277 页
============================================================

4
35
4
35
2
5
2
5
5
25
25
5
10
15
9
15
3
21
7
8
1
ω
21
7
8
11
4
11
4
15
19
15
19
4
6
4
6
图6.3.2
图6.3.3
同时网络图工期优化问题也可写成一个数学规划模型,然后用相应的软件求解.
为了介绍工期优化的数学规划模型,先介绍一下求工程工期的数学规划模型.
确定工期,实际上可以认为是给每个节点确定一个出现时间,最后一个节点的出
现时间就是工程工期,第一个节点的出现时间为零；一个可行的时间安排要求对每件
工作前后节点出现时间差应大于或等于工作的持续时间,例对工作(ij)，其前节点
为i，后节点为j，持续时间为a{j，假设两个节点的出现时间为X_{,X_{,则要求
$X_-_{≥a}$
例6.1.1中节点零为开始节点，出现时间为零,设节点2到节点14等7个节
点的出现时间分别为X_{}，X_2}，.，X_{7}，则X_{,就是工期，要求满足：
$X{1=5$
$X_{2}} 10$
$X {3}11$
$X {3}-X{2}≥4$
$X-X{1}≥44$
$X_{4}-X_2}=0$
$X _-X3}≥11$
$X_-X₄4≥21$
$X{-X_4≥$
$X _{}-{3}=0$
$X_{2}-X{4}3$
$X_{,}-X_{6}15$
$X_{}-_3}≥220$
$X_₁1,X2，, ,X,≥$
节点14出现时间要尽可能早,因而要求X{最小,所以对应的数学规划模
型为
259

============================================================
第 278 页
============================================================

min
$X_}$
s.t.
$X_{15$
$ _{2} 10$
$ _{3}1
$X_3-X2}≥4$
$X{4}-X{1}}=4$
$X{4}-X{_2}=0$
$X_- 3}5$
$X_{3}-X{2}≥2$
$X _{2}-X{4}22$
$X{}-_{}=0$
$X_{2}-X{4}≥35$
$X_{2}-X_{6}15$
$X {2}-X,2}≥}22$
$X_{1},X{2}， ,X,}=
用LINGO求解，可得X₁=6，₂2=10，X_₃=16，X=10，_=31，X_=36，X=51.
为了缩短工期,给每个工作安排一个持续时间缩短量,如在例6.1.2中要分
别设$y_{1，_{2}，…_，_{1代表工作A$，B}，…$，K$的缩短时间，显然要求其不超过最大可缩
短时间,同时每个工作前后节点出现时间差不少于缩短的持续时间，X_{7不超过
工期要求，所以有约束：
$X_{49
$X_{1≥5-y$
$X {2}≥}1-y_2}$
$X 3}≥11-y3$
$X₃3-X2}≥4-y4$
4-X₁1≥4-y5$
$X{-X{2}0$
X_-X3≥15-_6$
X_-X4≥21-y7
X2-X4≥35-_8
$X{6-X4≥25-y9$
$X{}-X_,}0$
$X₁-X₀≥15-y10$
$X{2}-X_,≥2-y
y₁≤0，y₂≤2，y₃≤3，y₄≤0，y≤1，
γ≤0，y₁≤5，y8≤5，y₃≤3，y₁0≤3，y₁≤4
X₁,y₁≥0,i=1,2,…，7,j=1,2,.,11
260

============================================================
第 279 页
============================================================

总费用为700y₂+400y₃+450y+600y+500y+300y₃+400y10+500y11，所以对
立的规划为
min
700y2+400y₃+450y₃+600y₂+500₃+300y₃+400y₁0+500y₁1
s.t.
$X {7}9$
$X_{1}+y{,}} 5$
$X _{2+y_2≥1$
$X _3+y3}1$
X₃-X2+y₄4≥4
X-X_₁+y₃≥4
$X{4}-X{2}}0$
X-X₃+y_₀≥15
$X-X4+y,≥21
$X-X₄4+y8≥3
$X-X4+y,≥25
$X{-X_3}=0$
$X{,-X+y10}≥1
$X-X₃+yμ≥20
y_₁≤0，y₂≤2，y₃3≤3，y₄≤0，y_₃≤1，y₀≤0,
y₁≤5，y8≤5，y₃≤3，y₁0≤3，y₁≤4
X,y,≥0,i=1,2,..7,j=1,2,..,11
使用LINGO求解得
y_1=0，X₁=5
$y_2=1$X₂2=9$
$_3=0,X₃3=13
₄=0,X4=9
y_{=0,X=30
y{=0,X=34
$γ_{2=0，X_,}=49
$y_{}=00$
$y_{}0$
$y_{10}00$
$y_1=1$
总费用为1200元.

============================================================
第 280 页
============================================================

网络计划技术在现代管理中有着重要的应用,是最为有效的管理方法之一.
近年来,网络科学的进一步发展和海量数据的产生为大范围推广网络计划技术
创造了条件.
第6章习题
中
(A)
1.某项物流业务所含的工作、所需时间、前项工作如下表所示.试绘出网
络图.
工作
耗时
前项工作
D
2
一
b
10
c
22
一
d
10
a
e
20
c
f
3
d
g
4
$f,be
2.根据下表给出的条件,绘出节点图和箭线图.
作业
紧前作业
作业
紧前作业
A
一
K
f
B
A
7
B
C
A
M
K,L
D
C
N
J
E
C
0
M,N$
F
D，E
P
T'T
G
A
0
1
H
E ,G
R
P，Q
I
E,H
S
J
O.R
F
262

============================================================
第 281 页
============================================================

3.计算下列网络图(图1)中节点的最早时间和最晚时间,并找出关键线路.
2
1
3
5
7
2
0
5
1
4
2
3
1
2
6
9
11
2
2
3
4
1
8
2
4
10
图1
4.计算下列网络图(图2)中工作的最早时间和最晚时间,并找出关键线路.
3
7
2
5
8
2
0
2
5
8
3
2
1
4
7
9
4
2
1
7
8
3
6
图2
(B)
1.表中给出一个汽车库及引道的施工计划：
作业编号
作业内容
作业时间/天
紧前作业
1
清理场地，准备施工
9
无
2
备料
8
无
3
车库地面施工
7
1,2
4
墙及房顶桁架预制
16
2
5
车库混凝土地面保养
25
3
6
竖立墙架
4
4,5
7
竖立房顶桁架
6
6
8
装窗及边墙
10
6
9
装门
4
6
10
装天花板
12
7
11
油漆
18
8,9,10
12
引道混凝土施工
8
3
13
引道混凝土保养
22
12
14
清理场地，交工验收
4
11,13
263

============================================================
第 282 页
============================================================

试回答:(1)该项工程从施工开始到全部结束的最短周期；(2) 如果引道混
凝土施工工期拖延10天，对整个工程进度有何影响；(3)若装天花板的施工时
间从12天缩短到8天,对整个工程进度有何影响；(4)为保证工期不拖延，装门
这项作业最晚应从哪一天开工；(5)如果要求该项工程必须在75天内完工，是
否应采取措施及应采取什么措施.
2.在上题中如果要求该项工程在70天内完工，又知各项作业正常完成所需
时间、采取加班作业时最短需要的完成时间，以及加班作业时每缩短一天所需附
加费用见下表：
正常作业
加班作业时所需
每缩短一天的附
作业编号
作业内容
所需天数/天
最短天数/天
加费用/(元·天)
1
清理场地，准备
9
7
6
施工
2
备料
8
一
一
3
车库地面施工
7
5
10
4
墙及房顶桁架
16
12
7
预制
5
车库混凝土地面
25
保养
6
竖立墙架
4
2
18
7
竖立房顶桁架
6
3
15
8
装窗及边墙
10
8
5
9
装门
4
3
5
10
装天花板
12
8
6
11
油漆
18
14
7
12
引道混凝土施工
8
6
10
13
引道混凝土保养
22
14
清理场地，交工
4
验收
试确定保证该项工程70天完成而又使全部费用最低的施工方案.
264

============================================================
第 283 页
============================================================

参考文献
[1]刘家壮，王建方.网络最优化[M].武汉：华中工学院出版社，1987.
[2]管梅谷，郑汉鼎.线性规划[M].济南：山东科学技术出版社，193.
[3]胡运权，等.运筹学基础及应用[M].6版.北京:高等教育出版社,2014.

============================================================
第 284 页
============================================================

第7章
排队论
排队论是专门研究由于随机因素的影响而产生的拥挤现象的科学，也称
为随机服务系统理论它所研究的问题有强烈的实际背景，其所得的结果有广
泛的应用本章只介绍排队论的基本理论与方法
7.1随机服务系统概论
本节将介绍随机服务系统的基本组成部分、符号表示法以及在排队论中常
用的几个概率分布.另外,生灭过程方法是处理随机服务系统的一个重要方法，
所以还将简单介绍生灭过程的理论.
1．随机服务系统的基本组成部分
在日常工作和生活的各个方面,人们都会遇到各种各样的拥挤问题——为
了获得某种服务而排队等待，如去医院看病、去售票处购票、去车站乘车，等等.
除了有形的排队以外,还可以是无形的队列，如有几个旅客同时打电话到售票处
订购车票,当一个旅客在通话时,其他旅客就只能在各自的电话机前等待.他们
可能分散在各个地方,但却形成了一个无形的队列等待通话.排队的不一定是
人，也可以是物，如生产线的原料、半成品的等待加工，因出故障而停止运转的机
器等待工人修理，码头的船只等待装卸,要降落的飞机因跑道不空而在空中盘
旋，等待降落等.提供服务的也不一定是人，可以是物，如机场的跑道、公共汽车
等.顾客可以是有限的，也可以是无限的；可以是可数的，也可以是不可数的，如
在水库问题里,上游来的水就是不可数的.服务员也不一定固定在一个地方对顾
客进行服务，如出租汽车随机到来为乘客服务．
今后凡是要求服务的对象统称为“顾客”,提供服务的统称为“服务台”.顾
客与服务台构成一个随机服务系统，或称排队系统.
一个排队系统能抽象地描述如下:为获得服务的顾客到达服务台前,服务台
有空闲便立刻得到服务，若服务台不空闲，则需要等待服务台出现空闲时再接受
266

============================================================
第 285 页
============================================================

服务.服务完后离开服务台.因此排队系统模型可用图7.1.1表示.
顾客到达
列队
服务完成离去
服务台
0
正在接受服务的顾客
服务台1
顾客到达
服务完成离去
服务台2
服务台3
图7.1.1
一个排队系统是由三个基本部分组成的:输人过程、排队规则及服务机构.
(1) 输入过程.输人过程就是顾客按怎样的规律到达.它首先应包括顾客总
体数,是有限的还是无限的,其次应说明顾客到达的方式,是成批到达(每批数
量是随机的还是确定性的)还是单个到达.最后应说明相继到达的顾客(成批或
单个)之间的时间间隔的分布是什么.
（2）排队规则.排队规则是指服务机构什么时候允许排队，什么时候不允许
排队;顾客在什么条件下不愿意排队，在什么条件下愿意排队;在顾客排队时，服
务的顺序是什么，它可以是先到先服务、后到先服务、随机服务、有优先权的
服务等.
（3)服务机构.服务机构主要是指服务台的数目，多个服务台进行服务时，
服务的方式是并联还是串联；服务时间服从什么分布等.
为了描述排队模型，D.K.Kendall首先提出排队模型的记号方案.用四个符
号表示一个排队模型:第一个符号表示顾客到达时间间隔分布,第二个符号表示
服务时间分布，第三个符号表示服务台数目，第四个符号表示排队系统中允许的
最大顾客容量.符号之间用一斜线“/”分开.例如,M/M/c/∞表示顾客到达时间
间隔分布是负指数分布，服务时间服从负指数分布，有c个平行的服务台，系统
的顾客容量没有限制.也有人用六个符号表示排队模型，除前面四个相同外，第
五个符号表示顾客总体的大小,第六个符号表示排队规则.
2.几个常用的概率分布和最简单流
(1)负指数分布(记为M)
若一个随机变量ξ，它的分布密度函数为
$λe^-}$
-λ$
t≥0
$f(l)=$
(λ>0,常数)
{0,
1<0

============================================================
第 286 页
============================================================

则称ξ服从参数为的指数分布，又称服从参数为的负指数分布，分布函
λ
λ
数为
${1- e^{-{},
t≥0
F(t)=$
0,
t<0
1
的数学期望为E()=，方差为D()=
1
当t≥0时，有
λ
P|ξ>t}=1-F(t）= e^
负指数分布有重要的应用,常用它作为各种“寿命”分布的近似.例如无线电
元器件的寿命、动物的寿命、电话问题中的通话时间等.排队论中的服务时间和
顾客到达间隔时间都常常假定服从负指数分布.
负指数分布有一个重要性质,即无记忆性或称无后效性.若把ζ解释为电子
元件的寿命,无记忆性就是不论现在的年龄多大,剩余寿命的条件分布与原分
布相同,不受已有年龄的影响,用概率公式表示为
P|ξ>t+x|ξ>t}=P|ξ>x}
反过来,连续型随机变量的分布函数中,只有负指数分布具有无记忆性.
(2)最简单流
通常把随机时刻出现的事件组成的序列称为随机事件流,例如用N(t)表示
(0,t]时刻内要求服务的顾客人数就是一个随机事件流.
现在我们提出在排队系统中常用的一种流—最简单流.
如果一事件流{N(t),t>0}满足下列3个条件,就称为最简单流.
1°平稳性以任何时刻_{0为起点，(_{0，_0+t]时间内出现的事件数只与时
间长度t有关，而与起点_0无关，因此用N（t)表示（_0}，_+_t]内出现的事件数，
$P{k(t)表示N(t)=k的概率，则
P(t)=P{N(t）=k},
k= 0,1,2,..
8
∑Pk(t)=1$
k=0
2°无后效性在（_，_{0+t]时间内出现k个事件与时刻_0以前出现的事
件数无关.
3° 普通性在充分小的时间区间Δt内,发生两个或两个以上事件的概率
是比Δt高阶的无穷小量，即
8
P(∆t）=∑P（∆t）=o(∆)
k }2$
在上述三个条件下，可以推出
268

============================================================
第 287 页
============================================================

(λt)$
$P_{k}=
-λ1
k=0,1,2,.
e
k!
最简单流与负指数分布有着密切的关系.如果随机事件到达的间隔时间相
互独立并且服从同一负指数分布,则这样的随机事件流就是最简单流.
最简单流在现实世界中常常遇到,如市内交通事故、稳定情形下电话呼唤次
数、到车站等车的乘客数、上下班高峰过后通过路口的自行车流、人流、汽车流等
都是或近似最简单流.一般说来,对于大量的稀有事件流，如果每一事件流在总
事件流中起的作用很小,而且相互独立,则总的合成流可以认为是最简单流.
(3)生灭过程
现在定义排队论中常用到的一类随机过程——生灭过程.
定义7.1.1设有某个系统具有状态集S={0,1,2，…}，若系统的状态随
时间t变化的过程{N(t)，i≥0}满足以下条件，则称为一个生灭过程.
设在时刻t系统处于状态n的条件下，再经过长为Δt(微小增量）的时间，
(1)转移到n+1(0≤n<+∞)的概率为λ，Δt+o(Δ_t)$;
(2)转移到n-1(1≤n<+∞)的概率为uμ₂Δt+o(Δt);
(3)转移到$S-{n-1，n_，n+1}的概率为o(Δt)，
其中λ_，>0,_{_>0为与t无关的固定常数.
若S仅包含有限个元素，S={0，1，2，…，k}，也满足以上条件，则称为有限状
态生灭过程.
生灭过程的例子很多,例如，一地区人口数量的自然增减、细菌繁殖与死亡、
服务台前顾客数量的变化都可看做或近似看做生灭过程模型.
现在来讨论系统在时刻t处于状态n的概率分布，就是求P_{n(t)=P_{$N({t)=$n_}，
n = 0,1,2,..,≥0.
设系统在时刻t+Δt处于状态n，这一事件可分解为如下四个互不相容的事
件之和：
(1)在时刻t处于状态$n，而在时刻$t+Δ_t仍处于状态$n，其概率为$P_{n(_t).
(1-λn∆t-nΔ∆l)+o(Δl);
(2) 在时刻t处于状态n-1，而在时刻t+Δ_t处于状态n，其概率为
$Pn-1(1)λn₁∆i+0（△_c);
(3)在时刻t处于状态n+1}，而在时刻l+Δt处于状态n，其概率为
$Pn+₁（t)n+₁∆+0（Δl）;
(4)在时刻t处于别的状态(即不是n-1,n_,n+1)，而在时刻$t+Δt处于状
态n，其概率为o(Δl).
由全概率公式，有
269

============================================================
第 288 页
============================================================

Pn（t+∆l）=Pn（t）（1-λΔl-μ∆t）+n+₁（）+Δ+
Pn-₁（t）λ-₁∆+o（∆）
类似地，对n=0有
$P0(t+Δt）=P0（t）（1-λ₀∆t）+P₁（t）μ₁Δ∆t+o(∆t）
将上面诸式右边不含Δt的项移到左边，用Δt除两边，然后令Δt→0,假设极
限存在,就得到差分微分方程组：
$P{（t）=λn-1Pn-₁（t）)-（λ+n)Pn（t）+μ+1Pn+（t
(7.1.1)
P(t)=-λ0P0（t）+₁P₁(t)
解出这组方程，即可得到时刻t系统的状态概率分布{P_{n}(t)，n∈S_}，即生灭过
程的瞬时解.一般说来，解方程组(7.1.1)比较困难.
假设当tt∞时，P_{n}(t)的极限存在.
$limPn（t）=pn，
n =0,1,2,…
$t→∞
同时可以证明
$limP)=0,,
n=0,1,2,.
t∞
这样方程组(7.1.1)两边对t取极限,就得到线性方程组
O=λn-1Pn-1-（λ+μn）pn+μn+1Pn+1
n=1,2,.
(7.1.2)
0=-λ0P0+μ₁P1
移项后，(7.1.2)变成
[λnPn-μ+Pn+1=λn-1Pn-1-μnP{n,
n= 1,2,..
λOP0-μ₁P₁=0
所以
λnPn-μn+₁Pn+₁=λn-₁Pn-₁-μnPn
0=d²2-°d0Y=…=-"d-"-2-"d-Y=
$λn$
$λ{n}λn−$
λ，·λn-₁·…·λ。
$P {}1$
$P_n$
$P{n$
$p0$
$μ{}1$
$μ{n+1_}$
n+1μn…μ1
假设
8
λn·λn-1·…·λ0
∑
<+∞
n=0μn+1μn··μ1
8
由于$ }$_n}=1,就能解出
$n=0
1
P_{o$
二
λn·λn-1·…·λ0
8
1+
∑
(7.1.3)
μn+1μn·μ1
n=0
λn-1λn-2·…·λ0
n=1,2,…
p{n$
P{0，
μnμ_n-1…·μ1
270

============================================================
第 289 页
============================================================

这就是生灭过程在l→∞时的状态概率.在大多数实际问题中,当t很大时,系统
会很快趋于统计平衡.
7.2无限源的排队系统
本节假定顾客来源是无限的,顾客到达的时间间隔服从负指数分布且不同
的到达时间间隔相互独立，每个服务台服务一个顾客的时间服从负指数分布，服
务台的服务时间相互独立，服务时间与间隔时间相互独立.
1.M/M/1/∞系统
设顾客流是参数为λ的最简单流，λ是单位时间内平均到达的顾客人数,即
1
顾客到达的时间间隔相互独立并且服从期望为一的负指数分布.只有一个服务
λ
台，服务一个顾客的服务时间v服从参数为μ的负指数分布.平均服务时间为
1
λ
E(v)=—，在服务台忙时，单位时间平均服务完的顾客数为μ.称ρ=-为服务
μ
μ
强度.
用N(t)表示在时刻t顾客在系统中的数量(包括等待服务的和正在接受服
务的顾客).我们先来证明系统{N(t),i≥0}组成生灭过程.
由于顾客的到达是最简单流,参数为λ，故有
$(λ_{)^{}$
$P_{k}=$
k=0,1,2,..
k!
则在长为Δt的时间内有一个顾客到达的概率为
c
$P₁(Δl）=λAe=λΔt（1-λΔ+
Δt{2+·）=λΔt+0（△c）
2!
没有顾客到达的概率为
$P0(Δt）=e-Δ=1-λΔ+o（Δ)
到达2个或2个以上顾客的概率为
8
R
∑Pk（∆t）=∑Pk（∆₁）-P0（∆t）-P₁（)
k=2
k}0$
H
(λ△_t)^{}$
-AΔ1
= e
-P_0(∆_l）-P₁(Δt)
k!
k=0
= e
-AΔ1AΔ
-λ∆t-(1-λ∆t)+0(∆t)
e
271

============================================================
第 290 页
============================================================

=o(∆t)
在服务台忙时（总认为只要系统内有顾客，服务员就得进行服务），顾客接
受服务完毕离开系统的时间间隔为独立的、参数为μ的负指数分布，所以在系统
忙时，输出过程为一最简单流,参数为u.于是当系统忙时,在Δt时间区间内1个
顾客被服务完的概率为$uΔt+o(Δ_{t)，没有顾客被服务完的概率为1-μΔ_t+
0(Δt)，两个或两个以上顾客被服务完的概率为o（∆t)，且u与系统的顾客数无
关，与微小时间区间的起点无关.
对任意给定的t(≥0)，微小增量Δt，假设
P（∆t）=P{N(t+∆t）=j|N(t）=i}，≥0
先考虑j=i+1的情况，当i≥1时，
$P_{,i+1}_t)=P{Δ_t时间内恰好到达1个顾客而没有顾客被服务完
或恰好有k个顾客到达并且k-1个顾客被服务完，k≥2}
=PΔt时间内恰好到达1个顾客而没有顾客被服务完}+
P{Δ_t时间内到达k个顾客而服务完$k-1个顾客，k≥2}
=λ∆t[1-∆t+(∆)]+o(∆t)
=λ∆t+o(∆t)
当i=0时，
P01(∆t)=PN(t+∆t）=1|N(t）=0}
=P{Δt时间内到达1个顾客}
=λ∆t+o(∆)
P,i−₁(∆t）=P{N(t+∆t）=i-1|N(t）=i}
=P{△t内无顾客到达且恰好服务完1个顾客
或到达k个顾客而服务完k+1个顾客，k≥1}
=P{∆t内无顾客到达并且恰好服务完1个顾客}+
P{Δ_t内有k个顾客到达而且恰好服务完k+1个顾客，k≥1}
=[1-λ∆t+（∆）][∆t+（∆）]+(∆)
=∆t+(∆t）
Pi,j(∆t)=P{N(t+∆t)=j|N(t)=i}
=P{Δt内到达k个顾客而服务完i+k-j个顾客，k≥2}
=o(∆t)，j>i+1
P,j(∆t)=P{N(t+△∆l）=j|N(t)=i|
=P{_t内服务完k个顾客而到达j-i+k个顾客，k≥2}
=o(∆t)，j<i-1
由以上结果，可知{N(t)，i≥0}是一生灭过程，并且
272

============================================================
第 291 页
============================================================

$λ_{n}=λ
n≥0
$μ_{n} =
n≥1
由生灭过程求平稳解公式,得
λn-1λn-2···λ{0
$P_{ }= ^{}P$
1
(7.2.1)
$Pn$
=
μ_nμn-1·μ₁1
由假设ρ=
λ
<1,则
μ
1
-= 1 -ρ
P_{0$
=
$\（\frac{}{)$
8
n
n=0
从而平稳分布为
$P{n=（1-ρ)ρ，n≥0
(7.2.2)
P_{0} =}1-ρ是排队系统中没有顾客的概率，也就是服务台空闲的概率，而ρ恰好是
服务台忙的概率.
利用平稳分布可以求统计平衡条件下的平均队长L、平均等待队长L{、顾客
的平均等待时间W平均逗留时间W等.
用N表示在统计平衡下系统的顾客数,平均队长L是N的数学期望
8
8
L=E(N)=∑npn=∑n(1-ρ)ρ
n=0
n=0
8
8
=（1-ρ）ρ∑nρ=（1-p）ρ∑（ρ）
$n=
8
$n=00$
ρ
(7.2.3)
1 −ρ
用$_{}表示在统计平衡时，排队等待的顾客数，它的数学期望$L_=E(_{})就
是在等待服务的平均顾客人数.
8
8
L=E(N₂）=∑（n-1)pn=∑npn-ΣPn
8
n=1$
n=
n=1
ρ
8
− ρ
1 -ρ
$n=00$
ρ
2
(7.2.4)
1 -ρ
273

============================================================
第 292 页
============================================================

现在来求平均等待时间W_{q，当一个顾客进入系统时,系统中已有n个顾客
1
1
的概率为p{n，每个顾客的平均服务时间为—，所以他的平均等待时间为n·
—
μ
μ
因此
8
1
1
8
1
ρ
λ
∑
∑
E(N)=
W
=
n
Pn$
=
npn$
4
μ
μ
n=0
μ(1-ρ)μ( −λ)
n=0
(7.2.5)
再来求顾客的平均逗留时间(平均等待时间再加上平均服务时间）W,
1
λ
1
1
W=W_+
+
(7.2.6)
μ(μ-λ)μ-λ
μ
平均队长L、平均等待队长L、平均逗留时间W、平均等待时间W_是排队系
统的重要特征.这些指标反映了排队系统的服务质量,是顾客及排队系统设计者
关心的几个指标.由(7.2.3)到(7.2.6)的公式,得到这四个指标之间的关系.
L=L-(1-p{0)
(7.2.7)
λW=L，λW=Lq
(7.2.8)
这两组关系式,可以做这样的直观解释:当系统内有顾客时,平均等待队长
L应该是平均队长L减1，当系统内没有顾客时，平均等待队长Lq与平均队长L
相等,所以
1
L=L-[（1-p0)·1+p0·0]=L-(1-p0)
单位时间内平均进入系统的顾客为λ个.每个顾客在系统内平均逗留W单
位时间.因此系统内平均有λW个顾客.同样的理由，系统内平均有λW_{个顾客
在等待服务.
(7.2.8)式在更一般的系统也成立，通常称为Little公式.
例7.2.1某火车站的售票处设有一个窗口.若购票者是以最简单流到达，
平均每分钟到达1人，假定售票时间服从负指数分布，平均每分钟可服务2人，
试研究售票窗口前的排队情况,并求等待顾客人数超过5人的概率.
λ
1
解由题设λ=1人/分，μ=2人/分，ρ=
Ⅱ
2
μ
ρ
平均队长L=P
=1（人）.
1 −ρ
2
ρ
1
平均等待队长L_}$
（人）.
二
1 −
2
平均等待时间W_{q}$
λ
1
（分).
=
Ⅱ
μ(μ-1)
2
274

============================================================
第 293 页
============================================================

1
平均逗留时间W=-
=1(分).
μ-λ
1
2
PIN≥61=∑ρP=()(1-\
8
8
口
$n{}=$
"=6
=2（\f{{$
8
$"+1
7
8
$（\fra{}{2})$
6
例7.2.2在某工地卸货台装卸设备的设计方案中，有三个方案可供选择，
分别记作甲、乙、丙.目的是选取使总费用最小的方案，有关费用（损失）如下表
所示：
方案
每天固定费用/元
每天可变操作费c/元
每小时平均装卸袋数/袋
甲
60
100
1 000
乙
130
150
2 000
丙
250
200
6 000
设货车按最简单流到达，平均每天(按10小时计算)到达15车，每车平均装
货500袋,卸货时间服从负指数分布.每辆车停留1小时的损失为10元.
解平均到达率λ= 1.5车/时,服务率μ依赖于方案.
1 000袋/时
=2车/时
μ甲
二
500袋/车
2000袋/时
μ2
=4车/时
=
500袋/车
6000袋/时
=12车/时
μ丙
二
500袋／车
由(7.2.6)，1辆车在系统内的平均停留时间为
1
$W_{}$
=2(时/车)
=
2 -1.5
1
$W_{2=
=0.4(时/车)
4 - 1.5
1
W
=0.095(时/车)
丙
=
12-1.5
每天货车在系统停留的平均损失费为W×10×15（元），每天的实际可变费用
（如燃料费等）为
(可变操作费/天）×设备忙的概率=c·（元/天)
275

============================================================
第 294 页
============================================================

方案
每天固定费用/元
每天实际可变费用/元
每天逗留费/元
每天总费用/元
甲
60
75
300
435
乙
130
56.25
09
246.25
丙
250
25
14.25
289.25
从上表知方案乙的总费用最省，
例7.2.3
要购置计算机,有两种方案.甲方案是购进一大型计算机，乙方
案是购置n台小型计算机.每台小型计算机是大型计算机处理能力的一.设要求
1
n
上机的题目是参数为λ的最简单流,大型计算机与小型计算机计算题目的时间
是负指数分布,大型计算机的参数是u.试从平均等待时间、平均逗留时间看，应
该选择哪一个方案.
解设ρ=，按甲方案购大型计算机，则
λ
μ
W_a$
ρ
λ
平均等待时间
μ(1-ρ)μ(μ-λ)
1
平均逗留时间
W
二
μ-λ
按乙方案购n台小型计算机，每台小型计算机的题目到达率为—，服务率为
λ
n
u
λ/n
$v$
$d^{$
=
，且
n
μ/n
μ
ρ
np
平均等待时间
W
Ⅱ
=nW$
乙
q甲
μ
μ(1-ρ)
(1-ρ)
n
W_{$
1
n
平均逗留时间
=nW_}$
=
μ
λ
μ-λ
n
n
所以只是从平均等待时间、平均逗留时间考虑，应该购置大型计算机.
2.M/M/1/k系统
有些系统容纳顾客的数量是有限制的.例如候诊室只能容纳k个就医者.第
k+1个顾客到来后,看到候诊室已经坐满了,就自动离开,不参加排队.
276

============================================================
第 295 页
============================================================

假定一个排队系统有一个服务台，服务时间是负指数分布,参数是μ.顾客
以最简单流到达,参数为λ.系统中共有k个位置可供进人系统的顾客占用,一旦
k个位置已被顾客占用(包括等待服务和接受服务的顾客)，新到的顾客就自动
离开服务系统而不再回来.如果系统中有空位置,新到的顾客就进入系统排队等
待服务，服务完后离开系统.
用N(t)表示时刻t系统中的顾客数，系统的状态集合为$S={0,1,
2，…，k}.与M/M/1/∞的证明方法一样，可以证明N(_t)，i≥0是个有限生
灭过程,有
$λ{n}=λ,
n = 0,1,2,. ,k -  1
(7.2.9)
$μ_{1}=,
n = 1,2,.. ,k
λ
x
n
$P_{1}=$
P{0}n=0,1,2,…,k
ρ =
μ
1
ρ=1
1
$k+1{}$
$P{o$
=
=
k
1 −ρ
∑
ρ
n
k+1，
ρ≠1
{1-ρ
n=0
1
ρ = 1
$k+1^{}$
$P_{}= $
n = 0,1,2,.. ,k
(1-ρ)ρ
n
1-ρ$
ρ≠1
I+y
k
平均队长$L{=}n{p{n}，分两种情况:
n=0
ρ=1时，
k
1
31
L=
M
n
$k+1$
2
n=0
ρ≠1时，
(1-ρ)ρ
n
(1-ρ)ρ
k
h
k
∑
np$
n-1$
$np{n=$
∑
n.
$k{+1$
1-ρ
$k {+1$
1 -ρ
n=1
$n=0$
n=0
(1-ρ)ρ
d
k
∑
ρ
"
1-ρ$
$k}+1$
dp
=0
$k+1
(1-ρ)ρd/1-ρ
$1-ρ$
$k +1$
dp
1-ρ
277

============================================================
第 296 页
============================================================

(k+1)ρ
k+1
ρ
(7.2.10)
1 -ρ
$1-p$
$k+1$
平均等待队长
$(k(k-1)
ρ =1
2(k+1)'
L。=L-(1-P{0)
(7.2.11)
9
ρ
ρ(1+kρ{)
ρ≠1
[1 − ρ
1 -ρ
$k{+1$
pk是个重要的量,它称为损失概率,即当系统中有k个顾客时,新到的顾客
就不能进入系统.单位时间平均损失的顾客数为
λ
ρ = 1
$k+1^{}$
$λ_1}=λpk=$
λ（1-ρ)ρ
k
ρ≠1
1-ρ
$k+1
单位时间内平均真正进入系统的顾客数为
kλ
ρ = 1
$k+1{}$
λ。=λ-λpk=λ(1-pk)=
λ(1-pρ{)
ρ≠1
[1 -ρ
$k+1
由Little公式，可以求得平均逗留时间、平均等待时间：
${k+ 1
ρ = 1
2λ
L
0
$W ==
(7.2.12)
λ
1
ρ≠1
$μ-λ
λ(1-ρ{)
( k - 1
ρ = 1
$Lq$
2λ
$W_{4}$
二
(7.2.13)
λn$
ρ
ρ≠1
(μ-λλ(1-ρ{)
1
当ρ≠1时，W_=W_{_}
+
μ
λe
λ(1-pk
平均服务强度ρ。
=1-p0，这是实际服务强度，就是服务台
=
μ
μ
λ
1-p0
正在为顾客服务的概率.而ρ
不是服务强度，因为有一部分顾客失
=
μ
1 −
278

============================================================
第 297 页
============================================================

去了.
例7.2.4一个理发店只有一个理发师，有3个空椅供等待理发的人使用.
设顾客以最简单流来到,平均每小时5人.理发师的理发时间服从负指数分布，平
均每小时6人.试求$L{，_{}$W_，$_{_.
5
解λ=5人/时，μ=6人/时，k=4，ρ=
.用公式(7.2.10），(7.2.11），
6
(7.2.12),(7.2.13)得到
$\{$
5
L=
≈1.64159(人）
$\-r{$
5
1-
6
L=L-（1-p{0）=L-1+
≈0.9202(人)
1 -(\fra{}{)$
5
$\^{)$
$P_{4}= =$
$1 -(\fr{{}{)$
≈ 0.134 3
5
7
L
1.641 59
$W ==
≈0.3793(时)
λ_e
λ(1-p_{4)
5.(1-0.1343)
$L}$
W
≈0.213(时)
二
4
λ。
例7.2.5给定一个M/M/1/k系统，具有λ=10人/时，μ=30人/时，
k=2.管理者想改进服务机构.方案甲是增加等待空间，使k=3.方案乙是将平
均服务率提高到μ=40人/时.设服务每个顾客的平均收益不变.问哪个方案获
得更大收益，当λ增加到每小时30人，又将有什么结果?
解由于服务每个顾客的平均收益不变，因此服务机构单位时间的收
益与单位时间内实际进入系统的平均人数n成正比（注意，不考虑
成本）.
λ(1-ρ{$
$n_k=λ(1-pk)=
$1-pρ{}$
$k+1
方案甲：$k=3,λ=10$,μ= 30.
070

============================================================
第 298 页
============================================================

[1-\fr{}{)$
3
$n_{3}  10
=9.75(人/时)
1 -(fr3{)}$
方案乙：k=2,λ=10,μ= 40.
10[1 -(3}$
=9.5(人/时)
$n{2}=$
$1-($\frac{}{3}$
3
因此扩大等待空间收益更大.
Y
当λ增加到30人/时时，ρ=
=1.这时方案甲有
μ
3
$n_{3}  30
=22.5(人/时)
3+1
λ
30
而方案乙是把μ提高到μ= 40人/时.ρ
<1, k = 2.
μ
40
2
1-
4
$n_{_2} 3 0
=22.7（人/时）
3
3
1-
所以当λ=30人/时时，提高服务率的收益比扩大等待空间的收益大.
3.M/M/c/∞系统
现在来讨论多个服务台的情况.假设系统有c个服务台，顾客到达时，若有空
闲的服务台便立刻接受服务；若没有空闲的服务台，则排队等待，等到有空闲服
务台时再接受服务.与以前一样，假设顾客以最简单流到达，参数为λ，服务台相
互独立，服务时间都服从参数为μ的负指数分布.
当系统中顾客人数n≤c时,这些顾客都正在接受服务,服务时间服从参数
为μ的负指数分布,可以证明顾客的输出是参数为nμ的最简单流.如果n>c,
那么只有c个顾客正在接受服务，其余在排队,顾客的输出服从参数为cu的最简
单流.
用N(t)表示t时刻排队系统内的顾客人数.与M/M/1/∞的推导方法类似，
可以证明{N(t)，i≥0}也是一个生灭过程.其参数为
280

============================================================
第 299 页
============================================================

$λ{n}λ
n = 0,1,2,..
{nμ，
n= 1,2,. ,c
$μ_{n}$
=
c,
n= c+1,.
由(7.1.3)得到
1
$(\frac{}{)$
n
λn-1}λ{n}-22$
$P_{}
n!
n = 0,1,2,.. , c − 1
$P{n$
$P{0$
二
$μ_{nμn-1
…·μ1
1
λ
n
$c^{ {
$P_{}{
n=c,c+1,.
μ
令ρ=
v$
，设_ρ_{<1.
μ
cμ
∑P{2}=∑_{n+∑P$
8
c-1
8
$n=0$
n=0
$n=c
c-1
1
8
∑
1
1
=
+
n
n!
2α
P_0o
n=0$
c!
$n_=c
c-1
M
1
1
8
=
n
∑
+
C
$ρ{_}$
$n-c$
d
d
P0$
n!
c!
n=0
$n=c
1-0
∑
1
1
1
=
n
C
(7.2.14)
d
+
d
P{0$
n!
c!
1-ρc
n=
所以
-1
1-
ρ
n
$cp{}$
(7.2.15)
+
$n=0n
c！(c-ρ)
先计算平均等待队长$_{，只有系统的顾客数n≥c时，才有n-c个顾客在排
队等待服务，所以
8
C
8
n-c
L=∑(n-c)pn$
d
P_{∑(n- c)(
c!
$n=c
$n=c=
ε
8
ρ
c
d
1
ρ
PoP ∑
np$
n-1
P_{0ρ_{c$
$\p{$
$\-ρc$
c!
c!
n=
ρc
1
ρ{$
$ρ{$
c
$0d.
p0
c!
(1 - ρc){}$
(1 - ρ{)^{}$
c!
ρ{c$
(7.2.16)
$2_$
（1-ρpc)
平均忙的服务台数为
281

============================================================
第 300 页
============================================================

e-1
8
M
$P_{n$
n=0
$n=c
c-1
ρ{
n
8
·ρ{c$
n
∑
=
n
M
00
$P_{0+c
$P_{0$
$n=00$
n!
c!
$n=c
e-1
$n-$
·ρc$
C
n
=ρ ∑
ρ
C
8
∑
$_{+c
$P_{0}+$
P_0$
(n - 1)!
$n=
c!
c!
$n=c+1$
c-2
n
c-1
· ρ{c$
n-1
=p·∑
d
1.0
8
C
$P_{0+$
p0
n=0n
(c-1)!
(c-1)!
$n=c+1$
c-2
∑P_{n+}_c-+$
8
∑_n}$
8
$=ρ
λ
=ρ|
∑
n = ρ
(7.2.17)
$pn$
二
$n= 0$
n=c
n=0
μ
平均逗留的顾客人数为
8
c-1
L=∑npn=∑n_pn+c·∑Ppn+∑(n- c)pn
8
8
$n=0$
$n=0$
$n=$
$n=c
ρ_{$
=c+L=ρ+
(7.2.18)
$2$
(1-pρc)
平均等待时间为
$L_{}$
$P_{$
$W_{}$
(7.2.19)
Ⅱ
λ
cμ·(1-ρc)^{}$
平均逗留时间为
L
P_{$
1
W =
+
(7.2.20)
λ
μ
例7.2.6一个大型露天矿山,考虑建设矿石卸矿场,是建一个好,还是建
两个好?估计矿车按最简单流到达，平均每小时到达15辆,卸车时间也服从负指
数分布,平均卸车时间是3分钟,每辆卡车售价8万元,建设第二个卸矿场需要投
资14万元.
解
平均到达率
λ=15辆/时
平均服务率
μ=20辆/时
只建一个卸矿场的情况：
15
$ρ_{1}   =
=0.75
20
在卸矿场停留的平均矿车数
λ
15
L =-
=3(辆)
μ-λ
20-15
282

============================================================
第 301 页
============================================================

λ
建两个卸矿场的情况：ρ=0.75，ρ_{2}
=0.375.
2μ
1
2.20
-1
P{0 =1+0.75+-
-(0.75){
=0.45
2！
2·20-15
0.45.15·20.(0.75)
L=
+0.75=0.12+0.75=0.87(辆)
1!(2·20-15)^{
因此建两个卸矿场可减少在卸矿场停留的矿车数为：3-0.87=2.13(辆).就是
相当于平均增加2.13辆矿车运矿石.而每辆卡车的价格为8万元,所以相当于增
加2.13×8=17.04(万元)的设备.建第二个卸矿场的投资为14万元，所以建两
个卸矿场是合适的.
4.排队系统费用优化决策
排队系统中涉及的有关费用往往可分为两类:顾客的等待损失费用以及与
服务设施相关的费用.排队系统的优化通常是为了使上述两种费用的总和或者
其中之一尽可能小.
例7.2.7设船到码头，在港口停留单位时间损失c_元，进港船只是最简单
流，参数为λ，装卸时间服从参数为μ的负指数分布，服务费用为c_{2}_}，c_{2}$是一个
正常数,求使整个系统总费用损失最小的服务率μ.
λ
$λc_{_}$
解因为平均队长L=，所以船在港口停留的损失费为
，服务费用为
μ-λ
μ-λ
$c_{2}μ.因此总费用为
$λc_{1}$
F{=
+ c_{2$
μ-λ
求μ使F达到最小，先求F的导数
dF
$λc_}$
+c{_$
dμ
(μ-λ )^{}$
dF$
$'$
让
=0$，解出μ=+
.因为
dμ
√
$$C_{2}$
$d^{2$
2λc_}$
(μ>λ)
$du{}$
(μ{-λ)^{}$
$0
$μ=μ^{$
最优服务率是μ，当μ=μ时,系统的最小总费用为
F（μ）=√λc₁C₂+c2λ+
$C，λ
=2√λc1c{2+c2λ$
$C_{2}$

============================================================
第 302 页
============================================================

例7.2.8有一个M/M/c/∞系统，假定每个顾客在系统停留单位时间的
损失费用为c_{}元，每个服务设备单位时间的单位服务率成本为$c_{2元.要求建立几
个服务台才能使系统单位时间平均总损失费用最小.
解单位时间平均损失费为
F=c₁L+c·C_₂μ
要求使F达到最小的正整数解c{,通常用边际分析法:找正整数c{*，使其满足
F（c{)≤F（c+1)
F(c{)≤F（c*-1)
由F（c{)≤F(c*+1)，得到
c_1·L（c）+c·_2·μ≤_₁·L（c+1）+（c*+1）·C₂2μ
$C_{}$
所以
L(c)-L（c+1)≤
μ
$C_{}$
同样，由F(c^{)≤F(c{*-1)得到
$c_{2}$
L(c-1)-L(c)≥
一
·μ
$C_{_}$
因此c必须满足不等式
C_{2$
L(c{)-L(c+1)≤-·μ≤L(c-1)-L(c)
$C_{_}$
$cC_{2$
取c=1，2，…，计算L(c)-L(c+1)之差，若μ落在L（c*)-L(c*+1),
$C_{}$
L(c{-1)-L(c^{)之间,c{就是最优解.
例7.2.9某公司中心实验室为各工厂服务.设做试验的人数按最简单流
到来，平均为48人次/天，c_{1=6元.做试验时间服从负指数分布，平均服务率为
$μ= 25人次/天，c_{2=4元.求最优试验设备数c^,使系统总费用为最小.
解λ=48人次/天，μ=25人次/天，=1.92.
μ
按M/M/c/∞计算p{0，L(c)等(注意以下公式只对ρ_。=
1.92
<1成立).
C
$P_{ =
c-1
(1.92)"
(1.92)
-1
+
n!
(c-1)!(c-1.92)
$n=0=0$
(1.92)^c+$
L( c)=$
(c-1)! ( c -1.92)
$2}_{0}+1.92
将计算结果列成下表
284

============================================================
第 303 页
============================================================

L(c)
c
L(c)-L(c+1)
L(c-1)-L(c)
F( c)
1
8
8
8
2
23.490
21.845
8
154.94
3
2.645
0.582
21.845
27.87
4
2.063
0.111
0.582
28.38
5
1.952
0.111
31.71
$C_{2}
100
=16.67
$C_{}$
6
所以取c=3（个)，总费用最小.
*
7.3
有限源排队系统
本节简要介绍顾客来源是一个有限集合的随机排队服务系统.
如果一个顾客加入排队系统,这个有限集合的元素就少一个,当一个顾客
接受服务结束,就立刻回到这个有限集合中去.这类排队系统主要应用在机器
维修问题上,有限集合是某单位的机器总数,顾客是出故障的机器,服务台是
维修工.
1.M/M/c/m/m系统
我们用机器及维修工来代替顾客及服务台的名称.假定有c个维修工共同
看管m(≥c)台机器.机器出故障后工人就去维修，修好以后，继续运转.如果维
修工都在维修机器,那么出故障的机器就停在那里等待修理.进入系统的顾客是
等待修理和正在维修的机器，服务台是维修工.
设每台机器的连续运转时间服从同参数的负指数分布，每台机器平均运转
1
时间为一.这说明一台机器单位运转时间内出故障的平均次数为λ.维修工的维
λ
1
修时间都服从同一负指数分布，平均修复时间为一.
μ
用N(t)表示时间t在系统的机器数(正在接受维修和等待维修的机器总
和)，则不难验证{N({)，{≥0}为一有限生灭过程，其状态空间为S={0$，
1,.,m}.
285

============================================================
第 304 页
============================================================

类似于7.2中的方法,可得到该排队系统的几个重要的数量指标.
平均发生故障的机器数
m
r-I
w
Y
n
m
m
n!
λ
n
∑
∑
n
$P_{0+$
n
P_{0
c!
$c}$
$n-c
μ
n0
$n=0
n
n=r
n
(7.3.1)
平均等待维修的机器数
m
Lq =∑(n- c)pn
(7.3.2)
n=c
平均正在工作的维修工人数
e-1
m
=∑np{+cP{$
=
n=C
平均运行的机器数
m
m
m
a=∑（m-n)p=m∑p_n-∑np{n=m-L
n=0
n=0
n=0
c-1
m
m
a+c+L₁=m-L+∑np{n+c∑P{n+∑(n-c)pn$
1=
$n=c
n=c
m
m
=m-L+∑npn=m-L+∑np{=m
n
n=0
这公式是很容易理解的.所有的机器m分成三类:正在运行的a，正在维修的
c，等待维修的$L_{_.
在统计平衡条件下单位时间发生故障的平均次数为
$m$
λ，=λ∑（m-n)pn=λa
1=0
即单位时间平均发生故障的机器数等于正在运行的机器平均发生故障次数.
由Little公式可得机器的平均停工时间和平均等待维修时间分别为
L
$W==$
(7.3.3)
λ_e$
λa
$_{}$
$L{}$
W
=
(7.3.4)
9
λe
λa
除此之外，还有一些表示工人空闲程度以及机器停工造成的损失等的指标，
它们对实际应用也是很有用的.
平均工作人数
$cove$
工人操作效率p(c)=
总工人数
C
平均空闲工人数
0
工人损失系数q(c)=
1
总工人数
c
286

============================================================
第 305 页
============================================================

平均工作机器数
a
机器利用率u(c)=
总机器数
m
等待维修机器数
7
机器损失系数r(c)=
V
总机器数
m
例7.3.1设某厂有自动车床若干台，各台的质量是相同的,连续运转时间
服从负指数分布，参数为λ.工人的技术也差不多，排除故障的时间服从负指数
分布,参数为μ.设=0.1,有两个方案.方案一:3个工人独立地各自看管6台机
μ
器.方案二:3个工人共同看管20台机器.试比较两个方案的优劣.
解方案一:因为是分别看管，可以各自独立分析，是3个M/M/1/6系统.
由上面的公式可求出
1-p0=0.5155,=0.5155(个),a=5.155(台)
L=0.3295（台），L=0.845（台）,q（1)=0.4845,r(1)=0.0549
方案二：m=20(台)，c=3(个)，=0.1，可求得
μ
c≈1.787(个)，a≈17.87(台)，L。≈0.339(台)
L≈2.126(台),q(3)≈0.4042,r(3)≈0.01695
机器损失系数、修理工人损失系数都小于方案一，所以方案二较好.
事实上，对给定的λ，μ，正整数c，m，在本节初的假设下，我们能证明如下一
般的结论:c个工人分别独立地各自看管m台机器时，修理工的损失系数q（1)与
机器损失系数r(1)分别大于c个工人共同看管cm台机器的相应量q(c),r(c).
这个结果是很直观的，当c个工人独自看管时，工人A单独看管m台机器，某个
时候可能有多于1台机器发生故障，他只能在1台上排除故障，其他的机器等待
维修.但可能工人B看管的m台机器全处于正常运转状态.如果是共同看管，B就
可以去排除A看管的等待维修的机器，从而降低损失系数.
2.M/M/c/m+N/m系统
现在来考虑有备用机器的情况.有m台机器进行生产，另有N台备用（如飞
机引擎、电报局的电传打字机、计算机元件、露天矿的矿车等).当生产的机器出
故障后,就立即用备用件替换下来(如没有备用件，这台机器就停止生产）由工
人进行修理.修好后，若正在生产的机器数为m,则它就加入备用,否则就投入生
产.其他假设与M/M/c/m/m系统相同.
类似M/M/c/m/m系统，可以得到该排队系统的几个数量指标.
当c≤N时，
287

============================================================
第 306 页
============================================================

$N-1
(7.3.5)
平均备用机器数L=∑（N-n)p{n
$n=0
N
$N+mm$
平均运转机器数a=Σmpn+Σ（m_-n+N)pn$
$n=00$
$n=N+1
N+m$
平均等待维修的机器数L=∑（n-c)pn
(7.3.6)
n=c
c-1
$N+m$
平均忙的工数c=}npn+cp{n$
1=0
=c
以上几个量的关系为
L+a+L+=m+N
这个公式是容易理解的.所有的机器(包括备用的)分成：正在运转的a,等待维
修的$L_{q}，正在维修的{，备用的$L备.
单位时间平均发生故障的次数
N
N+m
λ=∑mλpn+∑（m-n+N)λpn
"=0
n=N+1
N
$N+mm$
=λ[∑mpn+∑（m-n+N)pn]
n=0
n=N+1
=λa
由Little公式，可求得一部机器平均等待维修时间W_。及停工时间W.
$N+mm$
∑(n- c)pn$
$Lq$
$W}$
$n=r=$
(7.3.7)
λe
λa
r-1
$N+mm$
$N{}mm$
∑nPpn+c∑Pn+∑（n-c)pn
$c$
4
$n=0$
$W=
n=c$
n=c
λe$
λa
$N{+mm$
∑
$n{p{n$
$n=0
(7.3.8)
λ_e
c>N时,即维修工人数大于备用机器数时，当N部备用机器都运转时，还有
空闲工人,因此失效机器数当n≤N<c时,是全员生产，n>N时,是缺额生产.其他
指标都与c≤N时相同.
不难看出，当λ，u，m及c给定时,备用数N越大，越能保证同时有m台机器
进行生产,即越能以较高的概率p保证同时有m台机器进行生产,这样单位时间
的总产量就越高.但N越大,投资也越大.因此，N太大也是不合算的，问题是N到
底取多大为好?
288
、

============================================================
第 307 页
============================================================

这个问题可以有几种提法.一种是给定m_，λ，u，c及保证同时有m台机器进
行生产的概率不低于给定的p(0<p_<$1)的条件下，求最小的备用量$N{},即
N^ = min{N |∑P≥
N
$n=0
N
分成N_≥c，N<c两种情况，但∑$p_{n}$的计算公式很复杂，由此来解$N$是很不容易
n=0
N
的.通常可以让$N等于某个常数来求∑$p{}，看它是否达到p，然后逐步增加_,直
$n=0
N
到Σ${p_{n}≥p为止$.
$n= 0$
问题也可以改为：给定m_，λ，u，N与保证概率p，求最优工人数c,即
N
= min{c
∑{p_{n}p$
￥
$n= 0= 0$
若给出费用结构,还可把问题改为求单位时间期望总费用达到最小的最优
备用量N*.
例7.3.2某露天铁矿山，按设计配备12辆卡车参加运输作业(每辆载重
160吨,售价72万元),备用车8辆.要求保证同时有12辆车参加运输的概率不低
于0.995.设每辆车平均连续运输时间为3个月，服从负指数分布.有两个修理队
负责修理工作，修理时间服从负指数分布,平均修复时间为5天.问这个设计是否
合理.
解由假设知，这是M/M/c/m+N/m系统，m=12(辆)，=3(月/辆)，
λ
1
1
（月/辆），c=2（队).
二
μ
6
$m·λ
N
c·μ
我们有
=0.3333，
≈36.用c≤N$的公式，求N,要求
∑P_{n}≥0.995.
c·μ
λ
n=0
2
3
设N=2，有∑pn=0.9474.当N=3时，有∑Pp{n=0.9968.所以3辆备用车
$n=00$
n=0
就能达到要求，原设计用的备用车太多.
当N=3时，卡车的利用率$q(2)=0.7937.
第7章习题
(A)
1．设随机变量服从负指数分布，分布函数为
289

============================================================
第 308 页
============================================================

[1- e
$-λx}$
x≥0
$F()=
0,
x <0
求ξ的数学期望E(ξ)及方差D().
2.设N(t）服从泊松分布
(λl)
k
P{N(t)=k}=
-λ1
k =0,1,2,.
-e
k!
求N(t)的数学期望E[N（t)]及方差D[N(t)].
3.证明负指数分布具有无记忆性，即设ξ是随机变量,服从负指数分布，参
数为λ$>0,设t,x>0,则
P|ξ>t+x|ξ>=P|ξ>x₁=e^x
4.某单人理发店，顾客到达服从最简单流，平均每小时到达3人，理发时间
服从负指数分布，平均为15分钟，试求
(1)顾客来理发店不必等待的概率.
(2)理发店内顾客平均数.
(3)顾客在理发店内平均停留时间.
(4)平均到达率提高到多少时，顾客在店内平均停留时间才超过
1.25小时.
5.某一系统N(t)，t≥0}，顾客进入系统服从参数为λ的最简单流.在系
统中只有一个顾客时,服务时间服从参数为u，的负指数分布.当系统中多于一个
λ
顾客时,服务时间服从参数为$u{2(μ{2<μ{1-=ρ<1)$的负指数分布.试证明系
$μ_{2}$
统N（t)，≥O}组成生灭过程，并求出p_{n，P{0，L，}_，W，W_₂}的公式.
6.在第5题中，给出λ=0.5(人/分)，_{1=1.5(人/分)，u_{2=1(人/分).
求出P_{，P_₁，,P_2，L，}L_₃，W，W.
7.系统{N(t),t≥0}，顾客到来服从参数为λ的最简单流，但顾客发现系
统人多就不愿意排队等候,顾客接受服务的决心大小用概率αn表示，这一概率
1
与系统人数成反比，α_}=$
，n表示顾客的数目.服务时间服从参数为μ的负
n+1
指数分布
μ
$W_{W_{}$
8. 设有C个M/M/1/∞系统，顾客到达都是参数为的最简单流.服务时间
C
290

============================================================
第 309 页
============================================================

的最简单流，每个服务台都服从参数为$μ的负指数分布，=ρ<1，试比较这两
μ
者的空闲概率_{}，等待概率1-_{0}，等待队长$_{}队长L，等待时间W_{}及逗留时
间W.
9.某铁路局为经常油漆车厢,考虑了两个方案.方案一是设置一个手工油漆
工厂.年总开支为20万元（包括固定资产投资、人工费、使用费等).每节车厢油
漆时间服从参数μ_1=6(时)的负指数分布.方案二是建立一个喷漆车间,年总开
支费用为45万元，每节车厢的油漆时间服从u_{2=3(时)的负指数分布.设要油漆
的车厢按最简单流到达，平均每小时1/8节.油漆工厂常年开工(即每年开工时
间为365×24=8760(时))，每节车厢闲置的时间损失为每小时15元.问该铁路
局应采用哪个方案较好.
10.某单位有10部电梯,设电梯工作寿命服从负指数分布，平均工作15天.
有一个修理工，修一部电梯的时间服从负指数分布，平均需时2天.求平均发生故
障的电梯数及每部电梯平均停工时间.
（B)
1.已知某机场的值机系统分两类：传统值机和其他值机.传统值机比例为
65%，顾客到柜台办理登机和行李托运手续，每个柜台的平均处理时间为45秒/
人，最大排队时间10分钟;其他值机比例为35%，顾客自助办完登记后，再到柜
台办理行李托运手续，据统计，此系统中90%的人每人有0.6件行李要托运，托
运柜台处理时间为50秒/人，最大排队时间为8分钟.该机场高峰时，每小时到
达的人数为7128人,求机场里满足服务的传统值机柜台和托运柜台的个数.
2.某工程公司所属碎石场，其任务是将大石块轧碎加工成各种规格的碎石.
碎石场的加工过程是:在大石块堆积地(距轧石机水平距离30至200米)，由小
车装料用人工推至轧石机的料斗前，将块石装入料斗，开动卷扬机提升料斗，将
料倾缺于斜面槽而置于料台，然后将料装入轧石机轧碎，并经过筛分机筛分，最
后经带式运送机卸于料堆.由于各种原因，造成了料斗前小车排队，且有时轧石
机空载而等料.现在的问题是：
(1) 如何配备小车数,使轧石机空载和小车排队损失之和达到最小.经研
究，此系统为M/M/1/∞的排队系统,机械台班产值为_{1}，每个工人工作一班的
产值为C_2}，λ为平均到达率，μ为服务率.
(2) 已知C_{1=1659元/(台·班)$，_2=41元/(人·班)，u=1.62，试求λ，
并根据L(λ*)及机械空载率，判断是否需进一步改造该系统的劳动组合;若需
改造，可采用料斗旁设立若干空车作为“暂时仓库”的方案.
291

============================================================
第 310 页
============================================================

3.有一个只有一个泊位的小型卸货专用码头，船舶运送某些特定的货物
化,每艘船的卸货时间由船的大小、类型所决定，在45分钟到90分钟的范围
内变化.
现在需对该码头的卸货效率进行分析,即设法计算每艘船在港口停留的平
均时间和最长时间,每艘船等待卸货的时间,卸货设备的闲置时间百分比等.
参考文献
[1]徐光辉.随机服务系统[M].2版.北京:科学出版社,1988.
2 Hunter J.Mathematical Techniquesof Applied Probability,V.2,Discrete Time
Models:Techniques and Applications[ M].New York:Academic Press,1983.
3 Cooper B.Introduction to Queueing Theory[M].New York:North Holland1981.
[4]董泽清.排队论及其应用[M].西安:西安系统工程学会,1983.
[5]孟玉珂.排队论基础及应用[M].上海:同济大学出版社,1989.
[6]胡运权，等.运筹学基础及应用[M].6版.北京:高等教育出版社,2014.
[7]谭永基,等.经济管理数学模型案例教程[M].北京:高等教育出版社,2006.

============================================================
第 311 页
============================================================

第8章
决策分析
决策分析研究从多种可供选择的行动方案中选择最优方案的方法，本章
主要介绍决策分析的基本概念和基本方法，重点介绍风险型决策分析和不确
定型决策分析，结合实际例子给出各种决策问题的解法并对各种方法进行分
析和比较，另外还将介绍效用函数和信息价值的应用
8.1决策分析的基本概念
本节介绍决策分析的基本概念，包括决策、决策过程、决策的不同类型等.然
后再通过几个数学模型来说明这些概念.
1.决策分析的基本概念
决策是指人们为达到某一目标从几种不同的行动方案中选出最优方案做出
的抉择.决策分析研究从多种可供选择的行动方案中选择最优方案的方法.它在
现代管理科学中起着十分重要的作用.世界著名经济学家H.A.Simon提出“管理
就是决策”，他认为经济管理的中心任务就是决策.
一个完整的决策过程通常包括以下几个步骤:确定目标、收集信息、制订方
案、选择方案、执行决策并利用反馈信息进行控制.决策过程往往与多种因素有
关.在这里我们主要介绍一些定量决策的方法.决策问题通常分为三种类型：确
定型决策、风险型决策和不确定型决策.
确定型决策是在完全掌握未来的外界状态情况下做出决策.决策者掌握决
策所需的各种信息.决策者面临多种可供选择的方案,但每种方案只可能有一种
后果.
风险型决策是在不完全掌握未来的外界情况,但知道未来外界状态的概率
分布的情况下做出决策.在这种情况下决策者不仅面临多种方案可供选择,而且
每种方案还面临多种后果.每种后果出现的可能性是可以预测的.
不确定型决策是在未来状态的概率分布也未知的情况下做出决策.决策者
293

============================================================
第 312 页
============================================================

只能掌握各种方案可能出现的后果,但不知道各种后果发生的概率.
在后面的几节中我们将分别介绍解决这三类决策问题的具体方法.本节首
先介绍建立决策的数学模型所用到的一些基本概念.
(1)状态集
把决策的对象统称为一个系统.系统处于不同的状况称为状态.它是由不可
控制的自然因素所引起的结果,故称为自然状态.把自然状态数量化得到一个状
态变量,也称为随机变量.所有可能的自然状态所构成的集合称为状态集,记为
S={x}，其中x是状态变量,它可以是离散型的，也可以是连续型的.系统中每种
状态发生的概率记为P(x).
(2) 决策集
为达到预想的目标提出的每一个行动方案称为决策方案,简称为方案.将其
数量化后称为决策变量,记为a.决策变量的全体构成的集合称为决策集，记为
A={a}.它可以是离散型的，也可以是连续型的.本章主要研究状态集和决策集
都是有限集的情况.
（3）报酬函数
报酬函数是定义在A×S上的一个二元实值函数R(a，x).根据决策问题的
实际意义，报酬值R(a，x)可以表示在状态x出现时，决策者采取方案a所得到的
收益值或损失值.在一个决策问题中，如果R(a,x）=r表示收益值（损失值）,那
么当r是正值时，表示收益值(损失值）为r，当r是负值时，表示损失值（收益值）
是-r.
状态集、决策集和报酬函数是构成一个决策问题的最基本的要素.
(4)决策准则
决策者为了寻找最佳决策方案而采取的准则称为决策准则,记为Φ.最优值
是目标的数目标志,最优值对应的方案称为最优方案.一般选取决策准则使收益
尽可能大而损失尽可能小.由于决策者对收益、损失价值的偏好程度不同,对同
一决策问题,不同的决策者会采取不同的决策准则.
2.决策的数学模型
除非特殊说明,以下我们总假定决策问题的状态集和决策集都是有限集.一
个决策问题的数学模型由状态集S、决策集A、报酬函数R(a_，x) 和决策准则Φ
构成.因此可用解析法写出上述集合、函数和准则来表示一个决策问题的数学模
型.另外,经常用决策表或决策树来表示一个决策问题的数学模型.决策树将在
8.2给出.
设S=x₁，x₂，，x}，A=a₁，a₂，，am}，R（a₁，x）=令p（x）表示状态x
294

============================================================
第 313 页
============================================================

产生的概率.通常可用表8.1.1的决策表来表示一个决策问题的数学模型.
选定了决策准则Φ,便可根据Φ求出最优方案和最优值.
表8.1.1
S
R(a,x
$x_1}$
$x_{q2}$
$"x$
$p(x1)
$p(x{)
…
$p(x_{n)
$a_}$
r1
$r{2}$
$r{}$
$a_{2}$
$r{22 $
$2$
$r{22$
A
:
…
…
…
$a_m}$
$r_m}$
$2$
[m$
8.2 风险型决策分析
本节介绍进行风险型决策分析的条件、步骤和方法，主要介绍最大可能法、
期望值法,并讨论决策树技术的应用.
1．进行风险型决策分析的基本条件和方法
风险型决策是指决策者对未来的情况无法做出肯定的判断,但可以借助于
统计资料推算出各种情况发生的概率.这时的决策分析就称为风险型决策分析.
进行风险型决策分析时,被决策的问题应具备下列条件：
(1) 存在决策者希望达到的一个明确目标；
(2) 存在着两种或两种以上的自然状态；
（3)存在着可供决策者选择的不同方案；
（4)可以计算出各种方案在各种自然状态下的报酬值；
(5)可以确定各种自然状态产生的概率.
进行风险型决策分析首先要掌握决策所需的有关资料和信息,明确存在的
自然状态$S_={x}以及x发生的概率{p(x)$，明确可供选择的决策集A={a}.然后
计算报酬函数R(a,x)，建立决策的数学模型，根据决策目标选择决策准则，从
而找出最优方案.
一个风险型决策的数学模型可用表8.1.1所示的决策表来表示,也可以用
295

============================================================
第 314 页
============================================================

决策树来表示.我们将在后面详细讨论这种方法.
由于风险型决策的自然状态是不确定的,至少有两种自然状态且每种自然
状态出现的概率是知道的,因此,任何一种决策都要冒一定的风险.本节介绍两
种最基本的风险型决策分析方法.
（1)最大可能法
最大可能法是将风险型决策化为确定型决策而进行决策分析的一种方法.
一个事件的概率越大，它发生的可能性就越大.基于这种思想，在风险型决策中
选择一个概率最大的自然状态进行决策,把这种自然状态发生的概率看成1,而
其他自然状态发生的概率看成0,这样,认为系统只存在一种确定的自然状态，
用确定型决策分析方法来进行决策.
例8.2.1某农场要在一块地里种一种农作物，有三种可供选择的方案，即
种蔬菜、小麦或棉花.根据过去的经验和大量调查研究发现天气干旱、天气正常
和天气多雨的概率分别为0.2,0.7,0.1.每种农作物在三种天气下获利情况如
表8.2.1所示.为获得最大利润应如何决策？
解该问题的决策目标是获得最大利润，状态集$S={x_{₁1}，x_{2}，x_3}}，其中$x_{_}
x_2}}_{3}分别表示天气干旱、天气正常、天气多雨.三种自然状态发生的概率分别为
p（x₁）=0.2，p（x₂）=0.7，p（x₃）=0.1，决策集A=a₁,a₂，a₃3，其中a₁,a2，a₃3分别
表示种蔬菜、种小麦、种棉花三种方案.报酬函数如表8.2.1所示.
表8.2.1
天气情况
利润/元
天气干旱
天气正常
天气多雨
0.2
0.7
0.1
种蔬菜
1 000
4 000
7 000
方案
种小麦
2 000
5 000
3 000
种棉花
3 000
6 000
2 000
R（a_₁}，_₁1）=1000，R(a₁1}，x₂2）=4000，R（a₁1}，_₃3）=700
R（a2，x₁1）=20O0，R（a₂，x2）=50O0，R（a₂，x3）=3000
R(a_₃3}，x_₁）=3000，R(a_₃，x2）=6000，R(a3，_₃3）=2000
概率最大的自然状态是x{2}，它产生的概率是0.7,即天气正常的可能性最大.
用最大可能法进行决策.我们只考虑这一种自然状态.于是决策准则Φ:
max{$R(a_{₁}x_{2})}.易见决策的最优值是$R(a_{3}，x_2)=60O0$，对应$的最优方案为$a_3}
$a_{∈A
296

============================================================
第 315 页
============================================================

即农场应在这块地里种棉花.
一般地,用最大可能法进行风险型决策分析的步骤是：
第1步明确决策目标,收集与决策问题有关的信息；
第2步找出可能出现的自然状态$S={x}，并根据有关资料和经验确定各
种自然状态发生的概率p(x);
第3步列出可供选择的不同方案A=|a}；
第4步确定报酬函数R($a，x)；
第5步建立决策模型,通常列出决策表，计算出每个方案在概率最大时
的自然状态，如x_0下的报酬值为$R(a_，x_{0);
第6步确定决策准则,找出最优方案.决策准则通常为
Φ：maxR(a,_₁n)l或
min{R(a,x，0）}
a∈A
a∈A
(2)期望值法
期望值法是进行风险型决策分析常用的一种方法.用这种方法进行决策是
选择期望报酬值最大(或最小)的方案为最优方案.与最大可能法相比较,进行决
策分析的前面4步相同,在第5步列出决策表后,要计算每个方案的期望报酬值
E(R(a，x)).当状态变量x是离散型随机变量时，则
E(R(a,x))=∑p(x)R(a,x)
x∈5
当状态变量x是连续型随机变量且其概率密度函数是p(x)时，则
E(R(a,x))=R（a,x)p(x)dx
Js
在第6步中决策准则为
Φ:
max|E(R(a,x))}
a∈A
或
Φ： minE(R(a,x))}
a∈A
例8.2.2用期望值法解例8.2.1.
解决策者的目标是获得尽可能大的利润$状态集$S_={x_{1}，x_{2}，x_3}1}，}决策集
A={a{_1,a_{2,_3}$.x;发生的概率和报酬函数如表8.2.1所示.下面计算每个方案$a{
的期望报酬值.
E(R(a_1,x))=0.2×1000+0.7×4000+0.1×7000=3700
E(R(a2,x))=0.2×2000+0.7×5000+0.1×3000=4200
E(R(a3,x))=0.2×3000+0.7×6000+0.1×2000=5000
决策准则Φ:max{{E(R(a_,x))}.决策的最优值为5000元，对应的最优决策
"∈A
为a_{3}，即应在这块地里种棉花.
对例8.2.1用期望值法和最大可能法进行决策分析得到的最优方案是相同
297

============================================================
第 316 页
============================================================

的,但最优值并不相同.这是因为风险型决策分析得到的最优值与决策者的主观
意志有关,并不是真正的最优值.这种决策方法有一定的风险,但实践证明效果
还是比较好的.另一方面要注意,并不是对所有的问题用最大可能法和期望值法
进行决策分析都能得到同样的最优方案.例如,将例8.2.1中每种状态发生的概
率改为p（x₁）=0.3，p（x_₂）=0.4，p（x₃3)）=0.3，则方案a₁，a2,a3的期望报酬值将分
别为4000元，3500元，3900元.用期望值法进行决策分析应选a为最优方案.而
用最大可能法进行决策分析,则最优方案应为a_3，这里各种状态发生的概率很相
近,用最大可能法进行决策分析,误差就较大,在这种情况下,用期望值法比用最大
可能法进行决策分析更好.一般说来,当各种自然状态中有一种状态发生的概率特
别大,而在每个方案在各种自然状态下的报酬值差别又不是很大的情况下,用最大
可能法进行决策分析效果较好,否则,用期望值法进行决策分析效果较好.
2.决策树
决策树是如图8.2.1所示的一棵水平的树.图中的方框,即树的根，称为决
策点.从该点引出的m个分支称为方案枝，表示各种可行方案.各方案枝末端的
圆圈称为状态点.从该点引出的几个分支称为概率枝，上面标出每个状态发生的
概率.概率枝末端的三角符号表示报酬,它后面的数字表示某个方案在某种状态
下的报酬值.
$x{1，p(x1)$
△R(a{1{1})$
$x{}p(x{2)
△R(a{1{22}$)
…
$x_{n,}})
△R(a{1，_n)
$a_{1}$
$x{，}p(x{1)）
△R(a{2}{1)
a_2$
$x_{}p(x{2$
△R(a{}，{2$)
决策点
…
…
$x_{1,}px)$
△R(a{2，{)$
$a_{m$
…
$x_{1,p(x)）
△R(a_m，_{1})$
$x_{2}p({)
△R(a_{，{2)$
…
$x_{n,}px)
△R(a_m，_{n}$
图8.2.1

============================================================
第 317 页
============================================================

用决策树来表示一个风险型决策模型,比较直观,便于对问题未来的发展情
况进行预测,能随意删去非最优方案分支.在增加新的情况时也可随时增添新的
分支.利用决策树进行决策分析的方法称为决策树法,它实际上是期望值法的图
解形式.
用决策树进行风险型决策分析的步骤基本上与期望值法相同,只是用决策树来
代替决策表.根据所知道的信息A，S,p(x)和R(a_，x)，按上面的方法画出决策树，然后
从右向左进行分析.每个状态点引出的概率枝右端的报酬值乘每种状态发生的概率
之和就是每个方案对应的期望报酬值E(R(a_{；，x))，将它标在对应的状态点的上方.
若决策目标是效益最大,就选择决策准则为Φ:max{E(R(a；,x))}；若决策目标是损
$a_；EA
失最小,就选择决策准则$Φ:min{E(R(_{,x)){}.将最优值写在决策点的上方，对应最
$a_{EA
优值的方案枝为最优方案.将其他的方案枝标上符号“//”，表示被剪掉.
在实际问题中有大量非常复杂的决策问题,用决策树来进行决策分析比用
决策表更直观.
例8.2.3某企业欲开发一种新产品,对产品在未来10年内的销售情况分
两个阶段做出预测.预测前3年和后7年销路都好的概率是0.5,前3年销路
好而后7年销路差的概率是0.3，前3年和后7年销路都差的概率是0.2.现
有三个方案可供选择:方案甲是新建三个车间投产;方案乙是新建两个车间投
产;方案丙是首先新建一个车间投产,如果前3年销路好,再考虑是否扩建两
个新车间.各种方案的投资费用和利润如表8.2.2所示.试利用决策树法进行
决策分析.
表8.2.2
投资额/万元
年利润/万元
方案
前3年
后7年
当前
3年后
销路好
销路差
销路好
销路差
300
0
100
-30
甲
100
-30
乙
200
0
60
20
60
20
扩建250
30
30
100
-30
丙
100
不扩建0
30
30
30
30
解我们分两个阶段来分析$.前3年有两种自然状态$$S_{1}=}{x_{1}x_{2}}，其中
$x_{1},x_{2分别表示前3年销路好和差.后7年也有两种自然状态$S_{2={_3}，_{4}}，其中
x₃3}，x{4分别表示后7$年销路好和差.设S=z_₁}，₂2，₃₂2₄1，其中z_₁=x₁1_₃32=x{₁1_}
299

============================================================
第 318 页
============================================================

$Z_₃3}=x{2_3}，₄=_₂4._{₁1=x₁x{3表示前3年销路好而后7年销路也好，其他的z₁类似地
定义.由已知条件知
p（z₁1）=0.5，p（z₂）=0.3，p(z_₃)）=0，p（z4）=0.2
一开始决策集A={a_{1，a_2}，a_3}，其中a{₁}，a_2，a_3分别表示方案甲、$乙、丙.对方
案丙，3年后又有两个方案$a_{4}和$a_{3}可以选择，其中$a_{4表示扩建两个新车间，而$a_}$
表示不扩建.由问题的条件知
p(x1)=0.5+0.3=0.8，p(x₂2）=0.2
p(x_,∩x_3$
0.5
5
由条件概率公式知
$p(x_{3}x1=$
p(x1)$
0.8
8
5
3
p(x₄|x₁1）=1-p（x₃3|x1）=1-
8
8
画出决策树如图8.2.2所示.
前3年
一
一后7年
$x_{3} 58$
358.75
△100×7
4
$x_{2}3/8$
△-30×7
1
100×3
x$
$x_{2} 0.$
△-30×10
3
-300
$_{3} /18
315
△60×7
5
$x{4}38$
△20×7
2
60×3
236
a_2
x$
$x_{2} 0.2$
△20×10
1
-200
决策点
$x_{3} 58$
108.75
100×7
6
-100
9
aa
$x_{}38$
210
A-30×7
-250
2
S
$x_{3} /8
决策点
210
30×7
$x_{1i}.8$
7
200
3
$x_{42}38.
30×7
$_{2}0.2$
x4$
△30×10
图8.2.2
从右到左进行计算.
300

============================================================
第 319 页
============================================================

(1)先计算方案a_的期望报酬值.
状态点④的期望报酬值
$E{1}=100×7×+(-30)×7×
5
3
=358.75（万元）
8
8
方案$a_{}，即状态点①的期望报酬值
$E2}=(100×3+358.75)×0.8+(-30)×10×0.2-300=167(万元）
(2) 计算方案$a{2$的期望报酬值.
状态点⑤的期望报酬值
3
+20×7×-
=315（万元）
8
8
方案a_，即状态点②的期望报酬值
E4=(60×3+315)×0.8+20×10×0.2-200=236(万元）
（3)计算方案a_,的期望报酬值.
先计算状态点⑥的期望报酬值
5
3
E5=100×7×+(-30)×7×
-250=108.75（万元）
8
8
状态点⑦的期望报酬值
E=30×7=210(万元）
这样,在决策点
2
应选择方案$a_{_而舍弃方案$_₄，即不扩建新车间.下面计算状
态点③，即方案a_₃的期望报酬值
$E{,=(30×3+210)×0.8+30×10×0.2-100=200(万元)
取期望报酬值最大的方案为最优方案，则应选择a为最优方案，即企业应
新建两个新车间生产新产品,10年可获期望利润236万元.
决策树法可以直观地对各种方案加以比较,特别适合于有多种自然状态和
决策方案的情况以及多级决策问题.决策树能起到类似于框图在编写计算机程
序中的作用.它能够使我们在相互不同的决策迷宫中找出一条最优的可行道路.
另外，决策树法便于集体决策.
8.3不确定型决策分析
本节讨论不确定型决策问题.介绍五种进行不确定型决策分析的方法:乐观
法、悲观法、乐观系数法、后悔值法和等可能法
301

============================================================
第 320 页
============================================================

1．不确定型决策分析的条件
不确定型决策分析是指决策者对未来的情况虽有一定了解,但又无法确定
各种自然状态发生的概率.这时的决策分析就是不确定型决策分析.进行不确定
型决策分析时,被决策的问题应具有下列条件：
(1) 存在决策者希望达到的一个明确目标；
(2) 存在着两种或两种以上的自然状态；
（3)存在着可供决策者选择的不同方案；
(4)可以计算出各种方案在各种自然状态下的报酬值.
如果知道各种自然状态发生的概率,不确定型决策就成为一个风险型决策.在实
际问题中常常遇到不确定型决策问题.例如,有关新产品的销路问题,一种新股票发
行的变化问题等.对这类问题,没有决定各种自然状态发生概率的过去经验.
对于不确定型决策问题,决策者无法计算出每个方案的期望报酬值,在理论
上没有一个最优决策准则让决策者选择.对这类问题存在着几种不同的决策分
析方法，这些方法都有其合理性，具体选择哪一种,要取决于决策者的态度和经
济实力等.
2.不确定型决策分析的基本方法
下面介绍进行不确定型决策分析的五种常用的方法，为了叙述方便，以下我
们总假定报酬值表示收益值.
（1）乐观法
决策者从最乐观的观点出发，对每个方案按最有利的状态发生来考虑问题，
即求出每个方案在各种自然状态下的最大报酬值.然后从中选取各最大报酬值
中最大的方案为最优方案,即决策准则为
Φ：max max {R(a,x)}}
a∈A
x∈S
例8.3.1夏季某商店打算购进一种新潮服装.新潮服装的销售量预计可
能为1000件,1500件,2000件,2500件.每件新潮服装的购进价是100元,销
售价是120元.如果购进的服装夏季卖不完,则处理价为每件80元.为获得最大
销售利润,问从最乐观的观点出发商店应如何进行决策?
解这个间题中状态集S={x_{₁}，_₂}，_₃}，x_4}1$，其中x₁1}，_2}x_3和x42分别表示新
潮服装的夏季销售量为1000件,1500件,2000件,2500 件.而决策集A=
{a_{1}，a_{2}_{₃}，a_4}|，其中a{1}，a_2，a_₃}，a_{4分别表示购进新潮服装1000件，1500件，
2000件和2500件.报酬值为利润(单位:万元),如表8.3.1所示.
302

============================================================
第 321 页
============================================================

表8.3.1
S
R(a{,x)/万元
$x_{}$
$x_{2}$
$x_{3}$
$x_{}$
(1000)
(1500)
(2000)
(2 500)
$a_{1}1000$
2
2
2
2
$a_{2}{1} 5 )
1
3
3
3
A
$a_3} 2 000
0
2
4
4
$a_2}(2 500)
-1
1
3
5
由表8.3.1知方案$$a_{1}，a_{2}a_{3}和$a_{4}_在各种自然状态下的最大报酬值分别为
2万元，3万元，4万元和5万元，其中最大者为5万元.最优方案应为a_4，即购进
2500件新潮服装是乐观意义下的最优方案.显然这并不是实际意义上的最优方
案，因为采取这种方案有可能亏损1万元.
(2) 悲观法
悲观法也称为Wald决策法.决策者从最保守的观点出发,对客观情况做最
坏的估计,对每个方案按最不利的状态发生来考虑问题,然后在最坏的情况下选
出最优方案.用这种方法进行决策分析，首先计算出每个方案在各种自然状态下
的最小报酬值，然后从中选出最大者对应的方案为最优方案，决策准则为
Φ:
max{min{R(a,x)1}
a∈A
x∈S
下面用悲观法解例8.3.1.
解首先求出各个方案在各种自然状态下的最小报酬值.由表8.3.1易见
方案a_{_}，a_{2，a_{3和a{4在各种自然状态下的最小报酬值分别为2万元，1万元，0万
元和-1万元，其中最大者是2万元.对应的最优方案为a_{，即购进1000件新潮
服装在悲观意义下是最优方案.
(3)乐观系数法
乐观系数法也称为Hurwicz决策法.Hurwicz认为决策者不应该是完全乐观
的,否则，就仿佛生活在一个完全理想的世界中.为了克服完全乐观的情绪，他引
入了乐观系数的概念,这就意味着决策者不但要考虑最大和最小的报酬值,而且
要根据一些概率因素权衡它们的重要性.用这种方法进行决策分析,首先要确定
一个乐观系数α，使0≤$α≤1,它表示决策者的乐观程度;当α=0时,决策者感
到完全悲观;当α=1时,决策者感到完全乐观.然后认为最有利状态发生的概率
为α，最不利状态发生的概率为1-α，此时决策准则为
Φ：
max{αmaxR(a,x)}+(1-α)min|R(a,x)|}
a∈A
x∈S
x∈S
303

============================================================
第 322 页
============================================================

则.α的选取由决策者决定.
设乐观系数α=0.6.用乐观系数法解例8.3.1.
解α=0.6，则1-α=0.4.令
E₁=αmaxR（a₁,x）+（1-α)min{R(a₁,x)}
x∈S
x∈S
由表8.3.1中的数据知
E₁=0.6×2+0.4×2=2.0
$E2=0.6×3+0.4×1=2.2
E₃3=0.6×4+0.4×0=2.4
$E4=0.6×5+0.4×(-1)=2.6
其中E_{4最大，故a_{4为最优方案,即当乐观系数为0.6时，购进2500件新潮服装
是最优方案.
(4)后悔值法
后悔值法也称Savage 决策法.Savage指出决策者在他已经做了决策并且自
然状态发生了以后,可能会后悔.他可能希望选一个完全不同的决策方案.于是
Savage提出了一种使后悔值尽量小的决策分析方法,即后悔值法.采取某种方案
的后悔值等于某个状态下的最大报酬值减去某方案的报酬值,即在状态x下方
案a的后悔值为
RV(a,x)=maxR(a,x)-R(a,x)
a∈A
后悔值法的决策准则是在所有方案的最大后悔值中选取最小值所对应的方案为
最优方案，即决策准则为
Φ：min{maxRV(a,x)}}
a∈A x∈S
下面用后悔值法解例8.3.1.
解首先根据表8.3.1计算在状态x{下方案$a_{i的后悔值，然后计算方案$a{
的最大后悔值.计算结果如表8.3.2所示.
表8.3.2
S
RV(a_,x)
$x_{}$
$x_{2}$
maxRV
$x_{sq}$
$x_{}$
$a_{}$
0
1
2
3
3
$a_{2}$
一
0
A
1
2
2
$a_{3}$
2
1
0
1
$a_{}$
3
2
2
1
0
3
304

============================================================
第 323 页
============================================================

这样，
min{max{RV(a,x)}}=min{3,2,2,3|=2
a∈A
x∈S
对应的最优方案为$a_{2}或$a_{3}，即购进1500件或2000件新潮服装为最优方案.2万
元是决策者可能遭受的最大的后悔值中最小的.当决策者采用方案$a{或$a_{4}$时，
他遭受的后悔值可能比这个值大.
这种方法大量地应用在一个长过程中的单个计划的决策问题,使得对每个
计划平均来说后悔值最小.
(5)等可能法
等可能法也称Laplace决策法.这个方法假定各种自然状态都有相同的机会
发生,即它们发生的概率都相同.这样就把一个不确定型决策化为一个风险型决
策来进行分析.选择期望报酬值最大的方案为最优方案.
假定状态集S=}x_₁1}，x_₂}，，x，决策集A={a₁1，a_2}，…，am，报酬函数为
R(a_{}，_₁})，则决策准则为
{∑R(a1，x，}
"
Φ:
max
$a_{∈A
n
下面用等可能法解例8.3.1.
解由表8.3.1的数据知n=4,于是
4
1
4
4
1
4
4
1
4
4
1
4
1
4
4
这样最优方案为$a_{2或$a_{3},即购进1500件或2000件新潮服装是最优方案.
由上面的例子易见,对同一个不确定型决策问题,用不同的方法进行决策分
析得到不同的结果.究竞采取哪种方法好？这取决于决策者的态度、财力、物力、
目标和策略等.一般说来,如果决策者是一个大公司,而决策问题是公司的一个
局部问题,他们往往采用乐观法,一旦失败,也不会给公司造成很大的损失.反
之，如果决策者是一个小公司,而决策的问题影响公司的全局,他往往倾向于悲
观法，选一个较为保守的方法,当然如果能设法测定各种自然状态发生的概率，
则可将问题转化为风险型决策,将会得到较好的结果.
305

============================================================
第 324 页
============================================================

8.4效用函数和信息的价值
为了提高决策分析的准确性,本节引进了效用函数概念,并且讨论了效用函
数在风险型决策分析中的应用.本节还讨论了信息的价值及其应用,并给出具体
的应用实例.
1．效用函数及其应用
用期望值法进行决策分析求得的最优方案是期望报酬值最大意义下的方
案.它只能保证在统计意义上达到预期目标,即当决策问题多次反复出现时,用
期望报酬值最优来指导决策效果较好.在一次具体实践中,期望报酬值不一定是
实际报酬值.例如,例8.2.1中的期望报酬值是5000元.但如果自然状态是天气
正常,种棉花的实际报酬值是6000元,多于期望报酬值.如果天气干旱或多雨，
实际报酬值是3000元或2000元,少于期望报酬值.这样看来,追求期望报酬值
是有风险的.而不同的决策者对待风险的态度是不同的.例如,有一个风险型决
策问题，如图$$8.4.1所示.其中状态集$S_{={x_{1}，x_{2}$，x_{1}，x_{2发生的概率分别是
p（x₁1)=0.7，p(x₂2）=0.3，决策集A={a₁1，a2}.报酬函数R（a₁，_₁1)=10,
R(a_{₁1，x_₂2）=-3，R(a₂2，_₁1）=R(a_₂2，x_₂）=5，单位为$元.用_望值法进行决策分
析,应取方案a，为最优方案，它的期望报酬值为
E(R(a₁,,x))=0.7×10+0.3×(-3)
=6.1（万元）
$x{1} 0.$
6.1
△10
$x_{2} 0.3
$a$
6.1
△-3
$a_{2$
决策点
图8.4.1
假定这里报酬值表示收益值.实施方案a_{}，有70%的可能获得10万元,但也有
30%的可能亏损3万元.不同的决策者会采取不同的态度.对于不愿冒险的决策
者来说，他宁愿采取方案a_{2}，而舍弃方案a_{₁.这样他肯定能得到5万元的收人.在
他看来方案$a_{₂比a_{}好.对另外的决策者来说，他宁愿选择$a_{},因为有很大的可能
306

============================================================
第 325 页
============================================================

收入10万元,即他认为$a{1}比a{2好.另外，同一个结果，不同的人会有不同的看法.
例如某个方案能收入1000元,对于一个拥有100万元的人来说,他可能会放弃，
但对于一个只有500元的人来说,他很可能会采取.这样看来,不同的决策者对同一
个报酬值的看法可能不同,因而会做出不同的决策.为了对决策者对报酬值的偏好
程度给出一个数量标志,就引进了效用函数的概念，它表示决策者对风险的态度.
一个决策问题中所有报酬的集合称为报酬集，记为R.这里报酬可以有广泛
的含义，可以指结果、效益值、损失值等.设r_{₁}，_{2}∈R.如果一个决策者认为r_优
于r_{2}，则说他对r_{₁}比r{2偏好，用r_{1}>r_{2或r_2<r{}表示.如果他认为r{}和r{2$相当，则
称r{}和r{2$等价，记为r_{r{2}这样就在$R$的元素之间建立了-种偏好关系.它满
足下面的公理.
公理8.4.1
1$r_1}，{2}∈$R_，则下面的三个关$有且只有 个成立:r_{1}<r_}
r₁1>r₂，r₁}-r2
公理8.4.2设r₁1，2}，r3}∈R,r₁<r2且r₂2<r3}，则r₁<r3.
效用函数是定义在报酬集R上的一个实数值函数u(r).它满足下面的条件:
当r₁}>r₂时，则u（r₁1)>u(r2);当r₁-r₂2时，则u（r₁)=u(r₂).u（r)称为r的效用
值，它反映了决策者对r的偏好程度.对同一个决策问题,不同的决策者的效用函
数可能不同.
一个方案a的效用值u(a)定义为
u(a)=∑p(x)u(R(a,x))
x∈S
这里假定x是离散型随机变量.
下面给出确定效用函数值的方法.设r*和r，分别是报酬集R中的最大元和
最小元.为了方便起见，不妨设u(r)=1,u(r。)=0，由u(r)的性质知，对r≤
r≤r，则有0≤u(r)≤1.下面说明如何确定u(r).在图8.4.1所示的决策问题
中，若令u(10)=1，u(-3)=0，如果决策者认为方案$a{2比方案$a{好，即他认为5
万元的效用值大于$a_{的效用值，调整方案a_{2的报酬值，直到决策者认为两个方
案相当为止.例如，方案$a{2表示以概率1得到4万元的收入，决策者认为$a_{1}与$a_{2}$相
当，这时4万元的效用值等于方案a{的效用值，即
u(4)=1×0.7+0×0.3=0.7
另一方面,可以调整方案a{中的概率,直到决策者认为两个方案相当为止.如果
方案$a_{1}表示得到10万元收入的概率是0.8，而亏损3万元的概率是0.2,而决策
者认为$a_{1}与$a_{2$相当，即他认为$5$元的效用值与方案$a_{}的效用值相等，亦即
u(5)=1×0.8+0×0.2=0.8
一般地，设r₁},2∈_{，r{₁2<r<r2}如果决策者认为以概率$p得到$r₁}而以概率1-p
307

============================================================
第 326 页
============================================================

得到r{2与以概率1得到报酬r相当,则
u(r）=pu(r₁）+（1-p)u（r2)
特别地，若u（r2)=1，u（r₁)=0，则u（r)=1-p.设u（r₁1)和u（r2)已知，且r₁<2
<r.如果决策者认为以概率p得到报酬，而以概率1-p得到报酬r与以概率1得
到报酬r{2$相当,则
u(r₂)=pu（r₁)）+（1-p）u(r)
于是
u(r2)-pu(r₁)
$u(r)$
1-p
类似地，当r<r_{_}<r{2时,如果决策者认为以概率p得到报酬r，以概率1-p得到
报酬r,与以概率1得到报酬r，相当,则
u(r₁)=pu(r)+（1-p）u(r2)
于是
u(r₁)-(1-p)u(r2)
$u(r) =$
p
用这种方法我们可以得到一个决策者的效用函数.在直角坐标系里,用横坐标表
示报酬r，纵坐标表示效用函数值u(r)，画出的曲线称为效用曲线.效用曲线分为
三种基本类型.图8.4.2所示的效用曲线，其中u(r)是凹的，通常称为保守型效
用曲线；u_₂(r)是一条直线，称为中间型效用曲线；u_₃(r)是凸的，通常称为冒险
型效用曲线.这三种不同的效用曲线对应的效用
$u(r)$
函数分别称为凹函数、直线型函数和凸函数.在
1
实际中,效用函数很复杂.由决策者的意志所决
$u_(r))$
定，它在某些区间可能是凹的，在某些区间可能
$u_{2}r)$
是凸的等.
$u_{3})
在风险型决策分析中用期望报酬值最优来
7
0
选择最优方案是有风险的.不同的决策者对风险
的态度不同.利用效用函数来代替报酬函数进行
图8.4.2
决策分析,决策结果就比较充分地反映了决策者
的意愿.利用效用函数进行决策分析就是在期望值法中用效用函数代替报酬
函数.
例8.4.1某工厂欲生产一种新产品.有两种生产方案可供选择,即年
产2万吨和年产5万吨.根据市场预测知道产品销路有好、中、差、滞销四种
情况.这几种情况发生的概率和两个方案在各种情况中的经济效益如
表8.4.1所示.
308

============================================================
第 327 页
============================================================

表8.4.1
销路
年利润/万元
好
中
差
滞销
0.3
0.4
0.2
0.1
年产2万吨
200
200
200
-100
生产方案
年产5万吨
500
200
-200
-500
设工厂的效用函数u在各报酬的值为
u(500)=1，u(200)=0.5,u(-100)=0.1
u(-200)=0.05，u(-500)=0
试利用效用函数选择最优方案.
解该问题的状态集$S=x_₁1，x_{2，_3，x_4，其中x{₁1},x_₂}，x_{3}和x4分别表示销路
好、中、差和滞销.决策集A=a_{₁}，a_{2}|，其中$a{}和$a_{,分别表示年产2万吨和年产5
万吨两个方案.决策准则为选取期望效用值最大的方案为最优方案.
u(a₁1)=0.3×0.5+0.4×0.5+0.2×0.5+0.1×0.1=0.46
u(a₂2)=0.3×1+0.4×0.5+0.2×0.05+0.1×0=0.51
工厂应选a，为最优方案.
这里a，和a的期望报酬值分别为170万元和140万元.若按期望报酬值最
大选最优方案，应选方案a{_1.
由上面的例子易见把利润作为决策目标和把效用值作为决策目标,其结果
可能是不同的.一般利用效用函数进行决策分析更能反映决策者的主观愿望.效
用函数还可以用来简化决策树,进行多目标决策分析等(见文献[3]).
2.信息的价值
要想对各种自然状态发生的概率做正确的预测,必须掌握更多的信息，这就
必须付出咨询费用,当然也会带来经济效益.决策者必须对咨询费用和由此带来
的经济效益进行比较,然后决定是否值得咨询.确定未来状态发生的概率是进行
决策分析的重要依据.凭个人的主观意志,判断给出的状态发生的概率通常称为
先验概率或主观概率.在先验概率的基础上，通过咨询得到新的概率分布,称为
后验概率.用后验概率计算的最优期望报酬值与用先验概率计算的最优期望报
酬值之差称为咨询的信息价值.如果信息价值大于咨询费用,则进行咨询.否则，
将不值得进行咨询.
设一个决策问题的状态集$S=x_{₁}，x_2}，，xn}，x{₁发生的先验概率为$p（x_{₁).咨
309

============================================================
第 328 页
============================================================

询结果$Z={z_{₁}，_{2}，…$，z_n}，计算信息价值的步骤如下：
第1步利用各种自然状态x的先验概率分布p(x)求出各个方案的期望
报酬值,最大期望报酬值记为E（R)；
第2步根据咨询信息，计算各种自然状态的后验分布,即依赖于咨询信息
z的条件概率分布p(x|z).这里
p(x∩z)
p(x|z)=$
p(z)
p(x∩z)=p(z|x)p(x)，
π
p(z）=∑p(x₁)p(z|x₁)
三
其中p(x∩z)表示事件x与z同时发生的概率$；
第3步利用后验概率分布,计算各个方案的后验期望报酬值；
第4步对于z的每一个值,选出后验期望报酬值最大的方案.这时的报酬
值是x和$z的函数，记为R^{(x，z)；
第5步计算出后验期望报酬值与先验期望报酬值的差，即计算出
E(R*(x,z))-E(R).
例8.4.2某企业准备投资生产一种新产品.估计市场销售状况有三种可
能，x_{}：畅销，x_2：-般和$x_₃}：滞销.它们的先验概率分布分别为p(x_{₁1)=0.4_$，
p(x_2)=0.3和p(x_3)=0.3.各种销售状况的盈利分别为20万元，10万元和
-10万元.如果去咨询,则要付出咨询费0.5万元.咨询的结果也有三种可能,即
z_{1}:畅销，z_₂：一般，z_{：滞销.咨询的信息如表8.4.2所示.
表8.4.2
实际市场情况x
p(z|$
$x_{}$
$x_{}$
$x_{3q}$
$1z$
0.8
0.1
0.1
市场调查
$z_{22}$
0.1
0.8
0.1
结果z
$z_{3}$
0.1
0.1
0.8
表中p(z|x)表示在实际市场销售状态是x时,咨询结果为$z的条件概率.企
业面临两种可供选择的方案,即投资和不投资.首先用期望值法求出最优方案，
然后利用信息价值分析是否值得咨询.
解该问题的状态集$S=x_₁1}，_2}，_3}.决策集A={a_{₁}，a{2}，其中a{₁1}，a{2分别表$
310

============================================================
第 329 页
============================================================

示投资和不投资,利用先验概率分布计算各方案的期望报酬值.
E₁1=20×0.4+10×0.3+(-10)×0.3=8(万元)，E2=0(万元)
于是最大期望报酬值E(R)=8(万元)，即最优方案为投资生产新产品，期望利
润为8万元.
下面计算信息的价值.
第1步上面已经计算出E(R)=8(万元)；
第2步计算各自然状态的后验分布；
p(x₁∩_₁)
由
p(x{,|_z{1}=$
$p(_i)$
3
其中p（x,∩_₁）=p（z₁|x）p(（x₁），
p(z₁）=∑p(x₁)p(z₁|x₁)
ji
得计算结果如下面的表8.4.3和表8.4.4所示.
表8.4.3
x
p(x∩z)
p({1)
$x_}$
$x_{}$
$x_{q}$
$z_{1$
0.32
0.03
0.03
0.38
$z{2}$
0.04
0.24
0.03
0.31
2
$_{q}$
0.04
0.03
0.24
0.31
p(xi)
0.4
0.3
0.3
1
表8.4.4
x
p(x|z)
$x_ }$
$x_{2}$
$x_{}$
$z_{}$
0.842 10
0.078 95
0.078 95
2
$z_{2}$
0.129 03
0.774 19
0.096 78
$z_{3q}$
0.129 03
0.096 78
0.774 19
第3步利用表8.4.4中的后验概率计算各方案的期望报酬值.
E(a_{1，21)=0.84210×20+0.07895×10+0.07895×(-10)=16.842(万元)
E($a_{2}_1})=0(万元)
E(a{1，2{2)=0.129 03×20+0.77419×10+0.09678×(-10)=9.3547(万元)
E(a_{2}，_{2)=0(万元)
311

============================================================
第 330 页
============================================================

E(a1,23)=0.12903×20+0.09678×10+0.77419×(-10)=-4.1935(万元)
$E(a_{}，_3)=0(万元)
第4步当$z=_{₁}和$z=_{2时，执行方}$a{1}，当$z=z_{3}$时执行方案$a_{2.每种情况
的期望报酬值分别为
R（x，_₁）=16.842（万元)，R*（x，z2）=9.3547（万元），R（，3)=
0(万元).
第5步总的后验期望报酬值
E（R（x，z））=p（z₁）R（x₂z₁）+p（z₂）R（x₂z₂）+p（₃）R°（x₃）
=0.38×16.842+0.31×9.3547+0.31×0≈9.30(万元)
于是
E(R{(x，z))-E(R)=9.30-8=1.30(万元)
通过咨询可增加收益1.3万元，而咨询费用只有0.5万元，故应该进
行咨询.
能完全准确地预料未来状态的信息称为完全信息.在上面的例子中完全信
息意味着p(x_{1|_{₁)=1,当i≠j时，p(x,|_z；)=0，即在每种状态下都选最优方案.
这时完全信息的价值为
20×0.4+10×0.3+0.3×0-E(R)=11-8=3(万元)
这是咨询费用的上限.
灵敏度分析是对决策的最后检验步骤.决策者对模型中的主要参数,人为地
做一微小的变化.如果这个变化不影响决策结果,说明决策结果是稳定的.如果
决策结果改变,那么决策者在最后决策之前应重新对模型中的参数进行估计
(详见文献[3]).
随着现代决策学的发展,常规决策的自动化正在迅速普及.例如,将许多复
杂的常规决策编成计算程序,形成决策支持系统.通常智能决策系统包括专家系
统、数据仓库和知识管理等内容，其相关发展历史、方法和应用可参见文献
[11]、[12].此外,决策形式的多样化也是现代决策理论的一大特点，如传统的
个人决策向现代化的群体决策转化,以及利用协议规定组织内成员作用的社会
决策.单目标决策也在向多目标决策转化,如多特征决策分析经常使用的层次分
析法(AHP)，它由美国运筹学家T.L.Saaty(沙旦)于20世纪 70 年代提出，作为
一种多层次权重解析方法,它综合了人们的主观判断,通过定量计算进行可选方
案的优先排序.当层次元素具有网状结构时，Saaty 又扩展提出了网络层次分析
法(ANP).它们的提出以及结合模糊集等不确定描述工具,决策分析也就被推广
至不确定决策.
目前,决策分析的主要发展方向为以下两个.第一个包含描述性与规范性的
312

============================================================
第 331 页
============================================================

决策,主要从理论上探讨人们在决策过程中的行为机理,即按什么准则和什么方
式进行决策.第二个是计算机技术和决策分析方法的结合,随着实际决策问题的
大规模化和人工智能等学科的发展,决策支持系统必将有重要的应用.
第8章习题
(A)
1.某农场欲修一水坝,必须考虑年降雨量大小对水坝的破坏作用.根据过去
的经验知道雨量大、中、小的概率分别为0.2,0.5,0.3.有三种设计方案可供选
择，即按常规设计、采取加固措施设计和特殊加固措施设计.对每个设计方案需
要考虑建筑费用和因雨量大小造成破坏后的维修费用.经调查计算总费用如下
表所示.
状态
费用/万元
雨量大
雨量中
雨量小
0.2
0.5
0.3
常规设计
150
06
60
方案
一般加固
120
08
80
特殊加固
100
100
100
分别用最大可能法和期望值法进行决策分析，找出最优方案.如果决策者的
效用函数u(150)=1,u(120)=0.7,u(100)=0.6，u(90)=0.5，u(80)=0.4，
u(60)=0.试用效用函数法进行决策分析,找出最优方案.
2.某工程队承担一座桥梁的施工任务，由于施工地区夏季多雨，需停工三个
月.在停工期间该工程队可将施工机械搬走或留在原处.如搬走，一种方案是搬
到附近仓库里，需花费2000元；一种方案是搬到较远的城里，需花费4000元.
但当发生洪水时第一种方案将遭受50 000元的损失.如留在原处,一种方案是花
1500元筑一护堤,防止河水上涨发生高水位的侵袭;若不筑护堤,发生高水位侵
袭时将损失10000元.如发生洪水时,则不管是否筑护堤,施工机械留在原处都
将遭受60 000元的损失.根据历史资料,该地区夏季高水位发生的概率是0.25,
洪水发生的概率是0.02.试用决策树法找出最优方案.
3.某公司欲购进一种新产品，有三种可供选择的方案，即大批量购进、中批
量购进、小批量购进.在各种市场需要下推销该产品的获利情况如下表所示，其
313

============================================================
第 332 页
============================================================

中负数表示亏损.
市场情况
利润/万元
畅销
一般
滞销
大批量购进
009
200
-80
方案
中批量购进
400
300
-20
小批量购进
200
100
-10
(1) 分别用乐观法、悲观法、乐观系数法(乐观系数α=0.4)，后悔值法和等
可能法进行决策分析,找出最优方案.
(2)若根据以往的经验估计销售的状况为:畅销的概率为0.5,销路一般的
概率为0.3,滞销的概率为0.2.试用期望值法找出最优方案.如果市场调查部门
能帮助公司调查新产品销路的确切情况,该公司最多愿意付出多少调查费用?
4.某公司欲开发一个新项目.估计成功率为40%，一旦成功可获利润
8 000元.如果失败,则亏损4000元.该公司若请咨询部门帮助调查，则需咨询费
用500元.在成功的情况下,咨询部门给出正确预报的概率为0.8，在失败的情况
下，咨询部门给出正确预报的概率为0.6.问该公司是否值得求助于咨询部门?
该公司是否应开发新项目？
（B)
1.某工厂的铸造车间生产某种汽车零件的毛坯，并以每10件为一批送加工
车间.根据长期生产统计，该车间送加工车间的毛坏中，80%的批次中含有10%
的缺陷件，20%的批次中含有50%的缺陷件.假如将含10%缺陷件的批次送下一
车间，每批给加工带来1000元损失，将含50%缺陷件的批件送加工车间，每批
损失为4000元.作为一种替代方案，送出前可对每批毛坏进行检查返修，返修后
可消除全部缺陷,但每批需返修费2000元.还有一种替代方案是从每批毛坯中
先抽查一件,根据抽查情况再决定该批毛坏进行检查返修还是直接送加工车间，
抽查一件的费用为100元.试为该铸造车间确定一个使总期望费用为最小的决
策方案.
2.某投资人考虑一个两年投资计划.第一年他有3种决策可以选择：用所有
资金购买股票,或用一半资金购买股票,或用所有资金购买债券.如果第一年他
选择用一半资金购买股票,第二年他又有两种决策可以选择:用剩余的一半资金
购买股票或者不买.假设投资人所购买的股票均为A公司的股票，且经过分析，投
资人发现不同的投资方案所得到的收益与A公司经营状况的好坏有密切关系.那
314

============================================================
第 333 页
============================================================

么,请通过随机模拟数据研究投资人应当如何做出决策,使得收益达到最大.
参考文献
1BererJO.StatisticalDcisionTheoryFoundationsConcepts,andMthod[
New York : Springer-Verlag,1980.
[2] Sinn H W.Economic Decisions under Uncertainty[M].2nd ed.Heidelberg:Physi-
ca-Verlag,1989.
[3]张连诚.决策分析入门[M].沈阳：辽宁教育出版社,1985.
[4]李同明.经济管理决策——决策学、经济数学在经济管理决策中的应用[M].
北京：中国人民大学出版社,1990.
[5]冯文权.经济预测与决策技术[M].5版.武汉:武汉大学出版社,2008.
[6]中国人民大学数学教研室.运筹学通论[M].北京:中国人民大学出版
社,1987.
[7]潘天敏.现代管理常用数学方法[M].沈阳:辽宁人民出版社,1985.
[8]胡运权.运筹学应用案例集[M].北京:清华大学出版社,1988.
[9]胡运权，等.运筹学习题集[M].北京:清华大学出版社，1985.
[10]岳超源.决策理论与方法[M].北京:科学出版社,2003.
[11] Arnott D,Pervan G.A Critical Analysis of Decision Support Systems Research.
Journal of Information Technology,2008,20(2),62-87.
[12] Eom S,Kim E.A Surveyof Decision Support System Applications(1995-2001).
JouralofthOioa Rcociy0671):.
[13]西蒙·弗兰奇,等.决策分析[M].李华旸，译.北京:清华大学出版社,2012.

============================================================
第 334 页
============================================================

第9章
对策论
对策论研究的对象是带有对抗性质的模型它的中心问题是：什么是对策
的解和解的存在性以及如何求解本章介绍对策模型以后，分别简单地介绍矩
阵对策、多人对策、合作对策及网络对策等各种对策的解的概念及解的存在性
和求解方法等
9.1引
創言
这一节在介绍对策论发展简史以后将通过几个不同类型的例子,包括两人
和多人、策略集合有限和策略集合无限等例子来说明对策模型.
1．对策论发展简史
在现实社会中,我们经常会遇到带有竞赛或斗争性质的现象，如下棋、打扑
克、体育比赛、军事斗争等.这类现象的共同特点是参加的往往是利益互相冲突
的双方或几方，而对抗的结局并不取决于某一方所选择的策略，而是由双方或者
几方所选择的策略决定.这类带有对抗性质的现象称为“对策现象”.
最初用数学方法来研究对策现象的是数学家E.Zermelo（策梅洛），他在
1912年发表的“关于集合论在象棋对策中的应用”一文中,证明三种着法必定存
在一种:不依赖黑方(对手)如何行动，白方(自己一方)总取胜的着法,或黑方总
取胜的着法,或者有一方总能保证达到和局的着法(究竟存在的是哪一种,并没
能指出来).此后,1921年法国数学家E.Borel(波莱尔)讨论了个别几种对策现
象,引入了“最优策略”的概念,证明对于这些对策现象存在最优策略,并猜出了
一些结果.1928年,德国数学家J.von Neumann(冯·诺伊曼)证明了这些结果.
本世纪40年代以来,由于战争和生产的需要,提出不少“对策问题”,像飞
机如何侦察潜水艇的活动、护航商船队的组织形式等.这些问题引起一些科学家
的兴趣,进而对“对策现象”进行研究,同时许多经济问题使经济学和对策论的
研究结合起来,为对策论的应用提供了广泛的场所,也加快了对策论体系的形
316

============================================================
第 335 页
============================================================

成.1944年J.von Neumann 和 0.Morgenstern（摩根斯坦)总结了对策论的研究成
果,合著了《对策论与经济行为》一书.从此,对策论的研究开始系统化和公理化.
近几年来,对策论的发展很快,应用也很广泛,例如统计判决函数的研究使
对策论应用于统计学,微分对策应用于航天技术,以及某些经济学的理论研究引
起了人们对多人合作对策的兴趣.
2.对策模型
现实生活中的对策现象是很多的,除了竞赛、战争等对策现象,还有许多其
他方面的例子.例如在农业方面,在对大自然规律(像气候、自然灾害等)还没有
完全掌握的条件下,如何对施肥、选种、投资等进行决策,就是人与大自然进行对
策的对策现象.又例如工厂企业之间的合作、兼并以及资金的投人等也是对策现
象.不管是什么形式的对策现象,它们的共同特点是都包含下列三个内容：
(1)局中人:参加对策的每一方称为局中人.在象棋比赛中,参加对弈的两
位棋手就是两个局中人.在人与大自然作斗争时,人与大自然是两个局中人.局
中人可以是一个人，也可以是代表共同利益的一个集团.一个对策现象中,可以
有两个局中人，也可以有两个以上的局中人.我们用符号1={1，2，…，n|表示局
中人集合.
(2)策略集合:每个局中人在竞争的过程中，总希望自己取得尽可能好的结
果.这样,每个局中人都在想法挑选能达到目的的“方法”.我们把这种“方法”称
为局中人的策略,如在乒乓球团体赛中运动员的出场次序就是一个策略.在农业
问题中，人们为了与干旱作斗争，可以播种某种抗旱品种，也可以拟定一个打井、
修水库的计划.一个抗旱计划就是一个策略.要注意的是,策略是指局中人在整
个竞争过程中对付他方的一个完整方法,并非指竞争过程中某一步所采用的局
部办法.在下象棋时,对于一盘棋来说,某一步走“当头炮”，只是作为一个策略的
一个组成部分,并非一个完整的策略.
局中人的所有策略组成了该局中人的“策略集合”，策略集合可以是有限
的，也可以是无限的.用符号S_{表示局中人i的策略集合.当每个局中人在一局对
策中都在自己的策略集合选定一个策略后,这局对策的结果就被决定了.每个局
中人所选定的策略放在一起就叫做一个局势，记作S.
(3) 支付函数:竞争的结局用数量来表示,称为支付函数(或赢得函数)，所
以支付函数是定义在局势集合上的数值函数.用符号H{}表示局中人i的支付
函数.
一个对策模型就是由局中人、策略集合、支付函数这三部分组成的,用符号
Γ=<1={1，2，…，n}；S_₁，i∈I；H₁(S)，i∈I)
317

============================================================
第 336 页
============================================================

表示.
对策的进行过程是这样的，每个局中人都从自己的策略集合$_{中选出一
个策略$S{1，S^∈S₁，就组成一个局势S=（S1}，s（²2），，Sn)∈S{，把局势S$
n
代人每个局中人的支付函数H_(S)中，局中人i就获得_{(S)，这局对策就结
$=
束了.
3.例子
例9.1.1猜硬币游戏
两个参加者甲、乙各出示一枚硬币，在不让对方看见的情况下，将硬币放在
桌上，若两个硬币都呈正面或都呈反面，则甲得1分，乙付出1分;若两个硬币一
正一反,则乙得1分，甲付出1分.
这时甲、乙分别是局中人1和局中人2，他们各有两个策略，出示硬币的正
面或反面$用$α_{1}，$_{2分别表示局中人$1出示正面和反面这两个策略$；用$β_{1}，β_{2}$
分别表示局中人2出示正_和反面这两个策略$S_{₁}=α_{1}，_{2}，S_{2=β{1}，β_{2}.当
两个局中人分别从自己的策略集合中选定一个策略以后,就得到一个局势.这
个游戏的局势集合是S_{1×_₂2=（α₁1，β₁1），（a₁1，β₂2），（a_₂}，β₁1），（α_₂，β2）}.两个
局中人的支付函数H_{,H_{是定义在局势集合上的函数，由给定的规则可得到
H₁（α₁，β₁1）=1，H₁（α₁1，β₂2）=-1，H₁（α₂2，β₁）=-1，H₁（α2，β2）=1
H2（α₁}，β₁1）=-1，H2（α₁，β2）=1，H₂（α₂，β₁1）=1，H₂（α₂2，β₂2）=-1
例9.1.2两个人决斗，都拿着已经装上子弹的手枪,站在相隔距离是1单
位的地方,然后面对面走近,在每一步他们都可以决定是否打出唯一的一发子
弹.当然，离得越近,打得越准.假如其中一人开枪而未打中，按规则，他仍要继续
往前走.双方各在什么时机开枪好呢?
这个对策中局中人只有两个，局中人1和局中人2.局中人1的策略是选择
在双方距离为x时开枪，0≤x≤$1.所以局中人1的策略集合$S_{={x0≤
x≤1}.同样，局中人2选择在双方距离为y$时开枪，$S_{2={y|0≤y≤1|.局势集
合是S_{}×S_,=(x,y)|0≤x≤1，0≤y≤1}.
现在再来看定义在局势集合上的支付函数是什么？假设局中人1的命中
率函数是{p_{1}($x)$,，0_≤x≤1，它表示当距离是$x时，击中对方的概率;设局中人2
在双方相距为y$时开枪击中对方的概率是$_{2(y)$，0≤y≤$1.规定击中对方而
自己未被击中得1分,被对方击中但自己没有击中对方得-1分，双方都没有
被对方击中或者都被对方击中各得0分.以H_{₁}(_，y)表示局中人1的支付函
数,有
318

============================================================
第 337 页
============================================================

$H_{}x,)
1·p₁（x）+（-1）·[1-p₁（x）]=2p₁（x）-1
$x>y$
=1·p₁（x）[1-p₂（x）]+（-1）·[1-p₁（x）]p₂（x）=p₁（x）-p（x）
x=y
（-1）·p₂（y）+1·[1-p2（y）]=-2p2（y）+1
x<y$
在上式中，局中人1在双方相距为x时开枪，x>y表示局中人1先开枪，_{1}x)是
局中人2被击中的概率，若局中人2被击中，则局中人1得到的支付为1;1-
P_1}{x)是局中人2没有被击中的概率,若局中人2没有被击中,则局中人1必被击
中，他得到的支付是-1，所以1·p_{₁}(x)与(-1)·[1-p_{₁1(x)]这两项之和是局
中人1的期望支付.
x=y是两个局中人同时开枪的情形，其中1·p_{₁}(x)[1-p_{2(x)]表示局中人
2被击中而局中人1没有被击中时，局中人1的期望支付.（-1）·[1-
$P_{1}(x)]_2(x)则是局中人2没有被击中而局中人1被击中时，局中人1的期望支
付.两个人都击中对方或都没有被击中时支付是0.
x<y是局中人2先开枪的情形.p_{2}y)是局中人1被击中的概率，这时他得
到的支付是-1，1-p_2(y)是局中人1没有被击中的概率，按规则局中人2将继
续向前走，一定被击中,这时局中人1得到的支付是1,所以局中人1的期望支付
是(-1)·p_₂2(y)+1·[1-p₂2(y)]=1-2p2}(y).
同样可以写出局中人2的支付函数H_{}x_，y).
例9.1.3三个人做一个游戏,每个人同时出示一个硬币的正面或反面.如
果三个人出示的全是正面或全是反面,则三个人的支付都是0．如果有两个人出
示正面，一个人出示反面，则出示反面的人扣两分,两个出示正面的人每人各得
一分.如果有两个人出示反面，一个人出示正面，则出示正面的人扣两分,两个出
示反面的人每人各得一分.
这是一个3人对策，局中人集合1=1,2,3，每个局中人有两个策略：出示
正面或反面$.如果用$1代表出示正面，用0代表出示反面,那么$_{1={0$，$1}$_{2}
{0,1}，S_₃={0，1是局中人1局中人2、局中人3的策略集合，局势为
S_{1×S₂2xS_₃={（x₁，x2，x₃3）|x₁=0,1，i=1，2，3}
用H_{1}(_₁1}2_2}，_3)表示局中人1的支付函数，则
H₁0,0,0)=0，H₁(0,1,0)=1,H₁(0,1,1)=-2，H₁(0,0,1）=1
H₁（1,0,0)=-2，H₁(1,1,0)=1，H₁(1,1,1）=0，H₁(1,0,1)=1
同样可以求出局中人2、局中人3的支付函数H_2(x_1，_2}，_3})，
H₃（x1，x2，x₃3).
319

============================================================
第 338 页
============================================================

9.2矩阵对策的平衡局势
本节主要介绍矩阵对策——两人有限零和对策的平衡局势及其存在性定
理,并给出求解的线性规划方法.
1．矩阵对策及其平衡局势
当我们给定一个对策以后,首先想到的是在这个对策中,局中人应该选什么
策略最好.由于对策的结果不仅取决于一个局中人,而是由所有局中人的决策所
决定的,所以选择什么策略最好是个很复杂的问题.我们先从两人有限零和对策
开始来讨论这个问题.
两人有限零和对策(也称为矩阵对策)是指这样的对策:有两个局中人,每
个局中人的策略集合都是有限的._{₁=α₁，α₂}，，α}，S₂=β₁}，β₂，…，βn1.两个
局中人的支付函数H_{₁,2具有性质H_{1+_2}=}}O$.
此时，这类对策的局势集合是$S_₁1xS_2={（α₁，β₁）|i=1，2，，m；j=1，
2，…，n，包含mn个局势.设H₁（a₁，β₁）=a，就有H_2（α₁，β₁）=-a，i=1，2，…，
m,j=1$，2}，…$，n.这样支付函数就可以用-个$m×n矩阵A=(a_{)$^mx{n表示.
反之，如果给定-个m×n矩阵A=($a_{)$mxn，用行的数目代表局中人1的策
略个数,用列的数目代表局中人2的策略个数，用a{代表局中人1在局势(α_{β})
时的支付，-$_{i代表局中人2在局势(_{，β_{)时的支付，就给定了一个两人有限
零和对策.
例9.2.1例9.1.1就是一个矩阵对策,其中
1
一
$S_{1=a₁1},_2，S₂2=β_1}，β2，A
1
- 1
1
我们先来看在矩阵对策中,两个局中人如何采取最稳妥的策略.所谓最稳妥
策略表示:一个局中人采取各种各样的策略时,最不利的情况是什么,而从这些
最不利的情况中，他要选择其中最为有利的一种.
例如矩阵对策Γ=_{₁，S_₂2;A|，其中
3
0
2
A=-4 -1
3
2
-2-1
局中人1采用_{1时,他能得到3，0，或2，最不利情况是获得0.如果他采用_{}，他
能得到-4，-1或3，最不利情况是获得-4.如果他采用$α_{3时，他能得到2,-2
320

============================================================
第 339 页
============================================================

或-1.最不利情况是获得-2,这三个最不利的情况以“获得0”这种情况最为
有利.这时局中人1的最稳妥策略是采用α{_
上面所讲的从各种最不利的情况中选一个最有利的这一事实，如果用矩阵
的元素大小来叙述的话,就表示局中人1从各行中取出最小的数,然后再从这些
最小的数中取最大的一个数,在这个例子中就是
maxminaj}=max|0,-4,-2}=0
-
j
同样，局中人2所面临的各种情况是:采用β_{时，他将付出3，-4或2，最不
利的情况是付出3.采用β_{2时,付出的数将分别是0,-1或-2,最不利的情况是
付出0.采用β_{₃时，付出的数分别是2,3或-1，最不利的情况是付出3.这三个最
不利的情况中以“付出0”这个情况最有利.而这种选择也就是局中人2从矩阵
的每一列中选最大的数,然后再从这些最大数中取最小的一个,在我们的例子中
便是
min|maxa=min{3,0,3|=0
5
i
局中人2的最稳妥策略是采用策略β_2.
综上所述，给定矩阵对策Γ=S_₁，_2；A}，如果
max min a=min ai0j
i
j
那么局中人1的最稳妥策略是α.如果
min max a=  max a
j
i
那么局中人2的最稳妥策略是β_。.如果
(9.2.1)
i
j
j
i
j
!
max min aj=a0j
=min max aij
1
.
这说明,如果两个局中人都采取自己的最稳妥策略,那么他们都得到在最坏
情况下的最好结果.
由此可得到矩阵对策平衡局势的概念.
定义9.2.1矩阵对策Γ={S_{₁，S_2；A}，如果存在局势（i，j^)满足
等式
max min a= min max a_=aj
(9.2.2)
则称（i，j)是对策的平衡局势.i*，j分别是局中人1和局中人2的最优策
略，v=$a。称为对策Γ平衡局势的值.
例9.2.2某蔬菜种植地共有菜地3150亩，种植茄子、辣椒等13种蔬菜.
各种蔬菜在不同的水、肥、劳力、种子、日照时间等因素下，产量不相同.有的因素
321

============================================================
第 340 页
============================================================

是人们可以掌握的,有的因素,像水、阳光等是暂时不能掌握也很难预测的.共选
择了5个种植计划，把自然条件分为6类.每一个种植计划在不同的自然条件下
的获得(单位:百元)都能计算出来,得表9.2.1.
表9.2.1
单位：百元
$β{2}$
$β{3}$
$β{$
$β{s}$
β{6$
$β{}$
192 460
235 120
278 200
156 360
197 520
242 840
$α}$
$α_{2}$
189 560
231 700
273 630
155 620
195 600
239 710
$α_{3}$
192 060
234 799
277 095
158 235
198 580
243 280
α_{4$
194 370
237 218
280 751
158 475
199 813
245 362
$α_{s$
194 360
238 990
281 385
157 835
199 750
246 020
这是一个两人有限零和对策,计划制定者与大自然是两个局中人,他们的策
略集合是S_₁=α₁，α₂，α₃₂，α₄，α₂l，S₂2=β₁}，β₂2，β₃，β₄，β₂，β₀|.计划制定者获
得如表9.2.1,大自然的获得可以看成是计划制定者的获得的负数,所以该表就
是矩阵对策的支付矩阵.我们来找这个矩阵对策的平衡局势及其值.
maxmina=max{a₁4，a24，34，a44，a54=a4
i
;
i
局中人1的最稳妥策略为α_₄.
minmaxa=min{a4₁1,a5₂,a₃3,a44a45，a6=a4
j
;
I
局中人2的最稳妥策略为β
max min a= min max a= a44
！
矩阵对策的平衡局势为（$α_{₄}，β_{₄4)，值v=a_44= 158475.
下面给出矩阵对策平衡局势存在的充分必要条件.
定理9.2.1矩阵对策$r={$_{1，S_{2;A}满足等式(9.2.2)的充分必要条
件是
a，≤a；≤aj，i=1,2，，m；j=1,2，.,n
(9.2.3)
证充分性.设
max min a= min a{0
min max a= max aj0
(9.2.4)
:
j
1
j
i
那么
min a_{0j≤ai0j0≤max a_j
j
所以
max min a≤ min max aj
i
E
i
又由(9.2.3)
322

============================================================
第 341 页
============================================================

max aj.≤a₁。≤min a{j
I
min max a≤max a≤min a≤max min aj
就得到
max min a= min max a
j
i
必要性.由(9.2.4)及定理假设,得到
min a_{0j=max a
i
所以
=min ai0
=max a
a_i0j
i
≤a{i0j
i =1,2,…,m； j=1,2,.,n
aijo
≥
ai0j
(i_{}，_{)满足定理要求$.
I
从不等式组(9.2.3)可以得到,如果局中人1选取策略i，则局中人2选择
j以外的任何策略，他的付出值不可能小于$a{j.如果局中人2选择策略j，则
局中人1选择i以外的任何策略，收人值不可能大于$a{j.当局中人1选择策略
i,局中人2选择策略j时,两个局中人同时得到最坏情况下的最好结果.
2.矩阵对策的混合扩充
不是所有的矩阵对策都存在平衡局势.
例9.2.3矩阵对策={S_{}，S_2;A}}，其中
1
7
2
2
2
A=
0
3
1
3
1
2
2
由
1
\fra2}
i
j
1
=2=max a{
$\fa
j
i
i
max min a≠ min max a，所以平衡局势不存在.
i
i
i
为了克服有些矩阵对策没有平衡局势的困难,我们将扩充这些矩阵对策,当
然这种扩充要有意义,并且扩充以后,平衡局势存在的可能性就大得多.作这样
的扩充:把每个局中人的策略集合$S_{1}扩充为在集合$S_{上的概率分布集合_{}，i=
1,2.就是说,在进行多次对策时,不是每次都选择同一策略,而是以不同的概率
323

============================================================
第 342 页
============================================================

选择每个策略.支付函数是进行多次对策所得到支付的数学期望值,称这种扩充
为混合扩充.
对于矩阵对策Γ={S_{₁}，S_₂2；A}：
局中人1的混合策略集合为
m
S{={X=（x₁，x₂，，x）｜∑x₁=1，x₁≥0，=1，2，…，m}
司
局中人2的混合策略集合为
n
S₂={Y=（y₁，y₂，，y₂）|∑y,=1，y₁≥0，j=1，2，…,n}
=
在局势（X，Y)下，局中人1的支付函数为
E(X,Y)=∑∑a{x₁y
m
1
台高
局中人2的支付函数就是-E(X_，Y)，所以的混合扩充为：r={S_{}，$S_{2}；
E(X，Y)I.
扩充以后，可以类似地定义混合平衡局势.
定义9.2.2矩阵对策Γ={S_{₁，_₂2；A的混合扩充为Γ，如果存在局势
（x{，y^），使等式
maxminE(x,y）=minmaxE（x,y)=E(x,y)
(9.2.5)
x∈Sy∈S}
y∈S_{2x∈S{}$
成立，则称（x，y)是Γ的混合平衡局势，x，y是两个局中人的最优策略，
E(x*}，y)是混合平衡局势的值.
与定理9.2.1类似，可以证明：
定理9.2.2矩阵对策Γ=S_{1，S_2;A}的混合扩充满足等式(9.2.5)的充分
必要条件是
E（x,y）≤E（x，y)≤E（x，y），x∈S，y∈S_₂（9.2.6)
混合平衡局势可以使双方都达到最坏情况中的最好结果.
为方便起见，以后将对策的混合扩充的混合策略、混合局势、混合平衡局势
简称为策略、局势、平衡局势.而把没有扩充以前的对策的策略、局势、平衡局势
称为纯策略、纯局势、纯平衡局势.实际上纯策略可以看成是特殊的混合策略，是
每次对策都采取这个策略的混合策略.
进一步，可以得到矩阵对策平衡局势的存在性定理.
定理9.2.3矩阵对策在它的混合扩充中存在平衡局势.
定理9.2.3的证明将在9.3中给出.
3.矩阵对策的简化
设矩阵对策的支付矩阵是
324

============================================================
第 343 页
============================================================

(1
-2
0
0
1
-1
2
-1
1
容易看出，局中人1决不会采用他的第一个策略，这是因为不论局中人2选择什
么策略,局中人1的第三个策略的支付总比第一个策略的支付大.因此,局中人1
的第一个策略必定只能以零概率出现在他的最优策略中.
这样,要解上面这个矩阵对策,可以将矩阵的第一行划去，只要解矩阵对策
10
1
-1
(2- 1
1
就行了.
再对上面这个2×3矩阵进行考察，局中人2将他的策略一和策略三进行比
较，他显然不愿采用策略一，不论局中人1采用哪一个策略，局中人2的第三个策
略的支付都小于第一个策略的支付.因此可以将上面这个矩阵的第一列划去，只
要解矩阵对策
1
-1
就行了.容易验证它的平衡局势是x
1
1
4
I
，y
,值v=0$,再回到
2
2
2
2
原来的矩阵对策,可以猜想，它的平衡局势及其值应该是
1
x
y
0
v=0
2
二
,
2
2
下面我们介绍优超性概念.
定义9.2.3给出矩阵对策Γ={$_{₁}，S_2;A}，A=(a_{)$是m×n矩阵，如果
akj
≥
aj，j=1，2，…,n
(9.2.7)
则称局中人1的策略k优超于策略l，如果
ai
≤
a{1，i=1，2,.,m$
(9.2.8)
则称局中人2的策略k优超于策略l.
如果在(9.2.7)，(9.2.8)中成立严格不等式，则分别称局中人1，2的策略k
严格优超于策略l.
还可以定义一个纯策略被另外若干个纯策略的凸线性组合所优超的情形.
可以证明,在这种情形下如果是严格优超，则将被优超的那个纯策略所对应
的行或列划去后，由剩下的较小的矩阵对策的最优策略,就可以得到原来对策的
最优策略，只要将划去的那一行或列所对应的纯策略赋以概率0就行.而且值不
改变.
325

============================================================
第 344 页
============================================================

如果只是优超不是严格优超,仍可以从较小的矩阵对策的平衡局势得到原
来对策的平衡局势.只是由较小矩阵对策得到的平衡局势不一定是原对策的全
部平衡局势.如果只要求找矩阵对策的一个平衡局势,而不是全部平衡局势,就
可以用这种优超性简化求平衡局势的过程.
例9.2.4设矩阵对策的支付矩阵是
3
2
4
0
3
4
2
3
4
3
4
2
0
4
0
8
局中人1的策略一被他的策略三所优超，可以将矩阵第一行划去：
3
42
3
4 3 42
0 4 08
局中人2的第一个策略被他的第三个策略优超，可以将矩阵的第一列划去：
(423)
3
34 2
4
0
8
不难看出，这个3×3矩阵对策的元素满足下列关系：
2
3
1
1
≥
4
+
2
2
2
4
0
8
因此，又可以将这个3×3矩阵的第一列划去，得到
2
3
4
2
0
8
这个矩阵的第一行元素被第二、三行元素的一个凸线性组合所优超：
1
1
(2,3)≤=
(4，2)+
-(0,8)
2
2
因此，又可以将这个3×2矩阵的第一行划去，得到
(08)
容易验证,这个矩阵对策的平衡局势是x =
10/n
,值是
5
所以原来矩阵对策的平衡局势是x=
（0，0，$\fra}
$\frac{}{5}$
,值
326

============================================================
第 345 页
============================================================

16/5
是
4.线性规划求解方法
给定矩阵对策r={S_{₁}，S_{2;A}，由定理9.2.2，局势(x，y^)是Γ的平衡局
势的充分必要条件是下列不等式组成立：
n
mn
n
m
a{{≤∑∑
a{x{y≤∑ax，i=1,2，…，m；j=1,2，,n
三
i
定理9.2.4矩阵对策Γ=S_{₁，S_{2；A，如果存在实数V及局势(x{}，^)，
使下列不等式组成立：
n
∑
a₁y{≤V,i=1,2，,…,m
j=1
m
∑
$a₁yx{2≥V，j=1,2,…,n
i
则（x，y）是平衡局势，V是值.
m
证V≤∑a{x，j=1，2，，n，两边乘以y{}，得到
2
m
Vy；≤（∑a₁x）y，j=1，2，…，n
三
V≤a
n
m
所以
同理可以得到
7
=1
x03=
m
从而有
n
一
因此，求一个矩阵对策的平衡局势就变成解下列不等式组:找到x{1}，{x_₂}，…，
xm，y_₁}，_₂，…，y，及V，满足
m
M
m
$a_{y_x{}≥V
∑x{=1，j=1,2,.,n
三
n
n
(9.2.9)
三
x_₁≥0，y₁≥0,i=1,2,…，m；j=1,2,.,n
把解不等式组(9.2.9)变成解一对对偶规划问题.先假设$ai>0(i=1，2，.$，m；
j=1，2}，…，n)，否则可以对矩阵A=（aj)$的每个元素$a{j加上常数k，使a{j+
327

============================================================
第 346 页
============================================================

k>0，得到A^{=（a_₁+k)$.显然矩阵对策Γ=S_₁，S_2；A}与矩阵对策r^'={_{1}$_{2；
A'}的平衡局势相同，只是值增加了常数k.
作线性规划
m
min
∑
$x_{i}$
三
m
M
$ax{;}≥1，j=1,2, ·,n
(9.2.10)
s.t.
$x{i}≥0
i=1,2,.,m
和
M
n
max
$γ_}$
Ma
n
(9.2.11)
s.t.
a₁y₁≤1，i=1,2,,m
$γ_{1}≥0,
j=1,2,..,n
定理9.2.5线性规划(9.2.10)(9.2.11)有最优解X=(x₁1，x2}，…，x_m）
m
n
1
，X=V（x₁}，x₂}，，x）,Y=V（y₁
$y_}$
=
V
日
$_{2}，_，y_{n})$ 矩阵对策Γ={S_{₁，S_2；A$的平衡局势，V$ Γ的值.
证容易看出(9.2.10),(9.2.11)都有可行解,且互为对偶规划.由定理
1.5.3知，有最优解X=（x_₁，x₂，…，x），Y=（y₁1，y，，y{n），并且
∑x{1=∑y,>0.
m
"
三
三
m
n
n
=
∑ax=∑aV;≥V，j=1,2，…，n
m
m
=
三
∑x{=∑V_x₁=1，∑y;=Vy,=1
m
$m$
n
月
=
三
x{=Vx；≥0,，y,=Vy,≥0,i=1,2,,m，j=1,2，, ·,n
x_{}，_{2，，xm；y₁，y2，…，满足不等式组（9.2.9)，所以（X，Y)）是的平衡
局势，V是值．
例9.2.5给定矩阵对策的支付矩阵为
328

============================================================
第 347 页
============================================================

1
3
3
A=
4
2
1
3
2
求最优策略和值.
解由定理9.2.5,作线性规划：
min$z=x_,+x_2+x_3}$
s.t.
$x_{1}+4x{2+3x3} ≥1$
3x₁+2x₂2+2x3≥1
3x{2+x₂2+2x3≥1
x₁1，x2，x_3≥0
和
max
w=y₁+₂+y3
s.t.
y₁1+3y2+3y3≤1
4y{1+2y2+y_3≤1
3y1+2y2+2y3≤1
y_1}y₂2，y_3≥0
解这对对偶规划,得到最优解
x=y=\fra$
所以
7
7
1
V=
,0,
3
3
7
1
1
1
Y*
=
=
3
7
7
7
3
3
3
7
(X*，Y*)是矩阵对策的平衡局势，值等于
3
用数学规划方法求矩阵对策的平衡局势这个想法已经得到一些推广，可以
把求两人有限非零和对策(双矩阵对策)的平衡局势问题化成一个解二次规划
问题.再进一步,把求较特殊的n人对策的平衡局势问题化成一个非线性规划问
题.但是这些非线性规划也是不容易解的.
求平衡局势还有一些方法，例如迭代法、微分方程法等.有兴趣的读者可查
阅参考文献[6]，[8]的有关章节.
329

============================================================
第 348 页
============================================================

9.3非合作对策的平衡局势
本节介绍两类非合作对策—对抗对策和n人对策的平衡局势.证明了多
人有限非合作对策在它的混合扩充中存在平衡局势.
1．对抗对策及其平衡局势
把矩阵对策中策略集合有限的假设去掉,就是一般的两人零和对策,又称对
抗对策.关于对抗对策也有类似的结果.
引理9.3.1设$f是X×Y→R的一个有界函数，X,Y是两个集合，则
inf sup f(x,y)≥ sup inff(x,y)
γ∈YxeX
x∈X y∈Y
证
supf(x,y)≥f(x,y)，∀x∈X,y∈Y
x∈X
对上式的两边取下确界，就有
inf supf(x,y)≥inff(x,y)，∀x∈X
y∈Yx∈X
y∈Y
所以
inf supf(x,)≥ sup inff(x,γ)
一
EYx∈X
x∈X y∈Y
利用引理9.3.1,与证明定理9.2.1类似的方法，容易证明下列定理.
定理9.3.1
对抗对策r={S_{₁，S_₂；H}，H$}定义_$S_{×S_{2}的有界函数，
则
max infH(α,β),min supH(α,β)
$α∈S1β∈S_2}$
$β∈S_{2 a∈_1}$
存在并且相等的充分必要条件是存在$α{∈$S_{}，β^{∈$S_{₂2}，使
H(α，β）≤H（α，β)≤H(α°，β)，α∈S₁1，β∈S_₂（9.3.1)
定义9.3.1若对抗对策Γ={S_{₁1，S_2；H}存在局势（α，β^)使不等式组
(9.3.1)成立，则称(α，β^*)是Γ的平衡局势.α，β^分别是两个局中人的最
优策略$.v=H（α，β）是的值.
例9.3.1对抗对策Γ=S_₁，S₂；H}，S_₁=x|0≤≤1，$S_2=
{y|0≤y≤1},H（x，y)=2x-y^{2}.
max inf（2x²2-y^²2})=max（2x{2-1)=2×1^²2-1=1
x∈[0.1]y∈[0,1]
x∈[0.1]
min sup（2x²-y2）=min(2-y^{2}）=2-1²=1
y∈[0.1]x∈[0,1}
y∈[0,1]
Γ的平衡局势是(1,1)，值是H(1,1)=1.
330

============================================================
第 349 页
============================================================

2.n人对策及其平衡局势
在对抗对策={S_₁S₂；H}中，如果用H_{₁α，β)），H_₂a，β）=-H₁（α，β)分
别表示两个局中人的支付函数,那么不等式组(9.3.1)就变成
H_₁（α，β）≤H₁（α，β），α∈S_1
H2(α，β）≤H₂2（α，β)），β∈S_2
就是说，存在一组局势（α，β*），使局中人1或局中人2如果单独改动策略，就
只可能减少收入,不可能增加收入.这样双方都不想改动,就能处于平衡状态.我
们把这个想法推广到多人非零和对策上去.
用符号S∥s{表示这样的局势：局中人i把策略${{)换成策略$S{{)}，其他局
中人的策略不变，
{（u）S（1+）1）（1-）S（2）1）S=（）S∥S
定义9.3.2n人对策={_；$S_{，i∈I{；H{(S)，i∈}，如果有局势
$S=（s1，s2），n），使
H(S∥S）≤H（S），Vi∈I，∀Si∈S
(9.3.2)
就称S是Γ的一个平衡局势.
例9.3.2给定-个三人对策$，其中$I={1,2,3}，$S_{1={α_{₁1}，_{2}}，
$S_{2}=β₁}，β₂|，S_₃3=_₁1，γ₂}，H（S）（i=1，2，3）用表9.3.1表示：
表9.3.1
局中人
支付函数
1
2
ω
$H_{1}$
$H _{2}$
$H_{3}$
$α_{}$
β{1$
$γ_}$
1
1
2
$α_1}$
$β{1}$
$γ_{2}$
-3
1
1
$_{2}$
$γ_{}$
4
-2
-2
$α_1}$
策
$α_{}$
${2}$
$γ_{2}$
0
1
1
$α_2}$
$β{1$
$γ1$
1
2
-1
略
$β{1}$
$γ_{2}$
2
0
$α_{2}$
-1
$_{2}$
$γ_{1}$
3
$α_{}$
1
-1
${}$
$γ_{2}$
2
$α_{2}$
1
-1
局势（α_₁1，β_{1}，₁1）是平衡局势，因为
H₁（α₂，β₁，γ₁）=1≤H₁（α₁，β1，γ₁）=1
H2（α₁，β₂，γ₁1）=-2≤H₂2（α₁，β₁，₁）=1
331

============================================================
第 350 页
============================================================

$H3(α₁}，β1，γ₂2）=1≤H3（α₁，β₁1，γ₁1）=2
对抗对策、矩阵对策的平衡局势就是使局中人都得到最坏情况下的最好结
果.但是一般的两人非零和对策、多人对策不一定有这个结果,在例9.3.2中
maxminH₁（S（1，s²)，s³））)=max-3，1}=1在α{2上达到；
S(1)∈_₁s(2)∈S2
$S(3)}∈ S}$
xminH₂（S1，s²，s)）=max{0，-2}=0在β₁上达到；
max
$S(2)∈S_2S(1)∈S_}$
$s(3)e _{}$
maxminH₃(S1s²），s3）=max-2，-1}=-1在₂上达到.
s（3)∈S₃s（1)∈S₁
$S(2)}}$
而平衡局势是（α₁，β₁}，γ₁），并且H₁（a₁，β₁，γ₁）=1，H_2（a₁，β₁1，₁）=1，H₃3（α₁，
$β{1，γ1）=2$.
并不是所有的对策都存在平衡局势.下面,我们研究对抗对策和n人有限对
策的混合扩充.
3.混合扩充的平衡局势
（1)对抗对策=S_₁}，S₂2；H}，其中S_₁=x|O≤x≤1，S_₂2=y|0≤y≤
1}.H(x，y)是定义在$_{1}×S_{2上的连续函数.局中人1的支付函数是H(x，y)，局中
人2的支付函数是-H(x，y).局中人1的混合策略集合是
$S{={F(x)|（x)是定义在[0，1]上的分布函数}
局中人2的混合策略集合是
$S_{2}=}G(y)|G(y)是定义在[0，1]上的分布函数}
在局势（F(x)，G(y)）上，局中人1的支付函数为
H(F,G)=H(x,y)dF（x)dG(y)
0
局中人2的支付函数是-H{（F,_)，所以连续对策的混合扩充为：=$S_{}，
$S_{2;H}
(2)n人有限对策=1；$S_，i∈$I；H_{（S)，i∈1}
每个局中人的策略集合都是有限的：
S_=S，S，，S}，i=1,2,,n
局中人i的混合策略集合是
mi
S={x₁=（x，x，…，x）∑x=1，x≥0，
j=1,2,…,m},i=1,2,.,n
332

============================================================
第 351 页
============================================================

在局势x=（x_₁}，_₂}，…，xn）上，局中人i的支付函数为
$m1
m2
$m^{n}$
H_（x₁}，x₂}，…，xn}）=∑∑…∑
小
(1)
x
(2)
=1{2=$
${$
$x_{n$
i=1,2,..,n
所以它的混合扩充为
Γ={I；S，i∈I；H{（x），i∈}
当然，对策略集合S{无限的n人对策也可以作混合扩充，只是S_{上的概率分
布将复杂一些.
扩充以后，可以类似地定义混合平衡局势.
定义9.3.3若n人对策的混合扩充r{=_{；$_{，i∈I{；H_{}(x)，
i∈1}有局势x=（x_2，x2，…，x），使
H{（x）≥H（xx₁），∀x₁∈S，Vi∈I
则称x为T°的混合平衡局势.
现在来证明n人有限对策的混合扩充存在平衡局势.先证明下列引理.
引理9.3.2n人有限对策r={1；$S_{，i∈l；H{（x），i∈}，x
是平衡局势的充分必要条件是
H{（x）≥H（x*S），S_∈S_₁，i∈I
证$必要性是显然的，因为$S_{∈$S_{}$$
m;
mi
H（x∥x₁）=∑H（xS）x≤∑H（x）x=H²（x)
三
=
定理9.3.2n人有限对策的混合扩充存在平衡局势.
证设n人有限对策为={1；$S_{，i∈I；H₁(S），i∈I}，其中I={1，
2，…，n1，S={S,S，…，S}，i∈1
$m_;$
S{={x₁=（x1,x2，，x)
x=1，x1≥0,j=1,2…,m}
∑
n
对于任何x=（x_₁}，x_2，…，x{n）∈∏S{=S^和i∈I$，作函数
$=$
φ（x）=max{0，H₁（xS）-H（x）}，i=1，2，…,n；j=1，2，,m
此式表示局中人i改变策略的倾向,再定义局中人i改变策略的一个变换
p{1)$
(i)
$x_j$
+φj
$xra{{1}$
（i)
，i∈I,j=1,2, . ,m;
mi
∑$φ{^$
1+
k=
333

============================================================
第 352 页
============================================================

不难验证，x1=（x1}，，，x)）∈S_{}，并且这个变换是一个由S{到S{的连
续变换，由Brouwer不动点原理，存在x=（x{1}，x²2}，…，xn）)∈S}，使得
+φ_{i}x)
(i)
$x_
$m^_i$
1+∑4φ{1³}x$
1
现在来证明,这个x就是平衡局势.
对于任何i∈1，使得x_{>0的j中，至少存在-个j使得$φ_{(x)=0，否则，对
于j=1，2，…，m_{₁}，都有φ{(x)>0或者x{=0，则
H{（x∥S）>H（x）或者x=0
mi$
所以H{（∥S_{)_1>H{（x），即H{（x)）>H_{（x)），但这是不可能的.因此
$j三
对任何i∈I，都有一个l，使得
$（1{rx}$
=
mi$
1+
∑
$φ_{}x)
mi
并且x_{1>0，所以∑φ{1(x)=0$.$
=y
由于$φ_{(x)≥0，就得到对任何i∈$1与j=1,2，.，m_{
由引理9.3.2知，x是平衡局势.1
矩阵对策当然是n人有限对策的特殊情况，所以由上述定理就得到矩阵对
策Γ={S_{1，S_2；A在它的混合扩充中存在平衡局势，即定理9.2.3成立.
一般说来，当一个对策的策略个数无限时,这个对策的混合扩充不一定存在平
衡局势.关于平衡局势存在性问题的研究一直是对策论研究工作者感兴趣的问题
而且，找n人对策的平衡局势是很不容易的事.有兴趣的话，可以查阅相关文献
9.4 合作对策
合作对策是指在对策过程中,局中人可以事先商量,协调他们的策略,每个局
中人根据协调情况选择策略进行对策,结束后再重新分配这些局中人所得支付的
总和.因此合作对策的局中人要考虑如何结成联盟以及如何重新分配联盟的支付.
1.特征函数
334

============================================================
第 353 页
============================================================

局中人可以协调他们的策略，所以R的纯策略集合S{=∏$S_{混合扩充后，策略
$e{\r}$
集合是{$S_{i}上的概率分布$_{2}.联盟R采用最稳妥策略,就是要在最坏的情况下
$r{R}$
得到最好结果,最坏情况是R以外的局中人也组成联盟使R获得最少.R以外的
局中人的纯策略集合是$S{nR=$S_{}，混合扩充后的策略集合是$S_{R上的概率分
iER
布集合S.所以联盟至少可以得到
V(R)=max min ∑H(ξ,n)
(9.4.1)
ξ∈S_Rη∈S{ARi∈R
H_{(，η)是_采取}，\_采取η以后，H_{（S)的数学期望值$
给定联盟RCI，就有V(R)，再规定V()=0，就得到一个定义在局中人集
合I的所有子集合上的函数V(R)，称V(R)为T的特征函数.
可以构造一个两人有限零和对策来求V（R)：局中人集合I={R，1\R}，策略
集合S₁S_{}，支付函数H_S，SAn），S_∈∏S_{₁}，S∈S_{这是}个矩
$ eR}$
i八R
i∈R
ie}$
六R
阵对策，它的混合扩充存在解及值V，且.
V=max min ∑E₁(ξ,η)=min max∑E(ξ,n)
S∈SRnESR∈R
η∈5RS∈SR∈R
例9.4.1设合作三人对策的三个局中人1,2，3各有两个策略A和B.以
(a,b,c)表示三个局中人1,2,3的支付.列出表9.4.1,求这个对策的特征函数V(R).
表9.4.1
局中人
支付
(a, b，c)
一
2
ω
A
A
A
(1，1，
0)
A
2
B
(-3,
1,
2)
B
A
(4,-2,
A
2)
策
A
B
B
(0,
1,
1)
B
A
.A
(1,
2,-1)
略
8
A
B
(2,
0,-1)
8
B
A
(3,
1,-1)
8
B
B
(2,
1,-1)
首先，设局中人1，2组成联盟R={1，2}，R和\R={3|之间的两人零和对
策的支付矩阵是
335

============================================================
第 354 页
============================================================

A
B
AA
2
AB
2
1
BA
3
2
BB
4
3
这个4×2矩阵对策在纯策略集合中就有解，值等于3,所以V({1,2})=3.
令R={1,3}，\R=2}，得到下面的4×2矩阵
A
B
AA
1
6
AB
-1
1
BA
0
2
BB
1
1
这个矩阵对策在纯策略集合中有平衡局势,值等于1,所以V(|1,3})=1.
令R={2}，\R={1，3|，得到下列的2×4矩阵
AA
AB
BA
BB
A
1
1
2
0
B
1-2
1
1
1
3
1
1
,0,0,
3
这个矩阵对策的平衡局势,最优策略分别为
及
,值等于
4
4
+
4
4
1
1
,所以V(|2|)=
4
4
类似地，可以求出V(2，3})=1,V(1})=1，V(3})=-1.当R={1，2，
3时，
V(R)=max min∑H₁(ξ,n)
ξ∈SRη∈SiRER
3
=max
∑H(ξ)=max{2,0,4,2,2,1,3,2}=4
$5∈ S}$
i
在（A，B,A)上达到.再加上V()=0，就把特征函数的值全部求出了.
下面讨论特征函数的一些性质.
定理9.4.1设V(R)是对策Γ的特征函数，则
V(R U T) ≥ V(R)+ V(T) ,
∀R,TCI,R∩T= ∅
证
V(RU T)= max min
∑H₁(ξ,n)$
EESRUTηESARUTi∈RUT
R
336

============================================================
第 355 页
============================================================

≥max[min ∑H₁(,η)+min∑H₁(ξ,n)]
EESRUTηESARIER
ηESiTieT
≥max min ΣH(ξ,η)+maxmin ∑H₁(ξ,n)
ξ∈Snη∈SiRER
ξ∈ST η∈SiTIET
一
=V(R)+V(T)
定理9.4.2设V(R)是定义在I={1，2，…，n}的-切子集合上的一个函
数,并且满足
V(∅ )= 0,
V(RUT)≥V(R)+V(T)，∀R,CI，R∩T=
则存在一个n人对策，使Γ的特征函数就是V(R).
我们略去这个定理的证明.
由定理9.4.1及定理9.4.2,可以看出特征函数完全反映了n人合作对策的
性质.以后就用特征函数来表示一个n人合作对策,记作Γ={1,V_}.
n人合作对策Γ={1，V}，如果具有下列性质：
V(RUT)=V(R)+V(T)，∀R,TCI，R∩T=∅
则称V具有可加性.
n人合作对策的特征函数如果具有可加性,就称为非实质性的对策，它没有
值得研究的内容,这可以从下面的定理看出来.
定理9.4.3合作对策Γ={1，V}的特征函数V具有可加性的充分必要条
件是
n
V(1)=∑V(|i1)
(9.4.2)
同
证必要性是显然的.
充分性.假设(9.4.2)成立，任取R,TC1R∩T=，由特征函数的性质
"
V(1)=∑V(|i|）=∑V(|i）+∑V(|i）+∑V(|i)
三
i∈R
1
i∈八RUT
≤ V(R)+V(T)+V(I\RUT)
≤ V(R U T) +V(\R U T) ≤ V(I)
所以V(RUT)=V(R)+V(T).
一
在定理证明过程中可以看出，非实质性对策具有这样的性质：
V(R)=∑V(i)，∀RCI
iER
这就是说,局中人无论怎样组成联盟，他们的收人总是单独对抗的收入之和.所
以以后讨论的n人合作对策主要不是非实质性对策，而是其特征函数V满足
条件
337

============================================================
第 356 页
============================================================

1
的对策,这种对策称为实质性的对策.
2.分配
合作对策的每个局中人应当从联盟的收入中分得各自应得的份额,这可以
用一个n维向量$x=(x_{1}，x_{2，…，x_1})来表示，其中x{表示_中人i在x中应得的份
额.这个向量应满足下面两个条件
x₁≥V(|i})，=1,2,.,n
(9.4.3)
n
∑
$x_{i}}=V(
(9.4.4)
=
条件(9.4.3)表示,每一个局中人不管参加哪一个联盟,如果最后分配给他的数额
还达不到他一个人单独行动所能得到的收入,很难想象他会接受这样的分配.
条件（9.4.4）可以这样理解，如果
n
∑
x_{1 <V(1)
=
n
那么I中全部人员组成一个大联盟，得到总收入V(I)，由于V(I)-∑_{；>0，所
i=1
以每个局中人i可以在x，以外再得到一个额外的收入,例如每个局中人可以得到
1
1
[V(1) -
∑x₁]>0
n
=
因此，他们肯定不会接受x这个分配方案.另一方面，
n
∑
x_{; > V(
i=
也是不可能的.因为由特征函数的性质,无论怎样组成联盟，联盟收入的总和都
不会超过V(I)，那么总的分配就不允许超过V(I).可见(9.4.4)式一定成立.
以后称满足条件(9.4.3)，(9.4.4)的向量x为分配,用X表示分配的全体.
非实质性的对策只有一个分配
x=（V({1)）,V(|2|），.，V(|n}))
因为对某个i，有x；>V({i})，由(9.4.3)得到
n
n
$_{i$
∑V(|i)=V(1)
∑
i
i
这是不可能的.
对于实质性对策Γ=|I,V}，由于
338

============================================================
第 357 页
============================================================

n
a=V(1)-∑V(|i)>0
台
有无穷多种方式将$V(I1)-V_(）分为n个非负实数a₁,a_₂，，an(a{}=a).
n
1
\
容易验证
x=（V(|1}）+a₁，V（（2）+a₂，，V（n|）+a)
是个分配.
3.核心与稳定集
合作对策要想解决的一个重要问题就是求一个或者一组使每个局中人都满
意的分配,这就是通常说的求这个对策的解.但是到目前为止,还没有一个使大
家都比较满意的解的定义.我们将介绍几个常用的解.
下面先比较两个分配的好坏.
定义9.4.1设x=（x₁，x₂，…，x）和y=（y₁，y₂，…，yn）是合作对策r=1，
V的两个分配，联盟S是I的非空子集，如果满足条件
∑_1≤V(s)
$ies$
y；>x₁,
i∈S
就称y关于$S优超于x记为y>x.
S
显然，y关于$S优超于x，x关于$S优超于$z，就一定有y关于$S优超于$z.
单人联盟不可能有分配的优超关系，这是因为，如果y>x，则由优超的
|i}
定义
(y{≤V(|i)
$yγ_{1}>x{}$
于是有V(|i})≥y{>_₁，x;不符合分配的定义.
全体局中人联盟1也不可能有优超关系，这是因为，如果yx，则
n
∑y_{≤V(1)
三
y_{>x₁}，i∈
n
=
三
定义9.4.2
如果存在一个非空联盟S,使得y>x,则称分配y优超于分配
S
x，记为y >x.
分配的一般优超关系不一定满足传递性,举例如下：
339

============================================================
第 358 页
============================================================

设三人合作对策的特征函数V的值是
V(i})=0，=1,2,3
V({1，2}）=V({1,3}）=V(2,3|）=V(I)=10
考虑下面三个分配：
z=(0,5,5)，y=(6,4,0)，x=(4,0,6)
我们有z>y，y>x$,但是$z不优超于$.
下面我们利用分配的优超概念来定义对策的解.
定义9.4.3合作对策r={1，V有一分配集合C{，满足条件：如果x∈_，
就不存在分配y，使y>x，则称C是对策的核心.
下列的定理给出一个求核心的方法.
定理9.4.4设C是n人合作对策Γ={1，V}的核心，则分配x∈C的充分
必要条件是对任何SCI，都有
x_{1}≥V(s)
(9.4.5)
ies
证充分性.如果x是满足(9.4.5)的分配，但x≠C{,则由核心的定义,存在
非空集合SC及分配y=（y_{1}，_₂}，…，y_{n)，使y>x，也就$
S
∑y{1≤V(s)
iES
$y_{}>x{}
i∈s
所以，$V(S)≥∑y{₁>∑x{₁}≥V(S)$，而这是不可能的.
iES
必要性.C$是核心，如果存在分配x∈C及S_C$1，使∑$x_{₁}<V(S)，取
iEs
ε= V(S)-∑x_{1>0,
，a=V(I)-V(S)-∑V(|i})≥0
i∈S
ier\s
作向量y=（y_₁}，y_{₂}，，y_{n），其中
ε
$x_{}+$
\S
i∈S
$y_{1}= =$
V(|i})+-
a
i∈S
$n-|s|$
(S表示集合S包含的元素个数).
容易证明，y=（y_{1}，y_{₂，…，y_n)是分配，但yx，与假设矛盾.
一
S
例9.4.2三人合作对策r={1，V}，有
V(|1|）=4，V(|2|）=V(13|）=0，V(|1,2|）=5
V(|1,3|）=7，V({2,3|）=6,V(|1,2,3|）=10
求核心C.
340

============================================================
第 359 页
============================================================

解由定理9.4.4{(x₁，x{2}，_x3})∈C的充分必要条件是满足下列不等式组：
x₁1}≥4，x{2≥0，x₃3≥0
$x_{1+x{2+x_3}=1
x_{1}+x{2}≥$
x_₁1+x_{3}≥7$
$x_{2 +x{3}≥6$
由x₁1}+x_{2+x_3}=10，x_{2+x_{3≥6，得到x1≤4，所以x₁1=4，3$样得x{₂2≤3,
$x_{3}≤5，x_{2+x_32=6，所以
C=（4，6-x,x）|3≤x≤5
例9.4.3三人合作对策={1，V}，有
V(|1|）=V(2|）=V({3|）=0
V(|1，2|）=V(|1,3|）=V(2,3|）=V({1，2,3}）=1
求核心C.
解解下列不等式组：
x__1≥0，$x_2≥0，$x_3 ≥0
$x{1+x_2+x_31
x1+x₂2≥1$
$x{1}+x{3}≥1$
x_{2+x{3}≥1$
由后面_个式子得到x_{3}≤0，$x_{2}≤0，x_₁1}≤0$，但是x{1+x_{2}+x_{3}=1，所以不等$
式组无解.由定理9.4.4,核心C是空集.
用核心作为合作对策的解的优点是核心中的分配有很强的稳定性.任何联
盟都没有更好的分配,也就不想改变它.但是,可惜的是很多合作对策的核心是
空集.因此有必要提出一个存在的可能性比较大的解的概念.
J.vonNeumann提出另一个解的概念.
定义9.4.4设V是合作对策Γ={I，V}的部分分配组成的集合，如果它满
足
(1)x，y∈V，则x不优超于y；
(2)$如果x≠V，，则存在y∈V，使y>$x.
就称V是的一个稳定集，也称V是T的VN-M解.
例9.4.4证明V=
0
,0，,f0,
是例9.4.3中给
2
出的合作对策的稳定集.
341

============================================================
第 360 页
============================================================

(2.)（，0，)，（
证分配（
之间显然没有优超关系.分配
χ=（x₁，x2，x3})∈V，x₁+x2+₃3=1，x₁≥0，x_2≥0，x3≥0
分三种情况：
(1)x；中至少有于$，那么其余两个x；都小于
1
2
2
(2)x{；中有-于\，如果还有个x;}等于，就与$x≠V$矛盾，所其余
2
2
两个$x{}都小于
I
2°
1
(3)$x_{} 全小于
2
1
无论哪种情况，{要分配$x=x{1}{_{2}_{3}≠V{，就$少有$个分量小于$\，例如
2
1
1
1
1
$x_{_1<$
$x_{2}$
,就取y=
,0
∈V，
$x，所以V是稳定集.
2
,
2
2
11,21
定理9.4.5
如果合作对策Γ={I，V}有非空的核心C，且它的稳定集V存
在，则C⊆V_.
证假定分配x∈C{，但x≠V_，由稳定集的定义，存在$y∈V_,y_>x$，这与x∈
C矛盾，定理成立。
看来,稳定集的存在的可能性要比核心大,但是从J.vonNeumann在1944
年给出合作对策的稳定集的概念以后,许多人企图证明它的存在性都没有成功.
直到1969年,Lucas构造了一个没有稳定集的10人对策的例子以后,才说明了
一般合作对策的稳定集不一定存在.
4.核仁
关于合作对策的解的概念还有很多，下面我们将介绍从另一个角度提出的
解的概念.
给定合作对策Γ={1，V}，设$SC$1$是局中人的-个联盟，x=(x_{1}，x_2}，…，$x_{n})
是一个分配，定义在x处的超出值
了-(S)A=(x^{s)$
$x_{}$
ieS
这个值的大小反映了联盟S对于分配x的“态度”,e(S_，x)越大，x越不受S的欢
迎.因为S组成联盟以后的获得比分配给他们的要大得多.如果e(S,x)很小，最
好是负数,说明分配给联盟S的要比他们组成联盟以后的获得要多得多,当然受
342

============================================================
第 361 页
============================================================

联盟S的欢迎.
对于同一个分配$x，可以计算出$1$的2{}个子集$SC$1在x处的超出值$e($S$_
x)，以这2"个e(S_，x)为分量，按从大到小的次序排列，可以构成一个2"维
向量
θ（x）=（θ₁（x），θ₂（x），…，θ₂（x）)
其中
θ（x）=e（S_₁,x），θ₁（x)≥θ2（x）≥…≥θ₂2n（x），S_₁CI
我们希望找x，使θ(x)尽可能小.对于不同的分配x,y，规定θ的字典次序如
下:设存在下标k，使得
θ(x)=θ(y），i=1,2,.，,k-1
θ（x）<θk（y)
则称θ（x)字典序小于θ(y），记为
L
θ(x)<θ(y）
1
θ(x)≤θ(y)表示θ(x)字典序小于θ（y)或者等于θ(y).
定义9.4.5合作对策Γ={I，V}的核仁是分配集合X的子集合N，对其中
的每一个分配x,θ(x)是字典序最小的，即
N={x|x∈X，对于-切y∈X，有θ(x)≤θ(y)}
L
核仁这一概念是Schmeidler在1969年提出的,并且证明了合作对策的核仁
存在而且只包含唯一的分配.相关证明可查阅文献[12]的有关章节.
核仁有很好的存在性质，可是求核仁太困难了，下列定理将有助于求核仁.
定理9.4.6如果合作对策的核心C存在,则核仁NCC.
证设存在分配x，$x∈_}$x≠C{,则存在联盟$S_$，使
e(S,x)=V(S)-∑x₁>0
53!
设θ(x）=(θ₁(x)，2(x)，…)，其中θ{₁(x)≥θ2}(x)≥…，至少存在-个联盟S,
使e(S_$，x)>0.所以_{₁(x)>0.又因为C非空，存在y∈C_{，对所有的联盟S_，
e(S,y)=V(S)-∑y₁≤0
ies
所以
θ（y）=（θ₁（y），θ₂(y），…），θ（y）≤0，i=1,2，·,2
7
就有θ(y)<θ(x)，与x∈N矛盾_
例9.4.5求例9.4.2给出的合作对策的核仁.
343

============================================================
第 362 页
============================================================

V(S)-∑_1}，x∈ C.
i∈S
S={1|，e(S,x)=4-4=0
S={2|，e(S,x)=0-(6-x)=x-6
S={3}，e(S,x)=0-x=-x
S={1,2}，e(S,x)=5-[4+(6-x)]=x-5
S={1,3|，e(S,x)=7-(4+x)=3-x
S={2,3}，e(S,x)=6-[(6-x)+x)]=0
S ={1,2,3|,e(S,x)=10-10=0
x-6<x-5，-x<3-x，所以只需要求minmaxx-5，3-x1，minmax{x-5,
3≤x≤5
3≤x≤5
3-x}在x=4达到，所以N=(4，2,4)}.
5. Shapley 值
前面介绍的核心、稳定集是用优超概念来定义的,核心是不被优超的分配集
合.稳定集是优超这个集以外的分配的分配集合.核仁是利用超出值来定义的，
希望它的最大超出值最小化.利用优超、超出值等概念来定义的解还不少.下面
我们将从另一个角度来定义解.
先作这样的设想,一个“公平合理”的分配至少应该满足什么条件,再根据
这些条件来定义解.Shapley提出一个“公平合理”的分配至少应该满足下列三个
条件：
（1）分配值应该与局中人的标号无关.
（2)如果局中人i参加任何联盟S，都不对联盟做出任何贡献,就是
V(SU{i})=V(S)+V(|i})，SCI，i≠S
那么局中人i的分配值应该是V({i}).
(3)一个特征函数W，如果能写成两个特征函数U和V之和，那么局中人在
特征函数W下的分配应该是在特征函数U和特征函数V下的分配之和.
为了把上述三个条件严格化,先引进两个概念.
设π是I={1，2$，…，n的一个排列，也就是一个1到它自身的映射，以πS表
示联盟S在排列π下的象集.若πi=j，则j是i在π下的象.以π(1)表示定义在$
上的全体排列组成的集合.
设NI是个联盟，如果对于一切S⊆I，有
V(S)=V(S∩N)+∑V(i)
i∈S\N
则称N为对策的一个支柱.
设i≠N,则
344

============================================================
第 363 页
============================================================

V(SU|i)=V((SU{i)∩N)+∑V(|j})
j∈SUIi\N
=V(S∩N)+∑V(|j})+V(|i})
j∈ S\N
=V(S)+V(|i)
就是说,如果局中人i不属于任何支柱N，那么这个局中人对任何联盟不能做出
任何贡献.
定义9.4.6n人对策r={1，V的Shapley值是满足下面三条公理的函数
φ（V）=（φ₁（V），φ₂（V），·，φ（V))
(1) 如果对于π∈π(1)和每$个$Sc$I，有
V(πS)=V(S)
则
φ{(V)）=φ;(V)
(2)对于T的每一个支柱N，有
∑φ,(V)=V(N)
iEN
(3)对于定义在I的全体子集合上的任意两个特征函数U和V，有
φ(U +V)=φ(V)+φ(U)
由支柱N的定义及公理(2)，可以证明，当iN时，φ_(V)=V({i}).
Shapley在1953年证明了下面的定理.
定理9.4.7设={I,V是合作n人对策,则存在唯-的一组Shapley值
$φ{(V)
(n-|S|)!(|S|-1)!
∑
[V(S)-V(S\{i)]，=1,2,·,n
二
n!
Sali
(9.4.6)
我们略去这个定理的证明.这个定理可以作下述直观解释.
局中人i参加联盟S以后，他为联盟增加收人V（S)-V（S\{i}).他参加S的
概率是多少呢？如果我们想象n个局中人随机地依次参加对策，一共有n！个排
列次序，局中人i参加他前面S|-1个局中人组成的联盟，他后面n-S|个局
中人又依次序参加各个不同的联盟，共有(|S|-1)！·(n-|S|)！种排列次
序,所以出现的概率为
( |S|-1)!(n-|S|)!
n!
再对所有包含局中人i的S相加，就得到(9.4.6)式.
例9.4.6某公司有5个股东，股东1有三个投票权，股东2，3，4，5各有一
个投票权.一个提案必须得票半数以上方能通过,如果提案能通过就得到支付1，
345

============================================================
第 364 页
============================================================

否则就得到支付0.求这5人对策的Shapley值.
解局中人I={1,2,3，4,5|，特征函数V(S)，由假设
V({1，2|）=V({1,3})=V(|1,4|）=V(1,5|）=1
V(1,2,3|)=V({1,2,4})=V({1，2,5})=V({1，3,4})
=V({1,3,5})=V({1,4,51)=1
V(|1,2,3,4})=V({1,2,3,5})=V({1,2,4,5})
=V(|1,3,4,51)=V(|2,3,4,5|)=1
V({1,2,3,4,5})=1
先计算φ_{₁(V).只需要考虑V(S)-V(S\1})≠0且包含局中人1的联盟S.
当|S|=2时，有{1，2}，{1,3}，{1,4}，1,5}共4个，V(S)-V(S\{1})=1.
(2-1)!(5- 2)!
3！
1
4
=4
5!
5！
5
当|S|=3时,有{1,2,3|等共6个,V(S)-V(S\{1})=1.
(3-1)!(5 -3)!
6.
1
5!
5
当|S|=4时，有{1，2,3,4}等共4个，V(S)-V(S\{1})=1.
(4-1)!(5-4)!
1
4.
5!
5
1
1
1
所以
3
$φ_{1}(V)
+
+
5
5
5
5
再计算φ_{2(V).包含局中人2且$V(S)-V(S\{2})≠0的联盟只有
{1,2}，{2,3,4,5}，并且V(S)-V(S\{2})=1.
(2-1)!(5-2)!
(4-1)!(5-4)!
1
$4{2}V)=
+
5!
5!
10
$_₃3(V)，φ_{₄(V)，φ_(V)是同样的，所以Shapley值
31111
φ(V)=
5'10'10'110
对这个例子,我们可以计算它的核心、稳定集和核仁.
核心C=，核心是空集合.
稳定集V={(x,1-x,0,0,0)|0≤x≤1或（x，0,1-x,0,0)|0≤
x≤1或|（x,0,0，1-x，0)|0≤x≤1|或|(x,0,0，0,1-x)|0≤x≤1}.
1
I
346

============================================================
第 365 页
============================================================

*
9.5网络对策
在社会网络中，一个人购买产品、选择职业通常会受到周围人们的影响.研
究这种交互行为需要把对策论知识延伸到网络背景,也称为网络博弈.本节将介
绍网络上的图形对策和合作交流对策.
1.图形对策
有限的图形对策是指这样的对策:有一个局中人集合N,|N|=n,局中人通
过网络G(N)连接.每个局中人的策略集都是有限的，S_{={0,1}，即选择行动或
不行动.对于局中人集合的策略$x=（x_1}，_2}，，x_n），记局中人i的支付函数为u_}$
(x_{₁},_{N{(_{))，其中_{}（G)是网络中i的邻居集，x{；(c{)是i的邻居们采取的行动组
合,即i的支付受自己和邻居们行动的综合影响.下面看一个具体例子.
例9.5.1(互补的阈值对策)在网络G(N)中，只有当他的较多邻居们采
取行动时,局中人i才采取行动，他获得的支付与不行动相比是随着采取行动的
邻居们的数量而(弱)增加，从而
u（1，xN₁(c））≥u₁（0，xN₁（c））当且仅当∑x₁≥
$j∈^{2N)
其中是一个阈值.特别地，若多于t，的邻居们选择行动,则局中人i会选择1，
否则选择0.
进一步，如果行动需花费成本，且支付能随着更多的邻居采取行动而增加，
支付函数可表示为:对某个$a_{₁>0$和$c_{>0$$
- C{}$
$∈N_G
$u₁(0,xN;(G))=0$
此时，阈值$t_=_{/a_{}意味着如果至少$t_{个邻居选择行动，局中人i选择1有利,否
则选择0.
类似于矩阵对策，图形对策的$$Nash均衡为$个策略集$x=$x_{1}，_2}…}，x_{2)^{}
满足
u₁（1，xN；（c））≥u（0，xN₁（c）），如果x=1
u₁（0，xN₁(c)））≥u（1，x₁（G）），如果x₁=0
该条件要求每个局中人选取最大获得的行动来响应邻居们的行动去达到均衡.
图9.5.1至图9.5.3为例9.5.1中阈值取2时的三个纯策略下的均衡.以公共品服
347

============================================================
第 366 页
============================================================

务为例，“1”代表局中人提供公共品的行动，“0”为不提供,即搭便车.
0
0
0
0
0
0
0
0
0
0
图9.5.1
0
1
1
0
0
0
0
图9.5.2
0
0
1
1
0
图9.5.3
可以看到,在互补的阈值对策中存在多个均衡.当选择1（即采取行动）的局
中人达到最多时的均衡称为最大均衡,如图9.5.3所示.
图形对策的混合平衡定义及存在性，可以查阅文献[13]等.
有限的图形对策可以推广到如下情形：设第i个局中人的策略集为$S_{=[0,
j∈N_{}(
cx_{}，其中$f是一个连续可微的严格凹函数，且存在某个充分大的x，使得$f^'(0)>
c>f^{}(x),c>0为成本参数.下面的定理给出一个求$Nash 均衡的方法.
定理9.5.1设x满足f{（x)=c，策略集x=（x_₁}，_₂}，…，xn)$是-个均衡，
348

============================================================
第 367 页
============================================================

当且仅当对每个i=1，2，…，n，有如下条件成立：
{若$x₁1>0，则x₁+∑x₁}=x
j∈N(C)
$若$x{=0，则 ∑$x_₁≥x^{
j∈N_,()
证明略.
容易看出，任何均衡必须在每个局中人的邻域中有x的获得，否则他
会增加行动以获取更多支付.图9.5.4给出了x=1时三人网络的多个
均衡.
0
0
41ω
$\frac{} {3 }$
0
1
1
2
3
图9.5.4
网络对策中,还有其他形式的均衡,相关定义和求解方法可参阅文献[13]、
[14].
2.合作交流对策
Myerson基于局中人的网络结构，引入了一类有趣的合作对策，称为交流对
策，用来描述包含交流情形的合作对策现象.
给定网络G，若干局中人形成联盟S，S为G中点集N的一个子集，G[S]为S
的点导出子图，V（S)为S的特征函数，定义交流对策的值为
$V{(S)=∑ V(C)
A
CeG[S]
其思想是联盟只能在可以沟通的条件下发挥作用，
3
2
创造价值.下面看一个例子.
例9.5.2对图9.5.5中的网络,联盟S={1,4,5}
能起作用是因为局中人1，4，5在网络中的相互路径是
4
5
连通的，都位于G[S]的一个连通分支中，故
图9.5.5
$V(S₁)=V（S₁)=V（1，4,5|).
考虑联盟S_2={1,3，4}，在G中，局中人1与局中人3，4若要交流必须借助于局
中人5，故没有局中人5参加的话，局中人1与局中人3，4无法交流，S_2的收益
应为{3，4联盟的收益，V(S_₂2）=V（1}）+V({3，4})）=V({3，4}).
349

============================================================
第 368 页
============================================================

同理，联盟$$S_3=1，2}$的交流对策值为$_{}S_3)=0，因为局中人1，2在G中
根本无法交流.
有了联盟的合作交流值之后，Myerson为合作交流对策定义了一个分配
$φ{（V）=φ²_{6)
其中$φ{³}_{)是基于交流收益_{$的Shapley值$，φ{(V)称为Myerson值，它是Sha-
pley值在交流对策中的一个扩展.当G为完全图时，交流对策退化为$_{=V的合
作对策,联盟的Myerson值等于Shapley值.当网络结构改变时，{随之变化，M$y-
erson 值也要相应改变.
例9.5.3现有某立法机构讨论如何分配明年的预算资金，设资金总数为
1.遵循多数原则,即一个方案只有超过半数以上的成员同意才可以通过.试计算
它的 Myerson值.
1
下面求其
3
Myerson 值.
1
=
3
若G只有一条边，不妨设局中人1，2相连，局中人3与他们无交流，则
$V（{1，2）=V（|1，2|）=1，（|1，3}）=0,V（12,3|）=0，
$V(11})=（2|）=（{3|）=0,
1
所以$φ_{$
M
=0.
二
2
若G只有两条边，不妨设局中人1与2相连，2与3相连，1与3不直接相
=（2）4=（）40=（ε）41=（ε）4=（乙1）4
1
2
1
M
M
二
$，φ_{2}$
=
$，$φ{3}$
=
6
3
6
若G无边，则全部的${为0$，对应的$Myerson值也为0.
在对策论中可以根据不同指标对对策问题进行分类,通常的分类方式有:
（1）根据局中人的数量，分为两人对策和多人对策；（2）根据所有局中人的支付
函数的代数和是否为零,分为零和对策与非零和对策；(3）根据局中人掌握信息
的情况,分为完全信息对策和不完全信息对策；（4)根据决策过程是否有先后顺
序(即与时间有关),分为静态对策和动态对策；(5)根据对策模型的数学表示，
又分为矩阵对策、连续对策、微分对策等；(6）根据局中人是否合作,分为合作对
350

============================================================
第 369 页
============================================================

策和非合作对策.随着对策问题的详细化,对它的研究越加深人.文献[15]还介
绍了当下博弈论的热点研究:期权博弈、行为博弈、演化博弈及实验博弈等内容，
它们都与社会的发展息息相关.其中,算法博弈在近二十年来逐渐成为一个重要
的研究方向.该理论假设一个系统有规划者和参与者两类人,其中,规划者从整
体利益出发,设计系统以求全局最优；而参与者却从自身利益出发,选择利已行
动以求个体最优,这常常使得系统的实际性能低于预期.该理论主要研究如何进
行合理的机制设计、均衡解的界定及有效算法等内容.
第9章习题
(A)
1．举出几个可以归结为下列对策模型的例子.
（1）两人零和对策；
（2）两人非零和对策；
(3)多人对策.
2.假设甲、乙双方交战，乙方用三个师的兵力防卫一座城市，有两条公路可
通过该城.甲方用两个师的兵力进攻这座城市,可能两个师各攻一条公路，也可
能都攻同一条公路.防守方可用三个师的兵力防守一条公路，也可以用两个师防
守一条公路,用一个师防守另一条公路.哪方军队在某一条公路上的数量多，哪
方军队就控制这条公路.如果军队数量相同，则有一半机会防守方控制这条公
路，一半机会进攻方攻入该城.把进攻方作为局中人1，攻下这座城市的概率作为
支付，写出这个问题的矩阵对策.
3.证明定理9.3.1.
4.求下列矩阵对策的最稳妥策略.
(1)1
3
2
(2)
(6
5
6
5
5
3
6
4
1
4
2
-1
0
2
4
2
8
5
7
5
0
2
6
2
(3)
-2
12
-4
(4)
12
2
1)
1
4
8
3
44
-5
2
3
(2 1 6)
5.设矩阵对策$I={_{₁},S{2;A$有两个平衡局势(^{1},^{1}），(^2,^{2}）$，试明
351

============================================================
第 370 页
============================================================

(X{1}，^{2)，{^{2,，^{12)也$平$$衡势，并且对应值$相}等$
6.下列矩阵为局中人1的支付矩阵，先尽可能按优超原则简化，再求平衡
局势及其值.
(1)
2
4
(2)
3
5
4
2
(3)
5
7
- 6
2
3
5
6
2
4
-6
0
4
3
2
2
1
4
0
7
8
-5
-2
6
3
3
5
2
a
$b
7.给定2×2矩阵对策A =
,在纯策略集合中没有平衡局势,试证明
C
d
它的值
ad - bc
V =
a+d -b - c
平衡局势是
[
d-c
a-b
d -b$
a-c
[\a+d-b-c'a+d-b -c)
8.用线性规划方法解以下对策问题.
(1)(2 0 2)
(2)-1
2
1
0 3 1
1
-2
2
(1 2 1)
3
4
-3
9.证明在所有的两人对策中,核心是整个分配集又是唯一的稳定集.
10.考虑一对策，其特征函数为
V(|1})=4，V(|2|）=V(|3|)=0，V(|1，2|)=5
V(1,3|)=7,V({1,2,3|)=10，V(2,31)=6
求(1)分配集.(2)核心.(3)核仁。(4)证明V=|(4，6-x，x)|0≤x≤6是稳
定集.(5)Shapley值.
11．某个理事会，有5个理事，其中2个理事有否决权.通过一个提案必须有
半数以上理事同意,且都不能投弃权票.通过提案得到1,否则得到0.求这个合
作对策的核心、核仁、Shapley值、稳定集.
12.证明(9.4.6)式给出的φ_(V)，i=1,2，…，n满足Shapley值的三条公
理.
13.有一个多人群体,每人决定是否买书，如果不买，若邻居有，他可以从邻
居处借得.设买书的花费为c,读书的效用为1,给出该图形对策的支付函数.
352

============================================================
第 371 页
============================================================

（B)
1.甲、乙两人分别有1角、5分和1分的硬币各一枚.在双方互不知道的情况
下，各出一枚硬币.并规定当和为奇数时，甲赢得二人所出的硬币；当和为偶数
时，乙赢得所出硬币.试列出两人的对策模型，并说明该游戏对双方是否公
平合理.
2.沿河有1、2、3三个城镇，地理位置及各城镇的距离如图1所示.
20 km
38km
1
2
3
一河流
图1
城镇排放的污水需经过处理才能排入河中.三个城镇既可以单独建污水处
理厂，也可以联合建厂，用管道将污水集中处理(污水必须从上游城镇送往下游
城镇，处理厂必须建在下游位置).按照经验公式，建造污水处理厂的费用P{和
铺设管道的费用P2分别为
$P{1=73Q0.70)
$P2=0.66Q_0.51}L（万元)
其中Q表示污水处理量(单位：t/s)，L表示管道长度(单位：km).如果三个城镇
的污水量分别为$Q_{1=5$，Q_2=3Q_3=6，试从节约总投资的角度为三个城镇制定建
厂方案.如果联合建厂，费用应如何分担?
参考文献
[1] Von Neumann J,Morgenstern O.Theory of Games and Economic Behavior[ M].
Princeton,New Jersey : Princeton University Press,1944.
[2]中国科学院数学研究所第二室.对策论讲义[M].北京：人民教育出版
社,1960.
[3] Kuhn H W,Tucker A W.Contributions to the Theory of Games I-V[M].Prin-
ceton,New Jersey :Princeton University Press,1950-1959.
[4]MckinseyJCC.博弈论导引[M].高鸿勋,等译.北京：人民教育出版社，1960.
[5] Aubin J P.Mathematical Method of Game and Economic Theory[M].Amsterdam:
353

============================================================
第 372 页
============================================================

North-Holland Publishing Company,1979.
[6] Owen G.Game Theory[ M].New York :Academic Press,1982.
[7] Lucas W F.The Proof that a Game May Not Have a Solution[J].Trans.Amer.
Math.Soc.,1969,137(4):219-229.
[8] Thomas L C.Games,Theory and Applications[M].New York:Halsted Press,1984.
[9] Moeschlin O,Pallaschke D.Game Theory and Mathematical Economics[ M].Am-
sterdam : North-Holland Publishing Company,1981.
[10]王建华.对策论[M].北京:清华大学出版社,1986.
[11]谭永基，等.经济管理数学模型案例教程[M].2版.北京:高等教育出版
社,2014.
[12]刁在筠，等.运筹学[M].3版.北京:高等教育出版社,2007.
[13]马修·0.杰克逊.社会与经济网络[M].柳茂森，译.北京:中国人民大学出
版社,2011.
[14]朱·弗登博格，让·梯若尔.博弈论[M].黄涛,等译.北京:中国人民大学出
版社,2010.
[15]洪开荣,等.经济博弈论前沿专题[M].北京:经济科学出版社,2012.

============================================================
第 373 页
============================================================

习题参考答案或提示
第1章习题
(A)
1—4.略.
5.（1）x*=(6，2），z=12；（2）x=(6，14），z=48；（3)无解；(4)有无
穷多个最优解，即以点(2，3)^{与(4，2)^{为端点的线段上的点均为最优解，最优
值z{ =8$.$
6-8.略.
2
0
2
9.B =
,N ==
，B所对应的基本可行解为$x=(0,2},
1
3
0
0,4)
10—11.略.
12.
5
1
3
min
z=-1
一
$x_{}$
$x}$
+
$x_{ }$
4
2
8
S.l.
1
1
=3
+x_2$
+
$x_ }$
$1}$
4
2
1
1
5
=5
+x_{3$
+
$x4
+
x5$
$x_}$
2
8
4
7
25
+x{6$
=-39
-4x4$
x_{q$
$1x$
4
2
x₁≥0，j=1,.,6
13.略.
14.最优解$x{*=(13,5)^{}最优值$z{=-31$.
15.原问题为
355

============================================================
第 374 页
============================================================

min
-5x__-3x_2}$
s.t.
1
2
8-5
$x_{}$
$x_{22}$
≥
5
25
2
$x_{_ }$
+
x2$
≤2
5
$x_{1
$x_{_2}  0$
1
1
1
1
B=（A_₃3},A₁1}=$
5
，B^{}$
=
5
0
1
0
1
16.（1）x=（15，5，0),z=-35；（2）x=（0，2，0，4）,z=6；(3）问题
无界.
17.(1)x^{}=(0,4
28 50
T
104
；(2）无解；（3）人工变量不出基，但
3
3
，2*
3
3
6
T
18
值为零，得最优解x^{}=$
，2*
;（4)x{=(8,0,3,0)，,z=31.
5
5
5
18.(1)
max
5w₁+3w₂+2w₃3+4w4
s.t.
5w₁+w₂+w₃+8₄=10
2w{1+4w2+3w₃2+2₄=10
w₁≥0，j=1,2,3,4
(2)
max2w₁,+3w₂-5w3
s.t.
2w_1+2w2-W3≤1
3w_₁+w2-3w3≤2
4w_₁+6w₂2-5w3=4
$w_1≥0，w_₃3≥0,w_2$无约束
(3)
∑a{a{1}+∑b,β_
m
n
max
三
α；+β₁≤₁j，i=1,，m；j=1,.,n
s.t.
$α_{}，β{}≥$
356

============================================================
第 375 页
============================================================

19.略.
20.(1)$x^{=(0,
5
7
T
7
，2
2
4
4
4
(2)
max -5w{1}+3w{2}$
(3)
1
[-2w1
-w{2
=0
+
2
s.t.
≤1
$w_{}$
=1
-w1
1
T
-2w1
0≥
$w{
,1)
+
$w_{}$
.2
$w_}$
≤1
$w_{1≥0，w{2≥0$
21.略.
22.(1),(2),(3)不正确，(4)正确。
11
2
T
28
23.(1)x{}=
;(2) 无解;(3)$x^{}==
,0
,2
5
5
5
19
5
13
;(3)
24.（1)x=(5,0,3，0),z=-
4
4
5
T
5
(0,1,
无解；(4)^{}=$
,0
，z
2
2
5
7
T
0，
25.(1)w*=
，z=9；(2)0≤c_1≤6$.
6
6
26.(1)
最优解
最优值
入取值范围
(PCP)无界
λ<4
x{=0,j=1,2,3，4
$z()=0
4≤λ≤5
1
$x_{2}$
=1，x{=0,j=1,3,4
z(λ)=5-λ
5≤λ≤
2
11
(PCP)无界
λ>
2
(2)
λ取值范围
最优解
最优值
λ<2
(PRP)无解
2≤≤6
x{=0,j=1,2,3
z(λ) =0
6≤λ
λ
$x{2}-3+$
-，x{2}=x{3= 0$
z(λ)=-6+λ
2
357

============================================================
第 376 页
============================================================

(B)
150
915
260 050
1.(1)$最优解$x{2}=$130_{$x_}
二
$，x_{3}$
;最优值$z}=
13
13
13
3
365
85
(2) 因为对偶最优解$w{
$，w_{2}$
Ⅱ
$^{^{}$
唯
=
$，w4}$
=2w_{}=0.企业要改善现
13
13
13
状,需设法增加前3种资源的供应量,第4,5种资源增加,不会使利润增加.
(3) 当增加第i种单位资源时，需增加额外单位费用为d{,i=1,2,3，只有使
d{1<w_{时，才对企业有利，此时前3种资源每增加一个单位，总利润的增量为
3
∑(2w{2}-_d₁}).至于各种资源可以增加的范围需用参数规划理论得到.
2.(1)设x{1为每周生产产品甲的单位数，x_2为每周生产产品乙的单位数.
该问题的数学模型为
maxz=0.5x,+0.3x₂2
s.t. $2x{1}+2x_{2}≤400 000(仓库限制)
$x_{ }$
$x_{}$
≤130
（生产时间限制）
2 0002 500
$x_{1}$
≤250 000
(市场需求)
$x_{2}≤350 000
-x_{2}≤-50000
(合同约束）
$x_{1}x{2=0$
其最优解$x{2=150$000$，x2=50$000$，最优值z^{}}=90000$.
(2)$对偶最优解(即影子价格)2w{2=0$.25$，w_2=w_2=w=0$，w_2=0$.20$，即仓库
容量每增加一个单位,将使利润增加0.25单位,减少按合同供给特殊用户一个单
位乙产品,可增加利润0.20单位.而增加生产时间,扩大宣传力度都是不必要的.
(3)设t{是对应仓库容量的参数，_是对应合同约束的参数，其参数规
划如下：
max $z=0.5x,+0.3x2
S.t.$2x{1+2x2≤400000+t{1}$
5x₁+4x2≤1300 000
$x_{}$
≤250 000
$x_{2≤ 350 000
$x_{2}≥50000+
$x_{1，x_{2}}= 0$
358

============================================================
第 377 页
============================================================

(i)令$_{=0,当-300 000≤$_1}≤$140 000时，影子价格不变.故最多租用
140000单位的仓库额外容量，且每周租金不超过0.25单位/仓库单位时,对工
厂有利.
若工厂能租到100 000单位仓库容量,租金为每周0.15单位/仓库单位,则
每周可生产甲产品200 000单位，乙产品50 000单位,总利润为100 000单位.这
是个重合同、守信誉的策略。
(ii)令$_{1=0$，当-50000≤$_≤150000时，影子价格不变.如果特殊用户同
意修改合同,每周只需供应他们25000单位乙产品,但要求比原合同每少供应
一个单位乙产品需补偿经济损失0.1单位.此时，每周可生产甲产品175000单
位，乙产品25000单位,总利润为92500单位.
(i)在保持影子价格不变的前提下，当$_₁}，_，均可变动时，应解如下(LP)
问题
(max f=90 000+0.25t,-0.205
$l_}$
s.t.
150 000+
$-_{q}0$
2
5
350 000
$_{1+2}=0$
2
$t_}$
100 000
$+_{q=0$
2
300 000
$-_{3}0$
50 000
$+_{q}=0$
此时$l=125000，t=-37500，f*=128750.即每周可生产甲产品250000单位，
乙产品12500单位.扣除租金和补偿费用后的利润为f-额外租金费-额外补
偿费.
3.建议用统计的聚类和线性规划方法求解.此题规模大、无统一答案,是一
个好的应用案例
第2章习题
(A)
1.设A，B产品的生产量分别为x_{1}和x_{2件，该问题的数学模型为
359

============================================================
第 378 页
============================================================

maxz=c_₁x₁1+c_2x2
s.t.
a1₁x₁+a₁2x2≤b1
$a21x₁+a₂2x2≤b2
$a₃31x₁1+a32x2≤3
x₁1≥k1}，x2≥k2
$x_{1}，}$x_{2}$为整数
2.设0-1变量x_{表示
1,
指派第i个人完成第j项任务
x
=
{0,
不指派第i个人完成第j项任务
其数学模型为
1
月
n
s.t.
n
∑
x0=1，j=1,…,n
x=0或1，i,j=1,·，n
3.可行解集合=(4，0)，(5，0)，(6，0)，(7，0)，(8，0)，(5,1)，
(6$，1){}1，最优解x{}=(5$，1){，最优值$z{=0$.
4—5.略.
物
6.(1)最优解x°=(4，1)，最优值z=14.(2)最优解x=(2，3)，最优值
$z = - 34.
T
43
，最优值$z{}$
3
(B)
1.设x_{为从设在A_{}地的工厂运往销地B{$的运量，i=1，…，m_，j=1}…}，n.
又设
1 ,,
在A{地建厂
$y_{1}= =$
,i=1, . ,m
0，
不在A_{地建厂
则有
360

============================================================
第 379 页
============================================================

min z=∑∑cx+f_
m
m
0
=
三
n
s.t.
上
x≤a₁y₁,i=1,,m
三
m
∑x{≥b₁，j=1, ,n
三
x₁≥0,y;=0或1,i=1,.，m,j=1,.,n.
这是一个混合ILP.
2.设x_{为学生i在周j的值班时间.
(id1,
安排学生i在周j值班
$y_{=$
{0，
否则
用a_{}代表学生i在周j最多可安排的值班时间，_{为学生i每小时的报酬，则有
6
5
min $z=∑∑c{
=
j=1
s.t. 2y_₁≤x₁≤ayj,，i=1，…，6,j=1，…，5（不超过可安排时间)
5
∑
xi
≥7，i=5,6(研究生每周值班不少于7小时)
6
W
5
2
y_{≤3，i=1,…，6 (每个学生每周值班不超过3次)
三
6
∑
$y_{≤3，j=1，…，5(每天值班不超过3人)
三
$γ_{j+_{}≥1,j=1，，5(每天至少有$个研$生值班)
x≥0,y₁=0或1,i=1,…,6;j=1,…,5
值班方案如下，每周总支付713.6元.
学生代号
周一
周二
周三
周四
周五
1
6
0
6
0
7
2
0
4
0
6
0
3
0
8
0
0
5
4
5
0
6
0
0
5
3
0
2
5
0
6
0
2
0
3
2
361

============================================================
第 380 页
============================================================

3.
8
3
4
1
9
5
2
6
7
7
2
5
4
3
6
1
8
9
6
1
9
8
7
2
3
4
5
3
5
7
9
6
4
8
1
2
2
9
6
7
1
8
5
3
4
4
8
1
5
2
3
7
9
6
1
4
8
2
5
9
6
7
3
6
6
2
3
8
7
4
5
1
5
7
3
6
4
1
9
2
8
第3 章习题
(A)
1.略.
256
65-12
2.设产品A生产x{₁}百箱)，产品B生产$x_{2}(百箱)，最优解$x{}=
$x_{2}$
二
3.(1)整体最优解$x{}=(1，2)^{}，最优值$f(x{)=$
1
；(2)整体最优解
2
x^=(0$，2)^，最优值$f(x{)=-2；(3)整体最优解x”=$
1
1
T
,最优值
2
2
3
$f(x{  =$
2
4.略.
5.(1) 凸函数；(2) 凹函数；(3) 凸函数.
6—7.略.
46
$8.$t{=
290
9.近似解t=2.084，φ(t)=-1.938.
10.$_{}÷4.000 04$，该问题的精确解$t^{ =4$.
11—12.略.
13.(1)整体最优解为$x=
12
14
T
；(2)严格局部最优解为x=
5
5
362

============================================================
第 381 页
============================================================

(0,0){.
14.α≥0.
16—17. 略.
T
19.最优解x^*=(1,1)^{.
20.略.
4
T
4
16
-$\f{}{5).
21.最优解$x{}=$
,最优值$f(x{})}=$
$，λ{}=$
1
5
'5
25
T
x=（-1，1），=（0，4）；x=（1，1），=（2，0）；x=（-1，-1）
$λ3}= (0,0)T.
23.（1）Ap=0和当x=0时，p≥0；（2）当ax=b时，aP；0
和当x₁=0时，p；≥0；（3)当a，x=b₁时，ap;≤0，Cp=0和当
n
$x_{}}=0$时，p_{；≥0$.$
35 24
T
24.最优解$x^ =
3\'331)$
0
2k-1
25.(1)略.(2)
k
;(3) x{} =2.
x
k
26.最优解$x^{}=(0,0)^{.$
(B)
1.略.
2.最优解x=(380.95，476.19,142.86)，最优值f(x)=75238.
$\sqra2 }$
3.写出其Lagrange 函数，最短距离为
8
第4章习题
(A)
1.$ 短路线为$AtB_{2tC_{1}t$D_{1}tE$，其长度是$$8$.
363

============================================================
第 382 页
============================================================

2.设
fk（y）=max|c₁x₁+…+cxa₁x₁+…+a₁x≤y，x=0,1，i=1,2，…，k}
则
$f_（y）=max_₂x+fk-₁（-akxk）$
$x k}=01
$c_{,
$a_{1≤$
$f_}=$
{0,
$a_{1>y(当y<0时，$f_(y)=-∞)
3.
fk（x，x）=maxlfk-₁（x，xk-1）+φ（y）|k=2，3，.，N
$x{k}-1$
-xk
1
"
1
y=xk-$
x_k
$x_{ } = $
a
1
$f{(x,x₁1）=maxφ(y)），y=x--x1
7
4.最短路线为$1→3→4→5→2→1,最短路程为37.
5.(1)$最短路线为O→B→D→H→L→P→S→V,最短路程是$11$;
(2) 用穷举法有(m+n-1)({n+$
2
次加法，
u
次比较;用动态规划方法
n
n
总共用2mn+(m+n-2)次加法，mn次比较.
6.最优决策为$y_{1}=0，$y_2=0，y_3=81，$y_{₄=54总收益为2680$.
7.略.
(B)
略.
第5 章习题
(A)
1—6.略.
7.所求的最小树为T=G[{12}，{45|，{14{，{35}].
8.略.
9.设u；为点1到点i(2≤i≤6)的最短路的长，则u_2=1，u_₃=3，u_₄=5，u_₂=8，
$u_{}=8$.
10.最大流的值为4，其中x=1，x=1，x=1，x=3，x=3，x=3，其他x=0.
11.最小费用流为x=1，x₁=2，x=1，xbc=2，x=3，其他x₁=0$.
12.略.
8
19
13.网络密度d=
，聚类系数C=
\or5$
36
364

============================================================
第 383 页
============================================================

(B)
1.铺设电缆的道路为12,24,34,46,56,57,68，它们构成图的一棵最小树.总
长度为1400km.
2.每个服务员所走的最短路程分别为点i到点1的最短路.设点i到点1的
最短路为P（2≤i≤11），则P2=21，P₃=36，65，52，21}，P4={41}，P_=52，
21，P={65,52,21,P=73,36,65,52,21，8={85,52,21},=91,107，
S990L216=d9}=0
52,21} .
3.最优运输方案为x₁3=70，x₂₁1=40，x₂2=60，x24=80，x33=50，x₃=10$x2=
50$，_4s=100$总运价为44400元.
4.工作效率最高的分配方案为$x{}做工作$y_{₄}，{x_{2$做工作y_{₁}，x_{3}做工作$y_{3}{_{4
做工作$y_{2}，$x_{₂做工作$y_{}，工作效率为$14.
第6章习题
(A)
1.
d 10
②
f3
a2
b 10
g4
8
10
0
c 22
e 20
4
2.
L
4
8
24
B
K
M
A
F$
20
N
2
10
16
C
28
0
D
6
S
34
32
E
26
12
P
R
G
Q
30
H
I
14
18
22
箭线图
36

============================================================
第 384 页
============================================================

M
B
P
A
F
K
N
E
R
H
②
节点图
3.
节点
1
2
3
4
5
6
7
8
9
10
11
最早时间
0
2
4
2
4
6
7
3
7
5
12
最晚时间
0
3
4
5
4
9
7
6
10
8
12
关键线路①→③→⑤→⑦→⑩
4.
工作
1→21→41→3
2→5
4→5
4→7
4→6
3→6
5→8
5→7
6→7
6→9
7→9
8→9
最早开始时间
0
0
0
2
8
8
8
4
8
8
12
12
13
15
最早结束时间
2
4
5
8
11
10
12
15
10
13
19
15
20
最晚结束时间
5
8
5
8
8
18
13
13
15
18
18
20
20
20
最晚开始时间
3
0
1
5
8
15
11
5
8
16
17
13
18
15
关键线路为①→④→⑤→⑧→⑨
(B)
1.箭线图.
3
12
6
10
2
1
13
5
7
14
10
2
4
18
20
4
6
8
12
16
11
14
8
6
(1)最短工期85天；
(2) 无影响；
(3)缩短4天；
366

============================================================
第 385 页
============================================================

(4)第59天；
(5)缩短关键路线上10天工时.
2.最优费用为141元.
第7 章习题
(A)
1
1
1.E(ξ)=
D(=$
λ
12
2. E[N(t)]=λt，D[N(t)]= λt.
3.用条件概率公式.
λ
4.（1)p0=1-ρ=0.25,(2)L=
=3(人)，(3)W=
=1(小时)，
μ-λ
λ
1
(4) W≥1.25,即
≥1.25,就有λ≥3.2人/时.
4-λ
1"
$μ₁({2-λ$
λ
1
5. $p_{n}=$
L=
Lq{}}L$
$P_{0},}P_{0$
$2}_{0}
$n-1
μ₁μ2+λ（μ₂-μ₁1)
μ₁(1-ρ)
$μ_{2^μ1}$
$_q}$
L
$W_{a}$
(1-p_0)，W=
=
λ
L
λ
6.$p_{0=0.6，p1=0.2，p₂2=0.1，L=0.8（人)，L=0.4（人)，W=
1.6(分)，W_=0.8(分).
1
7. $P_{n}=
n!
$ρ+ e^{-$
ρ
$W =$
$W_}$
μ(1-e{
(1-e{0)
8. 略.
9.方案$的费用$S_{}=5$9.42万元，方案二的费用$S_{2=52.$884万元，用方案二
较好.
*10._{0}=0.0995，平均发生故障的电梯数为c=3246部，平均停工时间W=
7.21天.
(B)
1.58个,32个.
2.略.
3.(1)模型的构建
为简单计算，假设前一艘船卸货结束后马上离开码头，后一艘船立即可以开
367

============================================================
第 386 页
============================================================

始卸货.
引进如下记号：
a_{}—_第j艘船的到达时间;
t_}——第j-1艘船与第j艘船到达之间的时间间隔；
u_j}第j艘船的卸货时间；
l—_第j艘船的离开时间；
$m}$
一第j艘船的等待时间；
$S }$
一第i艘船在港口的停留时间：
$d_}$
卸完第j-1艘船到开始卸第j艘船之间的设备闲置时间；
$2W m}$
——船只最长等待时间；
$w_{—__—船只平均等待时间；
d_1—_设备闲置总时间；
$R_{—__设备闲置百分比.
为了分析码头的效率，我们考虑共有n条船到达码头卸货的情形，原则上
讲，n越大越好.由于n条船到达码头的时间和卸货时间都是不确定的，因此，我
们要用随机模拟(又称为Monte Carlo(蒙特卡罗)模拟)的方法来建立数学模型.
首先，我们假设两船到达之间的时间间隔是一个随机变量,服从15分到
145分之间的均匀分布；各船卸货时间也是一个服从45分到90分之间均匀分布
的随机变量.然后我们可以用发生均匀分布的随机数的方法，分别产生n个
[15，145]和[45，90]之间的随机数t_₁1}，t₂}，…，t{n和$u_{₁}，u_2}，…，u_{n模拟n艘船两两
之间到达的时间间隔和各艘船的卸货时间.
设初始时刻为0,利用船舶到达的时间间隔,我们可以计算出各船的到达时间
$a1=l₁1，a=aj-₁+t,（j=2，3，…，n)
有了这些数据后,我们就可以计算各艘船在码头等待卸货的时间，离开的时
间，以及两艘船之间卸货设备的闲置时间。
第一艘船到港就可以卸货，卸完货即可离开，因而有
$w_₁1=0，l1=a₁+u1
而在该船到达之前设备闲置，即
$d_{1}=a}$
以后各艘船到达码头时，若前一艘船已经离港，则马上可以卸货，否则必须
等待,等待时间为上一艘船的离港时间与本船到达时间之差，从而第j艘船的等
待时间为
368

============================================================
第 387 页
============================================================

0,
$a_{}≥l$
$='n$
(j=2,3,·,n)
$l-1-a，a<l-1
或
w₁=max|0,l₁-a,}（j=2,3，…,n)
由此可得
$l₁=a+w+u
若第j艘船需等待卸货,设备不会闲置,但若第j艘船的到达时间迟于第j-1
艘船的离开时间,那么这段时间差就是设备的闲置时间,即
a_{-lj-1}，a₁≥l
$d_{}=$
(j=2,3,·,n)
0，
$a_{< l_}$
或
w₁=max|0,a-l-1}（j=2,3，…，n)
进一步可以用下式计算船只停留时间：
s_=l₁-a,(j=1,2，·,n)
以及船只最大和平均停留时间以及最大和平均等待时间
1
$S_m}$
=max sj,
$"s$
=
$ }$
1≤j≤n
n
=
1
n
w
=max w,
∑
w
$w
m
1≤j≤n$
a
n
也可以计算设备闲置总时间和闲置时间百分比如下
n
_₁=∑d，R_=d₁n
$j$
由于t和u_;是随机产生的，重复进行计算，结果是会有差异的，所以仅用一
次计算的结果作为分析的依据是不合理的.较好的做法是重复进行多次模拟，取
各项数据的平均值作为分析的依据.
（2)模型的求解与应用
各种计算机高级语言和数学软件都有产生随机数的子程序或命令语句，随
机模拟是不难用一个简单的程序实现的.
我们以n=100为例,列出6次模拟的结果如下表所示，其中所有时间均以
分钟为单位.
船在港口的平均停留时间
106
85
101
116
112
94
船在港口的最长停留时间
287
180
233
280
234
264
船的平均等待时间
39
20
35
50
44
27
369

============================================================
第 388 页
============================================================

续表
船的最长等待时间
213
118
172
203
167
184
设备闲置时间的百分比
0.18
0.17
0.15
0.2
0.14
0.21
若为了提高码头的卸货能力,增加了部分劳力和改善了设备从而使卸货时
间减少至35至75分之间，两艘船到达的时间间隔仍为15~145分，六次模拟的
结果如下表所示.
船在港口的平均停留时间
74
62
64
67
67
73
船在港口的最长停留时间
161
116
167
178
173
190
船的平均等待时间
19
6
10
12
12
16
船的最长等待时间
102
58
102
110
104
131
设备闲置时间的百分比
0.25
0.33
0.32
0.3
0.31
0.27
从上表可见,每艘船的卸货时间缩短了15~20分,等待时间明显缩短,但设
备闲置时间的百分比增加了一倍.为了提高效率，可以接纳更多的船只来港卸
货，于是将两艘船到达的时间间隔缩短为10~120分.在装载时间仍为35~75分
的情况下,再进行6次模拟,其结果如下表所示.此时等待时间增加了，但设备闲
置时间减少了.
114
79
96
88
126
船在港口的平均停留时间
115
248
224
205
171
371
223
船在港口的最长停留时间
船的平均等待时间
57
24
41
35
71
61
175
152
155
122
船的最长等待时间
309
173
0.15
0.19
0.12
0.14
设备闲置时间的百分比
0.17
0.06
第8章习题
(A)
1．最大可能法：一般加固设计.期望值法:一般加固设计.利用效用函数：常
规设计.
2.决策树如下图所示.最优方案为不搬走，筑一防护堤.
370

============================================================
第 389 页
============================================================

$x_{1} .25
△
2000
3000
$x_{2} .73
△
2 000
$_{3} 0.002$
52000
$a_{}$
$ {1i} 25
4000
4000
$x_{2} 0.73
4000
a_{2
$ _{3} ..02$
X
4000
2 700
$x_{1i} 25
$a_{}$
△
1 500
决策点
2700
$x_{2} .73
△
1500
$ _{3} 0.02$
aa
61500
$ {1i} 02 5
V
10000
3700
$_{2} ..73
△0
$x_{3} 0. 0$
△60000
3.(1)乐观法:大批量购进;悲观法：小批量购进；乐观系数法:大批量购
进;后悔值法:大批量购进;等可能法:大批量购进.(2)大批量购进；44万元.
4.公司应求助于咨询部门的帮助,获利800元，公司应开发该项目.
(B)
1.略.
2.利用计算机模拟，得到A公司经营状况好坏的概率如下:第一年“好”的
概率为0.6，“坏”的概率为0.4.在第一年“好”的情况下，第二年“好”的概率为
0.7,“坏”的概率为0.3；在第一年“坏”的情况下，第二年“好”的概率为0.4,
“坏”的概率为0.6.具体信息如下表所示.
A公司的经营状况
决策方案
收益/千元
第一年
第二年
好
好
800
第一年用全部
好
坏
-500
资金购买股票
坏
好
600
坏
坏
-700
371

============================================================
第 390 页
============================================================

续表
A公司的经营状况
决策方案
收益/千元
第一年
第二年
好
好
300
仅第一年用一半
好
坏
0
资金购买股票
坏
好
100
坏
坏
-100
好
好
600
两年各用一半
好
坏
-600
资金购买股票
坏
好
500
坏
坏
-400
买债券
50
这样,风险投资问题可归结为一个多阶段决策问题.
为了比较直观地反映决策者选择不同方案,在各种不同情况下的可能收益，
可以采用决策树来表示.
0.7
800
C11
0.6
[410]
0.3
-500
$C_}$
[174]
0.4
600
0.4
C12
[-180]
0.6
-700
0.7
600
另一半
全部买股票
买股票
[240]
0.3
-600
d{12$
[240]
0.7
-300
0.6
另一半
一半
不买股票
[210]
0.3
0
买股票
$d_{}$
0.4
500
[174]
[136]
另一半
买股票
0.4
[-40]
0.6
-400
$_22$
[-20]
0.4
100
买债券
另一半
不买股票
[-20]
0.6
-100
50
[50]
372

============================================================
第 391 页
============================================================

画出决策树后,就可以着手计算不同决策的期望收益.具体计算从右向左进
行，对于第一个方案第二阶段的机会点$C_{1，其期望收益为800×0.7+(-500)×
0.3=410，将这个值写在机会点$_{1}的下面.同样地，第一个方案第二阶段的机会
点C_{2，其期望收益为600×0.4+(-700)×0.6=-180，将这个值写在机会点$C_{2}
下面.这样，机会点C_{1的期望收益值为410×0.6+(-180)×0.4=174，这就是第一
个方案最终的期望收益,将这个值写在机会点_{的下面.同理可以计算出其他
机会点的期望收益。
再来看决策点的选择.对于决策点$_{21}，$有两种选择$C_{2}和$C_22}C_{21}的_望收益
为240{$C_2}的期望收益为$210$，因此决策点$_{21应选择$C_{21}，期望收益为$240$，将240$
写在$d_{1}的下面，表示这个决策所得到的期望收益.类似地，对于决策点$d_{2}，应
择$C_{2{4}，_期望收益为-20$.而对于决策点d_{1}，有$种选择$C_{}，C_{2}和$C_3}其期望收益
分别为174,136,50,故应选择第一种方案,期望收益值为174.
第9章习题
(A)
1.略.
1
1
$2f
2.A=
1
3
2
4
3.略.
4.（1）（α₂，β2），（2）（α₁}，β2），（3）（α₂，β₁1），（4）（α₂，β₁).
5.略.
8
v=
3
(2) x=(0,3，0,）
2
3
16
=(0,0,
=
5
9
1
$Y^{}=
,0,
22
v=
11
7.略.
8.(1)x{=(
1
2
2
,0,
1
$Y*
,0)
4
3
3
3
3
v=
3
(2) X{=
17
20
9
14
12
20
$Y ^{}=
30
46
466
66
46'46'46
v=
46

============================================================
第 392 页
============================================================

9.根据定义证明.
10.核心C={(4，3-x，3+x)|0≤x≤2}，核仁N=(4，2，4)，Shapley值
28 1319
φ(V) =
，其余略.
6
中
6
,
6
2
Shapley值φ(V)=
稳定集
20'20'3030'30
V₁=l（y₁，y₂，₃，0，0）|y₁≥0，i=1,2,3，y₁+y₂+y₃=1}
V2=（y₁，y₂，0,y₃，0）|y₁≥0，=1，2，3，y₁+y₂+y₃=1}
₃3=（y₁，y₂，0，0,₃）|y₁≥0，=1，2，3，y₁+y₂+y3=1
12.略.
13.局中人i的支付函数为：
u₁(1,xN₁(c)））)=1-c
u_₁}（O，xN；(c））=1，如果存在某个j∈N₂（G)，有x₁=1$
u}（O，_N(c））=0，如果所有的j∈N₁（G)，有x₁}=0
其中1>c>0$.
(B)
1.略.
2.三城镇建厂方案一共有以下5种：
（1）三城镇分别建造.建造费用分别为
F(1)=73×507²=230（万元），F(2)）=73×30}7²2=160(万元），
F(3)）=73×60²=261（万元），
总投资额为F(1)+F(2)+F(3)=651(万元).
(2)城1,2合作，在城2处建厂，城3单独建.建造费用为
F(1，2)=73×(5+3）0.7²+0.66×50°×x20=351（万元），
总投资额为F(1,2)+F(3)=612(万元).
（3)城2,3合作，在城3处建厂，城1单独建.建造费用为
F(2，3）=73×（3+6）0²+0.66×3°×38=393（万元），
总投资额为F(2,3)+F(1)=623(万元).
(4)城1,3合作，在城3处建厂，城2单独建.建造费用为
F(1，3)=73×(5+6）0.7²+0.66×501×x58=490（万元），
总投资额为F(1,3)+F(2)=650(万元).
(5)三方合作建厂.建造费用为
374

============================================================
第 393 页
============================================================

F(1，23)=73×（5+3+6）07²+0.66×5^.×20+
0.66×(5+3)0^×38=580(万元)。
比较以上方案,费用最省的自然是第5种，三城镇自然都会考虑合作建设.
那么，应该如何分担这笔合作建造费用?
如果不采用 Shapley的方法,人们首先会想到根据排放污水量平均分担的办
法.于是，城1应该分担
5
V(1)=$
×580=207（万元），
5+3+6
同样，城2应分担V(2)=124万元，城3应分担V(3)=249万元.
然而，按照这样的方案，城1可以节省23万元，城2可节省36万元，城3却
只能节省12万元,似乎并不尽合理.
考虑到合作建厂的费用由建处理厂和铺设管道两部分组成，城3提出另外
的方案：建处理厂费用应按排污量平均分担，而2,3段管道费用应由1,2两城分
担，1,2段管道费用由城1单独承担.这种方案貌似公平，但仔细算来，城3只需
承担费用
6
V(3)=$
×73×(5+3+6)0.7=205(万元）
5+3+6
而城2和城1的费用将分别达到138万元和237万元(计算略).城1甚至超过
单独建厂的费用,这显然是不合理的.
如果采用Shapley的方法,我们可以把合作方案节省的投资额看成收
益，它将符合特征函数的要求.因此,可以用 Shapley值计算各方节省的资金
额.更方便地，可以直接用各种合作方案的建造费用作为效益函数计算
Shapley值，其结果就是各方应承担的投资费用.用上述数据计算，以第1城
为例，可得下表
's
|1}
{1,2}
{1,3}
{1,2,3}
$v( S_{)$
230
351
490
580
v(S_\i$
0
160
260
393
Δ_v
230
191
229
187
$_{}$
1
2
2
ω
$w(|_{)
1/3
1/6
1/6
1/3
w(|_{;|)·Δ
230/3
191/6
229/6
187/3
∑
209
375

============================================================
第 394 页
============================================================

即得$p_{1}=20$9万元$.类似地可以计算得到$p_{2=125万元，p_{3}=245万元.也就是说，
如果三方合作,则各方投资应按上述比例分摊.这时，各方按排污量平均每秒吨
的投资额分别为41.8万元、41.67万元和40.83万元.排放距离即铺设管道长
些,承担费用略大些.各方节省额的差额比按照排放污水量平均分担方案小些。
这种分摊结果还是更合理些.
376

============================================================
第 395 页
============================================================

郑重声明
高等教育出版社依法对本书享有专有出版权。任何未经许可
的复制、销售行为均违反《中华人民共和国著作权法》,其行为人将
承担相应的民事责任和行政责任;构成犯罪的,将被依法追究刑事
责任。为了维护市场秩序,保护读者的合法权益，避免读者误用盗
版书造成不良后果,我社将配合行政执法部门和司法机关对违法犯
罪的单位和个人进行严厉打击。社会各界人士如发现上述侵权行
为，希望及时举报，本社将奖励举报有功人员。
反盗版举报电话(010)58581999 58582371 58582488
反盗版举报传真
(010)82086060
反盗版举报邮箱
dd@ hep.com.cn
通信地址北京市西城区德外大街4号高等教育出版社法律事务与
版权管理部
邮政编码100120
防伪查询说明
用户购书后刮开封底防伪涂层，利用手机微信等软件扫描二维码，会跳
转至防伪查询网页，获得所购图书详细信息。也可将防伪二维码下的20位
密码按从左到右、从上到下的顺序发送短信至106695881280,免费查询所购
图书真伪。
反盗版短信举报
编辑短信“JB，图书名称，出版社，购买地点”发送至10669588128
防伪客服电话
(010)58582300
与本书配套的数字课程资源使用说明
一、注册/登录
访问http://abook.hep.com.cn/，点击“注册”,在注册页面输入用户名
密码及常用的邮箱进行注册。已注册的用户直接输人用户名和密码登录即
可进入“我的课程”页面。
二、课程绑定
点击“我的课程”页面右上方“绑定课程”，正确输入教材封底防伪标签
上的20位密码，点击“确定”完成课程绑定。
三、访问课程
在“正在学习”列表中选择已绑定的课程，点击“进人课程”即可浏览或
下载与本书配套的课程资源。刚绑定的课程请在"申请学习”列表中选择
相应课程并点击“进人课程”。
密码自登录之日起一年内有效，过期作废。
如有账号问题，请发邮件至：zhangyy2@ hep.com.cn。

